{"version":3,"file":"clients/example.min.js","mappings":"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CNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,GAGFC,GAAsB,CAC1BhE,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,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","sources":["webpack://mdx-m3-viewer/./node_modules/events/events.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/defs.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/fengaricore.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lapi.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lauxlib.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lcode.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/ldebug.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/ldo.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/ldump.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lfunc.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/ljstype.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/llex.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/llimits.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lobject.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lopcodes.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lparser.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lstate.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lstring.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/ltable.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/ltm.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lua.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/luaconf.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lundump.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lvm.js","webpack://mdx-m3-viewer/./node_modules/fengari/src/lzio.js","webpack://mdx-m3-viewer/webpack/bootstrap","webpack://mdx-m3-viewer/webpack/runtime/define property getters","webpack://mdx-m3-viewer/webpack/runtime/hasOwnProperty shorthand","webpack://mdx-m3-viewer/webpack/runtime/make namespace object","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/common.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/mat2.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/mat2d.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/mat3.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/mat4.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/vec3.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/vec4.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/quat.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/quat2.js","webpack://mdx-m3-viewer/./node_modules/gl-matrix/esm/vec2.js","webpack://mdx-m3-viewer/./src/common/gl-matrix-addon.ts","webpack://mdx-m3-viewer/./src/common/math.ts","webpack://mdx-m3-viewer/./src/common/canvas.ts","webpack://mdx-m3-viewer/./src/common/utf8.ts","webpack://mdx-m3-viewer/./src/common/bytesof.ts","webpack://mdx-m3-viewer/./src/common/searches.ts","webpack://mdx-m3-viewer/./src/common/typecast.ts","webpack://mdx-m3-viewer/./src/common/binarystream.ts","webpack://mdx-m3-viewer/./src/common/bitstream.ts","webpack://mdx-m3-viewer/./src/common/path.ts","webpack://mdx-m3-viewer/./src/common/isformat.ts","webpack://mdx-m3-viewer/./src/parsers/ini/file.ts","webpack://mdx-m3-viewer/./src/parsers/slk/file.ts","webpack://mdx-m3-viewer/./src/common/stringreverse.ts","webpack://mdx-m3-viewer/./src/parsers/m3/reference.ts","webpack://mdx-m3-viewer/./src/parsers/m3/md34.ts","webpack://mdx-m3-viewer/./src/parsers/m3/boundingsphere.ts","webpack://mdx-m3-viewer/./src/parsers/m3/boundingshape.ts","webpack://mdx-m3-viewer/./src/parsers/m3/animationreference.ts","webpack://mdx-m3-viewer/./src/parsers/m3/sd.ts","webpack://mdx-m3-viewer/./src/parsers/m3/unsupportedentry.ts","webpack://mdx-m3-viewer/./src/parsers/m3/indexentry.ts","webpack://mdx-m3-viewer/./src/parsers/m3/modelheader.ts","webpack://mdx-m3-viewer/./src/parsers/m3/sequence.ts","webpack://mdx-m3-viewer/./src/parsers/m3/stc.ts","webpack://mdx-m3-viewer/./src/parsers/m3/stg.ts","webpack://mdx-m3-viewer/./src/parsers/m3/sts.ts","webpack://mdx-m3-viewer/./src/parsers/m3/bone.ts","webpack://mdx-m3-viewer/./src/parsers/m3/division.ts","webpack://mdx-m3-viewer/./src/parsers/m3/region.ts","webpack://mdx-m3-viewer/./src/parsers/m3/batch.ts","webpack://mdx-m3-viewer/./src/parsers/m3/materialreference.ts","webpack://mdx-m3-viewer/./src/parsers/m3/standardmaterial.ts","webpack://mdx-m3-viewer/./src/parsers/m3/layer.ts","webpack://mdx-m3-viewer/./src/parsers/m3/event.ts","webpack://mdx-m3-viewer/./src/parsers/m3/attachmentpoint.ts","webpack://mdx-m3-viewer/./src/parsers/m3/camera.ts","webpack://mdx-m3-viewer/./src/parsers/m3/model.ts","webpack://mdx-m3-viewer/./src/parsers/m3/isformat.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/tokenstream.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/extent.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/sequence.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/animations.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/animationmap.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/animatedobject.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/layer.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/material.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/texture.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/textureanimation.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/geoset.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/geosetanimation.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/genericobject.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/bone.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/light.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/helper.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/attachment.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/particleemitter.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/particleemitter2.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/particleemitterpopcorn.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/ribbonemitter.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/camera.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/eventobject.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/collisionshape.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/faceeffect.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/unknownchunk.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/isformat.ts","webpack://mdx-m3-viewer/./src/parsers/mdlx/model.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/block.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/constants.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/blocktable.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/crypto.ts","webpack://mdx-m3-viewer/./node_modules/pako/dist/pako.esm.mjs","webpack://mdx-m3-viewer/./src/parsers/mpq/explode.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/isarchive.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/file.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/hash.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/hashtable.ts","webpack://mdx-m3-viewer/./src/parsers/mpq/archive.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/imp/import.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/imp/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3u/modification.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3u/modifiedobject.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3u/modificationtable.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3d/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3u/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wct/customtexttrigger.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wct/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/triggercategory.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/variable.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/subparameters.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/parameter.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/eca.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/trigger.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wtg/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/wts/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/force.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/player.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/randomitem.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/randomitemset.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/randomitemtable.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/randomunit.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/randomunittable.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/techavailabilitychange.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/upgradeavailabilitychange.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3i/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/map.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/doo/randomitem.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/doo/randomitemset.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/doo/doodad.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/doo/terraindoodad.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/doo/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3e/corner.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/w3e/file.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/droppeditem.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/droppeditemset.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/inventoryitem.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/modifiedability.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/randomunit.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/unit.ts","webpack://mdx-m3-viewer/./src/parsers/w3x/unitsdoo/file.ts","webpack://mdx-m3-viewer/./src/common/convertbitrange.ts","webpack://mdx-m3-viewer/./src/parsers/blp/jpg.js","webpack://mdx-m3-viewer/./src/parsers/blp/image.ts","webpack://mdx-m3-viewer/./src/parsers/blp/index.ts","webpack://mdx-m3-viewer/./src/common/dxt.ts","webpack://mdx-m3-viewer/./src/parsers/dds/image.ts","webpack://mdx-m3-viewer/./src/parsers/dds/isformat.ts","webpack://mdx-m3-viewer/./src/parsers/dds/index.ts","webpack://mdx-m3-viewer/./node_modules/tga-js/dist/esm/tga.js","webpack://mdx-m3-viewer/./src/parsers/tga/image.ts","webpack://mdx-m3-viewer/./src/parsers/tga/isformat.ts","webpack://mdx-m3-viewer/./src/common/fetchdatatype.ts","webpack://mdx-m3-viewer/./src/viewer/gl/clientbuffer.ts","webpack://mdx-m3-viewer/./src/viewer/gl/clientdatatexture.ts","webpack://mdx-m3-viewer/./src/viewer/gl/datatexture.ts","webpack://mdx-m3-viewer/./src/viewer/gl/shader.ts","webpack://mdx-m3-viewer/./src/viewer/gl/gl.ts","webpack://mdx-m3-viewer/./src/viewer/camera.ts","webpack://mdx-m3-viewer/./src/viewer/cell.ts","webpack://mdx-m3-viewer/./src/viewer/grid.ts","webpack://mdx-m3-viewer/./src/viewer/emittedobjectupdater.ts","webpack://mdx-m3-viewer/./src/viewer/scene.ts","webpack://mdx-m3-viewer/./src/viewer/resource.ts","webpack://mdx-m3-viewer/./src/viewer/genericresource.ts","webpack://mdx-m3-viewer/./src/viewer/handlerresource.ts","webpack://mdx-m3-viewer/./src/viewer/texture.ts","webpack://mdx-m3-viewer/./src/viewer/imagetexture.ts","webpack://mdx-m3-viewer/./src/viewer/viewer.ts","webpack://mdx-m3-viewer/./src/viewer/node.ts","webpack://mdx-m3-viewer/./src/viewer/bounds.ts","webpack://mdx-m3-viewer/./src/viewer/model.ts","webpack://mdx-m3-viewer/./src/viewer/modelinstance.ts","webpack://mdx-m3-viewer/./src/viewer/gl/index.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/blp/handler.ts","webpack://mdx-m3-viewer/./src/parsers/blp/isformat.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/blp/texture.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/dds/handler.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/dds/texture.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/texture.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/layer.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/standardmaterial.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/bone.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/sequence.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/sts.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/sd.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/stc.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/stg.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/attachment.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/camera.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/region.ts","webpack://mdx-m3-viewer/./src/viewer/skeletalnode.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/node.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/skeleton.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/modelinstance.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/batch.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/shaders/bonetexture.glsl.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/shaders/standard.vert.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/shaders/precision.glsl.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/shaders/standard.frag.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/handler.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/m3/model.ts","webpack://mdx-m3-viewer/./src/common/audio.ts","webpack://mdx-m3-viewer/./src/utils/mappeddata.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/sequence.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/sd.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/animatedobject.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/textureanimation.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/filtermode.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/layer.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/material.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/geosetanimation.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/replaceableids.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/genericobject.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/bone.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/light.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/helper.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/attachment.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/particleemitterobject.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/geometryemitterfuncs.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/texture.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/particleemitter2object.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/ribbonemitterobject.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/camera.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectemitterobject.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/collisionshape.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/batch.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/geoset.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/batchgroup.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/emittergroup.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/setupgroups.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/node.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/attachmentinstance.ts","webpack://mdx-m3-viewer/./src/viewer/emitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/emitter.ts","webpack://mdx-m3-viewer/./src/viewer/emittedobject.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/particle.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/particleemitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/particle2.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/particleemitter2.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/ribbon.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/ribbonemitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectemitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectspn.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectspnemitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectsplubr.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectsplemitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectubremitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectsnd.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/eventobjectsndemitter.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/modelinstance.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/transforms.glsl.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/sd.vert.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/sd.frag.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/hd.vert.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/hd.frag.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/particles.frag.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/handler.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/shaders/particles.vert.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/model.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/mdx/setupgeosets.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/tga/handler.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/tga/texture.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/shaders/ground.frag.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/shaders/water.frag.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/shaders/cliffs.frag.ts","webpack://mdx-m3-viewer/./src/common/arrayunique.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/variations.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/terrainmodel.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/standsequence.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/widget.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/unit.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/doodad.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/terraindoodad.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/map.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/index.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/viewer.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/shaders/ground.vert.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/shaders/water.vert.ts","webpack://mdx-m3-viewer/./src/viewer/handlers/w3x/shaders/cliffs.vert.ts","webpack://mdx-m3-viewer/./src/viewer/index.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/handle.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/agent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/player.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/widget.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/unit.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/force.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/group.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/trigger.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/timer.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/location.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/region.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/rect.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/enum.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/race.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/alliancetype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/racepreference.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/gamestate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/igamestate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/fgamestate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playerstate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playerscore.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playergameresult.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/unitstate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/aidifficulty.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/eventid.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/gameevent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playerevent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playerunitevent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/unitevent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/limitop.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/widgetevent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/dialogevent.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/unittype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/gamespeed.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/gamedifficulty.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/gametype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/mapflag.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/mapvisibility.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/mapsetting.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/mapdensity.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/mapcontrol.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playerslotstate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/volumegroup.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/camerafield.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/camerasetup.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/playercolor.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/placement.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/startlocprio.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/raritycontrol.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/blendmode.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/texmapflags.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/effecttype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/weathereffect.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/fogstate.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/version.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/itemtype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/attacktype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/damagetype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/weapontype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/soundtype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/pathingtype.ts","webpack://mdx-m3-viewer/./src/utils/jass2/types/hashtable.ts","webpack://mdx-m3-viewer/./src/utils/jass2/context.ts","webpack://mdx-m3-viewer/./src/utils/mdlx/sanitytest/utils.ts","webpack://mdx-m3-viewer/./src/utils/mdlx/primitives/primitives.ts","webpack://mdx-m3-viewer/./src/utils/w3x/weu/conversions.ts","webpack://mdx-m3-viewer/./clients/shared/camera.js","webpack://mdx-m3-viewer/./clients/example/index.js"],"sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","\"use strict\";\n\n/*\n * Fengari specific string conversion functions\n */\n\nlet luastring_from;\nif (typeof Uint8Array.from === \"function\") {\n    luastring_from = Uint8Array.from.bind(Uint8Array);\n} else {\n    luastring_from = function(a) {\n        let i = 0;\n        let len = a.length;\n        let r = new Uint8Array(len);\n        while (len > i) r[i] = a[i++];\n        return r;\n    };\n}\n\nlet luastring_indexOf;\nif (typeof (new Uint8Array().indexOf) === \"function\") {\n    luastring_indexOf = function(s, v, i) {\n        return s.indexOf(v, i);\n    };\n} else {\n    /* Browsers that don't support Uint8Array.indexOf seem to allow using Array.indexOf on Uint8Array objects e.g. IE11 */\n    let array_indexOf = [].indexOf;\n    if (array_indexOf.call(new Uint8Array(1), 0) !== 0) throw Error(\"missing .indexOf\");\n    luastring_indexOf = function(s, v, i) {\n        return array_indexOf.call(s, v, i);\n    };\n}\n\nlet luastring_of;\nif (typeof Uint8Array.of === \"function\") {\n    luastring_of = Uint8Array.of.bind(Uint8Array);\n} else {\n    luastring_of = function() {\n        return luastring_from(arguments);\n    };\n}\n\nconst is_luastring = function(s) {\n    return s instanceof Uint8Array;\n};\n\n/* test two lua strings for equality */\nconst luastring_eq = function(a, b) {\n    if (a !== b) {\n        let len = a.length;\n        if (len !== b.length) return false;\n        /* XXX: Should this be a constant time algorithm? */\n        for (let i=0; i<len; i++)\n            if (a[i] !== b[i]) return false;\n    }\n    return true;\n};\n\nconst unicode_error_message = \"cannot convert invalid utf8 to javascript string\";\nconst to_jsstring = function(value, from, to, replacement_char) {\n    if (!is_luastring(value)) throw new TypeError(\"to_jsstring expects a Uint8Array\");\n\n    if (to === void 0) {\n        to = value.length;\n    } else {\n        to = Math.min(value.length, to);\n    }\n\n    let str = \"\";\n    for (let i = (from!==void 0?from:0); i < to;) {\n        let u0 = value[i++];\n        if (u0 < 0x80) {\n            /* single byte sequence */\n            str += String.fromCharCode(u0);\n        } else if (u0 < 0xC2 || u0 > 0xF4) {\n            if (!replacement_char) throw RangeError(unicode_error_message);\n            str += \"�\";\n        } else if (u0 <= 0xDF) {\n            /* two byte sequence */\n            if (i >= to) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u1 = value[i++];\n            if ((u1&0xC0) !== 0x80) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            str += String.fromCharCode(((u0 & 0x1F) << 6) + (u1 & 0x3F));\n        } else if (u0 <= 0xEF) {\n            /* three byte sequence */\n            if (i+1 >= to) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u1 = value[i++];\n            if ((u1&0xC0) !== 0x80) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u2 = value[i++];\n            if ((u2&0xC0) !== 0x80) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u = ((u0 & 0x0F) << 12) + ((u1 & 0x3F) << 6) + (u2 & 0x3F);\n            if (u <= 0xFFFF) { /* BMP codepoint */\n                str += String.fromCharCode(u);\n            } else { /* Astral codepoint */\n                u -= 0x10000;\n                let s1 = (u >> 10) + 0xD800;\n                let s2 = (u % 0x400) + 0xDC00;\n                str += String.fromCharCode(s1, s2);\n            }\n        } else {\n            /* four byte sequence */\n            if (i+2 >= to) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u1 = value[i++];\n            if ((u1&0xC0) !== 0x80) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u2 = value[i++];\n            if ((u2&0xC0) !== 0x80) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            let u3 = value[i++];\n            if ((u3&0xC0) !== 0x80) {\n                if (!replacement_char) throw RangeError(unicode_error_message);\n                str += \"�\";\n                continue;\n            }\n            /* Has to be astral codepoint */\n            let u = ((u0 & 0x07) << 18) + ((u1 & 0x3F) << 12) + ((u2 & 0x3F) << 6) + (u3 & 0x3F);\n            u -= 0x10000;\n            let s1 = (u >> 10) + 0xD800;\n            let s2 = (u % 0x400) + 0xDC00;\n            str += String.fromCharCode(s1, s2);\n        }\n    }\n    return str;\n};\n\n/* bytes allowed unescaped in a uri */\nconst uri_allowed = (\";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#\").split('').reduce(function(uri_allowed, c) {\n    uri_allowed[c.charCodeAt(0)] = true;\n    return uri_allowed;\n}, {});\n\n/* utility function to convert a lua string to a js string with uri escaping */\nconst to_uristring = function(a) {\n    if (!is_luastring(a)) throw new TypeError(\"to_uristring expects a Uint8Array\");\n    let s = \"\";\n    for (let i=0; i<a.length; i++) {\n        let v = a[i];\n        if (uri_allowed[v]) {\n            s += String.fromCharCode(v);\n        } else {\n            s += \"%\" + (v<0x10?\"0\":\"\") + v.toString(16);\n        }\n    }\n    return s;\n};\n\nconst to_luastring_cache = {};\n\nconst to_luastring = function(str, cache) {\n    if (typeof str !== \"string\") throw new TypeError(\"to_luastring expects a javascript string\");\n\n    if (cache) {\n        let cached = to_luastring_cache[str];\n        if (is_luastring(cached)) return cached;\n    }\n\n    let len = str.length;\n    let outU8Array = Array(len); /* array is at *least* going to be length of string */\n    let outIdx = 0;\n    for (let i = 0; i < len; ++i) {\n        let u = str.charCodeAt(i);\n        if (u <= 0x7F) {\n            outU8Array[outIdx++] = u;\n        } else if (u <= 0x7FF) {\n            outU8Array[outIdx++] = 0xC0 | (u >> 6);\n            outU8Array[outIdx++] = 0x80 | (u & 63);\n        } else {\n            /* This part is to work around possible lack of String.codePointAt */\n            if (u >= 0xD800 && u <= 0xDBFF && (i+1) < len) {\n                /* is first half of surrogate pair */\n                let v = str.charCodeAt(i+1);\n                if (v >= 0xDC00 && v <= 0xDFFF) {\n                    /* is valid low surrogate */\n                    i++;\n                    u = (u - 0xD800) * 0x400 + v + 0x2400;\n                }\n            }\n            if (u <= 0xFFFF) {\n                outU8Array[outIdx++] = 0xE0 | (u >> 12);\n                outU8Array[outIdx++] = 0x80 | ((u >> 6) & 63);\n                outU8Array[outIdx++] = 0x80 | (u & 63);\n            } else {\n                outU8Array[outIdx++] = 0xF0 | (u >> 18);\n                outU8Array[outIdx++] = 0x80 | ((u >> 12) & 63);\n                outU8Array[outIdx++] = 0x80 | ((u >> 6) & 63);\n                outU8Array[outIdx++] = 0x80 | (u & 63);\n            }\n        }\n    }\n    outU8Array = luastring_from(outU8Array);\n\n    if (cache) to_luastring_cache[str] = outU8Array;\n\n    return outU8Array;\n};\n\nconst from_userstring = function(str) {\n    if (!is_luastring(str)) {\n        if (typeof str === \"string\") {\n            str = to_luastring(str);\n        } else {\n            throw new TypeError(\"expects an array of bytes or javascript string\");\n        }\n    }\n    return str;\n};\n\nmodule.exports.luastring_from    = luastring_from;\nmodule.exports.luastring_indexOf = luastring_indexOf;\nmodule.exports.luastring_of      = luastring_of;\nmodule.exports.is_luastring      = is_luastring;\nmodule.exports.luastring_eq      = luastring_eq;\nmodule.exports.to_jsstring       = to_jsstring;\nmodule.exports.to_uristring      = to_uristring;\nmodule.exports.to_luastring      = to_luastring;\nmodule.exports.from_userstring   = from_userstring;\n\n\n/* mark for precompiled code ('<esc>Lua') */\nconst LUA_SIGNATURE = to_luastring(\"\\x1bLua\");\n\nconst LUA_VERSION_MAJOR   = \"5\";\nconst LUA_VERSION_MINOR   = \"3\";\nconst LUA_VERSION_NUM     = 503;\nconst LUA_VERSION_RELEASE = \"4\";\n\nconst LUA_VERSION         = \"Lua \" + LUA_VERSION_MAJOR + \".\" + LUA_VERSION_MINOR;\nconst LUA_RELEASE         = LUA_VERSION + \".\" + LUA_VERSION_RELEASE;\nconst LUA_COPYRIGHT       = LUA_RELEASE + \"  Copyright (C) 1994-2017 Lua.org, PUC-Rio\";\nconst LUA_AUTHORS         = \"R. Ierusalimschy, L. H. de Figueiredo, W. Celes\";\n\nmodule.exports.LUA_SIGNATURE       = LUA_SIGNATURE;\nmodule.exports.LUA_VERSION_MAJOR   = LUA_VERSION_MAJOR;\nmodule.exports.LUA_VERSION_MINOR   = LUA_VERSION_MINOR;\nmodule.exports.LUA_VERSION_NUM     = LUA_VERSION_NUM;\nmodule.exports.LUA_VERSION_RELEASE = LUA_VERSION_RELEASE;\nmodule.exports.LUA_VERSION         = LUA_VERSION;\nmodule.exports.LUA_RELEASE         = LUA_RELEASE;\nmodule.exports.LUA_COPYRIGHT       = LUA_COPYRIGHT;\nmodule.exports.LUA_AUTHORS         = LUA_AUTHORS;\n\n\nconst thread_status = {\n    LUA_OK:        0,\n    LUA_YIELD:     1,\n    LUA_ERRRUN:    2,\n    LUA_ERRSYNTAX: 3,\n    LUA_ERRMEM:    4,\n    LUA_ERRGCMM:   5,\n    LUA_ERRERR:    6\n};\n\nconst constant_types = {\n    LUA_TNONE:          -1,\n    LUA_TNIL:           0,\n    LUA_TBOOLEAN:       1,\n    LUA_TLIGHTUSERDATA: 2,\n    LUA_TNUMBER:        3,\n    LUA_TSTRING:        4,\n    LUA_TTABLE:         5,\n    LUA_TFUNCTION:      6,\n    LUA_TUSERDATA:      7,\n    LUA_TTHREAD:        8,\n    LUA_NUMTAGS:        9\n};\n\nconstant_types.LUA_TSHRSTR = constant_types.LUA_TSTRING | (0 << 4);  /* short strings */\nconstant_types.LUA_TLNGSTR = constant_types.LUA_TSTRING | (1 << 4);  /* long strings */\n\nconstant_types.LUA_TNUMFLT = constant_types.LUA_TNUMBER | (0 << 4);  /* float numbers */\nconstant_types.LUA_TNUMINT = constant_types.LUA_TNUMBER | (1 << 4);  /* integer numbers */\n\nconstant_types.LUA_TLCL = constant_types.LUA_TFUNCTION | (0 << 4);  /* Lua closure */\nconstant_types.LUA_TLCF = constant_types.LUA_TFUNCTION | (1 << 4);  /* light C function */\nconstant_types.LUA_TCCL = constant_types.LUA_TFUNCTION | (2 << 4);  /* C closure */\n\n/*\n** Comparison and arithmetic functions\n*/\n\nconst LUA_OPADD  = 0;   /* ORDER TM, ORDER OP */\nconst LUA_OPSUB  = 1;\nconst LUA_OPMUL  = 2;\nconst LUA_OPMOD  = 3;\nconst LUA_OPPOW  = 4;\nconst LUA_OPDIV  = 5;\nconst LUA_OPIDIV = 6;\nconst LUA_OPBAND = 7;\nconst LUA_OPBOR  = 8;\nconst LUA_OPBXOR = 9;\nconst LUA_OPSHL  = 10;\nconst LUA_OPSHR  = 11;\nconst LUA_OPUNM  = 12;\nconst LUA_OPBNOT = 13;\n\nconst LUA_OPEQ = 0;\nconst LUA_OPLT = 1;\nconst LUA_OPLE = 2;\n\nconst LUA_MINSTACK = 20;\n\nconst { LUAI_MAXSTACK } = require('./luaconf.js');\nconst LUA_REGISTRYINDEX = -LUAI_MAXSTACK - 1000;\n\nconst lua_upvalueindex = function(i) {\n    return LUA_REGISTRYINDEX - i;\n};\n\n/* predefined values in the registry */\nconst LUA_RIDX_MAINTHREAD = 1;\nconst LUA_RIDX_GLOBALS    = 2;\nconst LUA_RIDX_LAST       = LUA_RIDX_GLOBALS;\n\nclass lua_Debug {\n    constructor() {\n        this.event = NaN;\n        this.name = null;           /* (n) */\n        this.namewhat = null;       /* (n) 'global', 'local', 'field', 'method' */\n        this.what = null;           /* (S) 'Lua', 'C', 'main', 'tail' */\n        this.source = null;         /* (S) */\n        this.currentline = NaN;     /* (l) */\n        this.linedefined = NaN;     /* (S) */\n        this.lastlinedefined = NaN; /* (S) */\n        this.nups = NaN;            /* (u) number of upvalues */\n        this.nparams = NaN;         /* (u) number of parameters */\n        this.isvararg = NaN;        /* (u) */\n        this.istailcall = NaN;      /* (t) */\n        this.short_src = null;      /* (S) */\n        /* private part */\n        this.i_ci = null;           /* active function */\n    }\n}\n\n/*\n** Event codes\n*/\nconst LUA_HOOKCALL     = 0;\nconst LUA_HOOKRET      = 1;\nconst LUA_HOOKLINE     = 2;\nconst LUA_HOOKCOUNT    = 3;\nconst LUA_HOOKTAILCALL = 4;\n\n\n/*\n** Event masks\n*/\nconst LUA_MASKCALL  = (1 << LUA_HOOKCALL);\nconst LUA_MASKRET   = (1 << LUA_HOOKRET);\nconst LUA_MASKLINE  = (1 << LUA_HOOKLINE);\nconst LUA_MASKCOUNT = (1 << LUA_HOOKCOUNT);\n\nmodule.exports.LUA_HOOKCALL            = LUA_HOOKCALL;\nmodule.exports.LUA_HOOKCOUNT           = LUA_HOOKCOUNT;\nmodule.exports.LUA_HOOKLINE            = LUA_HOOKLINE;\nmodule.exports.LUA_HOOKRET             = LUA_HOOKRET;\nmodule.exports.LUA_HOOKTAILCALL        = LUA_HOOKTAILCALL;\nmodule.exports.LUA_MASKCALL            = LUA_MASKCALL;\nmodule.exports.LUA_MASKCOUNT           = LUA_MASKCOUNT;\nmodule.exports.LUA_MASKLINE            = LUA_MASKLINE;\nmodule.exports.LUA_MASKRET             = LUA_MASKRET;\nmodule.exports.LUA_MINSTACK            = LUA_MINSTACK;\nmodule.exports.LUA_MULTRET             = -1;\nmodule.exports.LUA_OPADD               = LUA_OPADD;\nmodule.exports.LUA_OPBAND              = LUA_OPBAND;\nmodule.exports.LUA_OPBNOT              = LUA_OPBNOT;\nmodule.exports.LUA_OPBOR               = LUA_OPBOR;\nmodule.exports.LUA_OPBXOR              = LUA_OPBXOR;\nmodule.exports.LUA_OPDIV               = LUA_OPDIV;\nmodule.exports.LUA_OPEQ                = LUA_OPEQ;\nmodule.exports.LUA_OPIDIV              = LUA_OPIDIV;\nmodule.exports.LUA_OPLE                = LUA_OPLE;\nmodule.exports.LUA_OPLT                = LUA_OPLT;\nmodule.exports.LUA_OPMOD               = LUA_OPMOD;\nmodule.exports.LUA_OPMUL               = LUA_OPMUL;\nmodule.exports.LUA_OPPOW               = LUA_OPPOW;\nmodule.exports.LUA_OPSHL               = LUA_OPSHL;\nmodule.exports.LUA_OPSHR               = LUA_OPSHR;\nmodule.exports.LUA_OPSUB               = LUA_OPSUB;\nmodule.exports.LUA_OPUNM               = LUA_OPUNM;\nmodule.exports.LUA_REGISTRYINDEX       = LUA_REGISTRYINDEX;\nmodule.exports.LUA_RIDX_GLOBALS        = LUA_RIDX_GLOBALS;\nmodule.exports.LUA_RIDX_LAST           = LUA_RIDX_LAST;\nmodule.exports.LUA_RIDX_MAINTHREAD     = LUA_RIDX_MAINTHREAD;\nmodule.exports.constant_types          = constant_types;\nmodule.exports.lua_Debug               = lua_Debug;\nmodule.exports.lua_upvalueindex        = lua_upvalueindex;\nmodule.exports.thread_status           = thread_status;\n","/* Fengari specific functions\n *\n * This file includes fengari-specific data or and functionality for users to\n * manipulate fengari's string type.\n * The fields are exposed to the user on the 'fengari' entry point; however to\n * avoid a dependency on defs.js from lauxlib.js they are defined in this file.\n */\n\nconst defs = require(\"./defs.js\");\n\nconst FENGARI_VERSION_MAJOR   = \"0\";\nconst FENGARI_VERSION_MINOR   = \"1\";\nconst FENGARI_VERSION_NUM     = 1;\nconst FENGARI_VERSION_RELEASE = \"4\";\nconst FENGARI_VERSION         = \"Fengari \" + FENGARI_VERSION_MAJOR + \".\" + FENGARI_VERSION_MINOR;\nconst FENGARI_RELEASE         = FENGARI_VERSION + \".\" + FENGARI_VERSION_RELEASE;\nconst FENGARI_AUTHORS         = \"B. Giannangeli, Daurnimator\";\nconst FENGARI_COPYRIGHT       = FENGARI_RELEASE + \"  Copyright (C) 2017-2018 \" + FENGARI_AUTHORS + \"\\nBased on: \" + defs.LUA_COPYRIGHT;\n\nmodule.exports.FENGARI_AUTHORS         = FENGARI_AUTHORS;\nmodule.exports.FENGARI_COPYRIGHT       = FENGARI_COPYRIGHT;\nmodule.exports.FENGARI_RELEASE         = FENGARI_RELEASE;\nmodule.exports.FENGARI_VERSION         = FENGARI_VERSION;\nmodule.exports.FENGARI_VERSION_MAJOR   = FENGARI_VERSION_MAJOR;\nmodule.exports.FENGARI_VERSION_MINOR   = FENGARI_VERSION_MINOR;\nmodule.exports.FENGARI_VERSION_NUM     = FENGARI_VERSION_NUM;\nmodule.exports.FENGARI_VERSION_RELEASE = FENGARI_VERSION_RELEASE;\nmodule.exports.is_luastring            = defs.is_luastring;\nmodule.exports.luastring_eq            = defs.luastring_eq;\nmodule.exports.luastring_from          = defs.luastring_from;\nmodule.exports.luastring_indexOf       = defs.luastring_indexOf;\nmodule.exports.luastring_of            = defs.luastring_of;\nmodule.exports.to_jsstring             = defs.to_jsstring;\nmodule.exports.to_luastring            = defs.to_luastring;\nmodule.exports.to_uristring            = defs.to_uristring;\nmodule.exports.from_userstring         = defs.from_userstring;\n","\"use strict\";\n\nconst {\n    LUA_MULTRET,\n    LUA_OPBNOT,\n    LUA_OPEQ,\n    LUA_OPLE,\n    LUA_OPLT,\n    LUA_OPUNM,\n    LUA_REGISTRYINDEX,\n    LUA_RIDX_GLOBALS,\n    LUA_VERSION_NUM,\n    constant_types: {\n        LUA_NUMTAGS,\n        LUA_TBOOLEAN,\n        LUA_TCCL,\n        LUA_TFUNCTION,\n        LUA_TLCF,\n        LUA_TLCL,\n        LUA_TLIGHTUSERDATA,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNONE,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TSHRSTR,\n        LUA_TTABLE,\n        LUA_TTHREAD,\n        LUA_TUSERDATA\n    },\n    thread_status: { LUA_OK },\n    from_userstring,\n    to_luastring,\n} = require('./defs.js');\nconst { api_check } = require('./llimits.js');\nconst ldebug    = require('./ldebug.js');\nconst ldo       = require('./ldo.js');\nconst { luaU_dump } = require('./ldump.js');\nconst lfunc     = require('./lfunc.js');\nconst lobject   = require('./lobject.js');\nconst lstate    = require('./lstate.js');\nconst {\n    luaS_bless,\n    luaS_new,\n    luaS_newliteral\n} = require('./lstring.js');\nconst ltm       = require('./ltm.js');\nconst { LUAI_MAXSTACK } = require('./luaconf.js');\nconst lvm       = require('./lvm.js');\nconst ltable    = require('./ltable.js');\nconst { ZIO } = require('./lzio.js');\nconst TValue    = lobject.TValue;\nconst CClosure  = lobject.CClosure;\n\nconst api_incr_top = function(L) {\n    L.top++;\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n};\n\nconst api_checknelems = function(L, n) {\n    api_check(L, n < (L.top - L.ci.funcOff), \"not enough elements in the stack\");\n};\n\nconst fengari_argcheck = function(c) {\n    if (!c) throw TypeError(\"invalid argument\");\n};\n\nconst fengari_argcheckinteger = function(n) {\n    fengari_argcheck(typeof n === \"number\" && (n|0) === n);\n};\n\nconst isvalid = function(o) {\n    return o !== lobject.luaO_nilobject;\n};\n\nconst lua_version = function(L) {\n    if (L === null) return LUA_VERSION_NUM;\n    else return L.l_G.version;\n};\n\nconst lua_atpanic = function(L, panicf) {\n    let old = L.l_G.panic;\n    L.l_G.panic = panicf;\n    return old;\n};\n\nconst lua_atnativeerror = function(L, errorf) {\n    let old = L.l_G.atnativeerror;\n    L.l_G.atnativeerror = errorf;\n    return old;\n};\n\n// Return value for idx on stack\nconst index2addr = function(L, idx) {\n    let ci = L.ci;\n    if (idx > 0) {\n        let o = ci.funcOff + idx;\n        api_check(L, idx <= ci.top - (ci.funcOff + 1), \"unacceptable index\");\n        if (o >= L.top) return lobject.luaO_nilobject;\n        else return L.stack[o];\n    } else if (idx > LUA_REGISTRYINDEX) {\n        api_check(L, idx !== 0 && -idx <= L.top, \"invalid index\");\n        return L.stack[L.top + idx];\n    } else if (idx === LUA_REGISTRYINDEX) {\n        return L.l_G.l_registry;\n    } else { /* upvalues */\n        idx = LUA_REGISTRYINDEX - idx;\n        api_check(L, idx <= lfunc.MAXUPVAL + 1, \"upvalue index too large\");\n        if (ci.func.ttislcf()) /* light C function? */\n            return lobject.luaO_nilobject; /* it has no upvalues */\n        else {\n            return idx <= ci.func.value.nupvalues ? ci.func.value.upvalue[idx - 1] : lobject.luaO_nilobject;\n        }\n    }\n};\n\n// Like index2addr but returns the index on stack; doesn't allow pseudo indices\nconst index2addr_ = function(L, idx) {\n    let ci = L.ci;\n    if (idx > 0) {\n        let o = ci.funcOff + idx;\n        api_check(L, idx <= ci.top - (ci.funcOff + 1), \"unacceptable index\");\n        if (o >= L.top) return null;\n        else return o;\n    } else if (idx > LUA_REGISTRYINDEX) {\n        api_check(L, idx !== 0 && -idx <= L.top, \"invalid index\");\n        return L.top + idx;\n    } else { /* registry or upvalue */\n        throw Error(\"attempt to use pseudo-index\");\n    }\n};\n\nconst lua_checkstack = function(L, n) {\n    let res;\n    let ci = L.ci;\n    api_check(L, n >= 0, \"negative 'n'\");\n    if (L.stack_last - L.top > n) /* stack large enough? */\n        res = true;\n    else { /* no; need to grow stack */\n        let inuse = L.top + lstate.EXTRA_STACK;\n        if (inuse > LUAI_MAXSTACK - n)  /* can grow without overflow? */\n            res = false;  /* no */\n        else { /* try to grow stack */\n            ldo.luaD_growstack(L, n);\n            res = true;\n        }\n    }\n\n    if (res && ci.top < L.top + n)\n        ci.top = L.top + n;  /* adjust frame top */\n\n    return res;\n};\n\nconst lua_xmove = function(from, to, n) {\n    if (from === to) return;\n    api_checknelems(from, n);\n    api_check(from, from.l_G === to.l_G, \"moving among independent states\");\n    api_check(from, to.ci.top - to.top >= n, \"stack overflow\");\n    from.top -= n;\n    for (let i = 0; i < n; i++) {\n        to.stack[to.top] = new lobject.TValue();\n        lobject.setobj2s(to, to.top, from.stack[from.top + i]);\n        delete from.stack[from.top + i];\n        to.top++;\n    }\n};\n\n/*\n** basic stack manipulation\n*/\n\n/*\n** convert an acceptable stack index into an absolute index\n*/\nconst lua_absindex = function(L, idx) {\n    return (idx > 0 || idx <= LUA_REGISTRYINDEX)\n        ? idx\n        : (L.top - L.ci.funcOff) + idx;\n};\n\nconst lua_gettop = function(L) {\n    return L.top - (L.ci.funcOff + 1);\n};\n\nconst lua_pushvalue = function(L, idx) {\n    lobject.pushobj2s(L, index2addr(L, idx));\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n};\n\nconst lua_settop = function(L, idx) {\n    let func = L.ci.funcOff;\n    let newtop;\n    if (idx >= 0) {\n        api_check(L, idx <= L.stack_last - (func + 1), \"new top too large\");\n        newtop = func + 1 + idx;\n    } else {\n        api_check(L, -(idx + 1) <= L.top - (func + 1), \"invalid new top\");\n        newtop = L.top + idx + 1; /* 'subtract' index (index is negative) */\n    }\n    ldo.adjust_top(L, newtop);\n};\n\nconst lua_pop = function(L, n) {\n    lua_settop(L, -n - 1);\n};\n\nconst reverse = function(L, from, to) {\n    for (; from < to; from++, to--) {\n        let fromtv = L.stack[from];\n        let temp = new TValue(fromtv.type, fromtv.value);\n        lobject.setobjs2s(L, from, to);\n        lobject.setobj2s(L, to, temp);\n    }\n};\n\n/*\n** Let x = AB, where A is a prefix of length 'n'. Then,\n** rotate x n === BA. But BA === (A^r . B^r)^r.\n*/\nconst lua_rotate = function(L, idx, n) {\n    let t = L.top - 1;\n    let pIdx = index2addr_(L, idx);\n    let p = L.stack[pIdx];\n    api_check(L, isvalid(p) && idx > LUA_REGISTRYINDEX, \"index not in the stack\");\n    api_check(L, (n >= 0 ? n : -n) <= (t - pIdx + 1), \"invalid 'n'\");\n    let m = n >= 0 ? t - n : pIdx - n - 1;  /* end of prefix */\n    reverse(L, pIdx, m);\n    reverse(L, m + 1, L.top - 1);\n    reverse(L, pIdx, L.top - 1);\n};\n\nconst lua_copy = function(L, fromidx, toidx) {\n    let from = index2addr(L, fromidx);\n    index2addr(L, toidx).setfrom(from);\n};\n\nconst lua_remove = function(L, idx) {\n    lua_rotate(L, idx, -1);\n    lua_pop(L, 1);\n};\n\nconst lua_insert = function(L, idx) {\n    lua_rotate(L, idx, 1);\n};\n\nconst lua_replace = function(L, idx) {\n    lua_copy(L, -1, idx);\n    lua_pop(L, 1);\n};\n\n/*\n** push functions (JS -> stack)\n*/\n\nconst lua_pushnil = function(L) {\n    L.stack[L.top] = new TValue(LUA_TNIL, null);\n    api_incr_top(L);\n};\n\nconst lua_pushnumber = function(L, n) {\n    fengari_argcheck(typeof n === \"number\");\n    L.stack[L.top] = new TValue(LUA_TNUMFLT, n);\n    api_incr_top(L);\n};\n\nconst lua_pushinteger = function(L, n) {\n    fengari_argcheckinteger(n);\n    L.stack[L.top] = new TValue(LUA_TNUMINT, n);\n    api_incr_top(L);\n};\n\nconst lua_pushlstring = function(L, s, len) {\n    fengari_argcheckinteger(len);\n    let ts;\n    if (len === 0) {\n        s = to_luastring(\"\", true);\n        ts = luaS_bless(L, s);\n    } else {\n        s = from_userstring(s);\n        api_check(L, s.length >= len, \"invalid length to lua_pushlstring\");\n        ts = luaS_new(L, s.subarray(0, len));\n    }\n    lobject.pushsvalue2s(L, ts);\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    return ts.value;\n};\n\nconst lua_pushstring = function (L, s) {\n    if (s === undefined || s === null) {\n        L.stack[L.top] = new TValue(LUA_TNIL, null);\n        L.top++;\n    } else {\n        let ts = luaS_new(L, from_userstring(s));\n        lobject.pushsvalue2s(L, ts);\n        s = ts.getstr(); /* internal copy */\n    }\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    return s;\n};\n\nconst lua_pushvfstring = function (L, fmt, argp) {\n    fmt = from_userstring(fmt);\n    return lobject.luaO_pushvfstring(L, fmt, argp);\n};\n\nconst lua_pushfstring = function (L, fmt, ...argp) {\n    fmt = from_userstring(fmt);\n    return lobject.luaO_pushvfstring(L, fmt, argp);\n};\n\n/* Similar to lua_pushstring, but takes a JS string */\nconst lua_pushliteral = function (L, s) {\n    if (s === undefined || s === null) {\n        L.stack[L.top] = new TValue(LUA_TNIL, null);\n        L.top++;\n    } else {\n        fengari_argcheck(typeof s === \"string\");\n        let ts = luaS_newliteral(L, s);\n        lobject.pushsvalue2s(L, ts);\n        s = ts.getstr(); /* internal copy */\n    }\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n\n    return s;\n};\n\nconst lua_pushcclosure = function(L, fn, n) {\n    fengari_argcheck(typeof fn === \"function\");\n    fengari_argcheckinteger(n);\n    if (n === 0)\n        L.stack[L.top] = new TValue(LUA_TLCF, fn);\n    else {\n        api_checknelems(L, n);\n        api_check(L, n <= lfunc.MAXUPVAL, \"upvalue index too large\");\n        let cl = new CClosure(L, fn, n);\n        for (let i=0; i<n; i++)\n            cl.upvalue[i].setfrom(L.stack[L.top - n + i]);\n        for (let i=1; i<n; i++)\n            delete L.stack[--L.top];\n        if (n>0)\n            --L.top;\n        L.stack[L.top].setclCvalue(cl);\n    }\n    api_incr_top(L);\n};\n\nconst lua_pushjsclosure = lua_pushcclosure;\n\nconst lua_pushcfunction = function(L, fn) {\n    lua_pushcclosure(L, fn, 0);\n};\n\nconst lua_pushjsfunction = lua_pushcfunction;\n\nconst lua_pushboolean = function(L, b) {\n    L.stack[L.top] = new TValue(LUA_TBOOLEAN, !!b);\n    api_incr_top(L);\n};\n\nconst lua_pushlightuserdata = function(L, p) {\n    L.stack[L.top] = new TValue(LUA_TLIGHTUSERDATA, p);\n    api_incr_top(L);\n};\n\nconst lua_pushthread = function(L) {\n    L.stack[L.top] = new TValue(LUA_TTHREAD, L);\n    api_incr_top(L);\n    return L.l_G.mainthread === L;\n};\n\nconst lua_pushglobaltable = function(L) {\n    lua_rawgeti(L, LUA_REGISTRYINDEX, LUA_RIDX_GLOBALS);\n};\n\n/*\n** set functions (stack -> Lua)\n*/\n\n/*\n** t[k] = value at the top of the stack (where 'k' is a string)\n*/\nconst auxsetstr = function(L, t, k) {\n    let str = luaS_new(L, from_userstring(k));\n    api_checknelems(L, 1);\n    lobject.pushsvalue2s(L, str); /* push 'str' (to make it a TValue) */\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    lvm.settable(L, t, L.stack[L.top - 1], L.stack[L.top - 2]);\n    /* pop value and key */\n    delete L.stack[--L.top];\n    delete L.stack[--L.top];\n};\n\nconst lua_setglobal = function(L, name) {\n    auxsetstr(L, ltable.luaH_getint(L.l_G.l_registry.value, LUA_RIDX_GLOBALS), name);\n};\n\nconst lua_setmetatable = function(L, objindex) {\n    api_checknelems(L, 1);\n    let mt;\n    let obj = index2addr(L, objindex);\n    if (L.stack[L.top - 1].ttisnil())\n        mt = null;\n    else {\n        api_check(L, L.stack[L.top - 1].ttistable(), \"table expected\");\n        mt = L.stack[L.top - 1].value;\n    }\n\n    switch (obj.ttnov()) {\n        case LUA_TUSERDATA:\n        case LUA_TTABLE: {\n            obj.value.metatable = mt;\n            break;\n        }\n        default: {\n            L.l_G.mt[obj.ttnov()] = mt;\n            break;\n        }\n    }\n\n    delete L.stack[--L.top];\n    return true;\n};\n\nconst lua_settable = function(L, idx) {\n    api_checknelems(L, 2);\n    let t = index2addr(L, idx);\n    lvm.settable(L, t, L.stack[L.top - 2], L.stack[L.top - 1]);\n    delete L.stack[--L.top];\n    delete L.stack[--L.top];\n};\n\nconst lua_setfield = function(L, idx, k) {\n    auxsetstr(L, index2addr(L, idx), k);\n};\n\nconst lua_seti = function(L, idx, n) {\n    fengari_argcheckinteger(n);\n    api_checknelems(L, 1);\n    let t = index2addr(L, idx);\n    L.stack[L.top] = new TValue(LUA_TNUMINT, n);\n    api_incr_top(L);\n    lvm.settable(L, t, L.stack[L.top - 1], L.stack[L.top - 2]);\n    /* pop value and key */\n    delete L.stack[--L.top];\n    delete L.stack[--L.top];\n};\n\nconst lua_rawset = function(L, idx) {\n    api_checknelems(L, 2);\n    let o = index2addr(L, idx);\n    api_check(L, o.ttistable(), \"table expected\");\n    let k = L.stack[L.top - 2];\n    let v = L.stack[L.top - 1];\n    ltable.luaH_setfrom(L, o.value, k, v);\n    ltable.invalidateTMcache(o.value);\n    delete L.stack[--L.top];\n    delete L.stack[--L.top];\n};\n\nconst lua_rawseti = function(L, idx, n) {\n    fengari_argcheckinteger(n);\n    api_checknelems(L, 1);\n    let o = index2addr(L, idx);\n    api_check(L, o.ttistable(), \"table expected\");\n    ltable.luaH_setint(o.value, n, L.stack[L.top - 1]);\n    delete L.stack[--L.top];\n};\n\nconst lua_rawsetp = function(L, idx, p) {\n    api_checknelems(L, 1);\n    let o = index2addr(L, idx);\n    api_check(L, o.ttistable(), \"table expected\");\n    let k = new TValue(LUA_TLIGHTUSERDATA, p);\n    let v = L.stack[L.top - 1];\n    ltable.luaH_setfrom(L, o.value, k, v);\n    delete L.stack[--L.top];\n};\n\n/*\n** get functions (Lua -> stack)\n*/\n\nconst auxgetstr = function(L, t, k) {\n    let str = luaS_new(L, from_userstring(k));\n    lobject.pushsvalue2s(L, str);\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    lvm.luaV_gettable(L, t, L.stack[L.top - 1], L.top - 1);\n    return L.stack[L.top - 1].ttnov();\n};\n\nconst lua_rawgeti = function(L, idx, n) {\n    let t = index2addr(L, idx);\n    fengari_argcheckinteger(n);\n    api_check(L, t.ttistable(), \"table expected\");\n    lobject.pushobj2s(L, ltable.luaH_getint(t.value, n));\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    return L.stack[L.top - 1].ttnov();\n};\n\nconst lua_rawgetp = function(L, idx, p) {\n    let t = index2addr(L, idx);\n    api_check(L, t.ttistable(), \"table expected\");\n    let k = new TValue(LUA_TLIGHTUSERDATA, p);\n    lobject.pushobj2s(L, ltable.luaH_get(L, t.value, k));\n    api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    return L.stack[L.top - 1].ttnov();\n};\n\nconst lua_rawget = function(L, idx) {\n    let t = index2addr(L, idx);\n    api_check(L, t.ttistable(t), \"table expected\");\n    lobject.setobj2s(L, L.top - 1, ltable.luaH_get(L, t.value, L.stack[L.top - 1]));\n    return L.stack[L.top - 1].ttnov();\n};\n\n// narray and nrec are mostly useless for this implementation\nconst lua_createtable = function(L, narray, nrec) {\n    let t = new lobject.TValue(LUA_TTABLE, ltable.luaH_new(L));\n    L.stack[L.top] = t;\n    api_incr_top(L);\n};\n\nconst luaS_newudata = function(L, size) {\n    return new lobject.Udata(L, size);\n};\n\nconst lua_newuserdata = function(L, size) {\n    let u = luaS_newudata(L, size);\n    L.stack[L.top] = new lobject.TValue(LUA_TUSERDATA, u);\n    api_incr_top(L);\n    return u.data;\n};\n\nconst aux_upvalue = function(L, fi, n) {\n    fengari_argcheckinteger(n);\n    switch(fi.ttype()) {\n        case LUA_TCCL: {  /* C closure */\n            let f = fi.value;\n            if (!(1 <= n && n <= f.nupvalues)) return null;\n            return {\n                name: to_luastring(\"\", true),\n                val: f.upvalue[n-1]\n            };\n        }\n        case LUA_TLCL: {  /* Lua closure */\n            let f = fi.value;\n            let p = f.p;\n            if (!(1 <= n && n <= p.upvalues.length)) return null;\n            let name = p.upvalues[n-1].name;\n            return {\n                name: name ? name.getstr() : to_luastring(\"(*no name)\", true),\n                val: f.upvals[n-1]\n            };\n        }\n        default: return null;  /* not a closure */\n    }\n};\n\nconst lua_getupvalue = function(L, funcindex, n) {\n    let up = aux_upvalue(L, index2addr(L, funcindex), n);\n    if (up) {\n        let name = up.name;\n        let val = up.val;\n        lobject.pushobj2s(L, val);\n        api_check(L, L.top <= L.ci.top, \"stack overflow\");\n        return name;\n    }\n    return null;\n};\n\nconst lua_setupvalue = function(L, funcindex, n) {\n    let fi = index2addr(L, funcindex);\n    api_checknelems(L, 1);\n    let aux = aux_upvalue(L, fi, n);\n    if (aux) {\n        let name = aux.name;\n        let val = aux.val;\n        val.setfrom(L.stack[L.top-1]);\n        delete L.stack[--L.top];\n        return name;\n    }\n    return null;\n};\n\nconst lua_newtable = function(L) {\n    lua_createtable(L, 0, 0);\n};\n\nconst lua_register = function(L, n, f) {\n    lua_pushcfunction(L, f);\n    lua_setglobal(L, n);\n};\n\nconst lua_getmetatable = function(L, objindex) {\n    let obj = index2addr(L, objindex);\n    let mt;\n    let res = false;\n    switch (obj.ttnov()) {\n        case LUA_TTABLE:\n        case LUA_TUSERDATA:\n            mt = obj.value.metatable;\n            break;\n        default:\n            mt = L.l_G.mt[obj.ttnov()];\n            break;\n    }\n\n    if (mt !== null && mt !== undefined) {\n        L.stack[L.top] = new TValue(LUA_TTABLE, mt);\n        api_incr_top(L);\n        res = true;\n    }\n\n    return res;\n};\n\nconst lua_getuservalue = function(L, idx) {\n    let o = index2addr(L, idx);\n    api_check(L, o.ttisfulluserdata(), \"full userdata expected\");\n    let uv = o.value.uservalue;\n    L.stack[L.top] = new TValue(uv.type, uv.value);\n    api_incr_top(L);\n    return L.stack[L.top - 1].ttnov();\n};\n\nconst lua_gettable = function(L, idx) {\n    let t = index2addr(L, idx);\n    lvm.luaV_gettable(L, t, L.stack[L.top - 1], L.top - 1);\n    return L.stack[L.top - 1].ttnov();\n};\n\nconst lua_getfield = function(L, idx, k) {\n    return auxgetstr(L, index2addr(L, idx), k);\n};\n\nconst lua_geti = function(L, idx, n) {\n    let t = index2addr(L, idx);\n    fengari_argcheckinteger(n);\n    L.stack[L.top] = new TValue(LUA_TNUMINT, n);\n    api_incr_top(L);\n    lvm.luaV_gettable(L, t, L.stack[L.top - 1], L.top - 1);\n    return L.stack[L.top - 1].ttnov();\n};\n\nconst lua_getglobal = function(L, name) {\n    return auxgetstr(L, ltable.luaH_getint(L.l_G.l_registry.value, LUA_RIDX_GLOBALS), name);\n};\n\n/*\n** access functions (stack -> JS)\n*/\n\nconst lua_toboolean = function(L, idx) {\n    let o = index2addr(L, idx);\n    return !o.l_isfalse();\n};\n\nconst lua_tolstring = function(L, idx) {\n    let o = index2addr(L, idx);\n\n    if (!o.ttisstring()) {\n        if (!lvm.cvt2str(o)) {  /* not convertible? */\n            return null;\n        }\n        lobject.luaO_tostring(L, o);\n    }\n    return o.svalue();\n};\n\nconst lua_tostring =  lua_tolstring;\n\nconst lua_tojsstring = function(L, idx) {\n    let o = index2addr(L, idx);\n\n    if (!o.ttisstring()) {\n        if (!lvm.cvt2str(o)) {  /* not convertible? */\n            return null;\n        }\n        lobject.luaO_tostring(L, o);\n    }\n    return o.jsstring();\n};\n\nconst lua_todataview = function(L, idx) {\n    let u8 = lua_tolstring(L, idx);\n    return new DataView(u8.buffer, u8.byteOffset, u8.byteLength);\n};\n\nconst lua_rawlen = function(L, idx) {\n    let o = index2addr(L, idx);\n    switch (o.ttype()) {\n        case LUA_TSHRSTR:\n        case LUA_TLNGSTR:\n            return o.vslen();\n        case LUA_TUSERDATA:\n            return o.value.len;\n        case LUA_TTABLE:\n            return ltable.luaH_getn(o.value);\n        default:\n            return 0;\n    }\n};\n\nconst lua_tocfunction = function(L, idx) {\n    let o = index2addr(L, idx);\n    if (o.ttislcf() || o.ttisCclosure()) return o.value;\n    else return null;  /* not a C function */\n};\n\nconst lua_tointeger = function(L, idx) {\n    let n = lua_tointegerx(L, idx);\n    return n === false ? 0 : n;\n};\n\nconst lua_tointegerx = function(L, idx) {\n    return lvm.tointeger(index2addr(L, idx));\n};\n\nconst lua_tonumber = function(L, idx) {\n    let n = lua_tonumberx(L, idx);\n    return n === false ? 0 : n;\n};\n\nconst lua_tonumberx = function(L, idx) {\n    return lvm.tonumber(index2addr(L, idx));\n};\n\nconst lua_touserdata = function(L, idx) {\n    let o = index2addr(L, idx);\n    switch (o.ttnov()) {\n        case LUA_TUSERDATA:\n            return o.value.data;\n        case LUA_TLIGHTUSERDATA:\n            return o.value;\n        default: return null;\n    }\n};\n\nconst lua_tothread = function(L, idx) {\n    let o = index2addr(L, idx);\n    return o.ttisthread() ? o.value : null;\n};\n\nconst lua_topointer = function(L, idx) {\n    let o = index2addr(L, idx);\n    switch (o.ttype()) {\n        case LUA_TTABLE:\n        case LUA_TLCL:\n        case LUA_TCCL:\n        case LUA_TLCF:\n        case LUA_TTHREAD:\n        case LUA_TUSERDATA: /* note: this differs in behaviour to reference lua implementation */\n        case LUA_TLIGHTUSERDATA:\n            return o.value;\n        default:\n            return null;\n    }\n};\n\n\n/* A proxy is a function that the same lua value to the given lua state. */\n\n/* Having a weakmap of created proxies was only way I could think of to provide an 'isproxy' function */\nconst seen = new WeakMap();\n\n/* is the passed object a proxy? is it from the given state? (if passed) */\nconst lua_isproxy = function(p, L) {\n    let G = seen.get(p);\n    if (!G)\n        return false;\n    return (L === null) || (L.l_G === G);\n};\n\n/* Use 'create_proxy' helper function so that 'L' is not in scope */\nconst create_proxy = function(G, type, value) {\n    let proxy = function(L) {\n        api_check(L, L instanceof lstate.lua_State && G === L.l_G, \"must be from same global state\");\n        L.stack[L.top] = new TValue(type, value);\n        api_incr_top(L);\n    };\n    seen.set(proxy, G);\n    return proxy;\n};\n\nconst lua_toproxy = function(L, idx) {\n    let tv = index2addr(L, idx);\n    /* pass broken down tv incase it is an upvalue index */\n    return create_proxy(L.l_G, tv.type, tv.value);\n};\n\n\nconst lua_compare = function(L, index1, index2, op) {\n    let o1 = index2addr(L, index1);\n    let o2 = index2addr(L, index2);\n\n    let i = 0;\n\n    if (isvalid(o1) && isvalid(o2)) {\n        switch (op) {\n            case LUA_OPEQ: i = lvm.luaV_equalobj(L, o1, o2); break;\n            case LUA_OPLT: i = lvm.luaV_lessthan(L, o1, o2); break;\n            case LUA_OPLE: i = lvm.luaV_lessequal(L, o1, o2); break;\n            default: api_check(L, false, \"invalid option\");\n        }\n    }\n\n    return i;\n};\n\nconst lua_stringtonumber = function(L, s) {\n    let tv = new TValue();\n    let sz = lobject.luaO_str2num(s, tv);\n    if (sz !== 0) {\n        L.stack[L.top] = tv;\n        api_incr_top(L);\n    }\n    return sz;\n};\n\nconst f_call = function(L, ud) {\n    ldo.luaD_callnoyield(L, ud.funcOff, ud.nresults);\n};\n\nconst lua_type = function(L, idx) {\n    let o = index2addr(L, idx);\n    return isvalid(o) ?  o.ttnov() : LUA_TNONE;\n};\n\nconst lua_typename = function(L, t) {\n    api_check(L, LUA_TNONE <= t && t < LUA_NUMTAGS, \"invalid tag\");\n    return ltm.ttypename(t);\n};\n\nconst lua_iscfunction = function(L, idx) {\n    let o = index2addr(L, idx);\n    return o.ttislcf(o) || o.ttisCclosure();\n};\n\nconst lua_isnil = function(L, n) {\n    return lua_type(L, n) === LUA_TNIL;\n};\n\nconst lua_isboolean = function(L, n) {\n    return lua_type(L, n) === LUA_TBOOLEAN;\n};\n\nconst lua_isnone = function(L, n) {\n    return lua_type(L, n) === LUA_TNONE;\n};\n\nconst lua_isnoneornil = function(L, n) {\n    return lua_type(L, n) <= 0;\n};\n\nconst lua_istable = function(L, idx) {\n    return index2addr(L, idx).ttistable();\n};\n\nconst lua_isinteger = function(L, idx) {\n    return index2addr(L, idx).ttisinteger();\n};\n\nconst lua_isnumber = function(L, idx) {\n    return lvm.tonumber(index2addr(L, idx)) !== false;\n};\n\nconst lua_isstring = function(L, idx) {\n    let o = index2addr(L, idx);\n    return o.ttisstring() || lvm.cvt2str(o);\n};\n\nconst lua_isuserdata = function(L, idx) {\n    let o = index2addr(L, idx);\n    return o.ttisfulluserdata(o) || o.ttislightuserdata();\n};\n\nconst lua_isthread = function(L, idx) {\n    return lua_type(L, idx) === LUA_TTHREAD;\n};\n\nconst lua_isfunction = function(L, idx) {\n    return lua_type(L, idx) === LUA_TFUNCTION;\n};\n\nconst lua_islightuserdata = function(L, idx) {\n    return lua_type(L, idx) === LUA_TLIGHTUSERDATA;\n};\n\nconst lua_rawequal = function(L, index1, index2) {\n    let o1 = index2addr(L, index1);\n    let o2 = index2addr(L, index2);\n    return isvalid(o1) && isvalid(o2) ? lvm.luaV_equalobj(null, o1, o2) : 0;\n};\n\nconst lua_arith = function(L, op) {\n    if (op !== LUA_OPUNM && op !== LUA_OPBNOT)\n        api_checknelems(L, 2);  /* all other operations expect two operands */\n    else {  /* for unary operations, add fake 2nd operand */\n        api_checknelems(L, 1);\n        lobject.pushobj2s(L, L.stack[L.top-1]);\n        api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    }\n    /* first operand at top - 2, second at top - 1; result go to top - 2 */\n    lobject.luaO_arith(L, op, L.stack[L.top - 2], L.stack[L.top - 1], L.stack[L.top - 2]);\n    delete L.stack[--L.top];  /* remove second operand */\n};\n\n/*\n** 'load' and 'call' functions (run Lua code)\n*/\n\nconst default_chunkname = to_luastring(\"?\");\nconst lua_load = function(L, reader, data, chunkname, mode) {\n    if (!chunkname) chunkname = default_chunkname;\n    else chunkname = from_userstring(chunkname);\n    if (mode !== null) mode = from_userstring(mode);\n    let z = new ZIO(L, reader, data);\n    let status = ldo.luaD_protectedparser(L, z, chunkname, mode);\n    if (status === LUA_OK) {  /* no errors? */\n        let f = L.stack[L.top - 1].value; /* get newly created function */\n        if (f.nupvalues >= 1) {  /* does it have an upvalue? */\n            /* get global table from registry */\n            let gt = ltable.luaH_getint(L.l_G.l_registry.value, LUA_RIDX_GLOBALS);\n            /* set global table as 1st upvalue of 'f' (may be LUA_ENV) */\n            f.upvals[0].setfrom(gt);\n        }\n    }\n    return status;\n};\n\nconst lua_dump = function(L, writer, data, strip) {\n    api_checknelems(L, 1);\n    let o = L.stack[L.top -1];\n    if (o.ttisLclosure())\n        return luaU_dump(L, o.value.p, writer, data, strip);\n    return 1;\n};\n\nconst lua_status = function(L) {\n    return L.status;\n};\n\nconst lua_setuservalue = function(L, idx) {\n    api_checknelems(L, 1);\n    let o = index2addr(L, idx);\n    api_check(L, o.ttisfulluserdata(), \"full userdata expected\");\n    o.value.uservalue.setfrom(L.stack[L.top - 1]);\n    delete L.stack[--L.top];\n};\n\nconst checkresults = function(L,na,nr) {\n    api_check(L, nr === LUA_MULTRET || (L.ci.top - L.top >= (nr) - (na)),\n        \"results from function overflow current stack size\");\n};\n\nconst lua_callk = function(L, nargs, nresults, ctx, k) {\n    api_check(L, k === null || !(L.ci.callstatus & lstate.CIST_LUA), \"cannot use continuations inside hooks\");\n    api_checknelems(L, nargs + 1);\n    api_check(L, L.status === LUA_OK, \"cannot do calls on non-normal thread\");\n    checkresults(L, nargs, nresults);\n    let func = L.top - (nargs + 1);\n    if (k !== null && L.nny === 0) { /* need to prepare continuation? */\n        L.ci.c_k = k;\n        L.ci.c_ctx = ctx;\n        ldo.luaD_call(L, func, nresults);\n    } else { /* no continuation or no yieldable */\n        ldo.luaD_callnoyield(L, func, nresults);\n    }\n\n    if (nresults === LUA_MULTRET && L.ci.top < L.top)\n        L.ci.top = L.top;\n};\n\nconst lua_call = function(L, n, r) {\n    lua_callk(L, n, r, 0, null);\n};\n\nconst lua_pcallk = function(L, nargs, nresults, errfunc, ctx, k) {\n    api_check(L, k === null || !(L.ci.callstatus & lstate.CIST_LUA), \"cannot use continuations inside hooks\");\n    api_checknelems(L, nargs + 1);\n    api_check(L, L.status === LUA_OK, \"cannot do calls on non-normal thread\");\n    checkresults(L, nargs, nresults);\n    let status;\n    let func;\n    if (errfunc === 0)\n        func = 0;\n    else {\n        func = index2addr_(L, errfunc);\n    }\n    let funcOff = L.top - (nargs + 1); /* function to be called */\n    if (k === null || L.nny > 0) { /* no continuation or no yieldable? */\n        let c = {\n            funcOff: funcOff,\n            nresults: nresults /* do a 'conventional' protected call */\n        };\n        status = ldo.luaD_pcall(L, f_call, c, funcOff, func);\n    } else { /* prepare continuation (call is already protected by 'resume') */\n        let ci = L.ci;\n        ci.c_k = k;  /* prepare continuation (call is already protected by 'resume') */\n        ci.c_ctx = ctx;  /* prepare continuation (call is already protected by 'resume') */\n        /* save information for error recovery */\n        ci.extra = funcOff;\n        ci.c_old_errfunc = L.errfunc;\n        L.errfunc = func;\n        ci.callstatus &= ~lstate.CIST_OAH | L.allowhook;\n        ci.callstatus |= lstate.CIST_YPCALL;  /* function can do error recovery */\n        ldo.luaD_call(L, funcOff, nresults);  /* do the call */\n        ci.callstatus &= ~lstate.CIST_YPCALL;\n        L.errfunc = ci.c_old_errfunc;\n        status = LUA_OK;\n    }\n\n    if (nresults === LUA_MULTRET && L.ci.top < L.top)\n        L.ci.top = L.top;\n\n    return status;\n};\n\nconst lua_pcall = function(L, n, r, f) {\n    return lua_pcallk(L, n, r, f, 0, null);\n};\n\n/*\n** miscellaneous functions\n*/\n\nconst lua_error = function(L) {\n    api_checknelems(L, 1);\n    ldebug.luaG_errormsg(L);\n};\n\nconst lua_next = function(L, idx) {\n    let t = index2addr(L, idx);\n    api_check(L, t.ttistable(), \"table expected\");\n    L.stack[L.top] = new TValue();\n    let more = ltable.luaH_next(L, t.value, L.top - 1);\n    if (more) {\n        api_incr_top(L);\n        return 1;\n    } else {\n        delete L.stack[L.top];\n        delete L.stack[--L.top];\n        return 0;\n    }\n};\n\nconst lua_concat = function(L, n) {\n    api_checknelems(L, n);\n    if (n >= 2)\n        lvm.luaV_concat(L, n);\n    else if (n === 0) {\n        lobject.pushsvalue2s(L, luaS_bless(L, to_luastring(\"\", true)));\n        api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    }\n};\n\nconst lua_len = function(L, idx) {\n    let t = index2addr(L, idx);\n    let tv = new TValue();\n    lvm.luaV_objlen(L, tv, t);\n    L.stack[L.top] = tv;\n    api_incr_top(L);\n};\n\nconst getupvalref = function(L, fidx, n) {\n    let fi = index2addr(L, fidx);\n    api_check(L, fi.ttisLclosure(), \"Lua function expected\");\n    let f = fi.value;\n    fengari_argcheckinteger(n);\n    api_check(L, 1 <= n && n <= f.p.upvalues.length, \"invalid upvalue index\");\n    return {\n        f: f,\n        i: n - 1\n    };\n};\n\nconst lua_upvalueid = function(L, fidx, n) {\n    let fi = index2addr(L, fidx);\n    switch (fi.ttype()) {\n        case LUA_TLCL: {  /* lua closure */\n            let ref = getupvalref(L, fidx, n);\n            return ref.f.upvals[ref.i];\n        }\n        case LUA_TCCL: {  /* C closure */\n            let f = fi.value;\n            api_check(L, (n|0) === n && n > 0 && n <= f.nupvalues, \"invalid upvalue index\");\n            return f.upvalue[n - 1];\n        }\n        default: {\n            api_check(L, false, \"closure expected\");\n            return null;\n        }\n    }\n};\n\nconst lua_upvaluejoin = function(L, fidx1, n1, fidx2, n2) {\n    let ref1 = getupvalref(L, fidx1, n1);\n    let ref2 = getupvalref(L, fidx2, n2);\n    let up2 = ref2.f.upvals[ref2.i];\n    ref1.f.upvals[ref1.i] = up2;\n};\n\n// This functions are only there for compatibility purposes\nconst lua_gc = function () {};\n\nconst lua_getallocf = function () {\n    console.warn(\"lua_getallocf is not available\");\n    return 0;\n};\n\nconst lua_setallocf = function () {\n    console.warn(\"lua_setallocf is not available\");\n    return 0;\n};\n\nconst lua_getextraspace = function () {\n    console.warn(\"lua_getextraspace is not available\");\n    return 0;\n};\n\nmodule.exports.api_incr_top          = api_incr_top;\nmodule.exports.api_checknelems       = api_checknelems;\nmodule.exports.lua_absindex          = lua_absindex;\nmodule.exports.lua_arith             = lua_arith;\nmodule.exports.lua_atpanic           = lua_atpanic;\nmodule.exports.lua_atnativeerror     = lua_atnativeerror;\nmodule.exports.lua_call              = lua_call;\nmodule.exports.lua_callk             = lua_callk;\nmodule.exports.lua_checkstack        = lua_checkstack;\nmodule.exports.lua_compare           = lua_compare;\nmodule.exports.lua_concat            = lua_concat;\nmodule.exports.lua_copy              = lua_copy;\nmodule.exports.lua_createtable       = lua_createtable;\nmodule.exports.lua_dump              = lua_dump;\nmodule.exports.lua_error             = lua_error;\nmodule.exports.lua_gc                = lua_gc;\nmodule.exports.lua_getallocf         = lua_getallocf;\nmodule.exports.lua_getextraspace     = lua_getextraspace;\nmodule.exports.lua_getfield          = lua_getfield;\nmodule.exports.lua_getglobal         = lua_getglobal;\nmodule.exports.lua_geti              = lua_geti;\nmodule.exports.lua_getmetatable      = lua_getmetatable;\nmodule.exports.lua_gettable          = lua_gettable;\nmodule.exports.lua_gettop            = lua_gettop;\nmodule.exports.lua_getupvalue        = lua_getupvalue;\nmodule.exports.lua_getuservalue      = lua_getuservalue;\nmodule.exports.lua_insert            = lua_insert;\nmodule.exports.lua_isboolean         = lua_isboolean;\nmodule.exports.lua_iscfunction       = lua_iscfunction;\nmodule.exports.lua_isfunction        = lua_isfunction;\nmodule.exports.lua_isinteger         = lua_isinteger;\nmodule.exports.lua_islightuserdata   = lua_islightuserdata;\nmodule.exports.lua_isnil             = lua_isnil;\nmodule.exports.lua_isnone            = lua_isnone;\nmodule.exports.lua_isnoneornil       = lua_isnoneornil;\nmodule.exports.lua_isnumber          = lua_isnumber;\nmodule.exports.lua_isproxy           = lua_isproxy;\nmodule.exports.lua_isstring          = lua_isstring;\nmodule.exports.lua_istable           = lua_istable;\nmodule.exports.lua_isthread          = lua_isthread;\nmodule.exports.lua_isuserdata        = lua_isuserdata;\nmodule.exports.lua_len               = lua_len;\nmodule.exports.lua_load              = lua_load;\nmodule.exports.lua_newtable          = lua_newtable;\nmodule.exports.lua_newuserdata       = lua_newuserdata;\nmodule.exports.lua_next              = lua_next;\nmodule.exports.lua_pcall             = lua_pcall;\nmodule.exports.lua_pcallk            = lua_pcallk;\nmodule.exports.lua_pop               = lua_pop;\nmodule.exports.lua_pushboolean       = lua_pushboolean;\nmodule.exports.lua_pushcclosure      = lua_pushcclosure;\nmodule.exports.lua_pushcfunction     = lua_pushcfunction;\nmodule.exports.lua_pushfstring       = lua_pushfstring;\nmodule.exports.lua_pushglobaltable   = lua_pushglobaltable;\nmodule.exports.lua_pushinteger       = lua_pushinteger;\nmodule.exports.lua_pushjsclosure     = lua_pushjsclosure;\nmodule.exports.lua_pushjsfunction    = lua_pushjsfunction;\nmodule.exports.lua_pushlightuserdata = lua_pushlightuserdata;\nmodule.exports.lua_pushliteral       = lua_pushliteral;\nmodule.exports.lua_pushlstring       = lua_pushlstring;\nmodule.exports.lua_pushnil           = lua_pushnil;\nmodule.exports.lua_pushnumber        = lua_pushnumber;\nmodule.exports.lua_pushstring        = lua_pushstring;\nmodule.exports.lua_pushthread        = lua_pushthread;\nmodule.exports.lua_pushvalue         = lua_pushvalue;\nmodule.exports.lua_pushvfstring      = lua_pushvfstring;\nmodule.exports.lua_rawequal          = lua_rawequal;\nmodule.exports.lua_rawget            = lua_rawget;\nmodule.exports.lua_rawgeti           = lua_rawgeti;\nmodule.exports.lua_rawgetp           = lua_rawgetp;\nmodule.exports.lua_rawlen            = lua_rawlen;\nmodule.exports.lua_rawset            = lua_rawset;\nmodule.exports.lua_rawseti           = lua_rawseti;\nmodule.exports.lua_rawsetp           = lua_rawsetp;\nmodule.exports.lua_register          = lua_register;\nmodule.exports.lua_remove            = lua_remove;\nmodule.exports.lua_replace           = lua_replace;\nmodule.exports.lua_rotate            = lua_rotate;\nmodule.exports.lua_setallocf         = lua_setallocf;\nmodule.exports.lua_setfield          = lua_setfield;\nmodule.exports.lua_setglobal         = lua_setglobal;\nmodule.exports.lua_seti              = lua_seti;\nmodule.exports.lua_setmetatable      = lua_setmetatable;\nmodule.exports.lua_settable          = lua_settable;\nmodule.exports.lua_settop            = lua_settop;\nmodule.exports.lua_setupvalue        = lua_setupvalue;\nmodule.exports.lua_setuservalue      = lua_setuservalue;\nmodule.exports.lua_status            = lua_status;\nmodule.exports.lua_stringtonumber    = lua_stringtonumber;\nmodule.exports.lua_toboolean         = lua_toboolean;\nmodule.exports.lua_tocfunction       = lua_tocfunction;\nmodule.exports.lua_todataview        = lua_todataview;\nmodule.exports.lua_tointeger         = lua_tointeger;\nmodule.exports.lua_tointegerx        = lua_tointegerx;\nmodule.exports.lua_tojsstring        = lua_tojsstring;\nmodule.exports.lua_tolstring         = lua_tolstring;\nmodule.exports.lua_tonumber          = lua_tonumber;\nmodule.exports.lua_tonumberx         = lua_tonumberx;\nmodule.exports.lua_topointer         = lua_topointer;\nmodule.exports.lua_toproxy           = lua_toproxy;\nmodule.exports.lua_tostring          = lua_tostring;\nmodule.exports.lua_tothread          = lua_tothread;\nmodule.exports.lua_touserdata        = lua_touserdata;\nmodule.exports.lua_type              = lua_type;\nmodule.exports.lua_typename          = lua_typename;\nmodule.exports.lua_upvalueid         = lua_upvalueid;\nmodule.exports.lua_upvaluejoin       = lua_upvaluejoin;\nmodule.exports.lua_version           = lua_version;\nmodule.exports.lua_xmove             = lua_xmove;\n","\"use strict\";\n\nconst {\n    LUAL_BUFFERSIZE\n} = require('./luaconf.js');\nconst {\n    LUA_ERRERR,\n    LUA_MULTRET,\n    LUA_REGISTRYINDEX,\n    LUA_SIGNATURE,\n    LUA_TBOOLEAN,\n    LUA_TLIGHTUSERDATA,\n    LUA_TNIL,\n    LUA_TNONE,\n    LUA_TNUMBER,\n    LUA_TSTRING,\n    LUA_TTABLE,\n    LUA_VERSION_NUM,\n    lua_Debug,\n    lua_absindex,\n    lua_atpanic,\n    lua_call,\n    lua_checkstack,\n    lua_concat,\n    lua_copy,\n    lua_createtable,\n    lua_error,\n    lua_getfield,\n    lua_getinfo,\n    lua_getmetatable,\n    lua_getstack,\n    lua_gettop,\n    lua_insert,\n    lua_isinteger,\n    lua_isnil,\n    lua_isnumber,\n    lua_isstring,\n    lua_istable,\n    lua_len,\n    lua_load,\n    lua_newstate,\n    lua_newtable,\n    lua_next,\n    lua_pcall,\n    lua_pop,\n    lua_pushboolean,\n    lua_pushcclosure,\n    lua_pushcfunction,\n    lua_pushfstring,\n    lua_pushinteger,\n    lua_pushliteral,\n    lua_pushlstring,\n    lua_pushnil,\n    lua_pushstring,\n    lua_pushvalue,\n    lua_pushvfstring,\n    lua_rawequal,\n    lua_rawget,\n    lua_rawgeti,\n    lua_rawlen,\n    lua_rawseti,\n    lua_remove,\n    lua_setfield,\n    lua_setglobal,\n    lua_setmetatable,\n    lua_settop,\n    lua_toboolean,\n    lua_tointeger,\n    lua_tointegerx,\n    lua_tojsstring,\n    lua_tolstring,\n    lua_tonumber,\n    lua_tonumberx,\n    lua_topointer,\n    lua_tostring,\n    lua_touserdata,\n    lua_type,\n    lua_typename,\n    lua_version\n} = require('./lua.js');\nconst {\n    from_userstring,\n    luastring_eq,\n    to_luastring,\n    to_uristring\n} = require(\"./fengaricore.js\");\n\n/* extra error code for 'luaL_loadfilex' */\nconst LUA_ERRFILE = LUA_ERRERR+1;\n\n/* key, in the registry, for table of loaded modules */\nconst LUA_LOADED_TABLE = to_luastring(\"_LOADED\");\n\n/* key, in the registry, for table of preloaded loaders */\nconst LUA_PRELOAD_TABLE = to_luastring(\"_PRELOAD\");\n\nconst LUA_FILEHANDLE = to_luastring(\"FILE*\");\n\nconst LUAL_NUMSIZES  = 4*16 + 8;\n\nconst __name = to_luastring(\"__name\");\nconst __tostring = to_luastring(\"__tostring\");\n\nconst empty = new Uint8Array(0);\n\nclass luaL_Buffer {\n    constructor() {\n        this.L = null;\n        this.b = empty;\n        this.n = 0;\n    }\n}\n\nconst LEVELS1 = 10;  /* size of the first part of the stack */\nconst LEVELS2 = 11;  /* size of the second part of the stack */\n\n/*\n** search for 'objidx' in table at index -1.\n** return 1 + string at top if find a good name.\n*/\nconst findfield = function(L, objidx, level) {\n    if (level === 0 || !lua_istable(L, -1))\n        return 0;  /* not found */\n\n    lua_pushnil(L);  /* start 'next' loop */\n\n    while (lua_next(L, -2)) {  /* for each pair in table */\n        if (lua_type(L, -2) === LUA_TSTRING) {  /* ignore non-string keys */\n            if (lua_rawequal(L, objidx, -1)) {  /* found object? */\n                lua_pop(L, 1);  /* remove value (but keep name) */\n                return 1;\n            } else if (findfield(L, objidx, level - 1)) {  /* try recursively */\n                lua_remove(L, -2);  /* remove table (but keep name) */\n                lua_pushliteral(L, \".\");\n                lua_insert(L, -2);  /* place '.' between the two names */\n                lua_concat(L, 3);\n                return 1;\n            }\n        }\n        lua_pop(L, 1);  /* remove value */\n    }\n\n    return 0;  /* not found */\n};\n\n/*\n** Search for a name for a function in all loaded modules\n*/\nconst pushglobalfuncname = function(L, ar) {\n    let top = lua_gettop(L);\n    lua_getinfo(L, to_luastring(\"f\"), ar);  /* push function */\n    lua_getfield(L, LUA_REGISTRYINDEX, LUA_LOADED_TABLE);\n    if (findfield(L, top + 1, 2)) {\n        let name = lua_tostring(L, -1);\n        if (name[0] === 95 /* '_'.charCodeAt(0) */ &&\n            name[1] === 71 /* 'G'.charCodeAt(0) */ &&\n            name[2] === 46 /* '.'.charCodeAt(0) */\n        ) {  /* name start with '_G.'? */\n            lua_pushstring(L, name.subarray(3));  /* push name without prefix */\n            lua_remove(L, -2);  /* remove original name */\n        }\n        lua_copy(L, -1, top + 1);  /* move name to proper place */\n        lua_pop(L, 2);  /* remove pushed values */\n        return 1;\n    } else {\n        lua_settop(L, top);  /* remove function and global table */\n        return 0;\n    }\n};\n\nconst pushfuncname = function(L, ar) {\n    if (pushglobalfuncname(L, ar)) {  /* try first a global name */\n        lua_pushfstring(L, to_luastring(\"function '%s'\"), lua_tostring(L, -1));\n        lua_remove(L, -2);  /* remove name */\n    }\n    else if (ar.namewhat.length !== 0)  /* is there a name from code? */\n        lua_pushfstring(L, to_luastring(\"%s '%s'\"), ar.namewhat, ar.name);  /* use it */\n    else if (ar.what && ar.what[0] === 109 /* 'm'.charCodeAt(0) */)  /* main? */\n        lua_pushliteral(L, \"main chunk\");\n    else if (ar.what && ar.what[0] === 76 /* 'L'.charCodeAt(0) */)  /* for Lua functions, use <file:line> */\n        lua_pushfstring(L, to_luastring(\"function <%s:%d>\"), ar.short_src, ar.linedefined);\n    else  /* nothing left... */\n        lua_pushliteral(L, \"?\");\n};\n\nconst lastlevel = function(L) {\n    let ar = new lua_Debug();\n    let li = 1;\n    let le = 1;\n    /* find an upper bound */\n    while (lua_getstack(L, le, ar)) { li = le; le *= 2; }\n    /* do a binary search */\n    while (li < le) {\n        let m = Math.floor((li + le)/2);\n        if (lua_getstack(L, m, ar)) li = m + 1;\n        else le = m;\n    }\n    return le - 1;\n};\n\nconst luaL_traceback = function(L, L1, msg, level) {\n    let ar = new lua_Debug();\n    let top = lua_gettop(L);\n    let last = lastlevel(L1);\n    let n1 = last - level > LEVELS1 + LEVELS2 ? LEVELS1 : -1;\n    if (msg)\n        lua_pushfstring(L, to_luastring(\"%s\\n\"), msg);\n    luaL_checkstack(L, 10, null);\n    lua_pushliteral(L, \"stack traceback:\");\n    while (lua_getstack(L1, level++, ar)) {\n        if (n1-- === 0) {  /* too many levels? */\n            lua_pushliteral(L, \"\\n\\t...\");  /* add a '...' */\n            level = last - LEVELS2 + 1;  /* and skip to last ones */\n        } else {\n            lua_getinfo(L1, to_luastring(\"Slnt\", true), ar);\n            lua_pushfstring(L, to_luastring(\"\\n\\t%s:\"), ar.short_src);\n            if (ar.currentline > 0)\n                lua_pushliteral(L, `${ar.currentline}:`);\n            lua_pushliteral(L, \" in \");\n            pushfuncname(L, ar);\n            if (ar.istailcall)\n                lua_pushliteral(L, \"\\n\\t(...tail calls..)\");\n            lua_concat(L, lua_gettop(L) - top);\n        }\n    }\n    lua_concat(L, lua_gettop(L) - top);\n};\n\nconst panic = function(L) {\n    let msg = \"PANIC: unprotected error in call to Lua API (\" + lua_tojsstring(L, -1) + \")\";\n    throw new Error(msg);\n};\n\nconst luaL_argerror = function(L, arg, extramsg) {\n    let ar = new lua_Debug();\n\n    if (!lua_getstack(L, 0, ar))  /* no stack frame? */\n        return luaL_error(L, to_luastring(\"bad argument #%d (%s)\"), arg, extramsg);\n\n    lua_getinfo(L, to_luastring(\"n\"), ar);\n\n    if (luastring_eq(ar.namewhat, to_luastring(\"method\"))) {\n        arg--;  /* do not count 'self' */\n        if (arg === 0)  /* error is in the self argument itself? */\n            return luaL_error(L, to_luastring(\"calling '%s' on bad self (%s)\"), ar.name, extramsg);\n    }\n\n    if (ar.name === null)\n        ar.name = pushglobalfuncname(L, ar) ? lua_tostring(L, -1) : to_luastring(\"?\");\n\n    return luaL_error(L, to_luastring(\"bad argument #%d to '%s' (%s)\"), arg, ar.name, extramsg);\n};\n\nconst typeerror = function(L, arg, tname) {\n    let typearg;\n    if (luaL_getmetafield(L, arg, __name) === LUA_TSTRING)\n        typearg = lua_tostring(L, -1);\n    else if (lua_type(L, arg) === LUA_TLIGHTUSERDATA)\n        typearg = to_luastring(\"light userdata\", true);\n    else\n        typearg = luaL_typename(L, arg);\n\n    let msg = lua_pushfstring(L, to_luastring(\"%s expected, got %s\"), tname, typearg);\n    return luaL_argerror(L, arg, msg);\n};\n\nconst luaL_where = function(L, level) {\n    let ar = new lua_Debug();\n    if (lua_getstack(L, level, ar)) {\n        lua_getinfo(L, to_luastring(\"Sl\", true), ar);\n        if (ar.currentline > 0) {\n            lua_pushfstring(L, to_luastring(\"%s:%d: \"), ar.short_src, ar.currentline);\n            return;\n        }\n    }\n    lua_pushstring(L, to_luastring(\"\"));\n};\n\nconst luaL_error = function(L, fmt, ...argp) {\n    luaL_where(L, 1);\n    lua_pushvfstring(L, fmt, argp);\n    lua_concat(L, 2);\n    return lua_error(L);\n};\n\n/* Unlike normal lua, we pass in an error object */\nconst luaL_fileresult = function(L, stat, fname, e) {\n    if (stat) {\n        lua_pushboolean(L, 1);\n        return 1;\n    } else {\n        lua_pushnil(L);\n        let message, errno;\n        if (e) {\n            message = e.message;\n            errno = -e.errno;\n        } else {\n            message = \"Success\"; /* what strerror(0) returns */\n            errno = 0;\n        }\n        if (fname)\n            lua_pushfstring(L, to_luastring(\"%s: %s\"), fname, to_luastring(message));\n        else\n            lua_pushstring(L, to_luastring(message));\n        lua_pushinteger(L, errno);\n        return 3;\n    }\n};\n\n/* Unlike normal lua, we pass in an error object */\nconst luaL_execresult = function(L, e) {\n    let what, stat;\n    if (e === null) {\n        lua_pushboolean(L, 1);\n        lua_pushliteral(L, \"exit\");\n        lua_pushinteger(L, 0);\n        return 3;\n    } else if (e.status) {\n        what = \"exit\";\n        stat = e.status;\n    } else if (e.signal) {\n        what = \"signal\";\n        stat = e.signal;\n    } else {\n        /* XXX: node seems to have e.errno as a string instead of a number */\n        return luaL_fileresult(L, 0, null, e);\n    }\n    lua_pushnil(L);\n    lua_pushliteral(L, what);\n    lua_pushinteger(L, stat);\n    return 3;\n};\n\nconst luaL_getmetatable = function(L, n) {\n    return lua_getfield(L, LUA_REGISTRYINDEX, n);\n};\n\nconst luaL_newmetatable = function(L, tname) {\n    if (luaL_getmetatable(L, tname) !== LUA_TNIL)  /* name already in use? */\n        return 0;  /* leave previous value on top, but return 0 */\n    lua_pop(L, 1);\n    lua_createtable(L, 0, 2);  /* create metatable */\n    lua_pushstring(L, tname);\n    lua_setfield(L, -2, __name);  /* metatable.__name = tname */\n    lua_pushvalue(L, -1);\n    lua_setfield(L, LUA_REGISTRYINDEX, tname);  /* registry.name = metatable */\n    return 1;\n\n};\n\nconst luaL_setmetatable = function(L, tname) {\n    luaL_getmetatable(L, tname);\n    lua_setmetatable(L, -2);\n};\n\nconst luaL_testudata = function(L, ud, tname) {\n    let p = lua_touserdata(L, ud);\n    if (p !== null) {  /* value is a userdata? */\n        if (lua_getmetatable(L, ud)) {  /* does it have a metatable? */\n            luaL_getmetatable(L, tname);  /* get correct metatable */\n            if (!lua_rawequal(L, -1, -2))  /* not the same? */\n                p = null;  /* value is a userdata with wrong metatable */\n            lua_pop(L, 2);  /* remove both metatables */\n            return p;\n        }\n    }\n    return null;  /* value is not a userdata with a metatable */\n};\n\nconst luaL_checkudata = function(L, ud, tname) {\n    let p = luaL_testudata(L, ud, tname);\n    if (p === null) typeerror(L, ud, tname);\n    return p;\n};\n\nconst luaL_checkoption = function(L, arg, def, lst) {\n    let name = def !== null ? luaL_optstring(L, arg, def) : luaL_checkstring(L, arg);\n    for (let i = 0; lst[i]; i++)\n        if (luastring_eq(lst[i], name))\n            return i;\n    return luaL_argerror(L, arg, lua_pushfstring(L, to_luastring(\"invalid option '%s'\"), name));\n};\n\nconst tag_error = function(L, arg, tag) {\n    typeerror(L, arg, lua_typename(L, tag));\n};\n\nconst luaL_newstate = function() {\n    let L = lua_newstate();\n    if (L) lua_atpanic(L, panic);\n    return L;\n};\n\n\nconst luaL_typename = function(L, i) {\n    return lua_typename(L, lua_type(L, i));\n};\n\nconst luaL_argcheck = function(L, cond, arg, extramsg) {\n    if (!cond) luaL_argerror(L, arg, extramsg);\n};\n\nconst luaL_checkany = function(L, arg) {\n    if (lua_type(L, arg) === LUA_TNONE)\n        luaL_argerror(L, arg, to_luastring(\"value expected\", true));\n};\n\nconst luaL_checktype = function(L, arg, t) {\n    if (lua_type(L, arg) !== t)\n        tag_error(L, arg, t);\n};\n\nconst luaL_checklstring = function(L, arg) {\n    let s = lua_tolstring(L, arg);\n    if (s === null || s === undefined) tag_error(L, arg, LUA_TSTRING);\n    return s;\n};\n\nconst luaL_checkstring = luaL_checklstring;\n\nconst luaL_optlstring = function(L, arg, def) {\n    if (lua_type(L, arg) <= 0) {\n        return def === null ? null : from_userstring(def);\n    } else return luaL_checklstring(L, arg);\n};\n\nconst luaL_optstring = luaL_optlstring;\n\nconst interror = function(L, arg) {\n    if (lua_isnumber(L, arg))\n        luaL_argerror(L, arg, to_luastring(\"number has no integer representation\", true));\n    else\n        tag_error(L, arg, LUA_TNUMBER);\n};\n\nconst luaL_checknumber = function(L, arg) {\n    let d = lua_tonumberx(L, arg);\n    if (d === false)\n        tag_error(L, arg, LUA_TNUMBER);\n    return d;\n};\n\nconst luaL_optnumber = function(L, arg, def) {\n    return luaL_opt(L, luaL_checknumber, arg, def);\n};\n\nconst luaL_checkinteger = function(L, arg) {\n    let d = lua_tointegerx(L, arg);\n    if (d === false)\n        interror(L, arg);\n    return d;\n};\n\nconst luaL_optinteger = function(L, arg, def) {\n    return luaL_opt(L, luaL_checkinteger, arg, def);\n};\n\nconst luaL_prepbuffsize = function(B, sz) {\n    let newend = B.n + sz;\n    if (B.b.length < newend) {\n        let newsize = Math.max(B.b.length * 2, newend);  /* double buffer size */\n        let newbuff = new Uint8Array(newsize);  /* create larger buffer */\n        newbuff.set(B.b);  /* copy original content */\n        B.b = newbuff;\n    }\n    return B.b.subarray(B.n, newend);\n};\n\nconst luaL_buffinit = function(L, B) {\n    B.L = L;\n    B.b = empty;\n};\n\nconst luaL_buffinitsize = function(L, B, sz) {\n    luaL_buffinit(L, B);\n    return luaL_prepbuffsize(B, sz);\n};\n\nconst luaL_prepbuffer = function(B) {\n    return luaL_prepbuffsize(B, LUAL_BUFFERSIZE);\n};\n\nconst luaL_addlstring = function(B, s, l) {\n    if (l > 0) {\n        s = from_userstring(s);\n        let b = luaL_prepbuffsize(B, l);\n        b.set(s.subarray(0, l));\n        luaL_addsize(B, l);\n    }\n};\n\nconst luaL_addstring = function(B, s) {\n    s = from_userstring(s);\n    luaL_addlstring(B, s, s.length);\n};\n\nconst luaL_pushresult = function(B) {\n    lua_pushlstring(B.L, B.b, B.n);\n    /* delete old buffer */\n    B.n = 0;\n    B.b = empty;\n};\n\nconst luaL_addchar = function(B, c) {\n    luaL_prepbuffsize(B, 1);\n    B.b[B.n++] = c;\n};\n\nconst luaL_addsize = function(B, s) {\n    B.n += s;\n};\n\nconst luaL_pushresultsize = function(B, sz) {\n    luaL_addsize(B, sz);\n    luaL_pushresult(B);\n};\n\nconst luaL_addvalue = function(B) {\n    let L = B.L;\n    let s = lua_tostring(L, -1);\n    luaL_addlstring(B, s, s.length);\n    lua_pop(L, 1);  /* remove value */\n};\n\nconst luaL_opt = function(L, f, n, d) {\n    return lua_type(L, n) <= 0 ? d : f(L, n);\n};\n\nconst getS = function(L, ud) {\n    let s = ud.string;\n    ud.string = null;\n    return s;\n};\n\nconst luaL_loadbufferx = function(L, buff, size, name, mode) {\n    return lua_load(L, getS, {string: buff}, name, mode);\n};\n\nconst luaL_loadbuffer = function(L, s, sz, n) {\n    return luaL_loadbufferx(L, s, sz, n, null);\n};\n\nconst luaL_loadstring = function(L, s) {\n    return luaL_loadbuffer(L, s, s.length, s);\n};\n\nconst luaL_dostring = function(L, s) {\n    return (luaL_loadstring(L, s) || lua_pcall(L, 0, LUA_MULTRET, 0));\n};\n\nconst luaL_getmetafield = function(L, obj, event) {\n    if (!lua_getmetatable(L, obj))  /* no metatable? */\n        return LUA_TNIL;\n    else {\n        lua_pushstring(L, event);\n        let tt = lua_rawget(L, -2);\n        if (tt === LUA_TNIL)  /* is metafield nil? */\n            lua_pop(L, 2);  /* remove metatable and metafield */\n        else\n            lua_remove(L, -2);  /* remove only metatable */\n        return tt;  /* return metafield type */\n    }\n};\n\nconst luaL_callmeta = function(L, obj, event) {\n    obj = lua_absindex(L, obj);\n    if (luaL_getmetafield(L, obj, event) === LUA_TNIL)\n        return false;\n\n    lua_pushvalue(L, obj);\n    lua_call(L, 1, 1);\n\n    return true;\n};\n\nconst luaL_len = function(L, idx) {\n    lua_len(L, idx);\n    let l = lua_tointegerx(L, -1);\n    if (l === false)\n        luaL_error(L, to_luastring(\"object length is not an integer\", true));\n    lua_pop(L, 1);  /* remove object */\n    return l;\n};\n\nconst p_I = to_luastring(\"%I\");\nconst p_f = to_luastring(\"%f\");\nconst luaL_tolstring = function(L, idx) {\n    if (luaL_callmeta(L, idx, __tostring)) {\n        if (!lua_isstring(L, -1))\n            luaL_error(L, to_luastring(\"'__tostring' must return a string\"));\n    } else {\n        let t = lua_type(L, idx);\n        switch(t) {\n            case LUA_TNUMBER: {\n                if (lua_isinteger(L, idx))\n                    lua_pushfstring(L, p_I, lua_tointeger(L, idx));\n                else\n                    lua_pushfstring(L, p_f, lua_tonumber(L, idx));\n                break;\n            }\n            case LUA_TSTRING:\n                lua_pushvalue(L, idx);\n                break;\n            case LUA_TBOOLEAN:\n                lua_pushliteral(L, (lua_toboolean(L, idx) ? \"true\" : \"false\"));\n                break;\n            case LUA_TNIL:\n                lua_pushliteral(L, \"nil\");\n                break;\n            default: {\n                let tt = luaL_getmetafield(L, idx, __name);\n                let kind = tt === LUA_TSTRING ? lua_tostring(L, -1) : luaL_typename(L, idx);\n                lua_pushfstring(L, to_luastring(\"%s: %p\"), kind, lua_topointer(L, idx));\n                if (tt !== LUA_TNIL)\n                    lua_remove(L, -2);\n                break;\n            }\n        }\n    }\n\n    return lua_tolstring(L, -1);\n};\n\n/*\n** Stripped-down 'require': After checking \"loaded\" table, calls 'openf'\n** to open a module, registers the result in 'package.loaded' table and,\n** if 'glb' is true, also registers the result in the global table.\n** Leaves resulting module on the top.\n*/\nconst luaL_requiref = function(L, modname, openf, glb) {\n    luaL_getsubtable(L, LUA_REGISTRYINDEX, LUA_LOADED_TABLE);\n    lua_getfield(L, -1, modname); /* LOADED[modname] */\n    if (!lua_toboolean(L, -1)) {  /* package not already loaded? */\n        lua_pop(L, 1);  /* remove field */\n        lua_pushcfunction(L, openf);\n        lua_pushstring(L, modname);  /* argument to open function */\n        lua_call(L, 1, 1);  /* call 'openf' to open module */\n        lua_pushvalue(L, -1);  /* make copy of module (call result) */\n        lua_setfield(L, -3, modname);  /* LOADED[modname] = module */\n    }\n    lua_remove(L, -2);  /* remove LOADED table */\n    if (glb) {\n        lua_pushvalue(L, -1);  /* copy of module */\n        lua_setglobal(L, modname);  /* _G[modname] = module */\n    }\n};\n\nconst find_subarray = function(arr, subarr, from_index) {\n    var i = from_index >>> 0,\n        sl = subarr.length,\n        l = arr.length + 1 - sl;\n\n    loop: for (; i < l; i++) {\n        for (let j = 0; j < sl; j++)\n            if (arr[i+j] !== subarr[j])\n                continue loop;\n        return i;\n    }\n    return -1;\n};\n\nconst luaL_gsub = function(L, s, p, r) {\n    let wild;\n    let b = new luaL_Buffer();\n    luaL_buffinit(L, b);\n    while ((wild = find_subarray(s, p)) >= 0) {\n        luaL_addlstring(b, s, wild);  /* push prefix */\n        luaL_addstring(b, r);  /* push replacement in place of pattern */\n        s = s.subarray(wild + p.length);  /* continue after 'p' */\n    }\n    luaL_addstring(b, s);  /* push last suffix */\n    luaL_pushresult(b);\n    return lua_tostring(L, -1);\n};\n\n/*\n** ensure that stack[idx][fname] has a table and push that table\n** into the stack\n*/\nconst luaL_getsubtable = function(L, idx, fname) {\n    if (lua_getfield(L, idx, fname) === LUA_TTABLE)\n        return true;  /* table already there */\n    else {\n        lua_pop(L, 1);  /* remove previous result */\n        idx = lua_absindex(L, idx);\n        lua_newtable(L);\n        lua_pushvalue(L, -1);  /* copy to be left at top */\n        lua_setfield(L, idx, fname);  /* assign new table to field */\n        return false;  /* false, because did not find table there */\n    }\n};\n\n/*\n** set functions from list 'l' into table at top - 'nup'; each\n** function gets the 'nup' elements at the top as upvalues.\n** Returns with only the table at the stack.\n*/\nconst luaL_setfuncs = function(L, l, nup) {\n    luaL_checkstack(L, nup, to_luastring(\"too many upvalues\", true));\n    for (let lib in l) {  /* fill the table with given functions */\n        for (let i = 0; i < nup; i++)  /* copy upvalues to the top */\n            lua_pushvalue(L, -nup);\n        lua_pushcclosure(L, l[lib], nup);  /* closure with those upvalues */\n        lua_setfield(L, -(nup + 2), to_luastring(lib));\n    }\n    lua_pop(L, nup);  /* remove upvalues */\n};\n\n/*\n** Ensures the stack has at least 'space' extra slots, raising an error\n** if it cannot fulfill the request. (The error handling needs a few\n** extra slots to format the error message. In case of an error without\n** this extra space, Lua will generate the same 'stack overflow' error,\n** but without 'msg'.)\n*/\nconst luaL_checkstack = function(L, space, msg) {\n    if (!lua_checkstack(L, space)) {\n        if (msg)\n            luaL_error(L, to_luastring(\"stack overflow (%s)\"), msg);\n        else\n            luaL_error(L, to_luastring('stack overflow', true));\n    }\n};\n\nconst luaL_newlibtable = function(L) {\n    lua_createtable(L);\n};\n\nconst luaL_newlib = function(L, l) {\n    lua_createtable(L);\n    luaL_setfuncs(L, l, 0);\n};\n\n/* predefined references */\nconst LUA_NOREF  = -2;\nconst LUA_REFNIL = -1;\n\nconst luaL_ref = function(L, t) {\n    let ref;\n    if (lua_isnil(L, -1)) {\n        lua_pop(L, 1);  /* remove from stack */\n        return LUA_REFNIL;  /* 'nil' has a unique fixed reference */\n    }\n    t = lua_absindex(L, t);\n    lua_rawgeti(L, t, 0);  /* get first free element */\n    ref = lua_tointeger(L, -1);  /* ref = t[freelist] */\n    lua_pop(L, 1);  /* remove it from stack */\n    if (ref !== 0) {  /* any free element? */\n        lua_rawgeti(L, t, ref);  /* remove it from list */\n        lua_rawseti(L, t, 0);  /* (t[freelist] = t[ref]) */\n    }\n    else  /* no free elements */\n        ref = lua_rawlen(L, t) + 1;  /* get a new reference */\n    lua_rawseti(L, t, ref);\n    return ref;\n};\n\n\nconst luaL_unref = function(L, t, ref) {\n    if (ref >= 0) {\n        t = lua_absindex(L, t);\n        lua_rawgeti(L, t, 0);\n        lua_rawseti(L, t, ref);  /* t[ref] = t[freelist] */\n        lua_pushinteger(L, ref);\n        lua_rawseti(L, t, 0);  /* t[freelist] = ref */\n    }\n};\n\n\nconst errfile = function(L, what, fnameindex, error) {\n    let serr = error.message;\n    let filename = lua_tostring(L, fnameindex).subarray(1);\n    lua_pushfstring(L, to_luastring(\"cannot %s %s: %s\"), to_luastring(what), filename, to_luastring(serr));\n    lua_remove(L, fnameindex);\n    return LUA_ERRFILE;\n};\n\nlet getc;\n\nconst utf8_bom = [0XEF, 0XBB, 0XBF];  /* UTF-8 BOM mark */\nconst skipBOM = function(lf) {\n    lf.n = 0;\n    let c;\n    let p = 0;\n    do {\n        c = getc(lf);\n        if (c === null || c !== utf8_bom[p]) return c;\n        p++;\n        lf.buff[lf.n++] = c;  /* to be read by the parser */\n    } while (p < utf8_bom.length);\n    lf.n = 0;  /* prefix matched; discard it */\n    return getc(lf);  /* return next character */\n};\n\n/*\n** reads the first character of file 'f' and skips an optional BOM mark\n** in its beginning plus its first line if it starts with '#'. Returns\n** true if it skipped the first line.  In any case, '*cp' has the\n** first \"valid\" character of the file (after the optional BOM and\n** a first-line comment).\n*/\nconst skipcomment = function(lf) {\n    let c = skipBOM(lf);\n    if (c === 35 /* '#'.charCodeAt(0) */) {  /* first line is a comment (Unix exec. file)? */\n        do {  /* skip first line */\n            c = getc(lf);\n        } while (c && c !== 10 /* '\\n'.charCodeAt(0) */);\n\n        return {\n            skipped: true,\n            c: getc(lf)  /* skip end-of-line, if present */\n        };\n    } else {\n        return {\n            skipped: false,\n            c: c\n        };\n    }\n};\n\nlet luaL_loadfilex;\n\nif (typeof process === \"undefined\") {\n    class LoadF {\n        constructor() {\n            this.n = NaN;  /* number of pre-read characters */\n            this.f = null;  /* file being read */\n            this.buff = new Uint8Array(1024);  /* area for reading file */\n            this.pos = 0;  /* current position in file */\n            this.err = void 0;\n        }\n    }\n\n    const getF = function(L, ud) {\n        let lf = ud;\n\n        if (lf.f !== null && lf.n > 0) {  /* are there pre-read characters to be read? */\n            let bytes = lf.n; /* return them (chars already in buffer) */\n            lf.n = 0;  /* no more pre-read characters */\n            lf.f = lf.f.subarray(lf.pos);  /* we won't use lf.buff anymore */\n            return lf.buff.subarray(0, bytes);\n        }\n\n        let f = lf.f;\n        lf.f = null;\n        return f;\n    };\n\n    getc = function(lf) {\n        return lf.pos < lf.f.length ? lf.f[lf.pos++] : null;\n    };\n\n    luaL_loadfilex = function(L, filename, mode) {\n        let lf = new LoadF();\n        let fnameindex = lua_gettop(L) + 1;  /* index of filename on the stack */\n        if (filename === null) {\n            throw new Error(\"Can't read stdin in the browser\");\n        } else {\n            lua_pushfstring(L, to_luastring(\"@%s\"), filename);\n            let path = to_uristring(filename);\n            let xhr = new XMLHttpRequest();\n            xhr.open(\"GET\", path, false);\n            /*\n            Synchronous xhr in main thread always returns a js string.\n            Some browsers make console noise if you even attempt to set responseType\n            */\n            if (typeof window === \"undefined\") {\n                xhr.responseType = \"arraybuffer\";\n            }\n            xhr.send();\n            if (xhr.status >= 200 && xhr.status <= 299) {\n                if (typeof xhr.response === \"string\") {\n                    lf.f = to_luastring(xhr.response);\n                } else {\n                    lf.f = new Uint8Array(xhr.response);\n                }\n            } else {\n                lf.err = xhr.status;\n                return errfile(L, \"open\", fnameindex, { message: `${xhr.status}: ${xhr.statusText}` });\n            }\n        }\n        let com = skipcomment(lf);\n        /* check for signature first, as we don't want to add line number corrections in binary case */\n        if (com.c === LUA_SIGNATURE[0] && filename) {  /* binary file? */\n            /* no need to re-open */\n        } else if (com.skipped) { /* read initial portion */\n            lf.buff[lf.n++] = 10 /* '\\n'.charCodeAt(0) */;  /* add line to correct line numbers */\n        }\n        if (com.c !== null)\n            lf.buff[lf.n++] = com.c; /* 'c' is the first character of the stream */\n        let status = lua_load(L, getF, lf, lua_tostring(L, -1), mode);\n        let readstatus = lf.err;\n        if (readstatus) {\n            lua_settop(L, fnameindex);  /* ignore results from 'lua_load' */\n            return errfile(L, \"read\", fnameindex, readstatus);\n        }\n        lua_remove(L, fnameindex);\n        return status;\n    };\n} else {\n    const fs = require('fs');\n\n    class LoadF {\n        constructor() {\n            this.n = NaN;  /* number of pre-read characters */\n            this.f = null;  /* file being read */\n            this.buff = Buffer.alloc(1024);  /* area for reading file */\n            this.pos = 0;  /* current position in file */\n            this.err = void 0;\n        }\n    }\n\n    const getF = function(L, ud) {\n        let lf = ud;\n        let bytes = 0;\n        if (lf.n > 0) {  /* are there pre-read characters to be read? */\n            bytes = lf.n; /* return them (chars already in buffer) */\n            lf.n = 0;  /* no more pre-read characters */\n        } else {  /* read a block from file */\n            try {\n                bytes = fs.readSync(lf.f, lf.buff, 0, lf.buff.length, lf.pos); /* read block */\n            } catch(e) {\n                lf.err = e;\n                bytes = 0;\n            }\n            lf.pos += bytes;\n        }\n        if (bytes > 0)\n            return lf.buff.subarray(0, bytes);\n        else return null;\n    };\n\n    getc = function(lf) {\n        let b = Buffer.alloc(1);\n        let bytes;\n        try {\n            bytes = fs.readSync(lf.f, b, 0, 1, lf.pos);\n        } catch(e) {\n            lf.err = e;\n            return null;\n        }\n        lf.pos += bytes;\n        return bytes > 0 ? b.readUInt8() : null;\n    };\n\n    luaL_loadfilex = function(L, filename, mode) {\n        let lf = new LoadF();\n        let fnameindex = lua_gettop(L) + 1;  /* index of filename on the stack */\n        if (filename === null) {\n            lua_pushliteral(L, \"=stdin\");\n            lf.f = process.stdin.fd;\n        } else {\n            lua_pushfstring(L, to_luastring(\"@%s\"), filename);\n            try {\n                lf.f = fs.openSync(filename, \"r\");\n            } catch (e) {\n                return errfile(L, \"open\", fnameindex, e);\n            }\n        }\n        let com = skipcomment(lf);\n        /* check for signature first, as we don't want to add line number corrections in binary case */\n        if (com.c === LUA_SIGNATURE[0] && filename) {  /* binary file? */\n            /* no need to re-open */\n        } else if (com.skipped) { /* read initial portion */\n            lf.buff[lf.n++] = 10 /* '\\n'.charCodeAt(0) */;  /* add line to correct line numbers */\n        }\n        if (com.c !== null)\n            lf.buff[lf.n++] = com.c; /* 'c' is the first character of the stream */\n        let status = lua_load(L, getF, lf, lua_tostring(L, -1), mode);\n        let readstatus = lf.err;\n        if (filename) try { fs.closeSync(lf.f); } catch(e) {}  /* close file (even in case of errors) */\n        if (readstatus) {\n            lua_settop(L, fnameindex);  /* ignore results from 'lua_load' */\n            return errfile(L, \"read\", fnameindex, readstatus);\n        }\n        lua_remove(L, fnameindex);\n        return status;\n    };\n}\n\nconst luaL_loadfile = function(L, filename) {\n    return luaL_loadfilex(L, filename, null);\n};\n\nconst luaL_dofile = function(L, filename) {\n    return (luaL_loadfile(L, filename) || lua_pcall(L, 0, LUA_MULTRET, 0));\n};\n\nconst lua_writestringerror = function() {\n    for (let i=0; i<arguments.length; i++) {\n        let a = arguments[i];\n        if (typeof process === \"undefined\") {\n            /* split along new lines for separate console.error invocations */\n            do {\n                /* regexp uses [\\d\\D] to work around matching new lines\n                   the 's' flag is non-standard */\n                let r = /([^\\n]*)\\n?([\\d\\D]*)/.exec(a);\n                console.error(r[1]);\n                a = r[2];\n            } while (a !== \"\");\n        } else {\n            process.stderr.write(a);\n        }\n    }\n};\n\nconst luaL_checkversion_ = function(L, ver, sz) {\n    let v = lua_version(L);\n    if (sz != LUAL_NUMSIZES)  /* check numeric types */\n        luaL_error(L, to_luastring(\"core and library have incompatible numeric types\"));\n    if (v != lua_version(null))\n        luaL_error(L, to_luastring(\"multiple Lua VMs detected\"));\n    else if (v !== ver)\n        luaL_error(L, to_luastring(\"version mismatch: app. needs %f, Lua core provides %f\"), ver, v);\n};\n\n/* There is no point in providing this function... */\nconst luaL_checkversion = function(L) {\n    luaL_checkversion_(L, LUA_VERSION_NUM, LUAL_NUMSIZES);\n};\n\nmodule.exports.LUA_ERRFILE          = LUA_ERRFILE;\nmodule.exports.LUA_FILEHANDLE       = LUA_FILEHANDLE;\nmodule.exports.LUA_LOADED_TABLE     = LUA_LOADED_TABLE;\nmodule.exports.LUA_NOREF            = LUA_NOREF;\nmodule.exports.LUA_PRELOAD_TABLE    = LUA_PRELOAD_TABLE;\nmodule.exports.LUA_REFNIL           = LUA_REFNIL;\nmodule.exports.luaL_Buffer          = luaL_Buffer;\nmodule.exports.luaL_addchar         = luaL_addchar;\nmodule.exports.luaL_addlstring      = luaL_addlstring;\nmodule.exports.luaL_addsize         = luaL_addsize;\nmodule.exports.luaL_addstring       = luaL_addstring;\nmodule.exports.luaL_addvalue        = luaL_addvalue;\nmodule.exports.luaL_argcheck        = luaL_argcheck;\nmodule.exports.luaL_argerror        = luaL_argerror;\nmodule.exports.luaL_buffinit        = luaL_buffinit;\nmodule.exports.luaL_buffinitsize    = luaL_buffinitsize;\nmodule.exports.luaL_callmeta        = luaL_callmeta;\nmodule.exports.luaL_checkany        = luaL_checkany;\nmodule.exports.luaL_checkinteger    = luaL_checkinteger;\nmodule.exports.luaL_checklstring    = luaL_checklstring;\nmodule.exports.luaL_checknumber     = luaL_checknumber;\nmodule.exports.luaL_checkoption     = luaL_checkoption;\nmodule.exports.luaL_checkstack      = luaL_checkstack;\nmodule.exports.luaL_checkstring     = luaL_checkstring;\nmodule.exports.luaL_checktype       = luaL_checktype;\nmodule.exports.luaL_checkudata      = luaL_checkudata;\nmodule.exports.luaL_checkversion    = luaL_checkversion;\nmodule.exports.luaL_checkversion_   = luaL_checkversion_;\nmodule.exports.luaL_dofile          = luaL_dofile;\nmodule.exports.luaL_dostring        = luaL_dostring;\nmodule.exports.luaL_error           = luaL_error;\nmodule.exports.luaL_execresult      = luaL_execresult;\nmodule.exports.luaL_fileresult      = luaL_fileresult;\nmodule.exports.luaL_getmetafield    = luaL_getmetafield;\nmodule.exports.luaL_getmetatable    = luaL_getmetatable;\nmodule.exports.luaL_getsubtable     = luaL_getsubtable;\nmodule.exports.luaL_gsub            = luaL_gsub;\nmodule.exports.luaL_len             = luaL_len;\nmodule.exports.luaL_loadbuffer      = luaL_loadbuffer;\nmodule.exports.luaL_loadbufferx     = luaL_loadbufferx;\nmodule.exports.luaL_loadfile        = luaL_loadfile;\nmodule.exports.luaL_loadfilex       = luaL_loadfilex;\nmodule.exports.luaL_loadstring      = luaL_loadstring;\nmodule.exports.luaL_newlib          = luaL_newlib;\nmodule.exports.luaL_newlibtable     = luaL_newlibtable;\nmodule.exports.luaL_newmetatable    = luaL_newmetatable;\nmodule.exports.luaL_newstate        = luaL_newstate;\nmodule.exports.luaL_opt             = luaL_opt;\nmodule.exports.luaL_optinteger      = luaL_optinteger;\nmodule.exports.luaL_optlstring      = luaL_optlstring;\nmodule.exports.luaL_optnumber       = luaL_optnumber;\nmodule.exports.luaL_optstring       = luaL_optstring;\nmodule.exports.luaL_prepbuffer      = luaL_prepbuffer;\nmodule.exports.luaL_prepbuffsize    = luaL_prepbuffsize;\nmodule.exports.luaL_pushresult      = luaL_pushresult;\nmodule.exports.luaL_pushresultsize  = luaL_pushresultsize;\nmodule.exports.luaL_ref             = luaL_ref;\nmodule.exports.luaL_requiref        = luaL_requiref;\nmodule.exports.luaL_setfuncs        = luaL_setfuncs;\nmodule.exports.luaL_setmetatable    = luaL_setmetatable;\nmodule.exports.luaL_testudata       = luaL_testudata;\nmodule.exports.luaL_tolstring       = luaL_tolstring;\nmodule.exports.luaL_traceback       = luaL_traceback;\nmodule.exports.luaL_typename        = luaL_typename;\nmodule.exports.luaL_unref           = luaL_unref;\nmodule.exports.luaL_where           = luaL_where;\nmodule.exports.lua_writestringerror = lua_writestringerror;\n","\"use strict\";\n\nconst {\n    LUA_MULTRET,\n    LUA_OPADD,\n    LUA_OPBAND,\n    LUA_OPBNOT,\n    LUA_OPBOR,\n    LUA_OPBXOR,\n    LUA_OPDIV,\n    LUA_OPIDIV,\n    LUA_OPMOD,\n    LUA_OPSHL,\n    LUA_OPSHR,\n    LUA_OPUNM,\n    constant_types: {\n        LUA_TBOOLEAN,\n        LUA_TLIGHTUSERDATA,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TTABLE\n    },\n    to_luastring\n} = require('./defs.js');\nconst { lua_assert } = require(\"./llimits.js\");\nconst llex     = require('./llex.js');\nconst lobject  = require('./lobject.js');\nconst lopcodes = require('./lopcodes.js');\nconst lparser  = require('./lparser.js');\nconst ltable   = require('./ltable.js');\nconst lvm      = require('./lvm.js');\n\nconst OpCodesI = lopcodes.OpCodesI;\nconst TValue   = lobject.TValue;\n\n/* Maximum number of registers in a Lua function (must fit in 8 bits) */\nconst MAXREGS = 255;\n\n/*\n** Marks the end of a patch list. It is an invalid value both as an absolute\n** address, and as a list link (would link an element to itself).\n*/\nconst NO_JUMP = -1;\n\nconst BinOpr = {\n    OPR_ADD:      0,\n    OPR_SUB:      1,\n    OPR_MUL:      2,\n    OPR_MOD:      3,\n    OPR_POW:      4,\n    OPR_DIV:      5,\n    OPR_IDIV:     6,\n    OPR_BAND:     7,\n    OPR_BOR:      8,\n    OPR_BXOR:     9,\n    OPR_SHL:      10,\n    OPR_SHR:      11,\n    OPR_CONCAT:   12,\n    OPR_EQ:       13,\n    OPR_LT:       14,\n    OPR_LE:       15,\n    OPR_NE:       16,\n    OPR_GT:       17,\n    OPR_GE:       18,\n    OPR_AND:      19,\n    OPR_OR:       20,\n    OPR_NOBINOPR: 21\n};\n\nconst UnOpr = {\n    OPR_MINUS:    0,\n    OPR_BNOT:     1,\n    OPR_NOT:      2,\n    OPR_LEN:      3,\n    OPR_NOUNOPR:  4\n};\n\nconst hasjumps = function(e) {\n    return e.t !== e.f;\n};\n\n/*\n** If expression is a numeric constant returns either true or a new TValue\n** (depending on 'make_tvalue'). Otherwise, returns false.\n*/\nconst tonumeral = function(e, make_tvalue) {\n    let ek = lparser.expkind;\n    if (hasjumps(e))\n        return false;  /* not a numeral */\n    switch (e.k) {\n        case ek.VKINT:\n            if (make_tvalue) {\n                return new TValue(LUA_TNUMINT, e.u.ival);\n            }\n            return true;\n        case ek.VKFLT:\n            if (make_tvalue) {\n                return new TValue(LUA_TNUMFLT, e.u.nval);\n            }\n            return true;\n        default: return false;\n    }\n};\n\n/*\n** Create a OP_LOADNIL instruction, but try to optimize: if the previous\n** instruction is also OP_LOADNIL and ranges are compatible, adjust\n** range of previous instruction instead of emitting a new one. (For\n** instance, 'local a; local b' will generate a single opcode.)\n*/\nconst luaK_nil = function(fs, from, n) {\n    let previous;\n    let l = from + n - 1;  /* last register to set nil */\n    if (fs.pc > fs.lasttarget) {  /* no jumps to current position? */\n        previous = fs.f.code[fs.pc-1];\n        if (previous.opcode === OpCodesI.OP_LOADNIL) {  /* previous is LOADNIL? */\n            let pfrom = previous.A;  /* get previous range */\n            let pl = pfrom + previous.B;\n            if ((pfrom <= from && from <= pl + 1) ||\n                    (from <= pfrom && pfrom <= l + 1)) {  /* can connect both? */\n                if (pfrom < from) from = pfrom;  /* from = min(from, pfrom) */\n                if (pl > l) l = pl;  /* l = max(l, pl) */\n                lopcodes.SETARG_A(previous, from);\n                lopcodes.SETARG_B(previous, l - from);\n                return;\n            }\n        }  /* else go through */\n    }\n    luaK_codeABC(fs, OpCodesI.OP_LOADNIL, from, n - 1, 0);  /* else no optimization */\n};\n\nconst getinstruction = function(fs, e) {\n    return fs.f.code[e.u.info];\n};\n\n/*\n** Gets the destination address of a jump instruction. Used to traverse\n** a list of jumps.\n*/\nconst getjump = function(fs, pc) {\n    let offset = fs.f.code[pc].sBx;\n    if (offset === NO_JUMP)  /* point to itself represents end of list */\n        return NO_JUMP;  /* end of list */\n    else\n        return pc + 1 + offset;  /* turn offset into absolute position */\n};\n\n/*\n** Fix jump instruction at position 'pc' to jump to 'dest'.\n** (Jump addresses are relative in Lua)\n*/\nconst fixjump = function(fs, pc, dest) {\n    let jmp = fs.f.code[pc];\n    let offset = dest - (pc + 1);\n    lua_assert(dest !== NO_JUMP);\n    if (Math.abs(offset) > lopcodes.MAXARG_sBx)\n        llex.luaX_syntaxerror(fs.ls, to_luastring(\"control structure too long\", true));\n    lopcodes.SETARG_sBx(jmp, offset);\n};\n\n/*\n** Concatenate jump-list 'l2' into jump-list 'l1'\n*/\nconst luaK_concat = function(fs, l1, l2) {\n    if (l2 === NO_JUMP) return l1;  /* nothing to concatenate? */\n    else if (l1 === NO_JUMP)  /* no original list? */\n        l1 = l2;\n    else {\n        let list = l1;\n        let next = getjump(fs, list);\n        while (next !== NO_JUMP) {  /* find last element */\n            list = next;\n            next = getjump(fs, list);\n        }\n        fixjump(fs, list, l2);\n    }\n\n    return l1;\n};\n\n/*\n** Create a jump instruction and return its position, so its destination\n** can be fixed later (with 'fixjump'). If there are jumps to\n** this position (kept in 'jpc'), link them all together so that\n** 'patchlistaux' will fix all them directly to the final destination.\n*/\nconst luaK_jump = function (fs) {\n    let jpc = fs.jpc;  /* save list of jumps to here */\n    fs.jpc = NO_JUMP;  /* no more jumps to here */\n    let j = luaK_codeAsBx(fs, OpCodesI.OP_JMP, 0, NO_JUMP);\n    j = luaK_concat(fs, j, jpc);  /* keep them on hold */\n    return j;\n};\n\nconst luaK_jumpto = function(fs, t) {\n    return luaK_patchlist(fs, luaK_jump(fs), t);\n};\n\n/*\n** Code a 'return' instruction\n*/\nconst luaK_ret = function(fs, first, nret) {\n    luaK_codeABC(fs, OpCodesI.OP_RETURN, first, nret + 1, 0);\n};\n\n/*\n** Code a \"conditional jump\", that is, a test or comparison opcode\n** followed by a jump. Return jump position.\n*/\nconst condjump = function(fs, op, A, B, C) {\n    luaK_codeABC(fs, op, A, B, C);\n    return luaK_jump(fs);\n};\n\n/*\n** returns current 'pc' and marks it as a jump target (to avoid wrong\n** optimizations with consecutive instructions not in the same basic block).\n*/\nconst luaK_getlabel = function(fs) {\n    fs.lasttarget = fs.pc;\n    return fs.pc;\n};\n\n/*\n** Returns the position of the instruction \"controlling\" a given\n** jump (that is, its condition), or the jump itself if it is\n** unconditional.\n*/\nconst getjumpcontroloffset = function(fs, pc) {\n    if (pc >= 1 && lopcodes.testTMode(fs.f.code[pc - 1].opcode))\n        return pc - 1;\n    else\n        return pc;\n};\nconst getjumpcontrol = function(fs, pc) {\n    return fs.f.code[getjumpcontroloffset(fs, pc)];\n};\n\n/*\n** Patch destination register for a TESTSET instruction.\n** If instruction in position 'node' is not a TESTSET, return 0 (\"fails\").\n** Otherwise, if 'reg' is not 'NO_REG', set it as the destination\n** register. Otherwise, change instruction to a simple 'TEST' (produces\n** no register value)\n*/\nconst patchtestreg = function(fs, node, reg) {\n    let pc = getjumpcontroloffset(fs, node);\n    let i = fs.f.code[pc];\n    if (i.opcode !== OpCodesI.OP_TESTSET)\n        return false;  /* cannot patch other instructions */\n    if (reg !== lopcodes.NO_REG && reg !== i.B)\n        lopcodes.SETARG_A(i, reg);\n    else {\n        /* no register to put value or register already has the value;\n           change instruction to simple test */\n        fs.f.code[pc] = lopcodes.CREATE_ABC(OpCodesI.OP_TEST, i.B, 0, i.C);\n    }\n    return true;\n};\n\n/*\n** Traverse a list of tests ensuring no one produces a value\n*/\nconst removevalues = function(fs, list) {\n    for (; list !== NO_JUMP; list = getjump(fs, list))\n        patchtestreg(fs, list, lopcodes.NO_REG);\n};\n\n/*\n** Traverse a list of tests, patching their destination address and\n** registers: tests producing values jump to 'vtarget' (and put their\n** values in 'reg'), other tests jump to 'dtarget'.\n*/\nconst patchlistaux = function(fs, list, vtarget, reg, dtarget) {\n    while (list !== NO_JUMP) {\n        let next = getjump(fs, list);\n        if (patchtestreg(fs, list, reg))\n            fixjump(fs, list, vtarget);\n        else\n            fixjump(fs, list, dtarget);  /* jump to default target */\n        list = next;\n    }\n};\n\n/*\n** Ensure all pending jumps to current position are fixed (jumping\n** to current position with no values) and reset list of pending\n** jumps\n*/\nconst dischargejpc = function(fs) {\n    patchlistaux(fs, fs.jpc, fs.pc, lopcodes.NO_REG, fs.pc);\n    fs.jpc = NO_JUMP;\n};\n\n/*\n** Add elements in 'list' to list of pending jumps to \"here\"\n** (current position)\n*/\nconst luaK_patchtohere = function(fs, list) {\n    luaK_getlabel(fs);  /* mark \"here\" as a jump target */\n    fs.jpc = luaK_concat(fs, fs.jpc, list);\n};\n\n/*\n** Path all jumps in 'list' to jump to 'target'.\n** (The assert means that we cannot fix a jump to a forward address\n** because we only know addresses once code is generated.)\n*/\nconst luaK_patchlist = function(fs, list, target) {\n    if (target === fs.pc)  /* 'target' is current position? */\n        luaK_patchtohere(fs, list);  /* add list to pending jumps */\n    else {\n        lua_assert(target < fs.pc);\n        patchlistaux(fs, list, target, lopcodes.NO_REG, target);\n    }\n};\n\n/*\n** Path all jumps in 'list' to close upvalues up to given 'level'\n** (The assertion checks that jumps either were closing nothing\n** or were closing higher levels, from inner blocks.)\n*/\nconst luaK_patchclose = function(fs, list, level) {\n    level++;  /* argument is +1 to reserve 0 as non-op */\n    for (; list !== NO_JUMP; list = getjump(fs, list)) {\n        let ins = fs.f.code[list];\n        lua_assert(ins.opcode === OpCodesI.OP_JMP && (ins.A === 0 || ins.A >= level));\n        lopcodes.SETARG_A(ins, level);\n    }\n};\n\n/*\n** Emit instruction 'i', checking for array sizes and saving also its\n** line information. Return 'i' position.\n*/\nconst luaK_code = function(fs, i) {\n    let f = fs.f;\n    dischargejpc(fs);  /* 'pc' will change */\n    /* put new instruction in code array */\n    f.code[fs.pc] = i;\n    f.lineinfo[fs.pc] = fs.ls.lastline;\n    return fs.pc++;\n};\n\n/*\n** Format and emit an 'iABC' instruction. (Assertions check consistency\n** of parameters versus opcode.)\n*/\nconst luaK_codeABC = function(fs, o, a, b, c) {\n    lua_assert(lopcodes.getOpMode(o) === lopcodes.iABC);\n    lua_assert(lopcodes.getBMode(o) !== lopcodes.OpArgN || b === 0);\n    lua_assert(lopcodes.getCMode(o) !== lopcodes.OpArgN || c === 0);\n    lua_assert(a <= lopcodes.MAXARG_A && b <= lopcodes.MAXARG_B && c <= lopcodes.MAXARG_C);\n    return luaK_code(fs, lopcodes.CREATE_ABC(o, a, b, c));\n};\n\n/*\n** Format and emit an 'iABx' instruction.\n*/\nconst luaK_codeABx = function(fs, o, a, bc) {\n    lua_assert(lopcodes.getOpMode(o) === lopcodes.iABx || lopcodes.getOpMode(o) === lopcodes.iAsBx);\n    lua_assert(lopcodes.getCMode(o) === lopcodes.OpArgN);\n    lua_assert(a <= lopcodes.MAXARG_A && bc <= lopcodes.MAXARG_Bx);\n    return luaK_code(fs, lopcodes.CREATE_ABx(o, a, bc));\n};\n\nconst luaK_codeAsBx = function(fs,o,A,sBx) {\n    return luaK_codeABx(fs, o, A, (sBx) + lopcodes.MAXARG_sBx);\n};\n\n/*\n** Emit an \"extra argument\" instruction (format 'iAx')\n*/\nconst codeextraarg = function(fs, a) {\n    lua_assert(a <= lopcodes.MAXARG_Ax);\n    return luaK_code(fs, lopcodes.CREATE_Ax(OpCodesI.OP_EXTRAARG, a));\n};\n\n/*\n** Emit a \"load constant\" instruction, using either 'OP_LOADK'\n** (if constant index 'k' fits in 18 bits) or an 'OP_LOADKX'\n** instruction with \"extra argument\".\n*/\nconst luaK_codek = function(fs, reg, k) {\n    if (k <= lopcodes.MAXARG_Bx)\n        return luaK_codeABx(fs, OpCodesI.OP_LOADK, reg, k);\n    else {\n        let p = luaK_codeABx(fs, OpCodesI.OP_LOADKX, reg, 0);\n        codeextraarg(fs, k);\n        return p;\n    }\n};\n\n/*\n** Check register-stack level, keeping track of its maximum size\n** in field 'maxstacksize'\n*/\nconst luaK_checkstack = function(fs, n) {\n    let newstack = fs.freereg + n;\n    if (newstack > fs.f.maxstacksize) {\n        if (newstack >= MAXREGS)\n            llex.luaX_syntaxerror(fs.ls, to_luastring(\"function or expression needs too many registers\", true));\n        fs.f.maxstacksize = newstack;\n    }\n};\n\n/*\n** Reserve 'n' registers in register stack\n*/\nconst luaK_reserveregs = function(fs, n) {\n    luaK_checkstack(fs, n);\n    fs.freereg += n;\n};\n\n/*\n** Free register 'reg', if it is neither a constant index nor\n** a local variable.\n*/\nconst freereg = function(fs, reg) {\n    if (!lopcodes.ISK(reg) && reg >= fs.nactvar) {\n        fs.freereg--;\n        lua_assert(reg === fs.freereg);\n    }\n};\n\n/*\n** Free register used by expression 'e' (if any)\n*/\nconst freeexp = function(fs, e) {\n    if (e.k === lparser.expkind.VNONRELOC)\n        freereg(fs, e.u.info);\n};\n\n/*\n** Free registers used by expressions 'e1' and 'e2' (if any) in proper\n** order.\n*/\nconst freeexps = function(fs, e1, e2) {\n    let r1 = (e1.k === lparser.expkind.VNONRELOC) ? e1.u.info : -1;\n    let r2 = (e2.k === lparser.expkind.VNONRELOC) ? e2.u.info : -1;\n    if (r1 > r2) {\n        freereg(fs, r1);\n        freereg(fs, r2);\n    }\n    else {\n        freereg(fs, r2);\n        freereg(fs, r1);\n    }\n};\n\n\n/*\n** Add constant 'v' to prototype's list of constants (field 'k').\n** Use scanner's table to cache position of constants in constant list\n** and try to reuse constants. Because some values should not be used\n** as keys (nil cannot be a key, integer keys can collapse with float\n** keys), the caller must provide a useful 'key' for indexing the cache.\n*/\nconst addk = function(fs, key, v) {\n    let f = fs.f;\n    let idx = ltable.luaH_get(fs.L, fs.ls.h, key);  /* index scanner table */\n    if (idx.ttisinteger()) {  /* is there an index there? */\n        let k = idx.value;\n        /* correct value? (warning: must distinguish floats from integers!) */\n        if (k < fs.nk && f.k[k].ttype() === v.ttype() && f.k[k].value === v.value)\n            return k;  /* reuse index */\n    }\n    /* constant not found; create a new entry */\n    let k = fs.nk;\n    ltable.luaH_setfrom(fs.L, fs.ls.h, key, new lobject.TValue(LUA_TNUMINT, k));\n    f.k[k] = v;\n    fs.nk++;\n    return k;\n};\n\n/*\n** Add a string to list of constants and return its index.\n*/\nconst luaK_stringK = function(fs, s) {\n    let o = new TValue(LUA_TLNGSTR, s);\n    return addk(fs, o, o);  /* use string itself as key */\n};\n\n\n/*\n** Add an integer to list of constants and return its index.\n** Integers use userdata as keys to avoid collision with floats with\n** same value.\n*/\nconst luaK_intK = function(fs, n) {\n    let k = new TValue(LUA_TLIGHTUSERDATA, n);\n    let o = new TValue(LUA_TNUMINT, n);\n    return addk(fs, k, o);\n};\n\n/*\n** Add a float to list of constants and return its index.\n*/\nconst luaK_numberK = function(fs, r) {\n    let o = new TValue(LUA_TNUMFLT, r);\n    return addk(fs, o, o);  /* use number itself as key */\n};\n\n\n/*\n** Add a boolean to list of constants and return its index.\n*/\nconst boolK = function(fs, b) {\n    let o = new TValue(LUA_TBOOLEAN, b);\n    return addk(fs, o, o);  /* use boolean itself as key */\n};\n\n\n/*\n** Add nil to list of constants and return its index.\n*/\nconst nilK = function(fs) {\n    let v = new TValue(LUA_TNIL, null);\n    let k = new TValue(LUA_TTABLE, fs.ls.h);\n    /* cannot use nil as key; instead use table itself to represent nil */\n    return addk(fs, k, v);\n};\n\n/*\n** Fix an expression to return the number of results 'nresults'.\n** Either 'e' is a multi-ret expression (function call or vararg)\n** or 'nresults' is LUA_MULTRET (as any expression can satisfy that).\n*/\nconst luaK_setreturns = function(fs, e, nresults) {\n    let ek = lparser.expkind;\n    if (e.k === ek.VCALL) {  /* expression is an open function call? */\n        lopcodes.SETARG_C(getinstruction(fs, e), nresults + 1);\n    }\n    else if (e.k === ek.VVARARG) {\n        let pc = getinstruction(fs, e);\n        lopcodes.SETARG_B(pc, nresults + 1);\n        lopcodes.SETARG_A(pc, fs.freereg);\n        luaK_reserveregs(fs, 1);\n    }\n    else lua_assert(nresults === LUA_MULTRET);\n};\n\nconst luaK_setmultret = function(fs, e) {\n    luaK_setreturns(fs, e, LUA_MULTRET);\n};\n\n/*\n** Fix an expression to return one result.\n** If expression is not a multi-ret expression (function call or\n** vararg), it already returns one result, so nothing needs to be done.\n** Function calls become VNONRELOC expressions (as its result comes\n** fixed in the base register of the call), while vararg expressions\n** become VRELOCABLE (as OP_VARARG puts its results where it wants).\n** (Calls are created returning one result, so that does not need\n** to be fixed.)\n*/\nconst luaK_setoneret = function(fs, e) {\n    let ek = lparser.expkind;\n    if (e.k === ek.VCALL) {  /* expression is an open function call? */\n        /* already returns 1 value */\n        lua_assert(getinstruction(fs, e).C === 2);\n        e.k = ek.VNONRELOC;  /* result has fixed position */\n        e.u.info = getinstruction(fs, e).A;\n    } else if (e.k === ek.VVARARG) {\n        lopcodes.SETARG_B(getinstruction(fs, e), 2);\n        e.k = ek.VRELOCABLE;  /* can relocate its simple result */\n    }\n};\n\n/*\n** Ensure that expression 'e' is not a variable.\n*/\nconst luaK_dischargevars = function(fs, e) {\n    let ek = lparser.expkind;\n\n    switch (e.k) {\n        case ek.VLOCAL: {  /* already in a register */\n            e.k =  ek.VNONRELOC;  /* becomes a non-relocatable value */\n            break;\n        }\n        case ek.VUPVAL: {  /* move value to some (pending) register */\n            e.u.info = luaK_codeABC(fs, OpCodesI.OP_GETUPVAL, 0, e.u.info, 0);\n            e.k = ek.VRELOCABLE;\n            break;\n        }\n        case ek.VINDEXED: {\n            let op;\n            freereg(fs, e.u.ind.idx);\n            if (e.u.ind.vt === ek.VLOCAL) {  /* is 't' in a register? */\n                freereg(fs, e.u.ind.t);\n                op = OpCodesI.OP_GETTABLE;\n            } else {\n                lua_assert(e.u.ind.vt === ek.VUPVAL);\n                op = OpCodesI.OP_GETTABUP;  /* 't' is in an upvalue */\n            }\n            e.u.info = luaK_codeABC(fs, op, 0, e.u.ind.t, e.u.ind.idx);\n            e.k = ek.VRELOCABLE;\n            break;\n        }\n        case ek.VVARARG: case ek.VCALL: {\n            luaK_setoneret(fs, e);\n            break;\n        }\n        default: break;  /* there is one value available (somewhere) */\n    }\n};\n\nconst code_loadbool = function(fs, A, b, jump) {\n    luaK_getlabel(fs);  /* those instructions may be jump targets */\n    return luaK_codeABC(fs, OpCodesI.OP_LOADBOOL, A, b, jump);\n};\n\n/*\n** Ensures expression value is in register 'reg' (and therefore\n** 'e' will become a non-relocatable expression).\n*/\nconst discharge2reg = function(fs, e, reg) {\n    let ek = lparser.expkind;\n    luaK_dischargevars(fs, e);\n    switch (e.k) {\n        case ek.VNIL: {\n            luaK_nil(fs, reg, 1);\n            break;\n        }\n        case ek.VFALSE: case ek.VTRUE: {\n            luaK_codeABC(fs, OpCodesI.OP_LOADBOOL, reg, e.k === ek.VTRUE, 0);\n            break;\n        }\n        case ek.VK: {\n            luaK_codek(fs, reg, e.u.info);\n            break;\n        }\n        case ek.VKFLT: {\n            luaK_codek(fs, reg, luaK_numberK(fs, e.u.nval));\n            break;\n        }\n        case ek.VKINT: {\n            luaK_codek(fs, reg, luaK_intK(fs, e.u.ival));\n            break;\n        }\n        case ek.VRELOCABLE: {\n            let pc = getinstruction(fs, e);\n            lopcodes.SETARG_A(pc, reg);  /* instruction will put result in 'reg' */\n            break;\n        }\n        case ek.VNONRELOC: {\n            if (reg !== e.u.info)\n                luaK_codeABC(fs, OpCodesI.OP_MOVE, reg, e.u.info, 0);\n            break;\n        }\n        default: {\n            lua_assert(e.k === ek.VJMP);\n            return;  /* nothing to do... */\n        }\n    }\n    e.u.info = reg;\n    e.k = ek.VNONRELOC;\n};\n\n/*\n** Ensures expression value is in any register.\n*/\nconst discharge2anyreg = function(fs, e) {\n    if (e.k !== lparser.expkind.VNONRELOC) {  /* no fixed register yet? */\n        luaK_reserveregs(fs, 1);  /* get a register */\n        discharge2reg(fs, e, fs.freereg-1);  /* put value there */\n    }\n};\n\n/*\n** check whether list has any jump that do not produce a value\n** or produce an inverted value\n*/\nconst need_value = function(fs, list) {\n    for (; list !== NO_JUMP; list = getjump(fs, list)) {\n        let i = getjumpcontrol(fs, list);\n        if (i.opcode !== OpCodesI.OP_TESTSET) return true;\n    }\n    return false;  /* not found */\n};\n\n/*\n** Ensures final expression result (including results from its jump\n** lists) is in register 'reg'.\n** If expression has jumps, need to patch these jumps either to\n** its final position or to \"load\" instructions (for those tests\n** that do not produce values).\n*/\nconst exp2reg = function(fs, e, reg) {\n    let ek = lparser.expkind;\n    discharge2reg(fs, e, reg);\n    if (e.k === ek.VJMP)  /* expression itself is a test? */\n        e.t = luaK_concat(fs, e.t, e.u.info);  /* put this jump in 't' list */\n    if (hasjumps(e)) {\n        let final;  /* position after whole expression */\n        let p_f = NO_JUMP;  /* position of an eventual LOAD false */\n        let p_t = NO_JUMP;  /* position of an eventual LOAD true */\n        if (need_value(fs, e.t) || need_value(fs, e.f)) {\n            let fj = (e.k === ek.VJMP) ? NO_JUMP : luaK_jump(fs);\n            p_f = code_loadbool(fs, reg, 0, 1);\n            p_t = code_loadbool(fs, reg, 1, 0);\n            luaK_patchtohere(fs, fj);\n        }\n        final = luaK_getlabel(fs);\n        patchlistaux(fs, e.f, final, reg, p_f);\n        patchlistaux(fs, e.t, final, reg, p_t);\n    }\n    e.f = e.t = NO_JUMP;\n    e.u.info = reg;\n    e.k = ek.VNONRELOC;\n};\n\n/*\n** Ensures final expression result (including results from its jump\n** lists) is in next available register.\n*/\nconst luaK_exp2nextreg = function(fs, e) {\n    luaK_dischargevars(fs, e);\n    freeexp(fs, e);\n    luaK_reserveregs(fs, 1);\n    exp2reg(fs, e, fs.freereg - 1);\n};\n\n\n/*\n** Ensures final expression result (including results from its jump\n** lists) is in some (any) register and return that register.\n*/\nconst luaK_exp2anyreg = function(fs, e) {\n    luaK_dischargevars(fs, e);\n    if (e.k === lparser.expkind.VNONRELOC) {  /* expression already has a register? */\n        if (!hasjumps(e))  /* no jumps? */\n            return e.u.info;  /* result is already in a register */\n        if (e.u.info >= fs.nactvar) {  /* reg. is not a local? */\n            exp2reg(fs, e, e.u.info);  /* put final result in it */\n            return e.u.info;\n        }\n    }\n    luaK_exp2nextreg(fs, e);  /* otherwise, use next available register */\n    return e.u.info;\n};\n\n/*\n** Ensures final expression result is either in a register or in an\n** upvalue.\n*/\nconst luaK_exp2anyregup = function(fs, e) {\n    if (e.k !== lparser.expkind.VUPVAL || hasjumps(e))\n        luaK_exp2anyreg(fs, e);\n};\n\n/*\n** Ensures final expression result is either in a register or it is\n** a constant.\n*/\nconst luaK_exp2val = function(fs, e) {\n    if (hasjumps(e))\n        luaK_exp2anyreg(fs, e);\n    else\n        luaK_dischargevars(fs, e);\n};\n\n/*\n** Ensures final expression result is in a valid R/K index\n** (that is, it is either in a register or in 'k' with an index\n** in the range of R/K indices).\n** Returns R/K index.\n*/\nconst luaK_exp2RK = function(fs, e) {\n    let ek = lparser.expkind;\n    let vk = false;\n    luaK_exp2val(fs, e);\n    switch (e.k) {  /* move constants to 'k' */\n        case ek.VTRUE: e.u.info = boolK(fs, true); vk = true; break;\n        case ek.VFALSE: e.u.info = boolK(fs, false); vk = true; break;\n        case ek.VNIL: e.u.info = nilK(fs); vk = true; break;\n        case ek.VKINT: e.u.info = luaK_intK(fs, e.u.ival); vk = true; break;\n        case ek.VKFLT: e.u.info = luaK_numberK(fs, e.u.nval); vk = true; break;\n        case ek.VK: vk = true; break;\n        default: break;\n    }\n\n    if (vk) {\n        e.k = ek.VK;\n        if (e.u.info <= lopcodes.MAXINDEXRK)  /* constant fits in 'argC'? */\n            return lopcodes.RKASK(e.u.info);\n    }\n\n    /* not a constant in the right range: put it in a register */\n    return luaK_exp2anyreg(fs, e);\n};\n\n/*\n** Generate code to store result of expression 'ex' into variable 'var'.\n*/\nconst luaK_storevar = function(fs, vr, ex) {\n    let ek = lparser.expkind;\n    switch (vr.k) {\n        case ek.VLOCAL: {\n            freeexp(fs, ex);\n            exp2reg(fs, ex, vr.u.info);  /* compute 'ex' into proper place */\n            return;\n        }\n        case ek.VUPVAL: {\n            let e = luaK_exp2anyreg(fs, ex);\n            luaK_codeABC(fs, OpCodesI.OP_SETUPVAL, e, vr.u.info, 0);\n            break;\n        }\n        case ek.VINDEXED: {\n            let op = (vr.u.ind.vt === ek.VLOCAL) ? OpCodesI.OP_SETTABLE : OpCodesI.OP_SETTABUP;\n            let e = luaK_exp2RK(fs, ex);\n            luaK_codeABC(fs, op, vr.u.ind.t, vr.u.ind.idx, e);\n            break;\n        }\n    }\n    freeexp(fs, ex);\n};\n\n\n/*\n** Emit SELF instruction (convert expression 'e' into 'e:key(e,').\n*/\nconst luaK_self = function(fs, e, key) {\n    luaK_exp2anyreg(fs, e);\n    let ereg = e.u.info;  /* register where 'e' was placed */\n    freeexp(fs, e);\n    e.u.info = fs.freereg;  /* base register for op_self */\n    e.k = lparser.expkind.VNONRELOC;  /* self expression has a fixed register */\n    luaK_reserveregs(fs, 2);  /* function and 'self' produced by op_self */\n    luaK_codeABC(fs, OpCodesI.OP_SELF, e.u.info, ereg, luaK_exp2RK(fs, key));\n    freeexp(fs, key);\n};\n\n/*\n** Negate condition 'e' (where 'e' is a comparison).\n*/\nconst negatecondition = function(fs, e) {\n    let pc = getjumpcontrol(fs, e.u.info);\n    lua_assert(lopcodes.testTMode(pc.opcode) && pc.opcode !== OpCodesI.OP_TESTSET && pc.opcode !== OpCodesI.OP_TEST);\n    lopcodes.SETARG_A(pc, !(pc.A));\n};\n\n/*\n** Emit instruction to jump if 'e' is 'cond' (that is, if 'cond'\n** is true, code will jump if 'e' is true.) Return jump position.\n** Optimize when 'e' is 'not' something, inverting the condition\n** and removing the 'not'.\n*/\nconst jumponcond = function(fs, e, cond) {\n    if (e.k === lparser.expkind.VRELOCABLE) {\n        let ie = getinstruction(fs, e);\n        if (ie.opcode === OpCodesI.OP_NOT) {\n            fs.pc--;  /* remove previous OP_NOT */\n            return condjump(fs, OpCodesI.OP_TEST, ie.B, 0, !cond);\n        }\n        /* else go through */\n    }\n    discharge2anyreg(fs, e);\n    freeexp(fs, e);\n    return condjump(fs, OpCodesI.OP_TESTSET, lopcodes.NO_REG, e.u.info, cond);\n};\n\n/*\n** Emit code to go through if 'e' is true, jump otherwise.\n*/\nconst luaK_goiftrue = function(fs, e) {\n    let ek = lparser.expkind;\n    let pc;  /* pc of new jump */\n    luaK_dischargevars(fs, e);\n    switch (e.k) {\n        case ek.VJMP: {  /* condition? */\n            negatecondition(fs, e);  /* jump when it is false */\n            pc = e.u.info;  /* save jump position */\n            break;\n        }\n        case ek.VK: case ek.VKFLT: case ek.VKINT: case ek.VTRUE: {\n            pc = NO_JUMP;  /* always true; do nothing */\n            break;\n        }\n        default: {\n            pc = jumponcond(fs, e, 0);  /* jump when false */\n            break;\n        }\n    }\n    e.f = luaK_concat(fs, e.f, pc);  /* insert new jump in false list */\n    luaK_patchtohere(fs, e.t);  /* true list jumps to here (to go through) */\n    e.t = NO_JUMP;\n};\n\n/*\n** Emit code to go through if 'e' is false, jump otherwise.\n*/\nconst luaK_goiffalse = function(fs, e) {\n    let ek = lparser.expkind;\n    let pc;  /* pc of new jump */\n    luaK_dischargevars(fs, e);\n    switch (e.k) {\n        case ek.VJMP: {\n            pc = e.u.info;  /* already jump if true */\n            break;\n        }\n        case ek.VNIL: case ek.VFALSE: {\n            pc = NO_JUMP;  /* always false; do nothing */\n            break;\n        }\n        default: {\n            pc = jumponcond(fs, e, 1);  /* jump if true */\n            break;\n        }\n    }\n    e.t = luaK_concat(fs, e.t, pc);  /* insert new jump in 't' list */\n    luaK_patchtohere(fs, e.f);  /* false list jumps to here (to go through) */\n    e.f = NO_JUMP;\n};\n\n/*\n** Code 'not e', doing constant folding.\n*/\nconst codenot = function(fs, e) {\n    let ek = lparser.expkind;\n    luaK_dischargevars(fs, e);\n    switch (e.k) {\n        case ek.VNIL: case ek.VFALSE: {\n            e.k = ek.VTRUE;  /* true === not nil === not false */\n            break;\n        }\n        case ek.VK: case ek.VKFLT: case ek.VKINT: case ek.VTRUE: {\n            e.k = ek.VFALSE;  /* false === not \"x\" === not 0.5 === not 1 === not true */\n            break;\n        }\n        case ek.VJMP: {\n            negatecondition(fs, e);\n            break;\n        }\n        case ek.VRELOCABLE:\n        case ek.VNONRELOC: {\n            discharge2anyreg(fs, e);\n            freeexp(fs, e);\n            e.u.info = luaK_codeABC(fs, OpCodesI.OP_NOT, 0, e.u.info, 0);\n            e.k = ek.VRELOCABLE;\n            break;\n        }\n    }\n    /* interchange true and false lists */\n    { let temp = e.f; e.f = e.t; e.t = temp; }\n    removevalues(fs, e.f);  /* values are useless when negated */\n    removevalues(fs, e.t);\n};\n\n/*\n** Create expression 't[k]'. 't' must have its final result already in a\n** register or upvalue.\n*/\nconst luaK_indexed = function(fs, t, k) {\n    let ek = lparser.expkind;\n    lua_assert(!hasjumps(t) && (lparser.vkisinreg(t.k) || t.k === ek.VUPVAL));\n    t.u.ind.t = t.u.info;  /* register or upvalue index */\n    t.u.ind.idx = luaK_exp2RK(fs, k);  /* R/K index for key */\n    t.u.ind.vt = (t.k === ek.VUPVAL) ? ek.VUPVAL : ek.VLOCAL;\n    t.k = ek.VINDEXED;\n};\n\n/*\n** Return false if folding can raise an error.\n** Bitwise operations need operands convertible to integers; division\n** operations cannot have 0 as divisor.\n*/\nconst validop = function(op, v1, v2) {\n    switch (op) {\n        case LUA_OPBAND: case LUA_OPBOR: case LUA_OPBXOR:\n        case LUA_OPSHL: case LUA_OPSHR: case LUA_OPBNOT: {  /* conversion errors */\n            return (lvm.tointeger(v1) !== false && lvm.tointeger(v2) !== false);\n        }\n        case LUA_OPDIV: case LUA_OPIDIV: case LUA_OPMOD:  /* division by 0 */\n            return (v2.value !== 0);\n        default: return 1;  /* everything else is valid */\n    }\n};\n\n/*\n** Try to \"constant-fold\" an operation; return 1 iff successful.\n** (In this case, 'e1' has the final result.)\n*/\nconst constfolding = function(op, e1, e2) {\n    let ek = lparser.expkind;\n    let v1, v2;\n    if (!(v1 = tonumeral(e1, true)) || !(v2 = tonumeral(e2, true)) || !validop(op, v1, v2))\n        return 0;  /* non-numeric operands or not safe to fold */\n    let res = new TValue(); /* FIXME */\n    lobject.luaO_arith(null, op, v1, v2, res);  /* does operation */\n    if (res.ttisinteger()) {\n        e1.k = ek.VKINT;\n        e1.u.ival = res.value;\n    }\n    else {  /* folds neither NaN nor 0.0 (to avoid problems with -0.0) */\n        let n = res.value;\n        if (isNaN(n) || n === 0)\n            return false;\n        e1.k = ek.VKFLT;\n        e1.u.nval = n;\n    }\n    return true;\n};\n\n/*\n** Emit code for unary expressions that \"produce values\"\n** (everything but 'not').\n** Expression to produce final result will be encoded in 'e'.\n*/\nconst codeunexpval = function(fs, op, e, line) {\n    let r = luaK_exp2anyreg(fs, e);  /* opcodes operate only on registers */\n    freeexp(fs, e);\n    e.u.info = luaK_codeABC(fs, op, 0, r, 0);  /* generate opcode */\n    e.k = lparser.expkind.VRELOCABLE;  /* all those operations are relocatable */\n    luaK_fixline(fs, line);\n};\n\n/*\n** Emit code for binary expressions that \"produce values\"\n** (everything but logical operators 'and'/'or' and comparison\n** operators).\n** Expression to produce final result will be encoded in 'e1'.\n** Because 'luaK_exp2RK' can free registers, its calls must be\n** in \"stack order\" (that is, first on 'e2', which may have more\n** recent registers to be released).\n*/\nconst codebinexpval = function(fs, op, e1, e2, line) {\n    let rk2 = luaK_exp2RK(fs, e2);  /* both operands are \"RK\" */\n    let rk1 = luaK_exp2RK(fs, e1);\n    freeexps(fs, e1, e2);\n    e1.u.info = luaK_codeABC(fs, op, 0, rk1, rk2);  /* generate opcode */\n    e1.k = lparser.expkind.VRELOCABLE;  /* all those operations are relocatable */\n    luaK_fixline(fs, line);\n};\n\n\n/*\n** Emit code for comparisons.\n** 'e1' was already put in R/K form by 'luaK_infix'.\n*/\nconst codecomp = function(fs, opr, e1, e2) {\n    let ek = lparser.expkind;\n\n    let rk1;\n    if (e1.k === ek.VK)\n        rk1 = lopcodes.RKASK(e1.u.info);\n    else {\n        lua_assert(e1.k === ek.VNONRELOC);\n        rk1 = e1.u.info;\n    }\n\n    let rk2 = luaK_exp2RK(fs, e2);\n    freeexps(fs, e1, e2);\n    switch (opr) {\n        case BinOpr.OPR_NE: {  /* '(a ~= b)' ==> 'not (a === b)' */\n            e1.u.info = condjump(fs, OpCodesI.OP_EQ, 0, rk1, rk2);\n            break;\n        }\n        case BinOpr.OPR_GT: case BinOpr.OPR_GE: {\n            /* '(a > b)' ==> '(b < a)';  '(a >= b)' ==> '(b <= a)' */\n            let op = (opr - BinOpr.OPR_NE) + OpCodesI.OP_EQ;\n            e1.u.info = condjump(fs, op, 1, rk2, rk1);  /* invert operands */\n            break;\n        }\n        default: {  /* '==', '<', '<=' use their own opcodes */\n            let op = (opr - BinOpr.OPR_EQ) + OpCodesI.OP_EQ;\n            e1.u.info = condjump(fs, op, 1, rk1, rk2);\n            break;\n        }\n    }\n    e1.k = ek.VJMP;\n};\n\n/*\n** Apply prefix operation 'op' to expression 'e'.\n*/\nconst luaK_prefix = function(fs, op, e, line) {\n    let ef = new lparser.expdesc();\n    ef.k = lparser.expkind.VKINT;\n    ef.u.ival = ef.u.nval = ef.u.info = 0;\n    ef.t = NO_JUMP;\n    ef.f = NO_JUMP;\n    switch (op) {\n        case UnOpr.OPR_MINUS: case UnOpr.OPR_BNOT:  /* use 'ef' as fake 2nd operand */\n            if (constfolding(op + LUA_OPUNM, e, ef))\n                break;\n            /* FALLTHROUGH */\n        case UnOpr.OPR_LEN:\n            codeunexpval(fs, op + OpCodesI.OP_UNM, e, line);\n            break;\n        case UnOpr.OPR_NOT: codenot(fs, e); break;\n    }\n};\n\n/*\n** Process 1st operand 'v' of binary operation 'op' before reading\n** 2nd operand.\n*/\nconst luaK_infix = function(fs, op, v) {\n    switch (op) {\n        case BinOpr.OPR_AND: {\n            luaK_goiftrue(fs, v);  /* go ahead only if 'v' is true */\n            break;\n        }\n        case BinOpr.OPR_OR: {\n            luaK_goiffalse(fs, v);  /* go ahead only if 'v' is false */\n            break;\n        }\n        case BinOpr.OPR_CONCAT: {\n            luaK_exp2nextreg(fs, v);  /* operand must be on the 'stack' */\n            break;\n        }\n        case BinOpr.OPR_ADD: case BinOpr.OPR_SUB:\n        case BinOpr.OPR_MUL: case BinOpr.OPR_DIV: case BinOpr.OPR_IDIV:\n        case BinOpr.OPR_MOD: case BinOpr.OPR_POW:\n        case BinOpr.OPR_BAND: case BinOpr.OPR_BOR: case BinOpr.OPR_BXOR:\n        case BinOpr.OPR_SHL: case BinOpr.OPR_SHR: {\n            if (!tonumeral(v, false))\n                luaK_exp2RK(fs, v);\n            /* else keep numeral, which may be folded with 2nd operand */\n            break;\n        }\n        default: {\n            luaK_exp2RK(fs, v);\n            break;\n        }\n    }\n};\n\n/*\n** Finalize code for binary operation, after reading 2nd operand.\n** For '(a .. b .. c)' (which is '(a .. (b .. c))', because\n** concatenation is right associative), merge second CONCAT into first\n** one.\n*/\nconst luaK_posfix = function(fs, op, e1, e2, line) {\n    let ek = lparser.expkind;\n    switch (op) {\n        case BinOpr.OPR_AND: {\n            lua_assert(e1.t === NO_JUMP);  /* list closed by 'luK_infix' */\n            luaK_dischargevars(fs, e2);\n            e2.f = luaK_concat(fs, e2.f, e1.f);\n            e1.to(e2);\n            break;\n        }\n        case BinOpr.OPR_OR: {\n            lua_assert(e1.f === NO_JUMP);  /* list closed by 'luK_infix' */\n            luaK_dischargevars(fs, e2);\n            e2.t = luaK_concat(fs, e2.t, e1.t);\n            e1.to(e2);\n            break;\n        }\n        case BinOpr.OPR_CONCAT: {\n            luaK_exp2val(fs, e2);\n            let ins = getinstruction(fs, e2);\n            if (e2.k === ek.VRELOCABLE && ins.opcode === OpCodesI.OP_CONCAT) {\n                lua_assert(e1.u.info === ins.B - 1);\n                freeexp(fs, e1);\n                lopcodes.SETARG_B(ins, e1.u.info);\n                e1.k = ek.VRELOCABLE; e1.u.info = e2.u.info;\n            }\n            else {\n                luaK_exp2nextreg(fs, e2);  /* operand must be on the 'stack' */\n                codebinexpval(fs, OpCodesI.OP_CONCAT, e1, e2, line);\n            }\n            break;\n        }\n        case BinOpr.OPR_ADD: case BinOpr.OPR_SUB: case BinOpr.OPR_MUL: case BinOpr.OPR_DIV:\n        case BinOpr.OPR_IDIV: case BinOpr.OPR_MOD: case BinOpr.OPR_POW:\n        case BinOpr.OPR_BAND: case BinOpr.OPR_BOR: case BinOpr.OPR_BXOR:\n        case BinOpr.OPR_SHL: case BinOpr.OPR_SHR: {\n            if (!constfolding(op + LUA_OPADD, e1, e2))\n                codebinexpval(fs, op + OpCodesI.OP_ADD, e1, e2, line);\n            break;\n        }\n        case BinOpr.OPR_EQ: case BinOpr.OPR_LT: case BinOpr.OPR_LE:\n        case BinOpr.OPR_NE: case BinOpr.OPR_GT: case BinOpr.OPR_GE: {\n            codecomp(fs, op, e1, e2);\n            break;\n        }\n    }\n\n    return e1;\n};\n\n/*\n** Change line information associated with current position.\n*/\nconst luaK_fixline = function(fs, line) {\n    fs.f.lineinfo[fs.pc - 1] = line;\n};\n\n/*\n** Emit a SETLIST instruction.\n** 'base' is register that keeps table;\n** 'nelems' is #table plus those to be stored now;\n** 'tostore' is number of values (in registers 'base + 1',...) to add to\n** table (or LUA_MULTRET to add up to stack top).\n*/\nconst luaK_setlist = function(fs, base, nelems, tostore) {\n    let c =  (nelems - 1)/lopcodes.LFIELDS_PER_FLUSH + 1;\n    let b = (tostore === LUA_MULTRET) ? 0 : tostore;\n    lua_assert(tostore !== 0 && tostore <= lopcodes.LFIELDS_PER_FLUSH);\n    if (c <= lopcodes.MAXARG_C)\n        luaK_codeABC(fs, OpCodesI.OP_SETLIST, base, b, c);\n    else if (c <= lopcodes.MAXARG_Ax) {\n        luaK_codeABC(fs, OpCodesI.OP_SETLIST, base, b, 0);\n        codeextraarg(fs, c);\n    }\n    else\n        llex.luaX_syntaxerror(fs.ls, to_luastring(\"constructor too long\", true));\n    fs.freereg = base + 1;  /* free registers with list values */\n};\n\n\nmodule.exports.BinOpr             = BinOpr;\nmodule.exports.NO_JUMP            = NO_JUMP;\nmodule.exports.UnOpr              = UnOpr;\nmodule.exports.getinstruction     = getinstruction;\nmodule.exports.luaK_checkstack    = luaK_checkstack;\nmodule.exports.luaK_code          = luaK_code;\nmodule.exports.luaK_codeABC       = luaK_codeABC;\nmodule.exports.luaK_codeABx       = luaK_codeABx;\nmodule.exports.luaK_codeAsBx      = luaK_codeAsBx;\nmodule.exports.luaK_codek         = luaK_codek;\nmodule.exports.luaK_concat        = luaK_concat;\nmodule.exports.luaK_dischargevars = luaK_dischargevars;\nmodule.exports.luaK_exp2RK        = luaK_exp2RK;\nmodule.exports.luaK_exp2anyreg    = luaK_exp2anyreg;\nmodule.exports.luaK_exp2anyregup  = luaK_exp2anyregup;\nmodule.exports.luaK_exp2nextreg   = luaK_exp2nextreg;\nmodule.exports.luaK_exp2val       = luaK_exp2val;\nmodule.exports.luaK_fixline       = luaK_fixline;\nmodule.exports.luaK_getlabel      = luaK_getlabel;\nmodule.exports.luaK_goiffalse     = luaK_goiffalse;\nmodule.exports.luaK_goiftrue      = luaK_goiftrue;\nmodule.exports.luaK_indexed       = luaK_indexed;\nmodule.exports.luaK_infix         = luaK_infix;\nmodule.exports.luaK_intK          = luaK_intK;\nmodule.exports.luaK_jump          = luaK_jump;\nmodule.exports.luaK_jumpto        = luaK_jumpto;\nmodule.exports.luaK_nil           = luaK_nil;\nmodule.exports.luaK_numberK       = luaK_numberK;\nmodule.exports.luaK_patchclose    = luaK_patchclose;\nmodule.exports.luaK_patchlist     = luaK_patchlist;\nmodule.exports.luaK_patchtohere   = luaK_patchtohere;\nmodule.exports.luaK_posfix        = luaK_posfix;\nmodule.exports.luaK_prefix        = luaK_prefix;\nmodule.exports.luaK_reserveregs   = luaK_reserveregs;\nmodule.exports.luaK_ret           = luaK_ret;\nmodule.exports.luaK_self          = luaK_self;\nmodule.exports.luaK_setlist       = luaK_setlist;\nmodule.exports.luaK_setmultret    = luaK_setmultret;\nmodule.exports.luaK_setoneret     = luaK_setoneret;\nmodule.exports.luaK_setreturns    = luaK_setreturns;\nmodule.exports.luaK_storevar      = luaK_storevar;\nmodule.exports.luaK_stringK       = luaK_stringK;\n","\"use strict\";\n\nconst {\n    LUA_HOOKCOUNT,\n    LUA_HOOKLINE,\n    LUA_MASKCOUNT,\n    LUA_MASKLINE,\n    constant_types: {\n        LUA_TBOOLEAN,\n        LUA_TNIL,\n        LUA_TTABLE\n    },\n    thread_status: {\n        LUA_ERRRUN,\n        LUA_YIELD\n    },\n    from_userstring,\n    luastring_eq,\n    luastring_indexOf,\n    to_luastring\n} = require('./defs.js');\nconst {\n    api_check,\n    lua_assert\n} = require('./llimits.js');\nconst { LUA_IDSIZE } = require('./luaconf.js');\nconst lapi     = require('./lapi.js');\nconst ldo      = require('./ldo.js');\nconst lfunc    = require('./lfunc.js');\nconst llex     = require('./llex.js');\nconst lobject  = require('./lobject.js');\nconst lopcodes = require('./lopcodes.js');\nconst lstate   = require('./lstate.js');\nconst ltable   = require('./ltable.js');\nconst ltm      = require('./ltm.js');\nconst lvm      = require('./lvm.js');\n\nconst currentpc = function(ci) {\n    lua_assert(ci.callstatus & lstate.CIST_LUA);\n    return ci.l_savedpc - 1;\n};\n\nconst currentline = function(ci) {\n    return ci.func.value.p.lineinfo.length !== 0 ? ci.func.value.p.lineinfo[currentpc(ci)] : -1;\n};\n\n/*\n** If function yielded, its 'func' can be in the 'extra' field. The\n** next function restores 'func' to its correct value for debugging\n** purposes. (It exchanges 'func' and 'extra'; so, when called again,\n** after debugging, it also \"re-restores\" ** 'func' to its altered value.\n*/\nconst swapextra = function(L) {\n    if (L.status === LUA_YIELD) {\n        let ci = L.ci;  /* get function that yielded */\n        let temp = ci.funcOff;  /* exchange its 'func' and 'extra' values */\n        ci.func = L.stack[ci.extra];\n        ci.funcOff = ci.extra;\n        ci.extra = temp;\n    }\n};\n\nconst lua_sethook = function(L, func, mask, count) {\n    if (func === null || mask === 0) {  /* turn off hooks? */\n        mask = 0;\n        func = null;\n    }\n    if (L.ci.callstatus & lstate.CIST_LUA)\n        L.oldpc = L.ci.l_savedpc;\n    L.hook = func;\n    L.basehookcount = count;\n    L.hookcount = L.basehookcount;\n    L.hookmask = mask;\n};\n\nconst lua_gethook = function(L) {\n    return L.hook;\n};\n\n\nconst lua_gethookmask = function(L) {\n    return L.hookmask;\n};\n\n\nconst lua_gethookcount = function(L) {\n    return L.basehookcount;\n};\n\nconst lua_getstack = function(L, level, ar) {\n    let ci;\n    let status;\n    if (level < 0) return 0;  /* invalid (negative) level */\n    for (ci = L.ci; level > 0 && ci !== L.base_ci; ci = ci.previous)\n        level--;\n    if (level === 0 && ci !== L.base_ci) {  /* level found? */\n        status = 1;\n        ar.i_ci = ci;\n    } else\n        status = 0;  /* no such level */\n    return status;\n};\n\nconst upvalname = function(p, uv) {\n    lua_assert(uv < p.upvalues.length);\n    let s = p.upvalues[uv].name;\n    if (s === null) return to_luastring(\"?\", true);\n    return s.getstr();\n};\n\nconst findvararg = function(ci, n) {\n    let nparams = ci.func.value.p.numparams;\n    if (n >= ci.l_base - ci.funcOff - nparams)\n        return null;  /* no such vararg */\n    else {\n        return {\n            pos: ci.funcOff + nparams + n,\n            name: to_luastring(\"(*vararg)\", true)  /* generic name for any vararg */\n        };\n    }\n};\n\nconst findlocal = function(L, ci, n) {\n    let base, name = null;\n\n    if (ci.callstatus & lstate.CIST_LUA) {\n        if (n < 0)  /* access to vararg values? */\n            return findvararg(ci, -n);\n        else {\n            base = ci.l_base;\n            name = lfunc.luaF_getlocalname(ci.func.value.p, n, currentpc(ci));\n        }\n    } else\n        base = ci.funcOff + 1;\n\n    if (name === null) {  /* no 'standard' name? */\n        let limit = ci === L.ci ? L.top : ci.next.funcOff;\n        if (limit - base >= n && n > 0)  /* is 'n' inside 'ci' stack? */\n            name = to_luastring(\"(*temporary)\", true);  /* generic name for any valid slot */\n        else\n            return null;  /* no name */\n    }\n    return {\n        pos: base + (n - 1),\n        name: name\n    };\n};\n\nconst lua_getlocal = function(L, ar, n) {\n    let name;\n    swapextra(L);\n    if (ar === null) {  /* information about non-active function? */\n        if (!L.stack[L.top - 1].ttisLclosure())  /* not a Lua function? */\n            name = null;\n        else  /* consider live variables at function start (parameters) */\n            name = lfunc.luaF_getlocalname(L.stack[L.top - 1].value.p, n, 0);\n    } else {  /* active function; get information through 'ar' */\n        let local = findlocal(L, ar.i_ci, n);\n        if (local) {\n            name = local.name;\n            lobject.pushobj2s(L, L.stack[local.pos]);\n            api_check(L, L.top <= L.ci.top, \"stack overflow\");\n        } else {\n            name = null;\n        }\n    }\n    swapextra(L);\n    return name;\n};\n\nconst lua_setlocal = function(L, ar, n) {\n    let name;\n    swapextra(L);\n    let local = findlocal(L, ar.i_ci, n);\n    if (local) {\n        name = local.name;\n        lobject.setobjs2s(L, local.pos, L.top - 1);\n        delete L.stack[--L.top];  /* pop value */\n    } else {\n        name = null;\n    }\n    swapextra(L);\n    return name;\n};\n\nconst funcinfo = function(ar, cl) {\n    if (cl === null || cl instanceof lobject.CClosure) {\n        ar.source = to_luastring(\"=[JS]\", true);\n        ar.linedefined = -1;\n        ar.lastlinedefined = -1;\n        ar.what = to_luastring(\"J\", true);\n    } else {\n        let p = cl.p;\n        ar.source = p.source ? p.source.getstr() : to_luastring(\"=?\", true);\n        ar.linedefined = p.linedefined;\n        ar.lastlinedefined = p.lastlinedefined;\n        ar.what = ar.linedefined === 0 ? to_luastring(\"main\", true) : to_luastring(\"Lua\", true);\n    }\n\n    ar.short_src = lobject.luaO_chunkid(ar.source, LUA_IDSIZE);\n};\n\nconst collectvalidlines = function(L, f) {\n    if (f === null || f instanceof lobject.CClosure) {\n        L.stack[L.top] = new lobject.TValue(LUA_TNIL, null);\n        lapi.api_incr_top(L);\n    } else {\n        let lineinfo = f.p.lineinfo;\n        let t = ltable.luaH_new(L);\n        L.stack[L.top] = new lobject.TValue(LUA_TTABLE, t);\n        lapi.api_incr_top(L);\n        let v = new lobject.TValue(LUA_TBOOLEAN, true);\n        for (let i = 0; i < lineinfo.length; i++)\n            ltable.luaH_setint(t, lineinfo[i], v);\n    }\n};\n\nconst getfuncname = function(L, ci) {\n    let r = {\n        name: null,\n        funcname: null\n    };\n    if (ci === null)\n        return null;\n    else if (ci.callstatus & lstate.CIST_FIN) {  /* is this a finalizer? */\n        r.name = to_luastring(\"__gc\", true);\n        r.funcname = to_luastring(\"metamethod\", true);  /* report it as such */\n        return r;\n    }\n    /* calling function is a known Lua function? */\n    else if (!(ci.callstatus & lstate.CIST_TAIL) && ci.previous.callstatus & lstate.CIST_LUA)\n        return funcnamefromcode(L, ci.previous);\n    else return null;  /* no way to find a name */\n};\n\nconst auxgetinfo = function(L, what, ar, f, ci) {\n    let status = 1;\n    for (; what.length > 0; what = what.subarray(1)) {\n        switch (what[0]) {\n            case 83 /* ('S').charCodeAt(0) */: {\n                funcinfo(ar, f);\n                break;\n            }\n            case 108 /* ('l').charCodeAt(0) */: {\n                ar.currentline = ci && ci.callstatus & lstate.CIST_LUA ? currentline(ci) : -1;\n                break;\n            }\n            case 117 /* ('u').charCodeAt(0) */: {\n                ar.nups = f === null ? 0 : f.nupvalues;\n                if (f === null || f instanceof lobject.CClosure) {\n                    ar.isvararg = true;\n                    ar.nparams = 0;\n                } else {\n                    ar.isvararg = f.p.is_vararg;\n                    ar.nparams = f.p.numparams;\n                }\n                break;\n            }\n            case 116 /* ('t').charCodeAt(0) */: {\n                ar.istailcall = ci ? ci.callstatus & lstate.CIST_TAIL : 0;\n                break;\n            }\n            case 110 /* ('n').charCodeAt(0) */: {\n                let r = getfuncname(L, ci);\n                if (r === null) {\n                    ar.namewhat = to_luastring(\"\", true);\n                    ar.name = null;\n                } else {\n                    ar.namewhat = r.funcname;\n                    ar.name = r.name;\n                }\n                break;\n            }\n            case 76 /* ('L').charCodeAt(0) */:\n            case 102 /* ('f').charCodeAt(0) */:  /* handled by lua_getinfo */\n                break;\n            default: status = 0;  /* invalid option */\n        }\n    }\n\n    return status;\n};\n\nconst lua_getinfo = function(L, what, ar) {\n    what = from_userstring(what);\n    let status, cl, ci, func;\n    swapextra(L);\n    if (what[0] === 62 /* ('>').charCodeAt(0) */) {\n        ci = null;\n        func = L.stack[L.top - 1];\n        api_check(L, func.ttisfunction(), \"function expected\");\n        what = what.subarray(1);  /* skip the '>' */\n        L.top--;  /* pop function */\n    } else {\n        ci = ar.i_ci;\n        func = ci.func;\n        lua_assert(ci.func.ttisfunction());\n    }\n\n    cl = func.ttisclosure() ? func.value : null;\n    status = auxgetinfo(L, what, ar, cl, ci);\n    if (luastring_indexOf(what, 102 /* ('f').charCodeAt(0) */) >= 0) {\n        lobject.pushobj2s(L, func);\n        api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    }\n\n    swapextra(L);\n    if (luastring_indexOf(what, 76 /* ('L').charCodeAt(0) */) >= 0)\n        collectvalidlines(L, cl);\n\n    return status;\n};\n\nconst kname = function(p, pc, c) {\n    let r = {\n        name: null,\n        funcname: null\n    };\n\n    if (lopcodes.ISK(c)) {  /* is 'c' a constant? */\n        let kvalue = p.k[lopcodes.INDEXK(c)];\n        if (kvalue.ttisstring()) {  /* literal constant? */\n            r.name = kvalue.svalue();  /* it is its own name */\n            return r;\n        }\n        /* else no reasonable name found */\n    } else {  /* 'c' is a register */\n        let what = getobjname(p, pc, c); /* search for 'c' */\n        if (what && what.funcname[0] === 99 /* ('c').charCodeAt(0) */) {  /* found a constant name? */\n            return what;  /* 'name' already filled */\n        }\n        /* else no reasonable name found */\n    }\n    r.name = to_luastring(\"?\", true);\n    return r;  /* no reasonable name found */\n};\n\nconst filterpc = function(pc, jmptarget) {\n    if (pc < jmptarget)  /* is code conditional (inside a jump)? */\n        return -1;  /* cannot know who sets that register */\n    else return pc;  /* current position sets that register */\n};\n\n/*\n** try to find last instruction before 'lastpc' that modified register 'reg'\n*/\nconst findsetreg = function(p, lastpc, reg) {\n    let setreg = -1;  /* keep last instruction that changed 'reg' */\n    let jmptarget = 0;  /* any code before this address is conditional */\n    let OCi = lopcodes.OpCodesI;\n    for (let pc = 0; pc < lastpc; pc++) {\n        let i = p.code[pc];\n        let a = i.A;\n        switch (i.opcode) {\n            case OCi.OP_LOADNIL: {\n                let b = i.B;\n                if (a <= reg && reg <= a + b)  /* set registers from 'a' to 'a+b' */\n                    setreg = filterpc(pc, jmptarget);\n                break;\n            }\n            case OCi.OP_TFORCALL: {\n                if (reg >= a + 2)  /* affect all regs above its base */\n                    setreg = filterpc(pc, jmptarget);\n                break;\n            }\n            case OCi.OP_CALL:\n            case OCi.OP_TAILCALL: {\n                if (reg >= a)  /* affect all registers above base */\n                    setreg = filterpc(pc, jmptarget);\n                break;\n            }\n            case OCi.OP_JMP: {\n                let b = i.sBx;\n                let dest = pc + 1 + b;\n                /* jump is forward and do not skip 'lastpc'? */\n                if (pc < dest && dest <= lastpc) {\n                    if (dest > jmptarget)\n                        jmptarget = dest;  /* update 'jmptarget' */\n                }\n                break;\n            }\n            default:\n                if (lopcodes.testAMode(i.opcode) && reg === a)\n                    setreg = filterpc(pc, jmptarget);\n                break;\n        }\n    }\n\n    return setreg;\n};\n\n\nconst getobjname = function(p, lastpc, reg) {\n    let r = {\n        name: lfunc.luaF_getlocalname(p, reg + 1, lastpc),\n        funcname: null\n    };\n\n    if (r.name) {  /* is a local? */\n        r.funcname = to_luastring(\"local\", true);\n        return r;\n    }\n\n    /* else try symbolic execution */\n    let pc = findsetreg(p, lastpc, reg);\n    let OCi = lopcodes.OpCodesI;\n    if (pc !== -1) {  /* could find instruction? */\n        let i = p.code[pc];\n        switch (i.opcode) {\n            case OCi.OP_MOVE: {\n                let b = i.B;  /* move from 'b' to 'a' */\n                if (b < i.A)\n                    return getobjname(p, pc, b);  /* get name for 'b' */\n                break;\n            }\n            case OCi.OP_GETTABUP:\n            case OCi.OP_GETTABLE: {\n                let k = i.C;  /* key index */\n                let t = i.B;  /* table index */\n                let vn = i.opcode === OCi.OP_GETTABLE ? lfunc.luaF_getlocalname(p, t + 1, pc) : upvalname(p, t);\n                r.name = kname(p, pc, k).name;\n                r.funcname = (vn && luastring_eq(vn, llex.LUA_ENV)) ? to_luastring(\"global\", true) : to_luastring(\"field\", true);\n                return r;\n            }\n            case OCi.OP_GETUPVAL: {\n                r.name = upvalname(p, i.B);\n                r.funcname = to_luastring(\"upvalue\", true);\n                return r;\n            }\n            case OCi.OP_LOADK:\n            case OCi.OP_LOADKX: {\n                let b = i.opcode === OCi.OP_LOADK ? i.Bx : p.code[pc + 1].Ax;\n                if (p.k[b].ttisstring()) {\n                    r.name = p.k[b].svalue();\n                    r.funcname = to_luastring(\"constant\", true);\n                    return r;\n                }\n                break;\n            }\n            case OCi.OP_SELF: {\n                let k = i.C;\n                r.name = kname(p, pc, k).name;\n                r.funcname = to_luastring(\"method\", true);\n                return r;\n            }\n            default: break;\n        }\n    }\n\n    return null;\n};\n\n/*\n** Try to find a name for a function based on the code that called it.\n** (Only works when function was called by a Lua function.)\n** Returns what the name is (e.g., \"for iterator\", \"method\",\n** \"metamethod\") and sets '*name' to point to the name.\n*/\nconst funcnamefromcode = function(L, ci) {\n    let r = {\n        name: null,\n        funcname: null\n    };\n\n    let tm = 0;  /* (initial value avoids warnings) */\n    let p = ci.func.value.p;  /* calling function */\n    let pc = currentpc(ci);  /* calling instruction index */\n    let i = p.code[pc];  /* calling instruction */\n    let OCi = lopcodes.OpCodesI;\n\n    if (ci.callstatus & lstate.CIST_HOOKED) {\n        r.name = to_luastring(\"?\", true);\n        r.funcname = to_luastring(\"hook\", true);\n        return r;\n    }\n\n    switch (i.opcode) {\n        case OCi.OP_CALL:\n        case OCi.OP_TAILCALL:\n            return getobjname(p, pc, i.A);  /* get function name */\n        case OCi.OP_TFORCALL:\n            r.name = to_luastring(\"for iterator\", true);\n            r.funcname = to_luastring(\"for iterator\", true);\n            return r;\n        /* other instructions can do calls through metamethods */\n        case OCi.OP_SELF:\n        case OCi.OP_GETTABUP:\n        case OCi.OP_GETTABLE:\n            tm = ltm.TMS.TM_INDEX;\n            break;\n        case OCi.OP_SETTABUP:\n        case OCi.OP_SETTABLE:\n            tm = ltm.TMS.TM_NEWINDEX;\n            break;\n        case OCi.OP_ADD:    tm = ltm.TMS.TM_ADD;    break;\n        case OCi.OP_SUB:    tm = ltm.TMS.TM_SUB;    break;\n        case OCi.OP_MUL:    tm = ltm.TMS.TM_MUL;    break;\n        case OCi.OP_MOD:    tm = ltm.TMS.TM_MOD;    break;\n        case OCi.OP_POW:    tm = ltm.TMS.TM_POW;    break;\n        case OCi.OP_DIV:    tm = ltm.TMS.TM_DIV;    break;\n        case OCi.OP_IDIV:   tm = ltm.TMS.TM_IDIV;   break;\n        case OCi.OP_BAND:   tm = ltm.TMS.TM_BAND;   break;\n        case OCi.OP_BOR:    tm = ltm.TMS.TM_BOR;    break;\n        case OCi.OP_BXOR:   tm = ltm.TMS.TM_BXOR;   break;\n        case OCi.OP_SHL:    tm = ltm.TMS.TM_SHL;    break;\n        case OCi.OP_SHR:    tm = ltm.TMS.TM_SHR;    break;\n        case OCi.OP_UNM:    tm = ltm.TMS.TM_UNM;    break;\n        case OCi.OP_BNOT:   tm = ltm.TMS.TM_BNOT;   break;\n        case OCi.OP_LEN:    tm = ltm.TMS.TM_LEN;    break;\n        case OCi.OP_CONCAT: tm = ltm.TMS.TM_CONCAT; break;\n        case OCi.OP_EQ:     tm = ltm.TMS.TM_EQ;     break;\n        case OCi.OP_LT:     tm = ltm.TMS.TM_LT;     break;\n        case OCi.OP_LE:     tm = ltm.TMS.TM_LE;     break;\n        default:\n            return null;  /* cannot find a reasonable name */\n    }\n\n    r.name = L.l_G.tmname[tm].getstr();\n    r.funcname = to_luastring(\"metamethod\", true);\n    return r;\n};\n\nconst isinstack = function(L, ci, o) {\n    for (let i = ci.l_base; i < ci.top; i++) {\n        if (L.stack[i] === o)\n            return i;\n    }\n\n    return false;\n};\n\n/*\n** Checks whether value 'o' came from an upvalue. (That can only happen\n** with instructions OP_GETTABUP/OP_SETTABUP, which operate directly on\n** upvalues.)\n*/\nconst getupvalname = function(L, ci, o) {\n    let c = ci.func.value;\n    for (let i = 0; i < c.nupvalues; i++) {\n        if (c.upvals[i] === o) {\n            return {\n                name: upvalname(c.p, i),\n                funcname: to_luastring('upvalue', true)\n            };\n        }\n    }\n\n    return null;\n};\n\nconst varinfo = function(L, o) {\n    let ci = L.ci;\n    let kind = null;\n    if (ci.callstatus & lstate.CIST_LUA) {\n        kind = getupvalname(L, ci, o);  /* check whether 'o' is an upvalue */\n        let stkid = isinstack(L, ci, o);\n        if (!kind && stkid)  /* no? try a register */\n            kind = getobjname(ci.func.value.p, currentpc(ci), stkid - ci.l_base);\n    }\n\n    return kind ? lobject.luaO_pushfstring(L, to_luastring(\" (%s '%s')\", true), kind.funcname, kind.name) : to_luastring(\"\", true);\n};\n\nconst luaG_typeerror = function(L, o, op) {\n    let t = ltm.luaT_objtypename(L, o);\n    luaG_runerror(L, to_luastring(\"attempt to %s a %s value%s\", true), op, t, varinfo(L, o));\n};\n\nconst luaG_concaterror = function(L, p1, p2) {\n    if (p1.ttisstring() || lvm.cvt2str(p1)) p1 = p2;\n    luaG_typeerror(L, p1, to_luastring('concatenate', true));\n};\n\n/*\n** Error when both values are convertible to numbers, but not to integers\n*/\nconst luaG_opinterror = function(L, p1, p2, msg) {\n    if (lvm.tonumber(p1) === false)\n        p2 = p1;\n    luaG_typeerror(L, p2, msg);\n};\n\nconst luaG_ordererror = function(L, p1, p2) {\n    let t1 = ltm.luaT_objtypename(L, p1);\n    let t2 = ltm.luaT_objtypename(L, p2);\n    if (luastring_eq(t1, t2))\n        luaG_runerror(L, to_luastring(\"attempt to compare two %s values\", true), t1);\n    else\n        luaG_runerror(L, to_luastring(\"attempt to compare %s with %s\", true), t1, t2);\n};\n\n/* add src:line information to 'msg' */\nconst luaG_addinfo = function(L, msg, src, line) {\n    let buff;\n    if (src)\n        buff = lobject.luaO_chunkid(src.getstr(), LUA_IDSIZE);\n    else\n        buff = to_luastring(\"?\", true);\n\n    return lobject.luaO_pushfstring(L, to_luastring(\"%s:%d: %s\", true), buff, line, msg);\n};\n\nconst luaG_runerror = function(L, fmt, ...argp) {\n    let ci = L.ci;\n    let msg = lobject.luaO_pushvfstring(L, fmt, argp);\n    if (ci.callstatus & lstate.CIST_LUA)  /* if Lua function, add source:line information */\n        luaG_addinfo(L, msg, ci.func.value.p.source, currentline(ci));\n    luaG_errormsg(L);\n};\n\nconst luaG_errormsg = function(L) {\n    if (L.errfunc !== 0) {  /* is there an error handling function? */\n        let errfunc = L.errfunc;\n        lobject.pushobj2s(L, L.stack[L.top - 1]); /* move argument */\n        lobject.setobjs2s(L, L.top - 2, errfunc); /* push function */\n        ldo.luaD_callnoyield(L, L.top - 2, 1);\n    }\n\n    ldo.luaD_throw(L, LUA_ERRRUN);\n};\n\n/*\n** Error when both values are convertible to numbers, but not to integers\n*/\nconst luaG_tointerror = function(L, p1, p2) {\n    let temp = lvm.tointeger(p1);\n    if (temp === false)\n        p2 = p1;\n    luaG_runerror(L, to_luastring(\"number%s has no integer representation\", true), varinfo(L, p2));\n};\n\nconst luaG_traceexec = function(L) {\n    let ci = L.ci;\n    let mask = L.hookmask;\n    let counthook = (--L.hookcount === 0 && (mask & LUA_MASKCOUNT));\n    if (counthook)\n        L.hookcount = L.basehookcount;  /* reset count */\n    else if (!(mask & LUA_MASKLINE))\n        return;  /* no line hook and count != 0; nothing to be done */\n    if (ci.callstatus & lstate.CIST_HOOKYIELD) {  /* called hook last time? */\n        ci.callstatus &= ~lstate.CIST_HOOKYIELD;  /* erase mark */\n        return;  /* do not call hook again (VM yielded, so it did not move) */\n    }\n    if (counthook)\n        ldo.luaD_hook(L, LUA_HOOKCOUNT, -1);  /* call count hook */\n    if (mask & LUA_MASKLINE) {\n        let p = ci.func.value.p;\n        let npc = ci.l_savedpc - 1; // pcRel(ci.u.l.savedpc, p);\n        let newline = p.lineinfo.length !== 0 ? p.lineinfo[npc] : -1;\n        if (npc === 0 ||  /* call linehook when enter a new function, */\n            ci.l_savedpc <= L.oldpc ||  /* when jump back (loop), or when */\n            newline !== (p.lineinfo.length !== 0 ? p.lineinfo[L.oldpc - 1] : -1))  /* enter a new line */\n            ldo.luaD_hook(L, LUA_HOOKLINE, newline);  /* call line hook */\n    }\n    L.oldpc = ci.l_savedpc;\n    if (L.status === LUA_YIELD) {  /* did hook yield? */\n        if (counthook)\n            L.hookcount = 1;  /* undo decrement to zero */\n        ci.l_savedpc--;  /* undo increment (resume will increment it again) */\n        ci.callstatus |= lstate.CIST_HOOKYIELD;  /* mark that it yielded */\n        ci.funcOff = L.top - 1;  /* protect stack below results */\n        ci.func = L.stack[ci.funcOff];\n        ldo.luaD_throw(L, LUA_YIELD);\n    }\n};\n\nmodule.exports.luaG_addinfo     = luaG_addinfo;\nmodule.exports.luaG_concaterror = luaG_concaterror;\nmodule.exports.luaG_errormsg    = luaG_errormsg;\nmodule.exports.luaG_opinterror  = luaG_opinterror;\nmodule.exports.luaG_ordererror  = luaG_ordererror;\nmodule.exports.luaG_runerror    = luaG_runerror;\nmodule.exports.luaG_tointerror  = luaG_tointerror;\nmodule.exports.luaG_traceexec   = luaG_traceexec;\nmodule.exports.luaG_typeerror   = luaG_typeerror;\nmodule.exports.lua_gethook      = lua_gethook;\nmodule.exports.lua_gethookcount = lua_gethookcount;\nmodule.exports.lua_gethookmask  = lua_gethookmask;\nmodule.exports.lua_getinfo      = lua_getinfo;\nmodule.exports.lua_getlocal     = lua_getlocal;\nmodule.exports.lua_getstack     = lua_getstack;\nmodule.exports.lua_sethook      = lua_sethook;\nmodule.exports.lua_setlocal     = lua_setlocal;\n","\"use strict\";\n\nconst {\n    LUA_HOOKCALL,\n    LUA_HOOKRET,\n    LUA_HOOKTAILCALL,\n    LUA_MASKCALL,\n    LUA_MASKLINE,\n    LUA_MASKRET,\n    LUA_MINSTACK,\n    LUA_MULTRET,\n    LUA_SIGNATURE,\n    constant_types: {\n        LUA_TCCL,\n        LUA_TLCF,\n        LUA_TLCL,\n        LUA_TNIL\n    },\n    thread_status: {\n        LUA_ERRMEM,\n        LUA_ERRERR,\n        LUA_ERRRUN,\n        LUA_ERRSYNTAX,\n        LUA_OK,\n        LUA_YIELD\n    },\n    lua_Debug,\n    luastring_indexOf,\n    to_luastring\n} = require('./defs.js');\nconst lapi     = require('./lapi.js');\nconst ldebug   = require('./ldebug.js');\nconst lfunc    = require('./lfunc.js');\nconst {\n    api_check,\n    lua_assert,\n    LUAI_MAXCCALLS\n} = require('./llimits.js');\nconst lobject  = require('./lobject.js');\nconst lopcodes = require('./lopcodes.js');\nconst lparser  = require('./lparser.js');\nconst lstate   = require('./lstate.js');\nconst { luaS_newliteral } = require('./lstring.js');\nconst ltm      = require('./ltm.js');\nconst { LUAI_MAXSTACK } = require('./luaconf.js');\nconst lundump  = require('./lundump.js');\nconst lvm      = require('./lvm.js');\nconst { MBuffer } = require('./lzio.js');\n\nconst adjust_top = function(L, newtop) {\n    if (L.top < newtop) {\n        while (L.top < newtop)\n            L.stack[L.top++] = new lobject.TValue(LUA_TNIL, null);\n    } else {\n        while (L.top > newtop)\n            delete L.stack[--L.top];\n    }\n};\n\nconst seterrorobj = function(L, errcode, oldtop) {\n    let current_top = L.top;\n\n    /* extend stack so that L.stack[oldtop] is sure to exist */\n    while (L.top < oldtop + 1)\n        L.stack[L.top++] = new lobject.TValue(LUA_TNIL, null);\n\n    switch (errcode) {\n        case LUA_ERRMEM: {\n            lobject.setsvalue2s(L, oldtop, luaS_newliteral(L, \"not enough memory\"));\n            break;\n        }\n        case LUA_ERRERR: {\n            lobject.setsvalue2s(L, oldtop, luaS_newliteral(L, \"error in error handling\"));\n            break;\n        }\n        default: {\n            lobject.setobjs2s(L, oldtop, current_top - 1);\n        }\n    }\n\n    while (L.top > oldtop + 1)\n        delete L.stack[--L.top];\n};\n\nconst ERRORSTACKSIZE = LUAI_MAXSTACK + 200;\n\nconst luaD_reallocstack = function(L, newsize) {\n    lua_assert(newsize <= LUAI_MAXSTACK || newsize == ERRORSTACKSIZE);\n    lua_assert(L.stack_last == L.stack.length - lstate.EXTRA_STACK);\n    L.stack.length = newsize;\n    L.stack_last = newsize - lstate.EXTRA_STACK;\n};\n\nconst luaD_growstack = function(L, n) {\n    let size = L.stack.length;\n    if (size > LUAI_MAXSTACK)\n        luaD_throw(L, LUA_ERRERR);\n    else {\n        let needed = L.top + n + lstate.EXTRA_STACK;\n        let newsize = 2 * size;\n        if (newsize > LUAI_MAXSTACK) newsize = LUAI_MAXSTACK;\n        if (newsize < needed) newsize = needed;\n        if (newsize > LUAI_MAXSTACK) {  /* stack overflow? */\n            luaD_reallocstack(L, ERRORSTACKSIZE);\n            ldebug.luaG_runerror(L, to_luastring(\"stack overflow\", true));\n        }\n        else\n            luaD_reallocstack(L, newsize);\n    }\n};\n\nconst luaD_checkstack = function(L, n) {\n    if (L.stack_last - L.top <= n)\n        luaD_growstack(L, n);\n};\n\nconst stackinuse = function(L) {\n    let lim = L.top;\n    for (let ci = L.ci; ci !== null; ci = ci.previous) {\n        if (lim < ci.top) lim = ci.top;\n    }\n    lua_assert(lim <= L.stack_last);\n    return lim + 1; /* part of stack in use */\n};\n\nconst luaD_shrinkstack = function(L) {\n    let inuse = stackinuse(L);\n    let goodsize = inuse + Math.floor(inuse / 8) + 2*lstate.EXTRA_STACK;\n    if (goodsize > LUAI_MAXSTACK)\n        goodsize = LUAI_MAXSTACK;  /* respect stack limit */\n    if (L.stack.length > LUAI_MAXSTACK)  /* had been handling stack overflow? */\n        lstate.luaE_freeCI(L);  /* free all CIs (list grew because of an error) */\n    /* if thread is currently not handling a stack overflow and its\n     good size is smaller than current size, shrink its stack */\n    if (inuse <= (LUAI_MAXSTACK - lstate.EXTRA_STACK) && goodsize < L.stack.length)\n        luaD_reallocstack(L, goodsize);\n};\n\nconst luaD_inctop = function(L) {\n    luaD_checkstack(L, 1);\n    L.stack[L.top++] = new lobject.TValue(LUA_TNIL, null);\n};\n\n/*\n** Prepares a function call: checks the stack, creates a new CallInfo\n** entry, fills in the relevant information, calls hook if needed.\n** If function is a JS function, does the call, too. (Otherwise, leave\n** the execution ('luaV_execute') to the caller, to allow stackless\n** calls.) Returns true iff function has been executed (JS function).\n*/\nconst luaD_precall = function(L, off, nresults) {\n    let func = L.stack[off];\n\n    switch(func.type) {\n        case LUA_TCCL:\n        case LUA_TLCF: {\n            let f = func.type === LUA_TCCL ? func.value.f : func.value;\n\n            luaD_checkstack(L, LUA_MINSTACK);\n            let ci = lstate.luaE_extendCI(L);\n            ci.funcOff = off;\n            ci.nresults = nresults;\n            ci.func = func;\n            ci.top = L.top + LUA_MINSTACK;\n            lua_assert(ci.top <= L.stack_last);\n            ci.callstatus = 0;\n            if (L.hookmask & LUA_MASKCALL)\n                luaD_hook(L, LUA_HOOKCALL, -1);\n            let n = f(L); /* do the actual call */\n            if (typeof n !== \"number\" || n < 0 || (n|0) !== n)\n                throw Error(\"invalid return value from JS function (expected integer)\");\n            lapi.api_checknelems(L, n);\n\n            luaD_poscall(L, ci, L.top - n, n);\n\n            return true;\n        }\n        case LUA_TLCL: {\n            let base;\n            let p = func.value.p;\n            let n = L.top - off - 1;\n            let fsize = p.maxstacksize;\n            luaD_checkstack(L, fsize);\n            if (p.is_vararg) {\n                base = adjust_varargs(L, p, n);\n            } else {\n                for (; n < p.numparams; n++)\n                    L.stack[L.top++] = new lobject.TValue(LUA_TNIL, null); // complete missing arguments\n                base = off + 1;\n            }\n\n            let ci = lstate.luaE_extendCI(L);\n            ci.funcOff = off;\n            ci.nresults = nresults;\n            ci.func = func;\n            ci.l_base = base;\n            ci.top = base + fsize;\n            adjust_top(L, ci.top);\n            ci.l_code = p.code;\n            ci.l_savedpc = 0;\n            ci.callstatus = lstate.CIST_LUA;\n            if (L.hookmask & LUA_MASKCALL)\n                callhook(L, ci);\n            return false;\n        }\n        default:\n            luaD_checkstack(L, 1);\n            tryfuncTM(L, off, func);\n            return luaD_precall(L, off, nresults);\n    }\n};\n\nconst luaD_poscall = function(L, ci, firstResult, nres) {\n    let wanted = ci.nresults;\n\n    if (L.hookmask & (LUA_MASKRET | LUA_MASKLINE)) {\n        if (L.hookmask & LUA_MASKRET)\n            luaD_hook(L, LUA_HOOKRET, -1);\n        L.oldpc = ci.previous.l_savedpc;  /* 'oldpc' for caller function */\n    }\n\n    let res = ci.funcOff;\n    L.ci = ci.previous;\n    L.ci.next = null;\n    return moveresults(L, firstResult, res, nres, wanted);\n};\n\nconst moveresults = function(L, firstResult, res, nres, wanted) {\n    switch (wanted) {\n        case 0:\n            break;\n        case 1: {\n            if (nres === 0)\n                L.stack[res].setnilvalue();\n            else {\n                lobject.setobjs2s(L, res, firstResult); /* move it to proper place */\n            }\n            break;\n        }\n        case LUA_MULTRET: {\n            for (let i = 0; i < nres; i++)\n                lobject.setobjs2s(L, res + i, firstResult + i);\n            for (let i=L.top; i>=(res + nres); i--)\n                delete L.stack[i];\n            L.top = res + nres;\n            return false;\n        }\n        default: {\n            let i;\n            if (wanted <= nres) {\n                for (i = 0; i < wanted; i++)\n                    lobject.setobjs2s(L, res + i, firstResult + i);\n            } else {\n                for (i = 0; i < nres; i++)\n                    lobject.setobjs2s(L, res + i, firstResult + i);\n                for (; i < wanted; i++) {\n                    if (res+i >= L.top)\n                        L.stack[res + i] = new lobject.TValue(LUA_TNIL, null);\n                    else\n                        L.stack[res + i].setnilvalue();\n                }\n            }\n            break;\n        }\n    }\n    let newtop = res + wanted; /* top points after the last result */\n    for (let i=L.top; i>=newtop; i--)\n        delete L.stack[i];\n    L.top = newtop;\n    return true;\n};\n\n/*\n** Call a hook for the given event. Make sure there is a hook to be\n** called. (Both 'L->hook' and 'L->hookmask', which triggers this\n** function, can be changed asynchronously by signals.)\n*/\nconst luaD_hook = function(L, event, line) {\n    let hook = L.hook;\n    if (hook && L.allowhook) {  /* make sure there is a hook */\n        let ci = L.ci;\n        let top = L.top;\n        let ci_top = ci.top;\n        let ar = new lua_Debug();\n        ar.event = event;\n        ar.currentline = line;\n        ar.i_ci = ci;\n        luaD_checkstack(L, LUA_MINSTACK);  /* ensure minimum stack size */\n        ci.top = L.top + LUA_MINSTACK;\n        lua_assert(ci.top <= L.stack_last);\n        L.allowhook = 0;  /* cannot call hooks inside a hook */\n        ci.callstatus |= lstate.CIST_HOOKED;\n        hook(L, ar);\n        lua_assert(!L.allowhook);\n        L.allowhook = 1;\n        ci.top = ci_top;\n        adjust_top(L, top);\n        ci.callstatus &= ~lstate.CIST_HOOKED;\n    }\n};\n\nconst callhook = function(L, ci) {\n    let hook = LUA_HOOKCALL;\n    ci.l_savedpc++;  /* hooks assume 'pc' is already incremented */\n    if ((ci.previous.callstatus & lstate.CIST_LUA) &&\n      ci.previous.l_code[ci.previous.l_savedpc - 1].opcode == lopcodes.OpCodesI.OP_TAILCALL) {\n        ci.callstatus |= lstate.CIST_TAIL;\n        hook = LUA_HOOKTAILCALL;\n    }\n    luaD_hook(L, hook, -1);\n    ci.l_savedpc--;  /* correct 'pc' */\n};\n\nconst adjust_varargs = function(L, p, actual) {\n    let nfixargs = p.numparams;\n    /* move fixed parameters to final position */\n    let fixed = L.top - actual; /* first fixed argument */\n    let base = L.top; /* final position of first argument */\n\n    let i;\n    for (i = 0; i < nfixargs && i < actual; i++) {\n        lobject.pushobj2s(L, L.stack[fixed + i]);\n        L.stack[fixed + i].setnilvalue();\n    }\n\n    for (; i < nfixargs; i++)\n        L.stack[L.top++] = new lobject.TValue(LUA_TNIL, null);\n\n    return base;\n};\n\nconst tryfuncTM = function(L, off, func) {\n    let tm = ltm.luaT_gettmbyobj(L, func, ltm.TMS.TM_CALL);\n    if (!tm.ttisfunction(tm))\n        ldebug.luaG_typeerror(L, func, to_luastring(\"call\", true));\n    /* Open a hole inside the stack at 'func' */\n    lobject.pushobj2s(L, L.stack[L.top-1]); /* push top of stack again */\n    for (let p = L.top-2; p > off; p--)\n        lobject.setobjs2s(L, p, p-1); /* move other items up one */\n    lobject.setobj2s(L, off, tm); /* tag method is the new function to be called */\n};\n\n/*\n** Check appropriate error for stack overflow (\"regular\" overflow or\n** overflow while handling stack overflow). If 'nCalls' is larger than\n** LUAI_MAXCCALLS (which means it is handling a \"regular\" overflow) but\n** smaller than 9/8 of LUAI_MAXCCALLS, does not report an error (to\n** allow overflow handling to work)\n*/\nconst stackerror = function(L) {\n    if (L.nCcalls === LUAI_MAXCCALLS)\n        ldebug.luaG_runerror(L, to_luastring(\"JS stack overflow\", true));\n    else if (L.nCcalls >= LUAI_MAXCCALLS + (LUAI_MAXCCALLS >> 3))\n        luaD_throw(L, LUA_ERRERR);  /* error while handing stack error */\n};\n\n/*\n** Call a function (JS or Lua). The function to be called is at func.\n** The arguments are on the stack, right after the function.\n** When returns, all the results are on the stack, starting at the original\n** function position.\n*/\nconst luaD_call = function(L, off, nResults) {\n    if (++L.nCcalls >= LUAI_MAXCCALLS)\n        stackerror(L);\n    if (!luaD_precall(L, off, nResults))\n        lvm.luaV_execute(L);\n    L.nCcalls--;\n};\n\nconst luaD_throw = function(L, errcode) {\n    if (L.errorJmp) {  /* thread has an error handler? */\n        L.errorJmp.status = errcode;  /* set status */\n        throw L.errorJmp;\n    } else {  /* thread has no error handler */\n        let g = L.l_G;\n        L.status = errcode;  /* mark it as dead */\n        if (g.mainthread.errorJmp) {  /* main thread has a handler? */\n            g.mainthread.stack[g.mainthread.top++] = L.stack[L.top - 1];  /* copy error obj. */\n            luaD_throw(g.mainthread, errcode);  /* re-throw in main thread */\n        } else {  /* no handler at all; abort */\n            let panic = g.panic;\n            if (panic) {  /* panic function? */\n                seterrorobj(L, errcode, L.top);  /* assume EXTRA_STACK */\n                if (L.ci.top < L.top)\n                    L.ci.top = L.top;  /* pushing msg. can break this invariant */\n                panic(L);  /* call panic function (last chance to jump out) */\n            }\n            throw new Error(`Aborted ${errcode}`);\n        }\n    }\n};\n\nconst luaD_rawrunprotected = function(L, f, ud) {\n    let oldnCcalls = L.nCcalls;\n    let lj = {\n        status: LUA_OK,\n        previous: L.errorJmp /* chain new error handler */\n    };\n    L.errorJmp = lj;\n\n    try {\n        f(L, ud);\n    } catch (e) {\n        if (lj.status === LUA_OK) {\n            /* error was not thrown via luaD_throw, i.e. it is a JS error */\n            /* run user error handler (if it exists) */\n            let atnativeerror = L.l_G.atnativeerror;\n            if (atnativeerror) {\n                try {\n                    lj.status = LUA_OK;\n\n                    lapi.lua_pushcfunction(L, atnativeerror);\n                    lapi.lua_pushlightuserdata(L, e);\n                    luaD_callnoyield(L, L.top - 2, 1);\n\n                    /* Now run the message handler (if it exists) */\n                    /* copy of luaG_errormsg without the throw */\n                    if (L.errfunc !== 0) {  /* is there an error handling function? */\n                        let errfunc = L.errfunc;\n                        lobject.pushobj2s(L, L.stack[L.top - 1]); /* move argument */\n                        lobject.setobjs2s(L, L.top - 2, errfunc); /* push function */\n                        luaD_callnoyield(L, L.top - 2, 1);\n                    }\n\n                    lj.status = LUA_ERRRUN;\n                } catch(e2) {\n                    if (lj.status === LUA_OK) {\n                        /* also failed */\n                        lj.status = -1;\n                    }\n                }\n            } else {\n                lj.status = -1;\n            }\n        }\n    }\n\n    L.errorJmp = lj.previous;\n    L.nCcalls = oldnCcalls;\n\n    return lj.status;\n\n};\n\n/*\n** Completes the execution of an interrupted C function, calling its\n** continuation function.\n*/\nconst finishCcall = function(L, status) {\n    let ci = L.ci;\n\n    /* must have a continuation and must be able to call it */\n    lua_assert(ci.c_k !== null && L.nny === 0);\n    /* error status can only happen in a protected call */\n    lua_assert(ci.callstatus & lstate.CIST_YPCALL || status === LUA_YIELD);\n\n    if (ci.callstatus & lstate.CIST_YPCALL) {  /* was inside a pcall? */\n        ci.callstatus &= ~lstate.CIST_YPCALL;  /* continuation is also inside it */\n        L.errfunc = ci.c_old_errfunc;  /* with the same error function */\n    }\n\n    /* finish 'lua_callk'/'lua_pcall'; CIST_YPCALL and 'errfunc' already\n       handled */\n    if (ci.nresults === LUA_MULTRET && L.ci.top < L.top) L.ci.top = L.top;\n    let c_k = ci.c_k; /* don't want to call as method */\n    let n = c_k(L, status, ci.c_ctx);  /* call continuation function */\n    lapi.api_checknelems(L, n);\n    luaD_poscall(L, ci, L.top - n, n);  /* finish 'luaD_precall' */\n};\n\n/*\n** Executes \"full continuation\" (everything in the stack) of a\n** previously interrupted coroutine until the stack is empty (or another\n** interruption long-jumps out of the loop). If the coroutine is\n** recovering from an error, 'ud' points to the error status, which must\n** be passed to the first continuation function (otherwise the default\n** status is LUA_YIELD).\n*/\nconst unroll = function(L, ud) {\n    if (ud !== null)  /* error status? */\n        finishCcall(L, ud);  /* finish 'lua_pcallk' callee */\n\n    while (L.ci !== L.base_ci) {  /* something in the stack */\n        if (!(L.ci.callstatus & lstate.CIST_LUA))  /* C function? */\n            finishCcall(L, LUA_YIELD);  /* complete its execution */\n        else {  /* Lua function */\n            lvm.luaV_finishOp(L);  /* finish interrupted instruction */\n            lvm.luaV_execute(L);  /* execute down to higher C 'boundary' */\n        }\n    }\n};\n\n/*\n** Try to find a suspended protected call (a \"recover point\") for the\n** given thread.\n*/\nconst findpcall = function(L) {\n    for (let ci = L.ci; ci !== null; ci = ci.previous) {  /* search for a pcall */\n        if (ci.callstatus & lstate.CIST_YPCALL)\n            return ci;\n    }\n\n    return null;  /* no pending pcall */\n};\n\n/*\n** Recovers from an error in a coroutine. Finds a recover point (if\n** there is one) and completes the execution of the interrupted\n** 'luaD_pcall'. If there is no recover point, returns zero.\n*/\nconst recover = function(L, status) {\n    let ci = findpcall(L);\n    if (ci === null) return 0;  /* no recovery point */\n    /* \"finish\" luaD_pcall */\n    let oldtop = ci.extra;\n    lfunc.luaF_close(L, oldtop);\n    seterrorobj(L, status, oldtop);\n    L.ci = ci;\n    L.allowhook = ci.callstatus & lstate.CIST_OAH;  /* restore original 'allowhook' */\n    L.nny = 0;  /* should be zero to be yieldable */\n    luaD_shrinkstack(L);\n    L.errfunc = ci.c_old_errfunc;\n    return 1;  /* continue running the coroutine */\n};\n\n/*\n** Signal an error in the call to 'lua_resume', not in the execution\n** of the coroutine itself. (Such errors should not be handled by any\n** coroutine error handler and should not kill the coroutine.)\n*/\nconst resume_error = function(L, msg, narg) {\n    let ts = luaS_newliteral(L, msg);\n    if (narg === 0) {\n        lobject.pushsvalue2s(L, ts);\n        api_check(L, L.top <= L.ci.top, \"stack overflow\");\n    } else {\n        /* remove args from the stack */\n        for (let i=1; i<narg; i++)\n            delete L.stack[--L.top];\n        lobject.setsvalue2s(L, L.top-1, ts);  /* push error message */\n    }\n    return LUA_ERRRUN;\n};\n\n/*\n** Do the work for 'lua_resume' in protected mode. Most of the work\n** depends on the status of the coroutine: initial state, suspended\n** inside a hook, or regularly suspended (optionally with a continuation\n** function), plus erroneous cases: non-suspended coroutine or dead\n** coroutine.\n*/\nconst resume = function(L, n) {\n    let firstArg = L.top - n;  /* first argument */\n    let ci = L.ci;\n    if (L.status === LUA_OK) {  /* starting a coroutine? */\n        if (!luaD_precall(L, firstArg - 1, LUA_MULTRET))  /* Lua function? */\n            lvm.luaV_execute(L);  /* call it */\n    } else {  /* resuming from previous yield */\n        lua_assert(L.status === LUA_YIELD);\n        L.status = LUA_OK;  /* mark that it is running (again) */\n        ci.funcOff = ci.extra;\n        ci.func = L.stack[ci.funcOff];\n\n        if (ci.callstatus & lstate.CIST_LUA)  /* yielded inside a hook? */\n            lvm.luaV_execute(L);  /* just continue running Lua code */\n        else {  /* 'common' yield */\n            if (ci.c_k !== null) {  /* does it have a continuation function? */\n                n = ci.c_k(L, LUA_YIELD, ci.c_ctx); /* call continuation */\n                lapi.api_checknelems(L, n);\n                firstArg = L.top - n;  /* yield results come from continuation */\n            }\n\n            luaD_poscall(L, ci, firstArg, n);  /* finish 'luaD_precall' */\n        }\n\n        unroll(L, null);  /* run continuation */\n    }\n};\n\nconst lua_resume = function(L, from, nargs) {\n    let oldnny = L.nny;  /* save \"number of non-yieldable\" calls */\n\n    if (L.status === LUA_OK) {  /* may be starting a coroutine */\n        if (L.ci !== L.base_ci)  /* not in base level? */\n            return resume_error(L, \"cannot resume non-suspended coroutine\", nargs);\n    } else if (L.status !== LUA_YIELD)\n        return resume_error(L, \"cannot resume dead coroutine\", nargs);\n\n    L.nCcalls = from ? from.nCcalls + 1 : 1;\n    if (L.nCcalls >= LUAI_MAXCCALLS)\n        return resume_error(L, \"JS stack overflow\", nargs);\n\n    L.nny = 0;  /* allow yields */\n\n    lapi.api_checknelems(L, L.status === LUA_OK ? nargs + 1: nargs);\n\n    let status = luaD_rawrunprotected(L, resume, nargs);\n    if (status === -1)  /* error calling 'lua_resume'? */\n        status = LUA_ERRRUN;\n    else {  /* continue running after recoverable errors */\n        while (status > LUA_YIELD && recover(L, status)) {\n            /* unroll continuation */\n            status = luaD_rawrunprotected(L, unroll, status);\n        }\n\n        if (status > LUA_YIELD) {  /* unrecoverable error? */\n            L.status = status;  /* mark thread as 'dead' */\n            seterrorobj(L, status, L.top);  /* push error message */\n            L.ci.top = L.top;\n        } else\n            lua_assert(status === L.status);  /* normal end or yield */\n    }\n\n    L.nny = oldnny;  /* restore 'nny' */\n    L.nCcalls--;\n    lua_assert(L.nCcalls === (from ? from.nCcalls : 0));\n    return status;\n};\n\nconst lua_isyieldable = function(L) {\n    return L.nny === 0;\n};\n\nconst lua_yieldk = function(L, nresults, ctx, k) {\n    let ci = L.ci;\n    lapi.api_checknelems(L, nresults);\n\n    if (L.nny > 0) {\n        if (L !== L.l_G.mainthread)\n            ldebug.luaG_runerror(L, to_luastring(\"attempt to yield across a JS-call boundary\", true));\n        else\n            ldebug.luaG_runerror(L, to_luastring(\"attempt to yield from outside a coroutine\", true));\n    }\n\n    L.status = LUA_YIELD;\n    ci.extra = ci.funcOff;  /* save current 'func' */\n    if (ci.callstatus & lstate.CIST_LUA)  /* inside a hook? */\n        api_check(L, k === null, \"hooks cannot continue after yielding\");\n    else {\n        ci.c_k = k;\n        if (k !== null)  /* is there a continuation? */\n            ci.c_ctx = ctx;  /* save context */\n        ci.funcOff = L.top - nresults - 1;  /* protect stack below results */\n        ci.func = L.stack[ci.funcOff];\n        luaD_throw(L, LUA_YIELD);\n    }\n\n    lua_assert(ci.callstatus & lstate.CIST_HOOKED);  /* must be inside a hook */\n    return 0;  /* return to 'luaD_hook' */\n};\n\nconst lua_yield = function(L, n) {\n    lua_yieldk(L, n, 0, null);\n};\n\nconst luaD_pcall = function(L, func, u, old_top, ef) {\n    let old_ci = L.ci;\n    let old_allowhooks = L.allowhook;\n    let old_nny = L.nny;\n    let old_errfunc = L.errfunc;\n    L.errfunc = ef;\n\n    let status = luaD_rawrunprotected(L, func, u);\n\n    if (status !== LUA_OK) {\n        lfunc.luaF_close(L, old_top);\n        seterrorobj(L, status, old_top);\n        L.ci = old_ci;\n        L.allowhook = old_allowhooks;\n        L.nny = old_nny;\n        luaD_shrinkstack(L);\n    }\n\n    L.errfunc = old_errfunc;\n\n    return status;\n};\n\n/*\n** Similar to 'luaD_call', but does not allow yields during the call\n*/\nconst luaD_callnoyield = function(L, off, nResults) {\n    L.nny++;\n    luaD_call(L, off, nResults);\n    L.nny--;\n};\n\n/*\n** Execute a protected parser.\n*/\nclass SParser {\n    constructor(z, name, mode) {  /* data to 'f_parser' */\n        this.z = z;\n        this.buff = new MBuffer();  /* dynamic structure used by the scanner */\n        this.dyd = new lparser.Dyndata();  /* dynamic structures used by the parser */\n        this.mode = mode;\n        this.name = name;\n    }\n}\n\nconst checkmode = function(L, mode, x) {\n    if (mode && luastring_indexOf(mode, x[0]) === -1) {\n        lobject.luaO_pushfstring(L,\n            to_luastring(\"attempt to load a %s chunk (mode is '%s')\"), x, mode);\n        luaD_throw(L, LUA_ERRSYNTAX);\n    }\n};\n\nconst f_parser = function(L, p) {\n    let cl;\n    let c = p.z.zgetc();  /* read first character */\n    if (c === LUA_SIGNATURE[0]) {\n        checkmode(L, p.mode, to_luastring(\"binary\", true));\n        cl = lundump.luaU_undump(L, p.z, p.name);\n    } else {\n        checkmode(L, p.mode, to_luastring(\"text\", true));\n        cl = lparser.luaY_parser(L, p.z, p.buff, p.dyd, p.name, c);\n    }\n\n    lua_assert(cl.nupvalues === cl.p.upvalues.length);\n    lfunc.luaF_initupvals(L, cl);\n};\n\nconst luaD_protectedparser = function(L, z, name, mode) {\n    let p = new SParser(z, name, mode);\n    L.nny++;  /* cannot yield during parsing */\n    let status = luaD_pcall(L, f_parser, p, L.top, L.errfunc);\n    L.nny--;\n    return status;\n};\n\nmodule.exports.adjust_top           = adjust_top;\nmodule.exports.luaD_call            = luaD_call;\nmodule.exports.luaD_callnoyield     = luaD_callnoyield;\nmodule.exports.luaD_checkstack      = luaD_checkstack;\nmodule.exports.luaD_growstack       = luaD_growstack;\nmodule.exports.luaD_hook            = luaD_hook;\nmodule.exports.luaD_inctop          = luaD_inctop;\nmodule.exports.luaD_pcall           = luaD_pcall;\nmodule.exports.luaD_poscall         = luaD_poscall;\nmodule.exports.luaD_precall         = luaD_precall;\nmodule.exports.luaD_protectedparser = luaD_protectedparser;\nmodule.exports.luaD_rawrunprotected = luaD_rawrunprotected;\nmodule.exports.luaD_reallocstack    = luaD_reallocstack;\nmodule.exports.luaD_throw           = luaD_throw;\nmodule.exports.lua_isyieldable      = lua_isyieldable;\nmodule.exports.lua_resume           = lua_resume;\nmodule.exports.lua_yield            = lua_yield;\nmodule.exports.lua_yieldk           = lua_yieldk;\n","\"use strict\";\n\nconst {\n    LUA_SIGNATURE,\n    LUA_VERSION_MAJOR,\n    LUA_VERSION_MINOR,\n    constant_types: {\n        LUA_TBOOLEAN,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TSHRSTR\n    },\n    luastring_of\n} = require('./defs.js');\n\nconst LUAC_DATA    = luastring_of(25, 147, 13, 10, 26, 10);\nconst LUAC_INT     = 0x5678;\nconst LUAC_NUM     = 370.5;\nconst LUAC_VERSION = Number(LUA_VERSION_MAJOR) * 16 + Number(LUA_VERSION_MINOR);\nconst LUAC_FORMAT  = 0;   /* this is the official format */\n\nclass DumpState {\n    constructor() {\n        this.L = null;\n        this.write = null;\n        this.data = null;\n        this.strip = NaN;\n        this.status = NaN;\n    }\n}\n\nconst DumpBlock = function(b, size, D) {\n    if (D.status === 0 && size > 0)\n        D.status = D.writer(D.L, b, size, D.data);\n};\n\nconst DumpByte = function(y, D) {\n    DumpBlock(luastring_of(y), 1, D);\n};\n\nconst DumpInt = function(x, D) {\n    let ab = new ArrayBuffer(4);\n    let dv = new DataView(ab);\n    dv.setInt32(0, x, true);\n    let t = new Uint8Array(ab);\n    DumpBlock(t, 4, D);\n};\n\nconst DumpInteger = function(x, D) {\n    let ab = new ArrayBuffer(4);\n    let dv = new DataView(ab);\n    dv.setInt32(0, x, true);\n    let t = new Uint8Array(ab);\n    DumpBlock(t, 4, D);\n};\n\nconst DumpNumber = function(x, D) {\n    let ab = new ArrayBuffer(8);\n    let dv = new DataView(ab);\n    dv.setFloat64(0, x, true);\n    let t = new Uint8Array(ab);\n    DumpBlock(t, 8, D);\n};\n\nconst DumpString = function(s, D) {\n    if (s === null)\n        DumpByte(0, D);\n    else {\n        let size = s.tsslen() + 1;\n        let str = s.getstr();\n        if (size < 0xFF)\n            DumpByte(size, D);\n        else {\n            DumpByte(0xFF, D);\n            DumpInteger(size, D);\n        }\n        DumpBlock(str, size - 1, D);  /* no need to save '\\0' */\n    }\n};\n\nconst DumpCode = function(f, D) {\n    let s = f.code.map(e => e.code);\n    DumpInt(s.length, D);\n\n    for (let i = 0; i < s.length; i++)\n        DumpInt(s[i], D);\n};\n\nconst DumpConstants = function(f, D) {\n    let n = f.k.length;\n    DumpInt(n, D);\n    for (let i = 0; i < n; i++) {\n        let o = f.k[i];\n        DumpByte(o.ttype(), D);\n        switch (o.ttype()) {\n            case LUA_TNIL:\n                break;\n            case LUA_TBOOLEAN:\n                DumpByte(o.value ? 1 : 0, D);\n                break;\n            case LUA_TNUMFLT:\n                DumpNumber(o.value, D);\n                break;\n            case LUA_TNUMINT:\n                DumpInteger(o.value, D);\n                break;\n            case LUA_TSHRSTR:\n            case LUA_TLNGSTR:\n                DumpString(o.tsvalue(), D);\n                break;\n        }\n    }\n};\n\nconst DumpProtos = function(f, D) {\n    let n = f.p.length;\n    DumpInt(n, D);\n    for (let i = 0; i < n; i++)\n        DumpFunction(f.p[i], f.source, D);\n};\n\nconst DumpUpvalues = function(f, D) {\n    let n = f.upvalues.length;\n    DumpInt(n, D);\n    for (let i = 0; i < n; i++) {\n        DumpByte(f.upvalues[i].instack ? 1 : 0, D);\n        DumpByte(f.upvalues[i].idx, D);\n    }\n};\n\nconst DumpDebug = function(f, D) {\n    let n = D.strip ? 0 : f.lineinfo.length;\n    DumpInt(n, D);\n    for (let i = 0; i < n; i++)\n        DumpInt(f.lineinfo[i], D);\n    n = D.strip ? 0 : f.locvars.length;\n    DumpInt(n, D);\n    for (let i = 0; i < n; i++) {\n        DumpString(f.locvars[i].varname, D);\n        DumpInt(f.locvars[i].startpc, D);\n        DumpInt(f.locvars[i].endpc, D);\n    }\n    n = D.strip ? 0 : f.upvalues.length;\n    DumpInt(n, D);\n    for (let i = 0; i < n; i++)\n        DumpString(f.upvalues[i].name, D);\n};\n\nconst DumpFunction = function(f, psource, D) {\n    if (D.strip || f.source === psource)\n        DumpString(null, D);  /* no debug info or same source as its parent */\n    else\n        DumpString(f.source, D);\n    DumpInt(f.linedefined, D);\n    DumpInt(f.lastlinedefined, D);\n    DumpByte(f.numparams, D);\n    DumpByte(f.is_vararg?1:0, D);\n    DumpByte(f.maxstacksize, D);\n    DumpCode(f, D);\n    DumpConstants(f, D);\n    DumpUpvalues(f, D);\n    DumpProtos(f, D);\n    DumpDebug(f, D);\n};\n\nconst DumpHeader = function(D) {\n    DumpBlock(LUA_SIGNATURE, LUA_SIGNATURE.length, D);\n    DumpByte(LUAC_VERSION, D);\n    DumpByte(LUAC_FORMAT, D);\n    DumpBlock(LUAC_DATA, LUAC_DATA.length, D);\n    DumpByte(4, D); // intSize\n    DumpByte(4, D); // size_tSize\n    DumpByte(4, D); // instructionSize\n    DumpByte(4, D); // integerSize\n    DumpByte(8, D); // numberSize\n    DumpInteger(LUAC_INT, D);\n    DumpNumber(LUAC_NUM, D);\n};\n\n/*\n** dump Lua function as precompiled chunk\n*/\nconst luaU_dump = function(L, f, w, data, strip) {\n    let D = new DumpState();\n    D.L = L;\n    D.writer = w;\n    D.data = data;\n    D.strip = strip;\n    D.status = 0;\n    DumpHeader(D);\n    DumpByte(f.upvalues.length, D);\n    DumpFunction(f, null, D);\n    return D.status;\n};\n\nmodule.exports.luaU_dump = luaU_dump;\n","\"use strict\";\n\nconst { constant_types: { LUA_TNIL } } = require('./defs.js');\nconst lobject = require('./lobject.js');\n\nclass Proto {\n    constructor(L) {\n        this.id = L.l_G.id_counter++;\n        this.k = [];              // constants used by the function\n        this.p = [];              // functions defined inside the function\n        this.code = [];           // opcodes\n        this.cache = null;        // last-created closure with this prototype\n        this.lineinfo = [];       // map from opcodes to source lines (debug information)\n        this.upvalues = [];       // upvalue information\n        this.numparams = 0;       // number of fixed parameters\n        this.is_vararg = false;\n        this.maxstacksize = 0;    // number of registers needed by this function\n        this.locvars = [];        // information about local variables (debug information)\n        this.linedefined = 0;     // debug information\n        this.lastlinedefined = 0; // debug information\n        this.source = null;       // used for debug information\n    }\n}\n\nconst luaF_newLclosure = function(L, n) {\n    return new lobject.LClosure(L, n);\n};\n\n\nconst luaF_findupval = function(L, level) {\n    return L.stack[level];\n};\n\nconst luaF_close = function(L, level) {\n    /* Create new TValues on stack;\n     * any closures will keep referencing old TValues */\n    for (let i=level; i<L.top; i++) {\n        let old = L.stack[i];\n        L.stack[i] = new lobject.TValue(old.type, old.value);\n    }\n};\n\n/*\n** fill a closure with new upvalues\n*/\nconst luaF_initupvals = function(L, cl) {\n    for (let i = 0; i < cl.nupvalues; i++)\n        cl.upvals[i] = new lobject.TValue(LUA_TNIL, null);\n};\n\n/*\n** Look for n-th local variable at line 'line' in function 'func'.\n** Returns null if not found.\n*/\nconst luaF_getlocalname = function(f, local_number, pc) {\n    for (let i = 0; i < f.locvars.length && f.locvars[i].startpc <= pc; i++) {\n        if (pc < f.locvars[i].endpc) {  /* is variable active? */\n            local_number--;\n            if (local_number === 0)\n                return f.locvars[i].varname.getstr();\n        }\n    }\n    return null;  /* not found */\n};\n\nmodule.exports.MAXUPVAL          = 255;\nmodule.exports.Proto             = Proto;\nmodule.exports.luaF_findupval    = luaF_findupval;\nmodule.exports.luaF_close        = luaF_close;\nmodule.exports.luaF_getlocalname = luaF_getlocalname;\nmodule.exports.luaF_initupvals   = luaF_initupvals;\nmodule.exports.luaF_newLclosure  = luaF_newLclosure;\n","\"use strict\";\n\nconst { luastring_of } = require('./defs.js');\n\nconst luai_ctype_ = luastring_of(\n    0x00,  /* EOZ */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* 0. */\n    0x00,  0x08,  0x08,  0x08,  0x08,  0x08,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* 1. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x0c,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,        /* 2. */\n    0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,\n    0x16,  0x16,  0x16,  0x16,  0x16,  0x16,  0x16,  0x16,        /* 3. */\n    0x16,  0x16,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,\n    0x04,  0x15,  0x15,  0x15,  0x15,  0x15,  0x15,  0x05,        /* 4. */\n    0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,\n    0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,        /* 5. */\n    0x05,  0x05,  0x05,  0x04,  0x04,  0x04,  0x04,  0x05,\n    0x04,  0x15,  0x15,  0x15,  0x15,  0x15,  0x15,  0x05,        /* 6. */\n    0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,\n    0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,        /* 7. */\n    0x05,  0x05,  0x05,  0x04,  0x04,  0x04,  0x04,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* 8. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* 9. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* a. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* b. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* c. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* d. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* e. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,        /* f. */\n    0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00\n);\n\nconst ALPHABIT = 0;\nconst DIGITBIT = 1;\nconst PRINTBIT = 2;\nconst SPACEBIT = 3;\nconst XDIGITBIT = 4;\n\nconst lisdigit = function(c) {\n    return (luai_ctype_[c+1] & (1<<DIGITBIT)) !== 0;\n};\n\nconst lisxdigit = function(c) {\n    return (luai_ctype_[c+1] & (1<<XDIGITBIT)) !== 0;\n};\n\nconst lisprint = function(c) {\n    return (luai_ctype_[c+1] & (1<<PRINTBIT)) !== 0;\n};\n\nconst lisspace = function(c) {\n    return (luai_ctype_[c+1] & (1<<SPACEBIT)) !== 0;\n};\n\nconst lislalpha = function(c) {\n    return (luai_ctype_[c+1] & (1<<ALPHABIT)) !== 0;\n};\n\nconst lislalnum = function(c) {\n    return (luai_ctype_[c+1] & ((1<<ALPHABIT)|(1<<DIGITBIT))) !== 0;\n};\n\nmodule.exports.lisdigit   = lisdigit;\nmodule.exports.lislalnum  = lislalnum;\nmodule.exports.lislalpha  = lislalpha;\nmodule.exports.lisprint   = lisprint;\nmodule.exports.lisspace   = lisspace;\nmodule.exports.lisxdigit  = lisxdigit;\n","\"use strict\";\n\nconst {\n    constant_types: { LUA_TBOOLEAN, LUA_TLNGSTR },\n    thread_status: { LUA_ERRSYNTAX },\n    to_luastring\n} = require('./defs.js');\nconst {\n    LUA_MINBUFFER,\n    MAX_INT,\n    lua_assert\n} = require('./llimits.js');\nconst ldebug   = require('./ldebug.js');\nconst ldo      = require('./ldo.js');\nconst {\n    lisdigit,\n    lislalnum,\n    lislalpha,\n    lisspace,\n    lisxdigit\n} = require('./ljstype.js');\nconst lobject  = require('./lobject.js');\nconst {\n    luaS_bless,\n    luaS_hash,\n    luaS_hashlongstr,\n    luaS_new\n} = require('./lstring.js');\nconst ltable   = require('./ltable.js');\nconst {\n    EOZ,\n    luaZ_buffer,\n    luaZ_buffremove,\n    luaZ_resetbuffer,\n    luaZ_resizebuffer\n} = require('./lzio.js');\n\nconst FIRST_RESERVED = 257;\n\nconst LUA_ENV = to_luastring(\"_ENV\", true);\n\n/* terminal symbols denoted by reserved words */\nconst TK_AND      = FIRST_RESERVED;\nconst TK_BREAK    = FIRST_RESERVED + 1;\nconst TK_DO       = FIRST_RESERVED + 2;\nconst TK_ELSE     = FIRST_RESERVED + 3;\nconst TK_ELSEIF   = FIRST_RESERVED + 4;\nconst TK_END      = FIRST_RESERVED + 5;\nconst TK_FALSE    = FIRST_RESERVED + 6;\nconst TK_FOR      = FIRST_RESERVED + 7;\nconst TK_FUNCTION = FIRST_RESERVED + 8;\nconst TK_GOTO     = FIRST_RESERVED + 9;\nconst TK_IF       = FIRST_RESERVED + 10;\nconst TK_IN       = FIRST_RESERVED + 11;\nconst TK_LOCAL    = FIRST_RESERVED + 12;\nconst TK_NIL      = FIRST_RESERVED + 13;\nconst TK_NOT      = FIRST_RESERVED + 14;\nconst TK_OR       = FIRST_RESERVED + 15;\nconst TK_REPEAT   = FIRST_RESERVED + 16;\nconst TK_RETURN   = FIRST_RESERVED + 17;\nconst TK_THEN     = FIRST_RESERVED + 18;\nconst TK_TRUE     = FIRST_RESERVED + 19;\nconst TK_UNTIL    = FIRST_RESERVED + 20;\nconst TK_WHILE    = FIRST_RESERVED + 21;\n/* other terminal symbols */\nconst TK_IDIV     = FIRST_RESERVED + 22;\nconst TK_CONCAT   = FIRST_RESERVED + 23;\nconst TK_DOTS     = FIRST_RESERVED + 24;\nconst TK_EQ       = FIRST_RESERVED + 25;\nconst TK_GE       = FIRST_RESERVED + 26;\nconst TK_LE       = FIRST_RESERVED + 27;\nconst TK_NE       = FIRST_RESERVED + 28;\nconst TK_SHL      = FIRST_RESERVED + 29;\nconst TK_SHR      = FIRST_RESERVED + 30;\nconst TK_DBCOLON  = FIRST_RESERVED + 31;\nconst TK_EOS      = FIRST_RESERVED + 32;\nconst TK_FLT      = FIRST_RESERVED + 33;\nconst TK_INT      = FIRST_RESERVED + 34;\nconst TK_NAME     = FIRST_RESERVED + 35;\nconst TK_STRING   = FIRST_RESERVED + 36;\n\nconst RESERVED = {\n    \"TK_AND\":      TK_AND,\n    \"TK_BREAK\":    TK_BREAK,\n    \"TK_DO\":       TK_DO,\n    \"TK_ELSE\":     TK_ELSE,\n    \"TK_ELSEIF\":   TK_ELSEIF,\n    \"TK_END\":      TK_END,\n    \"TK_FALSE\":    TK_FALSE,\n    \"TK_FOR\":      TK_FOR,\n    \"TK_FUNCTION\": TK_FUNCTION,\n    \"TK_GOTO\":     TK_GOTO,\n    \"TK_IF\":       TK_IF,\n    \"TK_IN\":       TK_IN,\n    \"TK_LOCAL\":    TK_LOCAL,\n    \"TK_NIL\":      TK_NIL,\n    \"TK_NOT\":      TK_NOT,\n    \"TK_OR\":       TK_OR,\n    \"TK_REPEAT\":   TK_REPEAT,\n    \"TK_RETURN\":   TK_RETURN,\n    \"TK_THEN\":     TK_THEN,\n    \"TK_TRUE\":     TK_TRUE,\n    \"TK_UNTIL\":    TK_UNTIL,\n    \"TK_WHILE\":    TK_WHILE,\n    \"TK_IDIV\":     TK_IDIV,\n    \"TK_CONCAT\":   TK_CONCAT,\n    \"TK_DOTS\":     TK_DOTS,\n    \"TK_EQ\":       TK_EQ,\n    \"TK_GE\":       TK_GE,\n    \"TK_LE\":       TK_LE,\n    \"TK_NE\":       TK_NE,\n    \"TK_SHL\":      TK_SHL,\n    \"TK_SHR\":      TK_SHR,\n    \"TK_DBCOLON\":  TK_DBCOLON,\n    \"TK_EOS\":      TK_EOS,\n    \"TK_FLT\":      TK_FLT,\n    \"TK_INT\":      TK_INT,\n    \"TK_NAME\":     TK_NAME,\n    \"TK_STRING\":   TK_STRING\n};\n\nconst luaX_tokens = [\n    \"and\", \"break\", \"do\", \"else\", \"elseif\",\n    \"end\", \"false\", \"for\", \"function\", \"goto\", \"if\",\n    \"in\", \"local\", \"nil\", \"not\", \"or\", \"repeat\",\n    \"return\", \"then\", \"true\", \"until\", \"while\",\n    \"//\", \"..\", \"...\", \"==\", \">=\", \"<=\", \"~=\",\n    \"<<\", \">>\", \"::\", \"<eof>\",\n    \"<number>\", \"<integer>\", \"<name>\", \"<string>\"\n].map((e, i)=>to_luastring(e));\n\nclass SemInfo {\n    constructor() {\n        this.r = NaN;\n        this.i = NaN;\n        this.ts = null;\n    }\n}\n\nclass Token {\n    constructor() {\n        this.token = NaN;\n        this.seminfo = new SemInfo();\n    }\n}\n\n/* state of the lexer plus state of the parser when shared by all\n   functions */\nclass LexState {\n    constructor() {\n        this.current = NaN;  /* current character (charint) */\n        this.linenumber = NaN;  /* input line counter */\n        this.lastline = NaN;  /* line of last token 'consumed' */\n        this.t = new Token();  /* current token */\n        this.lookahead = new Token();  /* look ahead token */\n        this.fs = null;  /* current function (parser) */\n        this.L = null;\n        this.z = null; /* input stream */\n        this.buff = null;  /* buffer for tokens */\n        this.h = null;  /* to reuse strings */\n        this.dyd = null;  /* dynamic structures used by the parser */\n        this.source = null;  /* current source name */\n        this.envn = null;  /* environment variable name */\n    }\n}\n\nconst save = function(ls, c) {\n    let b = ls.buff;\n    if (b.n + 1 > b.buffer.length) {\n        if (b.buffer.length >= MAX_INT/2)\n            lexerror(ls, to_luastring(\"lexical element too long\", true), 0);\n        let newsize = b.buffer.length*2;\n        luaZ_resizebuffer(ls.L, b, newsize);\n    }\n    b.buffer[b.n++] = c < 0 ? 255 + c + 1 : c;\n};\n\nconst luaX_token2str = function(ls, token) {\n    if (token < FIRST_RESERVED) {  /* single-byte symbols? */\n        return lobject.luaO_pushfstring(ls.L, to_luastring(\"'%c'\", true), token);\n    } else {\n        let s = luaX_tokens[token - FIRST_RESERVED];\n        if (token < TK_EOS)  /* fixed format (symbols and reserved words)? */\n            return lobject.luaO_pushfstring(ls.L, to_luastring(\"'%s'\", true), s);\n        else  /* names, strings, and numerals */\n            return s;\n    }\n};\n\nconst currIsNewline = function(ls) {\n    return ls.current === 10 /* ('\\n').charCodeAt(0) */ || ls.current === 13 /* ('\\r').charCodeAt(0) */;\n};\n\nconst next = function(ls) {\n    ls.current = ls.z.zgetc();\n};\n\nconst save_and_next = function(ls) {\n    save(ls, ls.current);\n    next(ls);\n};\n\n/*\n** creates a new string and anchors it in scanner's table so that\n** it will not be collected until the end of the compilation\n** (by that time it should be anchored somewhere)\n*/\nconst TVtrue = new lobject.TValue(LUA_TBOOLEAN, true);\nconst luaX_newstring = function(ls, str) {\n    let L = ls.L;\n    let ts = luaS_new(L, str);\n    /* HACK: Workaround lack of ltable 'keyfromval' */\n    let tpair = ls.h.strong.get(luaS_hashlongstr(ts));\n    if (!tpair) { /* not in use yet? */\n        let key = new lobject.TValue(LUA_TLNGSTR, ts);\n        ltable.luaH_setfrom(L, ls.h, key, TVtrue);\n    } else { /* string already present */\n        ts = tpair.key.tsvalue(); /* re-use value previously stored */\n    }\n    return ts;\n};\n\n/*\n** increment line number and skips newline sequence (any of\n** \\n, \\r, \\n\\r, or \\r\\n)\n*/\nconst inclinenumber = function(ls) {\n    let old = ls.current;\n    lua_assert(currIsNewline(ls));\n    next(ls);  /* skip '\\n' or '\\r' */\n    if (currIsNewline(ls) && ls.current !== old)\n        next(ls);  /* skip '\\n\\r' or '\\r\\n' */\n    if (++ls.linenumber >= MAX_INT)\n        lexerror(ls, to_luastring(\"chunk has too many lines\", true), 0);\n};\n\nconst luaX_setinput = function(L, ls, z, source, firstchar) {\n    ls.t = {\n        token: 0,\n        seminfo: new SemInfo()\n    };\n    ls.L = L;\n    ls.current = firstchar;\n    ls.lookahead = {\n        token: TK_EOS,\n        seminfo: new SemInfo()\n    };\n    ls.z = z;\n    ls.fs = null;\n    ls.linenumber = 1;\n    ls.lastline = 1;\n    ls.source = source;\n    ls.envn = luaS_bless(L, LUA_ENV);\n    luaZ_resizebuffer(L, ls.buff, LUA_MINBUFFER);  /* initialize buffer */\n};\n\nconst check_next1 = function(ls, c) {\n    if (ls.current === c) {\n        next(ls);\n        return true;\n    }\n\n    return false;\n};\n\n/*\n** Check whether current char is in set 'set' (with two chars) and\n** saves it\n*/\nconst check_next2 = function(ls, set) {\n    if (ls.current === set[0].charCodeAt(0) || ls.current === set[1].charCodeAt(0)) {\n        save_and_next(ls);\n        return true;\n    }\n\n    return false;\n};\n\nconst read_numeral = function(ls, seminfo) {\n    let expo = \"Ee\";\n    let first = ls.current;\n    lua_assert(lisdigit(ls.current));\n    save_and_next(ls);\n    if (first === 48 /* ('0').charCodeAt(0) */ && check_next2(ls, \"xX\"))  /* hexadecimal? */\n        expo = \"Pp\";\n\n    for (;;) {\n        if (check_next2(ls, expo))  /* exponent part? */\n            check_next2(ls, \"-+\");  /* optional exponent sign */\n        if (lisxdigit(ls.current))\n            save_and_next(ls);\n        else if (ls.current === 46 /* ('.').charCodeAt(0) */)\n            save_and_next(ls);\n        else break;\n    }\n\n    // save(ls, 0);\n\n    let obj = new lobject.TValue();\n    if (lobject.luaO_str2num(luaZ_buffer(ls.buff), obj) === 0)  /* format error? */\n        lexerror(ls, to_luastring(\"malformed number\", true), TK_FLT);\n    if (obj.ttisinteger()) {\n        seminfo.i = obj.value;\n        return TK_INT;\n    } else {\n        lua_assert(obj.ttisfloat());\n        seminfo.r = obj.value;\n        return TK_FLT;\n    }\n};\n\nconst txtToken = function(ls, token) {\n    switch (token) {\n        case TK_NAME: case TK_STRING:\n        case TK_FLT: case TK_INT:\n            // save(ls, 0);\n            return lobject.luaO_pushfstring(ls.L, to_luastring(\"'%s'\", true), luaZ_buffer(ls.buff));\n        default:\n            return luaX_token2str(ls, token);\n    }\n};\n\nconst lexerror = function(ls, msg, token) {\n    msg = ldebug.luaG_addinfo(ls.L, msg, ls.source, ls.linenumber);\n    if (token)\n        lobject.luaO_pushfstring(ls.L, to_luastring(\"%s near %s\"), msg, txtToken(ls, token));\n    ldo.luaD_throw(ls.L, LUA_ERRSYNTAX);\n};\n\nconst luaX_syntaxerror = function(ls, msg) {\n    lexerror(ls, msg, ls.t.token);\n};\n\n/*\n** skip a sequence '[=*[' or ']=*]'; if sequence is well formed, return\n** its number of '='s; otherwise, return a negative number (-1 iff there\n** are no '='s after initial bracket)\n*/\nconst skip_sep = function(ls) {\n    let count = 0;\n    let s = ls.current;\n    lua_assert(s === 91 /* ('[').charCodeAt(0) */ || s === 93 /* (']').charCodeAt(0) */);\n    save_and_next(ls);\n    while (ls.current === 61 /* ('=').charCodeAt(0) */) {\n        save_and_next(ls);\n        count++;\n    }\n    return ls.current === s ? count : (-count) - 1;\n};\n\nconst read_long_string = function(ls, seminfo, sep) {\n    let line = ls.linenumber;  /* initial line (for error message) */\n    save_and_next(ls);  /* skip 2nd '[' */\n\n    if (currIsNewline(ls))  /* string starts with a newline? */\n        inclinenumber(ls);  /* skip it */\n\n    let skip = false;\n    for (; !skip ;) {\n        switch (ls.current) {\n            case EOZ: {  /* error */\n                let what = seminfo ? \"string\" : \"comment\";\n                let msg = `unfinished long ${what} (starting at line ${line})`;\n                lexerror(ls, to_luastring(msg), TK_EOS);\n                break;\n            }\n            case 93 /* (']').charCodeAt(0) */: {\n                if (skip_sep(ls) === sep) {\n                    save_and_next(ls);  /* skip 2nd ']' */\n                    skip = true;\n                }\n                break;\n            }\n            case 10 /* ('\\n').charCodeAt(0) */:\n            case 13 /* ('\\r').charCodeAt(0) */: {\n                save(ls, 10 /* ('\\n').charCodeAt(0) */);\n                inclinenumber(ls);\n                if (!seminfo) luaZ_resetbuffer(ls.buff);\n                break;\n            }\n            default: {\n                if (seminfo) save_and_next(ls);\n                else next(ls);\n            }\n        }\n    }\n\n    if (seminfo)\n        seminfo.ts = luaX_newstring(ls, ls.buff.buffer.subarray(2 + sep, ls.buff.n - (2 + sep)));\n};\n\nconst esccheck = function(ls, c, msg) {\n    if (!c) {\n        if (ls.current !== EOZ)\n            save_and_next(ls);  /* add current to buffer for error message */\n        lexerror(ls, msg, TK_STRING);\n    }\n};\n\nconst gethexa = function(ls) {\n    save_and_next(ls);\n    esccheck(ls, lisxdigit(ls.current), to_luastring(\"hexadecimal digit expected\", true));\n    return lobject.luaO_hexavalue(ls.current);\n};\n\nconst readhexaesc = function(ls) {\n    let r = gethexa(ls);\n    r = (r << 4) + gethexa(ls);\n    luaZ_buffremove(ls.buff, 2);  /* remove saved chars from buffer */\n    return r;\n};\n\nconst readutf8desc = function(ls) {\n    let i = 4;  /* chars to be removed: '\\', 'u', '{', and first digit */\n    save_and_next(ls);  /* skip 'u' */\n    esccheck(ls, ls.current === 123 /* ('{').charCodeAt(0) */, to_luastring(\"missing '{'\", true));\n    let r = gethexa(ls);  /* must have at least one digit */\n\n    save_and_next(ls);\n    while (lisxdigit(ls.current)) {\n        i++;\n        r = (r << 4) + lobject.luaO_hexavalue(ls.current);\n        esccheck(ls, r <= 0x10FFFF, to_luastring(\"UTF-8 value too large\", true));\n        save_and_next(ls);\n    }\n    esccheck(ls, ls.current === 125 /* ('}').charCodeAt(0) */, to_luastring(\"missing '}'\", true));\n    next(ls);  /* skip '}' */\n    luaZ_buffremove(ls.buff, i);  /* remove saved chars from buffer */\n    return r;\n};\n\nconst utf8esc = function(ls) {\n    let buff = new Uint8Array(lobject.UTF8BUFFSZ);\n    let n = lobject.luaO_utf8esc(buff, readutf8desc(ls));\n    for (; n > 0; n--)  /* add 'buff' to string */\n        save(ls, buff[lobject.UTF8BUFFSZ - n]);\n};\n\nconst readdecesc = function(ls) {\n    let r = 0;  /* result accumulator */\n    let i;\n    for (i = 0; i < 3 && lisdigit(ls.current); i++) {  /* read up to 3 digits */\n        r = 10 * r + ls.current - 48 /* ('0').charCodeAt(0) */;\n        save_and_next(ls);\n    }\n    esccheck(ls, r <= 255, to_luastring(\"decimal escape too large\", true));\n    luaZ_buffremove(ls.buff, i);  /* remove read digits from buffer */\n    return r;\n};\n\nconst read_string = function(ls, del, seminfo) {\n    save_and_next(ls);  /* keep delimiter (for error messages) */\n\n    while (ls.current !== del) {\n        switch (ls.current) {\n            case EOZ:\n                lexerror(ls, to_luastring(\"unfinished string\", true), TK_EOS);\n                break;\n            case 10 /* ('\\n').charCodeAt(0) */:\n            case 13 /* ('\\r').charCodeAt(0) */:\n                lexerror(ls, to_luastring(\"unfinished string\", true), TK_STRING);\n                break;\n            case 92 /* ('\\\\').charCodeAt(0) */: {  /* escape sequences */\n                save_and_next(ls);  /* keep '\\\\' for error messages */\n                let will;\n                let c;\n                switch(ls.current) {\n                    case 97 /* ('a').charCodeAt(0) */: c = 7 /* \\a isn't valid JS */; will = 'read_save'; break;\n                    case 98 /* ('b').charCodeAt(0) */: c = 8 /* ('\\b').charCodeAt(0) */; will = 'read_save'; break;\n                    case 102 /* ('f').charCodeAt(0) */: c = 12 /* ('\\f').charCodeAt(0) */; will = 'read_save'; break;\n                    case 110 /* ('n').charCodeAt(0) */: c = 10 /* ('\\n').charCodeAt(0) */; will = 'read_save'; break;\n                    case 114 /* ('r').charCodeAt(0) */: c = 13 /* ('\\r').charCodeAt(0) */; will = 'read_save'; break;\n                    case 116 /* ('t').charCodeAt(0) */: c = 9 /* ('\\t').charCodeAt(0) */; will = 'read_save'; break;\n                    case 118 /* ('v').charCodeAt(0) */: c = 11 /* ('\\v').charCodeAt(0) */; will = 'read_save'; break;\n                    case 120 /* ('x').charCodeAt(0) */: c = readhexaesc(ls); will = 'read_save'; break;\n                    case 117 /* ('u').charCodeAt(0) */: utf8esc(ls); will = 'no_save'; break;\n                    case 10 /* ('\\n').charCodeAt(0) */:\n                    case 13 /* ('\\r').charCodeAt(0) */:\n                        inclinenumber(ls); c = 10 /* ('\\n').charCodeAt(0) */; will = 'only_save'; break;\n                    case 92 /* ('\\\\').charCodeAt(0) */:\n                    case 34 /* ('\"').charCodeAt(0) */:\n                    case 39 /* ('\\'').charCodeAt(0) */:\n                        c = ls.current; will = 'read_save'; break;\n                    case EOZ: will = 'no_save'; break;  /* will raise an error next loop */\n                    case 122 /* ('z').charCodeAt(0) */: {  /* zap following span of spaces */\n                        luaZ_buffremove(ls.buff, 1);  /* remove '\\\\' */\n                        next(ls);  /* skip the 'z' */\n                        while (lisspace(ls.current)) {\n                            if (currIsNewline(ls)) inclinenumber(ls);\n                            else next(ls);\n                        }\n                        will = 'no_save'; break;\n                    }\n                    default: {\n                        esccheck(ls, lisdigit(ls.current), to_luastring(\"invalid escape sequence\", true));\n                        c = readdecesc(ls);  /* digital escape '\\ddd' */\n                        will = 'only_save'; break;\n                    }\n                }\n\n                if (will === 'read_save')\n                    next(ls);\n\n                if (will === 'read_save' || will === 'only_save') {\n                    luaZ_buffremove(ls.buff, 1);  /* remove '\\\\' */\n                    save(ls, c);\n                }\n\n                break;\n            }\n            default:\n                save_and_next(ls);\n        }\n    }\n    save_and_next(ls);  /* skip delimiter */\n\n    seminfo.ts = luaX_newstring(ls, ls.buff.buffer.subarray(1, ls.buff.n-1));\n};\n\nconst token_to_index = Object.create(null); /* don't want to return true for e.g. 'hasOwnProperty' */\nluaX_tokens.forEach((e, i)=>token_to_index[luaS_hash(e)] = i);\n\nconst isreserved = function(w) {\n    let kidx = token_to_index[luaS_hashlongstr(w)];\n    return kidx !== void 0 && kidx <= 22;\n};\n\nconst llex = function(ls, seminfo) {\n    luaZ_resetbuffer(ls.buff);\n    for (;;) {\n        lua_assert(typeof ls.current == \"number\"); /* fengari addition */\n        switch (ls.current) {\n            case 10 /* ('\\n').charCodeAt(0) */:\n            case 13 /* ('\\r').charCodeAt(0) */: {  /* line breaks */\n                inclinenumber(ls);\n                break;\n            }\n            case 32 /* (' ').charCodeAt(0) */:\n            case 12 /* ('\\f').charCodeAt(0) */:\n            case 9 /* ('\\t').charCodeAt(0) */:\n            case 11 /* ('\\v').charCodeAt(0) */: {  /* spaces */\n                next(ls);\n                break;\n            }\n            case 45 /* ('-').charCodeAt(0) */: {  /* '-' or '--' (comment) */\n                next(ls);\n                if (ls.current !== 45 /* ('-').charCodeAt(0) */) return 45 /* ('-').charCodeAt(0) */;\n                /* else is a comment */\n                next(ls);\n                if (ls.current === 91 /* ('[').charCodeAt(0) */) {  /* long comment? */\n                    let sep = skip_sep(ls);\n                    luaZ_resetbuffer(ls.buff);  /* 'skip_sep' may dirty the buffer */\n                    if (sep >= 0) {\n                        read_long_string(ls, null, sep);  /* skip long comment */\n                        luaZ_resetbuffer(ls.buff);  /* previous call may dirty the buff. */\n                        break;\n                    }\n                }\n\n                /* else short comment */\n                while (!currIsNewline(ls) && ls.current !== EOZ)\n                    next(ls);  /* skip until end of line (or end of file) */\n                break;\n            }\n            case 91 /* ('[').charCodeAt(0) */: {  /* long string or simply '[' */\n                let sep = skip_sep(ls);\n                if (sep >= 0) {\n                    read_long_string(ls, seminfo, sep);\n                    return TK_STRING;\n                } else if (sep !== -1)  /* '[=...' missing second bracket */\n                    lexerror(ls, to_luastring(\"invalid long string delimiter\", true), TK_STRING);\n                return 91 /* ('[').charCodeAt(0) */;\n            }\n            case 61 /* ('=').charCodeAt(0) */: {\n                next(ls);\n                if (check_next1(ls, 61 /* ('=').charCodeAt(0) */)) return TK_EQ;\n                else return 61 /* ('=').charCodeAt(0) */;\n            }\n            case 60 /* ('<').charCodeAt(0) */: {\n                next(ls);\n                if (check_next1(ls, 61 /* ('=').charCodeAt(0) */)) return TK_LE;\n                else if (check_next1(ls, 60 /* ('<').charCodeAt(0) */)) return TK_SHL;\n                else return 60 /* ('<').charCodeAt(0) */;\n            }\n            case 62 /* ('>').charCodeAt(0) */: {\n                next(ls);\n                if (check_next1(ls, 61 /* ('=').charCodeAt(0) */)) return TK_GE;\n                else if (check_next1(ls, 62 /* ('>').charCodeAt(0) */)) return TK_SHR;\n                else return 62 /* ('>').charCodeAt(0) */;\n            }\n            case 47 /* ('/').charCodeAt(0) */: {\n                next(ls);\n                if (check_next1(ls, 47 /* ('/').charCodeAt(0) */)) return TK_IDIV;\n                else return 47 /* ('/').charCodeAt(0) */;\n            }\n            case 126 /* ('~').charCodeAt(0) */: {\n                next(ls);\n                if (check_next1(ls, 61 /* ('=').charCodeAt(0) */)) return TK_NE;\n                else return 126 /* ('~').charCodeAt(0) */;\n            }\n            case 58 /* (':').charCodeAt(0) */: {\n                next(ls);\n                if (check_next1(ls, 58 /* (':').charCodeAt(0) */)) return TK_DBCOLON;\n                else return 58 /* (':').charCodeAt(0) */;\n            }\n            case 34 /* ('\"').charCodeAt(0) */:\n            case 39 /* ('\\'').charCodeAt(0) */: {  /* short literal strings */\n                read_string(ls, ls.current, seminfo);\n                return TK_STRING;\n            }\n            case 46 /* ('.').charCodeAt(0) */: {  /* '.', '..', '...', or number */\n                save_and_next(ls);\n                if (check_next1(ls, 46 /* ('.').charCodeAt(0) */)) {\n                    if (check_next1(ls, 46 /* ('.').charCodeAt(0) */))\n                        return TK_DOTS;   /* '...' */\n                    else return TK_CONCAT;   /* '..' */\n                }\n                else if (!lisdigit(ls.current)) return 46 /* ('.').charCodeAt(0) */;\n                else return read_numeral(ls, seminfo);\n            }\n            case 48 /* ('0').charCodeAt(0) */: case 49 /* ('1').charCodeAt(0) */: case 50 /* ('2').charCodeAt(0) */: case 51 /* ('3').charCodeAt(0) */: case 52 /* ('4').charCodeAt(0) */:\n            case 53 /* ('5').charCodeAt(0) */: case 54 /* ('6').charCodeAt(0) */: case 55 /* ('7').charCodeAt(0) */: case 56 /* ('8').charCodeAt(0) */: case 57 /* ('9').charCodeAt(0) */: {\n                return read_numeral(ls, seminfo);\n            }\n            case EOZ: {\n                return TK_EOS;\n            }\n            default: {\n                if (lislalpha(ls.current)) {  /* identifier or reserved word? */\n                    do {\n                        save_and_next(ls);\n                    } while (lislalnum(ls.current));\n                    let ts = luaX_newstring(ls, luaZ_buffer(ls.buff));\n                    seminfo.ts = ts;\n                    let kidx = token_to_index[luaS_hashlongstr(ts)];\n                    if (kidx !== void 0 && kidx <= 22)  /* reserved word? */\n                        return kidx + FIRST_RESERVED;\n                    else\n                        return TK_NAME;\n                } else {  /* single-char tokens (+ - / ...) */\n                    let c = ls.current;\n                    next(ls);\n                    return c;\n                }\n            }\n        }\n    }\n};\n\nconst luaX_next = function(ls) {\n    ls.lastline = ls.linenumber;\n    if (ls.lookahead.token !== TK_EOS) {  /* is there a look-ahead token? */\n        ls.t.token = ls.lookahead.token;  /* use this one */\n        ls.t.seminfo.i = ls.lookahead.seminfo.i;\n        ls.t.seminfo.r = ls.lookahead.seminfo.r;\n        ls.t.seminfo.ts = ls.lookahead.seminfo.ts;\n        ls.lookahead.token = TK_EOS;  /* and discharge it */\n    } else\n        ls.t.token = llex(ls, ls.t.seminfo);  /* read next token */\n};\n\nconst luaX_lookahead = function(ls) {\n    lua_assert(ls.lookahead.token === TK_EOS);\n    ls.lookahead.token = llex(ls, ls.lookahead.seminfo);\n    return ls.lookahead.token;\n};\n\nmodule.exports.FIRST_RESERVED   = FIRST_RESERVED;\nmodule.exports.LUA_ENV          = LUA_ENV;\nmodule.exports.LexState         = LexState;\nmodule.exports.RESERVED         = RESERVED;\nmodule.exports.isreserved       = isreserved;\nmodule.exports.luaX_lookahead   = luaX_lookahead;\nmodule.exports.luaX_newstring   = luaX_newstring;\nmodule.exports.luaX_next        = luaX_next;\nmodule.exports.luaX_setinput    = luaX_setinput;\nmodule.exports.luaX_syntaxerror = luaX_syntaxerror;\nmodule.exports.luaX_token2str   = luaX_token2str;\nmodule.exports.luaX_tokens      = luaX_tokens;\n","\"use strict\";\n\nconst { luai_apicheck } = require(\"./luaconf.js\");\n\nconst lua_assert = function(c) {\n    if (!c) throw Error(\"assertion failed\");\n};\nmodule.exports.lua_assert = lua_assert;\n\nmodule.exports.luai_apicheck = luai_apicheck || function(l, e) { return lua_assert(e); };\n\nconst api_check = function(l, e, msg) {\n    return luai_apicheck(l, e && msg);\n};\nmodule.exports.api_check = api_check;\n\nconst LUAI_MAXCCALLS = 200;\nmodule.exports.LUAI_MAXCCALLS = LUAI_MAXCCALLS;\n\n/* minimum size for string buffer */\nconst LUA_MINBUFFER = 32;\nmodule.exports.LUA_MINBUFFER = LUA_MINBUFFER;\n\nconst luai_nummod = function(L, a, b) {\n    let m = a % b;\n    if ((m*b) < 0)\n        m += b;\n    return m;\n};\nmodule.exports.luai_nummod = luai_nummod;\n\n// If later integers are more than 32bit, LUA_MAXINTEGER will then be != MAX_INT\nconst MAX_INT = 2147483647;\nmodule.exports.MAX_INT = MAX_INT;\nconst MIN_INT = -2147483648;\nmodule.exports.MIN_INT = MIN_INT;\n","\"use strict\";\n\nconst {\n    LUA_OPADD,\n    LUA_OPBAND,\n    LUA_OPBNOT,\n    LUA_OPBOR,\n    LUA_OPBXOR,\n    LUA_OPDIV,\n    LUA_OPIDIV,\n    LUA_OPMOD,\n    LUA_OPMUL,\n    LUA_OPPOW,\n    LUA_OPSHL,\n    LUA_OPSHR,\n    LUA_OPSUB,\n    LUA_OPUNM,\n    constant_types: {\n        LUA_NUMTAGS,\n        LUA_TBOOLEAN,\n        LUA_TCCL,\n        LUA_TFUNCTION,\n        LUA_TLCF,\n        LUA_TLCL,\n        LUA_TLIGHTUSERDATA,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNUMBER,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TSHRSTR,\n        LUA_TSTRING,\n        LUA_TTABLE,\n        LUA_TTHREAD,\n        LUA_TUSERDATA\n    },\n    from_userstring,\n    luastring_indexOf,\n    luastring_of,\n    to_jsstring,\n    to_luastring\n} = require('./defs.js');\nconst {\n    lisdigit,\n    lisprint,\n    lisspace,\n    lisxdigit\n} = require('./ljstype.js');\nconst ldebug  = require('./ldebug.js');\nconst ldo     = require('./ldo.js');\nconst lstate  = require('./lstate.js');\nconst {\n    luaS_bless,\n    luaS_new\n} = require('./lstring.js');\nconst ltable  = require('./ltable.js');\nconst {\n    LUA_COMPAT_FLOATSTRING,\n    ldexp,\n    lua_integer2str,\n    lua_number2str\n} = require('./luaconf.js');\nconst lvm     = require('./lvm.js');\nconst {\n    MAX_INT,\n    luai_nummod,\n    lua_assert\n} = require(\"./llimits.js\");\nconst ltm     = require('./ltm.js');\n\nconst LUA_TPROTO = LUA_NUMTAGS;\nconst LUA_TDEADKEY = LUA_NUMTAGS+1;\n\nclass TValue {\n\n    constructor(type, value) {\n        this.type = type;\n        this.value = value;\n    }\n\n    /* type tag of a TValue (bits 0-3 for tags + variant bits 4-5) */\n    ttype() {\n        return this.type & 0x3F;\n    }\n\n    /* type tag of a TValue with no variants (bits 0-3) */\n    ttnov() {\n        return this.type & 0x0F;\n    }\n\n    checktag(t) {\n        return this.type === t;\n    }\n\n    checktype(t) {\n        return this.ttnov() === t;\n    }\n\n    ttisnumber() {\n        return this.checktype(LUA_TNUMBER);\n    }\n\n    ttisfloat() {\n        return this.checktag(LUA_TNUMFLT);\n    }\n\n    ttisinteger() {\n        return this.checktag(LUA_TNUMINT);\n    }\n\n    ttisnil() {\n        return this.checktag(LUA_TNIL);\n    }\n\n    ttisboolean() {\n        return this.checktag(LUA_TBOOLEAN);\n    }\n\n    ttislightuserdata() {\n        return this.checktag(LUA_TLIGHTUSERDATA);\n    }\n\n    ttisstring() {\n        return this.checktype(LUA_TSTRING);\n    }\n\n    ttisshrstring() {\n        return this.checktag(LUA_TSHRSTR);\n    }\n\n    ttislngstring() {\n        return this.checktag(LUA_TLNGSTR);\n    }\n\n    ttistable() {\n        return this.checktag(LUA_TTABLE);\n    }\n\n    ttisfunction() {\n        return this.checktype(LUA_TFUNCTION);\n    }\n\n    ttisclosure() {\n        return (this.type & 0x1F) === LUA_TFUNCTION;\n    }\n\n    ttisCclosure() {\n        return this.checktag(LUA_TCCL);\n    }\n\n    ttisLclosure() {\n        return this.checktag(LUA_TLCL);\n    }\n\n    ttislcf() {\n        return this.checktag(LUA_TLCF);\n    }\n\n    ttisfulluserdata() {\n        return this.checktag(LUA_TUSERDATA);\n    }\n\n    ttisthread() {\n        return this.checktag(LUA_TTHREAD);\n    }\n\n    ttisdeadkey() {\n        return this.checktag(LUA_TDEADKEY);\n    }\n\n    l_isfalse() {\n        return this.ttisnil() || (this.ttisboolean() && this.value === false);\n    }\n\n    setfltvalue(x) {\n        this.type = LUA_TNUMFLT;\n        this.value = x;\n    }\n\n    chgfltvalue(x) {\n        lua_assert(this.type == LUA_TNUMFLT);\n        this.value = x;\n    }\n\n    setivalue(x) {\n        this.type = LUA_TNUMINT;\n        this.value = x;\n    }\n\n    chgivalue(x) {\n        lua_assert(this.type == LUA_TNUMINT);\n        this.value = x;\n    }\n\n    setnilvalue() {\n        this.type = LUA_TNIL;\n        this.value = null;\n    }\n\n    setfvalue(x) {\n        this.type = LUA_TLCF;\n        this.value = x;\n    }\n\n    setpvalue(x) {\n        this.type = LUA_TLIGHTUSERDATA;\n        this.value = x;\n    }\n\n    setbvalue(x) {\n        this.type = LUA_TBOOLEAN;\n        this.value = x;\n    }\n\n    setsvalue(x) {\n        this.type = LUA_TLNGSTR; /* LUA_TSHRSTR? */\n        this.value = x;\n    }\n\n    setuvalue(x) {\n        this.type = LUA_TUSERDATA;\n        this.value = x;\n    }\n\n    setthvalue(x) {\n        this.type = LUA_TTHREAD;\n        this.value = x;\n    }\n\n    setclLvalue(x) {\n        this.type = LUA_TLCL;\n        this.value = x;\n    }\n\n    setclCvalue(x) {\n        this.type = LUA_TCCL;\n        this.value = x;\n    }\n\n    sethvalue(x) {\n        this.type = LUA_TTABLE;\n        this.value = x;\n    }\n\n    setdeadvalue() {\n        this.type = LUA_TDEADKEY;\n        this.value = null;\n    }\n\n    setfrom(tv) { /* in lua C source setobj2t is often used for this */\n        this.type = tv.type;\n        this.value = tv.value;\n    }\n\n    tsvalue() {\n        lua_assert(this.ttisstring());\n        return this.value;\n    }\n\n    svalue() {\n        return this.tsvalue().getstr();\n    }\n\n    vslen() {\n        return this.tsvalue().tsslen();\n    }\n\n    jsstring(from, to) {\n        return to_jsstring(this.svalue(), from, to, true);\n    }\n}\n\nconst pushobj2s = function(L, tv) {\n    L.stack[L.top++] = new TValue(tv.type, tv.value);\n};\nconst pushsvalue2s = function(L, ts) {\n    L.stack[L.top++] = new TValue(LUA_TLNGSTR, ts);\n};\n/* from stack to (same) stack */\nconst setobjs2s = function(L, newidx, oldidx) {\n    L.stack[newidx].setfrom(L.stack[oldidx]);\n};\n/* to stack (not from same stack) */\nconst setobj2s = function(L, newidx, oldtv) {\n    L.stack[newidx].setfrom(oldtv);\n};\nconst setsvalue2s = function(L, newidx, ts) {\n    L.stack[newidx].setsvalue(ts);\n};\n\nconst luaO_nilobject = new TValue(LUA_TNIL, null);\nObject.freeze(luaO_nilobject);\nmodule.exports.luaO_nilobject = luaO_nilobject;\n\nclass LClosure {\n\n    constructor(L, n) {\n        this.id = L.l_G.id_counter++;\n\n        this.p = null;\n        this.nupvalues = n;\n        this.upvals = new Array(n); /* list of upvalues. initialised in luaF_initupvals */\n    }\n\n}\n\nclass CClosure {\n\n    constructor(L, f, n) {\n        this.id = L.l_G.id_counter++;\n\n        this.f = f;\n        this.nupvalues = n;\n        this.upvalue = new Array(n); /* list of upvalues as TValues */\n        while (n--) {\n            this.upvalue[n] = new TValue(LUA_TNIL, null);\n        }\n    }\n\n}\n\nclass Udata {\n\n    constructor(L, size) {\n        this.id = L.l_G.id_counter++;\n\n        this.metatable = null;\n        this.uservalue = new TValue(LUA_TNIL, null);\n        this.len = size;\n        this.data = Object.create(null); // ignores size argument\n    }\n\n}\n\n/*\n** Description of a local variable for function prototypes\n** (used for debug information)\n*/\nclass LocVar {\n    constructor() {\n        this.varname = null;\n        this.startpc = NaN;  /* first point where variable is active */\n        this.endpc = NaN;    /* first point where variable is dead */\n    }\n}\n\nconst RETS = to_luastring(\"...\");\nconst PRE  = to_luastring(\"[string \\\"\");\nconst POS  = to_luastring(\"\\\"]\");\n\nconst luaO_chunkid = function(source, bufflen) {\n    let l = source.length;\n    let out;\n    if (source[0] === 61 /* ('=').charCodeAt(0) */) {  /* 'literal' source */\n        if (l < bufflen) {  /* small enough? */\n            out = new Uint8Array(l-1);\n            out.set(source.subarray(1));\n        } else {  /* truncate it */\n            out = new Uint8Array(bufflen);\n            out.set(source.subarray(1, bufflen+1));\n        }\n    } else if (source[0] === 64 /* ('@').charCodeAt(0) */) {  /* file name */\n        if (l <= bufflen) {  /* small enough? */\n            out = new Uint8Array(l-1);\n            out.set(source.subarray(1));\n        } else {  /* add '...' before rest of name */\n            out = new Uint8Array(bufflen);\n            out.set(RETS);\n            bufflen -= RETS.length;\n            out.set(source.subarray(l - bufflen), RETS.length);\n        }\n    } else {  /* string; format as [string \"source\"] */\n        out = new Uint8Array(bufflen);\n        let nli = luastring_indexOf(source, 10 /* ('\\n').charCodeAt(0) */);  /* find first new line (if any) */\n        out.set(PRE);  /* add prefix */\n        let out_i = PRE.length;\n        bufflen -= PRE.length + RETS.length + POS.length;  /* save space for prefix+suffix */\n        if (l < bufflen && nli === -1) {  /* small one-line source? */\n            out.set(source, out_i);  /* keep it */\n            out_i += source.length;\n        } else {\n            if (nli !== -1) l = nli;  /* stop at first newline */\n            if (l > bufflen) l = bufflen;\n            out.set(source.subarray(0, l), out_i);\n            out_i += l;\n            out.set(RETS, out_i);\n            out_i += RETS.length;\n        }\n        out.set(POS, out_i);\n        out_i += POS.length;\n        out = out.subarray(0, out_i);\n    }\n    return out;\n};\n\nconst luaO_hexavalue = function(c) {\n    if (lisdigit(c)) return c - 48;\n    else return (c & 0xdf) - 55;\n};\n\nconst UTF8BUFFSZ = 8;\n\nconst luaO_utf8esc = function(buff, x) {\n    let n = 1;  /* number of bytes put in buffer (backwards) */\n    lua_assert(x <= 0x10FFFF);\n    if (x < 0x80)  /* ascii? */\n        buff[UTF8BUFFSZ - 1] = x;\n    else {  /* need continuation bytes */\n        let mfb = 0x3f;  /* maximum that fits in first byte */\n        do {\n            buff[UTF8BUFFSZ - (n++)] = 0x80 | (x & 0x3f);\n            x >>= 6;  /* remove added bits */\n            mfb >>= 1;  /* now there is one less bit available in first byte */\n        } while (x > mfb);  /* still needs continuation byte? */\n        buff[UTF8BUFFSZ - n] = (~mfb << 1) | x;  /* add first byte */\n    }\n    return n;\n};\n\n/* maximum number of significant digits to read (to avoid overflows\n   even with single floats) */\nconst MAXSIGDIG = 30;\n\n/*\n** convert an hexadecimal numeric string to a number, following\n** C99 specification for 'strtod'\n*/\nconst lua_strx2number = function(s) {\n    let i = 0;\n    let r = 0.0;  /* result (accumulator) */\n    let sigdig = 0;  /* number of significant digits */\n    let nosigdig = 0;  /* number of non-significant digits */\n    let e = 0;  /* exponent correction */\n    let neg;  /* 1 if number is negative */\n    let hasdot = false;  /* true after seen a dot */\n    while (lisspace(s[i])) i++;  /* skip initial spaces */\n    if ((neg = (s[i] === 45 /* ('-').charCodeAt(0) */))) i++;  /* check signal */\n    else if (s[i] === 43 /* ('+').charCodeAt(0) */) i++;\n    if (!(s[i] === 48 /* ('0').charCodeAt(0) */ && (s[i+1] === 120 /* ('x').charCodeAt(0) */ || s[i+1] === 88 /* ('X').charCodeAt(0) */)))  /* check '0x' */\n        return null;  /* invalid format (no '0x') */\n    for (i += 2; ; i++) {  /* skip '0x' and read numeral */\n        if (s[i] === 46 /* ('.').charCodeAt(0) i.e. dot/lua_getlocaledecpoint(); */) {\n            if (hasdot) break;  /* second dot? stop loop */\n            else hasdot = true;\n        } else if (lisxdigit(s[i])) {\n            if (sigdig === 0 && s[i] === 48 /* ('0').charCodeAt(0) */)  /* non-significant digit (zero)? */\n                nosigdig++;\n            else if (++sigdig <= MAXSIGDIG)  /* can read it without overflow? */\n                r = (r * 16) + luaO_hexavalue(s[i]);\n            else e++; /* too many digits; ignore, but still count for exponent */\n            if (hasdot) e--;  /* decimal digit? correct exponent */\n        } else break;  /* neither a dot nor a digit */\n    }\n\n    if (nosigdig + sigdig === 0)  /* no digits? */\n        return null;  /* invalid format */\n    e *= 4;  /* each digit multiplies/divides value by 2^4 */\n    if (s[i] === 112 /* ('p').charCodeAt(0) */ || s[i] === 80 /* ('P').charCodeAt(0) */) {  /* exponent part? */\n        let exp1 = 0;  /* exponent value */\n        let neg1;  /* exponent signal */\n        i++;  /* skip 'p' */\n        if ((neg1 = (s[i] === 45 /* ('-').charCodeAt(0) */))) i++;  /* signal */\n        else if (s[i] === 43 /* ('+').charCodeAt(0) */) i++;\n        if (!lisdigit(s[i]))\n            return null;  /* invalid; must have at least one digit */\n        while (lisdigit(s[i]))  /* read exponent */\n            exp1 = exp1 * 10 + s[i++] - 48 /* ('0').charCodeAt(0) */;\n        if (neg1) exp1 = -exp1;\n        e += exp1;\n    }\n    if (neg) r = -r;\n    return {\n        n: ldexp(r, e),\n        i: i\n    };\n};\n\nconst lua_str2number = function(s) {\n    try {\n        s = to_jsstring(s);\n    } catch (e) {\n        return null;\n    }\n    /* use a regex to validate number and also to get length\n       parseFloat ignores trailing junk */\n    let r = /^[\\t\\v\\f \\n\\r]*[+-]?(?:[0-9]+\\.?[0-9]*|\\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(s);\n    if (!r)\n        return null;\n    let flt = parseFloat(r[0]);\n    return !isNaN(flt) ? { n: flt, i: r[0].length } : null;\n};\n\nconst l_str2dloc = function(s, mode) {\n    let result = mode === 'x' ? lua_strx2number(s) : lua_str2number(s); /* try to convert */\n    if (result === null) return null;\n    while (lisspace(s[result.i])) result.i++;  /* skip trailing spaces */\n    return (result.i === s.length || s[result.i] === 0) ? result : null;  /* OK if no trailing characters */\n};\n\nconst SIGILS = [\n    46  /* (\".\").charCodeAt(0) */,\n    120 /* (\"x\").charCodeAt(0) */,\n    88  /* (\"X\").charCodeAt(0) */,\n    110 /* (\"n\").charCodeAt(0) */,\n    78  /* (\"N\").charCodeAt(0) */\n];\nconst modes = {\n    [ 46]: \".\",\n    [120]: \"x\",\n    [ 88]: \"x\",\n    [110]: \"n\",\n    [ 78]: \"n\"\n};\nconst l_str2d = function(s) {\n    let l = s.length;\n    let pmode = 0;\n    for (let i=0; i<l; i++) {\n        let v = s[i];\n        if (SIGILS.indexOf(v) !== -1) {\n            pmode = v;\n            break;\n        }\n    }\n    let mode = modes[pmode];\n    if (mode === 'n')  /* reject 'inf' and 'nan' */\n        return null;\n    let end = l_str2dloc(s, mode);  /* try to convert */\n    // if (end === null) {   /* failed? may be a different locale */\n    //     throw new Error(\"Locale not available to handle number\"); // TODO\n    // }\n    return end;\n};\n\nconst MAXBY10  = Math.floor(MAX_INT / 10);\nconst MAXLASTD = MAX_INT % 10;\n\nconst l_str2int = function(s) {\n    let i = 0;\n    let a = 0;\n    let empty = true;\n    let neg;\n\n    while (lisspace(s[i])) i++;  /* skip initial spaces */\n    if ((neg = (s[i] === 45 /* ('-').charCodeAt(0) */))) i++;\n    else if (s[i] === 43 /* ('+').charCodeAt(0) */) i++;\n    if (s[i] === 48 /* ('0').charCodeAt(0) */ && (s[i+1] === 120 /* ('x').charCodeAt(0) */ || s[i+1] === 88 /* ('X').charCodeAt(0) */)) {  /* hex? */\n        i += 2;  /* skip '0x' */\n        for (; i < s.length && lisxdigit(s[i]); i++) {\n            a = (a * 16 + luaO_hexavalue(s[i]))|0;\n            empty = false;\n        }\n    } else {  /* decimal */\n        for (; i < s.length && lisdigit(s[i]); i++) {\n            let d = s[i] - 48 /* ('0').charCodeAt(0) */;\n            if (a >= MAXBY10 && (a > MAXBY10 || d > MAXLASTD + neg))  /* overflow? */\n                return null;  /* do not accept it (as integer) */\n            a = (a * 10 + d)|0;\n            empty = false;\n        }\n    }\n    while (i < s.length && lisspace(s[i])) i++;  /* skip trailing spaces */\n    if (empty || (i !== s.length && s[i] !== 0)) return null;  /* something wrong in the numeral */\n    else {\n        return {\n            n: (neg ? -a : a)|0,\n            i: i\n        };\n    }\n};\n\nconst luaO_str2num = function(s, o) {\n    let s2i = l_str2int(s);\n    if (s2i !== null) {   /* try as an integer */\n        o.setivalue(s2i.n);\n        return s2i.i+1;\n    } else {   /* else try as a float */\n        s2i = l_str2d(s);\n        if (s2i !== null) {\n            o.setfltvalue(s2i.n);\n            return s2i.i+1;\n        } else\n            return 0;  /* conversion failed */\n    }\n};\n\nconst luaO_tostring = function(L, obj) {\n    let buff;\n    if (obj.ttisinteger())\n        buff = to_luastring(lua_integer2str(obj.value));\n    else {\n        let str = lua_number2str(obj.value);\n        if (!LUA_COMPAT_FLOATSTRING && /^[-0123456789]+$/.test(str)) {  /* looks like an int? */\n            str += '.0'; /* adds '.0' to result: lua_getlocaledecpoint removed as optimisation */\n        }\n        buff = to_luastring(str);\n    }\n    obj.setsvalue(luaS_bless(L, buff));\n};\n\nconst pushstr = function(L, str) {\n    ldo.luaD_inctop(L);\n    setsvalue2s(L, L.top-1, luaS_new(L, str));\n};\n\nconst luaO_pushvfstring = function(L, fmt, argp) {\n    let n = 0;\n    let i = 0;\n    let a = 0;\n    let e;\n    for (;;) {\n        e = luastring_indexOf(fmt, 37 /* ('%').charCodeAt(0) */, i);\n        if (e == -1) break;\n        pushstr(L, fmt.subarray(i, e));\n        switch(fmt[e+1]) {\n            case 115 /* ('s').charCodeAt(0) */: {\n                let s = argp[a++];\n                if (s === null) s = to_luastring(\"(null)\", true);\n                else {\n                    s = from_userstring(s);\n                    /* respect null terminator */\n                    let i = luastring_indexOf(s, 0);\n                    if (i !== -1)\n                        s = s.subarray(0, i);\n                }\n                pushstr(L, s);\n                break;\n            }\n            case 99 /* ('c').charCodeAt(0) */: {\n                let buff = argp[a++];\n                if (lisprint(buff))\n                    pushstr(L, luastring_of(buff));\n                else\n                    luaO_pushfstring(L, to_luastring(\"<\\\\%d>\", true), buff);\n                break;\n            }\n            case 100 /* ('d').charCodeAt(0) */:\n            case 73 /* ('I').charCodeAt(0) */:\n                ldo.luaD_inctop(L);\n                L.stack[L.top-1].setivalue(argp[a++]);\n                luaO_tostring(L, L.stack[L.top-1]);\n                break;\n            case 102 /* ('f').charCodeAt(0) */:\n                ldo.luaD_inctop(L);\n                L.stack[L.top-1].setfltvalue(argp[a++]);\n                luaO_tostring(L, L.stack[L.top-1]);\n                break;\n            case 112 /* ('p').charCodeAt(0) */: {\n                let v = argp[a++];\n                if (v instanceof lstate.lua_State ||\n                    v instanceof ltable.Table ||\n                    v instanceof Udata ||\n                    v instanceof LClosure ||\n                    v instanceof CClosure) {\n                    pushstr(L, to_luastring(\"0x\"+v.id.toString(16)));\n                } else {\n                    switch(typeof v) {\n                        case \"undefined\":\n                            pushstr(L, to_luastring(\"undefined\"));\n                            break;\n                        case \"number\":  /* before check object as null is an object */\n                            pushstr(L, to_luastring(\"Number(\"+v+\")\"));\n                            break;\n                        case \"string\":  /* before check object as null is an object */\n                            pushstr(L, to_luastring(\"String(\"+JSON.stringify(v)+\")\"));\n                            break;\n                        case \"boolean\":  /* before check object as null is an object */\n                            pushstr(L, to_luastring(v?\"Boolean(true)\":\"Boolean(false)\"));\n                            break;\n                        case \"object\":\n                            if (v === null) { /* null is special */\n                                pushstr(L, to_luastring(\"null\"));\n                                break;\n                            }\n                            /* fall through */\n                        case \"function\": {\n                            let id = L.l_G.ids.get(v);\n                            if (!id) {\n                                id = L.l_G.id_counter++;\n                                L.l_G.ids.set(v, id);\n                            }\n                            pushstr(L, to_luastring(\"0x\"+id.toString(16)));\n                            break;\n                        }\n                        default:\n                            /* user provided object. no id available */\n                            pushstr(L, to_luastring(\"<id NYI>\"));\n                    }\n                }\n                break;\n            }\n            case 85 /* ('U').charCodeAt(0) */: {\n                let buff = new Uint8Array(UTF8BUFFSZ);\n                let l = luaO_utf8esc(buff, argp[a++]);\n                pushstr(L, buff.subarray(UTF8BUFFSZ - l));\n                break;\n            }\n            case 37 /* ('%').charCodeAt(0) */:\n                pushstr(L, to_luastring(\"%\", true));\n                break;\n            default:\n                ldebug.luaG_runerror(L, to_luastring(\"invalid option '%%%c' to 'lua_pushfstring'\"), fmt[e + 1]);\n        }\n        n += 2;\n        i = e + 2;\n    }\n    ldo.luaD_checkstack(L, 1);\n    pushstr(L, fmt.subarray(i));\n    if (n > 0) lvm.luaV_concat(L, n+1);\n    return L.stack[L.top-1].svalue();\n};\n\nconst luaO_pushfstring = function(L, fmt, ...argp) {\n    return luaO_pushvfstring(L, fmt, argp);\n};\n\n\n/*\n** converts an integer to a \"floating point byte\", represented as\n** (eeeeexxx), where the real value is (1xxx) * 2^(eeeee - 1) if\n** eeeee !== 0 and (xxx) otherwise.\n*/\nconst luaO_int2fb = function(x) {\n    let e = 0;  /* exponent */\n    if (x < 8) return x;\n    while (x >= (8 << 4)) {  /* coarse steps */\n        x = (x + 0xf) >> 4;  /* x = ceil(x / 16) */\n        e += 4;\n    }\n    while (x >= (8 << 1)) {  /* fine steps */\n        x = (x + 1) >> 1;  /* x = ceil(x / 2) */\n        e++;\n    }\n    return ((e+1) << 3) | (x - 8);\n};\n\nconst intarith = function(L, op, v1, v2) {\n    switch (op) {\n        case LUA_OPADD:  return (v1 + v2)|0;\n        case LUA_OPSUB:  return (v1 - v2)|0;\n        case LUA_OPMUL:  return lvm.luaV_imul(v1, v2);\n        case LUA_OPMOD:  return lvm.luaV_mod(L, v1, v2);\n        case LUA_OPIDIV: return lvm.luaV_div(L, v1, v2);\n        case LUA_OPBAND: return (v1 & v2);\n        case LUA_OPBOR:  return (v1 | v2);\n        case LUA_OPBXOR: return (v1 ^ v2);\n        case LUA_OPSHL:  return lvm.luaV_shiftl(v1, v2);\n        case LUA_OPSHR:  return lvm.luaV_shiftl(v1, -v2);\n        case LUA_OPUNM:  return (0 - v1)|0;\n        case LUA_OPBNOT: return (~0 ^ v1);\n        default: lua_assert(0);\n    }\n};\n\n\nconst numarith = function(L, op, v1, v2) {\n    switch (op) {\n        case LUA_OPADD:  return v1 + v2;\n        case LUA_OPSUB:  return v1 - v2;\n        case LUA_OPMUL:  return v1 * v2;\n        case LUA_OPDIV:  return v1 / v2;\n        case LUA_OPPOW:  return Math.pow(v1, v2);\n        case LUA_OPIDIV: return Math.floor(v1 / v2);\n        case LUA_OPUNM:  return -v1;\n        case LUA_OPMOD:  return luai_nummod(L, v1, v2);\n        default: lua_assert(0);\n    }\n};\n\nconst luaO_arith = function(L, op, p1, p2, p3) {\n    let res = (typeof p3 === \"number\") ? L.stack[p3] : p3;  /* FIXME */\n\n    switch (op) {\n        case LUA_OPBAND: case LUA_OPBOR: case LUA_OPBXOR:\n        case LUA_OPSHL: case LUA_OPSHR:\n        case LUA_OPBNOT: {  /* operate only on integers */\n            let i1, i2;\n            if ((i1 = lvm.tointeger(p1)) !== false && (i2 = lvm.tointeger(p2)) !== false) {\n                res.setivalue(intarith(L, op, i1, i2));\n                return;\n            }\n            else break;  /* go to the end */\n        }\n        case LUA_OPDIV: case LUA_OPPOW: {  /* operate only on floats */\n            let n1, n2;\n            if ((n1 = lvm.tonumber(p1)) !== false && (n2 = lvm.tonumber(p2)) !== false) {\n                res.setfltvalue(numarith(L, op, n1, n2));\n                return;\n            }\n            else break;  /* go to the end */\n        }\n        default: {  /* other operations */\n            let n1, n2;\n            if (p1.ttisinteger() && p2.ttisinteger()) {\n                res.setivalue(intarith(L, op, p1.value, p2.value));\n                return;\n            }\n            else if ((n1 = lvm.tonumber(p1)) !== false && (n2 = lvm.tonumber(p2)) !== false) {\n                res.setfltvalue(numarith(L, op, n1, n2));\n                return;\n            }\n            else break;  /* go to the end */\n        }\n    }\n    /* could not perform raw operation; try metamethod */\n    lua_assert(L !== null);  /* should not fail when folding (compile time) */\n    ltm.luaT_trybinTM(L, p1, p2, p3, (op - LUA_OPADD) + ltm.TMS.TM_ADD);\n};\n\n\nmodule.exports.CClosure          = CClosure;\nmodule.exports.LClosure          = LClosure;\nmodule.exports.LUA_TDEADKEY      = LUA_TDEADKEY;\nmodule.exports.LUA_TPROTO        = LUA_TPROTO;\nmodule.exports.LocVar            = LocVar;\nmodule.exports.TValue            = TValue;\nmodule.exports.Udata             = Udata;\nmodule.exports.UTF8BUFFSZ        = UTF8BUFFSZ;\nmodule.exports.luaO_arith        = luaO_arith;\nmodule.exports.luaO_chunkid      = luaO_chunkid;\nmodule.exports.luaO_hexavalue    = luaO_hexavalue;\nmodule.exports.luaO_int2fb       = luaO_int2fb;\nmodule.exports.luaO_pushfstring  = luaO_pushfstring;\nmodule.exports.luaO_pushvfstring = luaO_pushvfstring;\nmodule.exports.luaO_str2num      = luaO_str2num;\nmodule.exports.luaO_tostring     = luaO_tostring;\nmodule.exports.luaO_utf8esc      = luaO_utf8esc;\nmodule.exports.numarith          = numarith;\nmodule.exports.pushobj2s         = pushobj2s;\nmodule.exports.pushsvalue2s      = pushsvalue2s;\nmodule.exports.setobjs2s         = setobjs2s;\nmodule.exports.setobj2s          = setobj2s;\nmodule.exports.setsvalue2s       = setsvalue2s;\n","\"use strict\";\n\nconst OpCodes = [\n    \"MOVE\",\n    \"LOADK\",\n    \"LOADKX\",\n    \"LOADBOOL\",\n    \"LOADNIL\",\n    \"GETUPVAL\",\n    \"GETTABUP\",\n    \"GETTABLE\",\n    \"SETTABUP\",\n    \"SETUPVAL\",\n    \"SETTABLE\",\n    \"NEWTABLE\",\n    \"SELF\",\n    \"ADD\",\n    \"SUB\",\n    \"MUL\",\n    \"MOD\",\n    \"POW\",\n    \"DIV\",\n    \"IDIV\",\n    \"BAND\",\n    \"BOR\",\n    \"BXOR\",\n    \"SHL\",\n    \"SHR\",\n    \"UNM\",\n    \"BNOT\",\n    \"NOT\",\n    \"LEN\",\n    \"CONCAT\",\n    \"JMP\",\n    \"EQ\",\n    \"LT\",\n    \"LE\",\n    \"TEST\",\n    \"TESTSET\",\n    \"CALL\",\n    \"TAILCALL\",\n    \"RETURN\",\n    \"FORLOOP\",\n    \"FORPREP\",\n    \"TFORCALL\",\n    \"TFORLOOP\",\n    \"SETLIST\",\n    \"CLOSURE\",\n    \"VARARG\",\n    \"EXTRAARG\"\n];\n\nconst OpCodesI = {\n    OP_MOVE:     0,\n    OP_LOADK:    1,\n    OP_LOADKX:   2,\n    OP_LOADBOOL: 3,\n    OP_LOADNIL:  4,\n    OP_GETUPVAL: 5,\n    OP_GETTABUP: 6,\n    OP_GETTABLE: 7,\n    OP_SETTABUP: 8,\n    OP_SETUPVAL: 9,\n    OP_SETTABLE: 10,\n    OP_NEWTABLE: 11,\n    OP_SELF:     12,\n    OP_ADD:      13,\n    OP_SUB:      14,\n    OP_MUL:      15,\n    OP_MOD:      16,\n    OP_POW:      17,\n    OP_DIV:      18,\n    OP_IDIV:     19,\n    OP_BAND:     20,\n    OP_BOR:      21,\n    OP_BXOR:     22,\n    OP_SHL:      23,\n    OP_SHR:      24,\n    OP_UNM:      25,\n    OP_BNOT:     26,\n    OP_NOT:      27,\n    OP_LEN:      28,\n    OP_CONCAT:   29,\n    OP_JMP:      30,\n    OP_EQ:       31,\n    OP_LT:       32,\n    OP_LE:       33,\n    OP_TEST:     34,\n    OP_TESTSET:  35,\n    OP_CALL:     36,\n    OP_TAILCALL: 37,\n    OP_RETURN:   38,\n    OP_FORLOOP:  39,\n    OP_FORPREP:  40,\n    OP_TFORCALL: 41,\n    OP_TFORLOOP: 42,\n    OP_SETLIST:  43,\n    OP_CLOSURE:  44,\n    OP_VARARG:   45,\n    OP_EXTRAARG: 46\n};\n\n/*\n** masks for instruction properties. The format is:\n** bits 0-1: op mode\n** bits 2-3: C arg mode\n** bits 4-5: B arg mode\n** bit 6: instruction set register A\n** bit 7: operator is a test (next instruction must be a jump)\n*/\nconst OpArgN = 0;  /* argument is not used */\nconst OpArgU = 1;  /* argument is used */\nconst OpArgR = 2;  /* argument is a register or a jump offset */\nconst OpArgK = 3;  /* argument is a constant or register/constant */\n\n/* basic instruction format */\nconst iABC  = 0;\nconst iABx  = 1;\nconst iAsBx = 2;\nconst iAx   = 3;\n\nconst luaP_opmodes = [\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iABC,   /* OP_MOVE */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgN << 2 | iABx,   /* OP_LOADK */\n    0 << 7 | 1 << 6 | OpArgN << 4 | OpArgN << 2 | iABx,   /* OP_LOADKX */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgU << 2 | iABC,   /* OP_LOADBOOL */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgN << 2 | iABC,   /* OP_LOADNIL */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgN << 2 | iABC,   /* OP_GETUPVAL */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgK << 2 | iABC,   /* OP_GETTABUP */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgK << 2 | iABC,   /* OP_GETTABLE */\n    0 << 7 | 0 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_SETTABUP */\n    0 << 7 | 0 << 6 | OpArgU << 4 | OpArgN << 2 | iABC,   /* OP_SETUPVAL */\n    0 << 7 | 0 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_SETTABLE */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgU << 2 | iABC,   /* OP_NEWTABLE */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgK << 2 | iABC,   /* OP_SELF */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_ADD */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_SUB */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_MUL */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_MOD */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_POW */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_DIV */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_IDIV */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_BAND */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_BOR */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_BXOR */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_SHL */\n    0 << 7 | 1 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_SHR */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iABC,   /* OP_UNM */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iABC,   /* OP_BNOT */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iABC,   /* OP_NOT */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iABC,   /* OP_LEN */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgR << 2 | iABC,   /* OP_CONCAT */\n    0 << 7 | 0 << 6 | OpArgR << 4 | OpArgN << 2 | iAsBx,  /* OP_JMP */\n    1 << 7 | 0 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_EQ */\n    1 << 7 | 0 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_LT */\n    1 << 7 | 0 << 6 | OpArgK << 4 | OpArgK << 2 | iABC,   /* OP_LE */\n    1 << 7 | 0 << 6 | OpArgN << 4 | OpArgU << 2 | iABC,   /* OP_TEST */\n    1 << 7 | 1 << 6 | OpArgR << 4 | OpArgU << 2 | iABC,   /* OP_TESTSET */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgU << 2 | iABC,   /* OP_CALL */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgU << 2 | iABC,   /* OP_TAILCALL */\n    0 << 7 | 0 << 6 | OpArgU << 4 | OpArgN << 2 | iABC,   /* OP_RETURN */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iAsBx,  /* OP_FORLOOP */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iAsBx,  /* OP_FORPREP */\n    0 << 7 | 0 << 6 | OpArgN << 4 | OpArgU << 2 | iABC,   /* OP_TFORCALL */\n    0 << 7 | 1 << 6 | OpArgR << 4 | OpArgN << 2 | iAsBx,  /* OP_TFORLOOP */\n    0 << 7 | 0 << 6 | OpArgU << 4 | OpArgU << 2 | iABC,   /* OP_SETLIST */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgN << 2 | iABx,   /* OP_CLOSURE */\n    0 << 7 | 1 << 6 | OpArgU << 4 | OpArgN << 2 | iABC,   /* OP_VARARG */\n    0 << 7 | 0 << 6 | OpArgU << 4 | OpArgU << 2 | iAx     /* OP_EXTRAARG */\n];\n\nconst getOpMode = function(m) {\n    return luaP_opmodes[m] & 3;\n};\n\nconst getBMode = function(m) {\n    return (luaP_opmodes[m] >> 4) & 3;\n};\n\nconst getCMode = function(m) {\n    return (luaP_opmodes[m] >> 2) & 3;\n};\n\nconst testAMode = function(m) {\n    return luaP_opmodes[m] & (1 << 6);\n};\n\nconst testTMode = function(m) {\n    return luaP_opmodes[m] & (1 << 7);\n};\n\nconst SIZE_C     = 9;\nconst SIZE_B     = 9;\nconst SIZE_Bx    = (SIZE_C + SIZE_B);\nconst SIZE_A     = 8;\nconst SIZE_Ax    = (SIZE_C + SIZE_B + SIZE_A);\nconst SIZE_OP    = 6;\nconst POS_OP     = 0;\nconst POS_A      = (POS_OP + SIZE_OP);\nconst POS_C      = (POS_A + SIZE_A);\nconst POS_B      = (POS_C + SIZE_C);\nconst POS_Bx     = POS_C;\nconst POS_Ax     = POS_A;\nconst MAXARG_Bx  = ((1 << SIZE_Bx) - 1);\nconst MAXARG_sBx = (MAXARG_Bx >> 1); /* 'sBx' is signed */\nconst MAXARG_Ax  = ((1<<SIZE_Ax)-1);\nconst MAXARG_A   = ((1 << SIZE_A) - 1);\nconst MAXARG_B   = ((1 << SIZE_B) - 1);\nconst MAXARG_C   = ((1 << SIZE_C) - 1);\n\n/* this bit 1 means constant (0 means register) */\nconst BITRK      = (1 << (SIZE_B - 1));\n\nconst MAXINDEXRK = (BITRK - 1);\n\n/*\n** invalid register that fits in 8 bits\n*/\nconst NO_REG     = MAXARG_A;\n\n/* test whether value is a constant */\nconst ISK = function (x) {\n    return x & BITRK;\n};\n\n/* gets the index of the constant */\nconst INDEXK = function (r) {\n    return r & ~BITRK;\n};\n\n/* code a constant index as a RK value */\nconst RKASK = function(x) {\n    return x | BITRK;\n};\n\n\n/* creates a mask with 'n' 1 bits at position 'p' */\nconst MASK1 = function(n, p) {\n    return ((~((~0)<<(n)))<<(p));\n};\n\n/* creates a mask with 'n' 0 bits at position 'p' */\nconst MASK0 = function(n, p) {\n    return (~MASK1(n, p));\n};\n\nconst GET_OPCODE = function(i) {\n    return i.opcode;\n};\n\nconst SET_OPCODE = function(i, o) {\n    i.code = (i.code & MASK0(SIZE_OP, POS_OP)) | ((o << POS_OP) & MASK1(SIZE_OP, POS_OP));\n    return fullins(i);\n};\n\nconst setarg = function(i, v, pos, size) {\n    i.code = (i.code & MASK0(size, pos)) | ((v << pos) & MASK1(size, pos));\n    return fullins(i);\n};\n\nconst GETARG_A = function(i) {\n    return i.A;\n};\n\nconst SETARG_A = function(i,v) {\n    return setarg(i, v, POS_A, SIZE_A);\n};\n\nconst GETARG_B = function(i) {\n    return i.B;\n};\n\nconst SETARG_B = function(i,v) {\n    return setarg(i, v, POS_B, SIZE_B);\n};\n\nconst GETARG_C = function(i) {\n    return i.C;\n};\n\nconst SETARG_C = function(i,v) {\n    return setarg(i, v, POS_C, SIZE_C);\n};\n\nconst GETARG_Bx = function(i) {\n    return i.Bx;\n};\n\nconst SETARG_Bx = function(i,v) {\n    return setarg(i, v, POS_Bx, SIZE_Bx);\n};\n\nconst GETARG_Ax = function(i) {\n    return i.Ax;\n};\n\nconst SETARG_Ax = function(i,v) {\n    return setarg(i, v, POS_Ax, SIZE_Ax);\n};\n\nconst GETARG_sBx = function(i) {\n    return i.sBx;\n};\n\nconst SETARG_sBx = function(i, b) {\n    return SETARG_Bx(i, b + MAXARG_sBx);\n};\n\n/*\n** Pre-calculate all possible part of the instruction\n*/\nconst fullins = function(ins) {\n    if (typeof ins === \"number\") {\n        return {\n            code:   ins,\n            opcode: (ins >> POS_OP) & MASK1(SIZE_OP, 0),\n            A:      (ins >> POS_A)  & MASK1(SIZE_A,  0),\n            B:      (ins >> POS_B)  & MASK1(SIZE_B,  0),\n            C:      (ins >> POS_C)  & MASK1(SIZE_C,  0),\n            Bx:     (ins >> POS_Bx) & MASK1(SIZE_Bx, 0),\n            Ax:     (ins >> POS_Ax) & MASK1(SIZE_Ax, 0),\n            sBx:    ((ins >> POS_Bx) & MASK1(SIZE_Bx, 0)) - MAXARG_sBx\n        };\n    } else {\n        let i = ins.code;\n        ins.opcode = (i >> POS_OP) & MASK1(SIZE_OP, 0);\n        ins.A      = (i >> POS_A)  & MASK1(SIZE_A,  0);\n        ins.B      = (i >> POS_B)  & MASK1(SIZE_B,  0);\n        ins.C      = (i >> POS_C)  & MASK1(SIZE_C,  0);\n        ins.Bx     = (i >> POS_Bx) & MASK1(SIZE_Bx, 0);\n        ins.Ax     = (i >> POS_Ax) & MASK1(SIZE_Ax, 0);\n        ins.sBx    = ((i >> POS_Bx) & MASK1(SIZE_Bx, 0)) - MAXARG_sBx;\n        return ins;\n    }\n};\n\nconst CREATE_ABC = function(o, a, b, c) {\n    return fullins(o << POS_OP | a << POS_A | b << POS_B | c << POS_C);\n};\n\nconst CREATE_ABx = function(o, a, bc) {\n    return fullins(o << POS_OP | a << POS_A | bc << POS_Bx);\n};\n\nconst CREATE_Ax = function(o, a) {\n    return fullins(o << POS_OP | a << POS_Ax);\n};\n\n/* number of list items to accumulate before a SETLIST instruction */\nconst LFIELDS_PER_FLUSH = 50;\n\nmodule.exports.BITRK               = BITRK;\nmodule.exports.CREATE_ABC          = CREATE_ABC;\nmodule.exports.CREATE_ABx          = CREATE_ABx;\nmodule.exports.CREATE_Ax           = CREATE_Ax;\nmodule.exports.GET_OPCODE          = GET_OPCODE;\nmodule.exports.GETARG_A            = GETARG_A;\nmodule.exports.GETARG_B            = GETARG_B;\nmodule.exports.GETARG_C            = GETARG_C;\nmodule.exports.GETARG_Bx           = GETARG_Bx;\nmodule.exports.GETARG_Ax           = GETARG_Ax;\nmodule.exports.GETARG_sBx          = GETARG_sBx;\nmodule.exports.INDEXK              = INDEXK;\nmodule.exports.ISK                 = ISK;\nmodule.exports.LFIELDS_PER_FLUSH   = LFIELDS_PER_FLUSH;\nmodule.exports.MAXARG_A            = MAXARG_A;\nmodule.exports.MAXARG_Ax           = MAXARG_Ax;\nmodule.exports.MAXARG_B            = MAXARG_B;\nmodule.exports.MAXARG_Bx           = MAXARG_Bx;\nmodule.exports.MAXARG_C            = MAXARG_C;\nmodule.exports.MAXARG_sBx          = MAXARG_sBx;\nmodule.exports.MAXINDEXRK          = MAXINDEXRK;\nmodule.exports.NO_REG              = NO_REG;\nmodule.exports.OpArgK              = OpArgK;\nmodule.exports.OpArgN              = OpArgN;\nmodule.exports.OpArgR              = OpArgR;\nmodule.exports.OpArgU              = OpArgU;\nmodule.exports.OpCodes             = OpCodes;\nmodule.exports.OpCodesI            = OpCodesI;\nmodule.exports.POS_A               = POS_A;\nmodule.exports.POS_Ax              = POS_Ax;\nmodule.exports.POS_B               = POS_B;\nmodule.exports.POS_Bx              = POS_Bx;\nmodule.exports.POS_C               = POS_C;\nmodule.exports.POS_OP              = POS_OP;\nmodule.exports.RKASK               = RKASK;\nmodule.exports.SETARG_A            = SETARG_A;\nmodule.exports.SETARG_Ax           = SETARG_Ax;\nmodule.exports.SETARG_B            = SETARG_B;\nmodule.exports.SETARG_Bx           = SETARG_Bx;\nmodule.exports.SETARG_C            = SETARG_C;\nmodule.exports.SETARG_sBx          = SETARG_sBx;\nmodule.exports.SET_OPCODE          = SET_OPCODE;\nmodule.exports.SIZE_A              = SIZE_A;\nmodule.exports.SIZE_Ax             = SIZE_Ax;\nmodule.exports.SIZE_B              = SIZE_B;\nmodule.exports.SIZE_Bx             = SIZE_Bx;\nmodule.exports.SIZE_C              = SIZE_C;\nmodule.exports.SIZE_OP             = SIZE_OP;\nmodule.exports.fullins             = fullins;\nmodule.exports.getBMode            = getBMode;\nmodule.exports.getCMode            = getCMode;\nmodule.exports.getOpMode           = getOpMode;\nmodule.exports.iABC                = iABC;\nmodule.exports.iABx                = iABx;\nmodule.exports.iAsBx               = iAsBx;\nmodule.exports.iAx                 = iAx;\nmodule.exports.testAMode           = testAMode;\nmodule.exports.testTMode           = testTMode;\n","\"use strict\";\n\nconst {\n    LUA_MULTRET,\n    to_luastring\n} = require('./defs.js');\nconst {\n    BinOpr: {\n        OPR_ADD,\n        OPR_AND,\n        OPR_BAND,\n        OPR_BOR,\n        OPR_BXOR,\n        OPR_CONCAT,\n        OPR_DIV,\n        OPR_EQ,\n        OPR_GE,\n        OPR_GT,\n        OPR_IDIV,\n        OPR_LE,\n        OPR_LT,\n        OPR_MOD,\n        OPR_MUL,\n        OPR_NE,\n        OPR_NOBINOPR,\n        OPR_OR,\n        OPR_POW,\n        OPR_SHL,\n        OPR_SHR,\n        OPR_SUB\n    },\n    UnOpr: {\n        OPR_BNOT,\n        OPR_LEN,\n        OPR_MINUS,\n        OPR_NOT,\n        OPR_NOUNOPR\n    },\n    NO_JUMP,\n    getinstruction,\n    luaK_checkstack,\n    luaK_codeABC,\n    luaK_codeABx,\n    luaK_codeAsBx,\n    luaK_codek,\n    luaK_concat,\n    luaK_dischargevars,\n    luaK_exp2RK,\n    luaK_exp2anyreg,\n    luaK_exp2anyregup,\n    luaK_exp2nextreg,\n    luaK_exp2val,\n    luaK_fixline,\n    luaK_getlabel,\n    luaK_goiffalse,\n    luaK_goiftrue,\n    luaK_indexed,\n    luaK_infix,\n    luaK_intK,\n    luaK_jump,\n    luaK_jumpto,\n    luaK_nil,\n    luaK_patchclose,\n    luaK_patchlist,\n    luaK_patchtohere,\n    luaK_posfix,\n    luaK_prefix,\n    luaK_reserveregs,\n    luaK_ret,\n    luaK_self,\n    luaK_setlist,\n    luaK_setmultret,\n    luaK_setoneret,\n    luaK_setreturns,\n    luaK_storevar,\n    luaK_stringK\n} = require('./lcode.js');\nconst ldo      = require('./ldo.js');\nconst lfunc    = require('./lfunc.js');\nconst llex     = require('./llex.js');\nconst {\n    LUAI_MAXCCALLS,\n    MAX_INT,\n    lua_assert\n}  = require('./llimits.js');\nconst lobject  = require('./lobject.js');\nconst {\n    OpCodesI: {\n        OP_CALL,\n        OP_CLOSURE,\n        OP_FORLOOP,\n        OP_FORPREP,\n        OP_GETUPVAL,\n        OP_MOVE,\n        OP_NEWTABLE,\n        OP_SETTABLE,\n        OP_TAILCALL,\n        OP_TFORCALL,\n        OP_TFORLOOP,\n        OP_VARARG\n    },\n    LFIELDS_PER_FLUSH,\n    SETARG_B,\n    SETARG_C,\n    SET_OPCODE\n} = require('./lopcodes.js');\nconst {\n    luaS_eqlngstr,\n    luaS_new,\n    luaS_newliteral\n} = require('./lstring.js');\nconst ltable   = require('./ltable.js');\nconst Proto    = lfunc.Proto;\nconst R        = llex.RESERVED;\n\nconst MAXVARS = 200;\n\nconst hasmultret = function(k) {\n    return k === expkind.VCALL || k === expkind.VVARARG;\n};\n\nconst eqstr = function(a, b) {\n    /* TODO: use plain equality as strings are cached */\n    return luaS_eqlngstr(a, b);\n};\n\nclass BlockCnt {\n    constructor() {\n        this.previous = null;  /* chain */\n        this.firstlabel = NaN; /* index of first label in this block */\n        this.firstgoto = NaN;  /* index of first pending goto in this block */\n        this.nactvar = NaN;    /* # active locals outside the block */\n        this.upval = NaN;      /* true if some variable in the block is an upvalue */\n        this.isloop = NaN;     /* true if 'block' is a loop */\n    }\n}\n\nconst expkind = {\n    VVOID: 0,        /* when 'expdesc' describes the last expression a list,\n                        this kind means an empty list (so, no expression) */\n    VNIL: 1,         /* constant nil */\n    VTRUE: 2,        /* constant true */\n    VFALSE: 3,       /* constant false */\n    VK: 4,           /* constant in 'k'; info = index of constant in 'k' */\n    VKFLT: 5,        /* floating constant; nval = numerical float value */\n    VKINT: 6,        /* integer constant; nval = numerical integer value */\n    VNONRELOC: 7,    /* expression has its value in a fixed register;\n                        info = result register */\n    VLOCAL: 8,       /* local variable; info = local register */\n    VUPVAL: 9,       /* upvalue variable; info = index of upvalue in 'upvalues' */\n    VINDEXED: 10,    /* indexed variable;\n                        ind.vt = whether 't' is register or upvalue;\n                        ind.t = table register or upvalue;\n                        ind.idx = key's R/K index */\n    VJMP: 11,        /* expression is a test/comparison;\n                        info = pc of corresponding jump instruction */\n    VRELOCABLE: 12,  /* expression can put result in any register;\n                        info = instruction pc */\n    VCALL: 13,       /* expression is a function call; info = instruction pc */\n    VVARARG: 14      /* vararg expression; info = instruction pc */\n};\n\nconst vkisvar = function(k) {\n    return expkind.VLOCAL <= k && k <= expkind.VINDEXED;\n};\n\nconst vkisinreg = function(k) {\n    return k === expkind.VNONRELOC || k === expkind.VLOCAL;\n};\n\nclass expdesc {\n    constructor() {\n        this.k = NaN;\n        this.u = {\n            ival: NaN,    /* for VKINT */\n            nval: NaN,    /* for VKFLT */\n            info: NaN,    /* for generic use */\n            ind: {        /* for indexed variables (VINDEXED) */\n                idx: NaN, /* index (R/K) */\n                t: NaN,   /* table (register or upvalue) */\n                vt: NaN   /* whether 't' is register (VLOCAL) or upvalue (VUPVAL) */\n            }\n        };\n        this.t = NaN;     /* patch list of 'exit when true' */\n        this.f = NaN;     /* patch list of 'exit when false' */\n    }\n\n    to(e) { // Copy e content to this, cf. luaK_posfix\n        this.k = e.k;\n        this.u = e.u;\n        this.t = e.t;\n        this.f = e.f;\n    }\n}\n\nclass FuncState {\n    constructor() {\n        this.f = null;         /* current function header */\n        this.prev = null;      /* enclosing function */\n        this.ls = null;        /* lexical state */\n        this.bl = null;        /* chain of current blocks */\n        this.pc = NaN;         /* next position to code (equivalent to 'ncode') */\n        this.lasttarget = NaN; /* 'label' of last 'jump label' */\n        this.jpc = NaN;        /* list of pending jumps to 'pc' */\n        this.nk = NaN;         /* number of elements in 'k' */\n        this.np = NaN;         /* number of elements in 'p' */\n        this.firstlocal = NaN; /* index of first local var (in Dyndata array) */\n        this.nlocvars = NaN;   /* number of elements in 'f->locvars' */\n        this.nactvar = NaN;    /* number of active local variables */\n        this.nups = NaN;       /* number of upvalues */\n        this.freereg = NaN;    /* first free register */\n    }\n}\n\n/* description of active local variable */\nclass Vardesc {\n    constructor() {\n        this.idx = NaN;  /* variable index in stack */\n    }\n}\n\n\n/* description of pending goto statements and label statements */\nclass Labeldesc {\n    constructor() {\n        this.name = null;  /* label identifier */\n        this.pc = NaN;  /* position in code */\n        this.line = NaN;  /* line where it appeared */\n        this.nactvar = NaN;  /* local level where it appears in current block */\n    }\n}\n\n\n/* list of labels or gotos */\nclass Labellist {\n    constructor() {\n        this.arr = []; /* array */\n        this.n = NaN;  /* number of entries in use */\n        this.size = NaN;  /* array size */\n    }\n}\n\n/* dynamic structures used by the parser */\nclass Dyndata {\n    constructor() {\n        this.actvar = {  /* list of active local variables */\n            arr: [],\n            n: NaN,\n            size: NaN\n        };\n        this.gt = new Labellist();\n        this.label = new Labellist();\n    }\n}\n\nconst semerror = function(ls, msg) {\n    ls.t.token = 0;  /* remove \"near <token>\" from final message */\n    llex.luaX_syntaxerror(ls, msg);\n};\n\nconst error_expected = function(ls, token) {\n    llex.luaX_syntaxerror(ls, lobject.luaO_pushfstring(ls.L, to_luastring(\"%s expected\", true), llex.luaX_token2str(ls, token)));\n};\n\nconst errorlimit = function(fs, limit, what) {\n    let L = fs.ls.L;\n    let line = fs.f.linedefined;\n    let where = (line === 0)\n        ? to_luastring(\"main function\", true)\n        : lobject.luaO_pushfstring(L, to_luastring(\"function at line %d\", true), line);\n    let msg = lobject.luaO_pushfstring(L, to_luastring(\"too many %s (limit is %d) in %s\", true),\n        what, limit, where);\n    llex.luaX_syntaxerror(fs.ls, msg);\n};\n\nconst checklimit = function(fs, v, l, what) {\n    if (v > l) errorlimit(fs, l, what);\n};\n\nconst testnext = function(ls, c) {\n    if (ls.t.token === c) {\n        llex.luaX_next(ls);\n        return true;\n    }\n\n    return false;\n};\n\nconst check = function(ls, c) {\n    if (ls.t.token !== c)\n        error_expected(ls, c);\n};\n\nconst checknext = function(ls, c) {\n    check(ls, c);\n    llex.luaX_next(ls);\n};\n\nconst check_condition = function(ls, c, msg) {\n    if (!c)\n        llex.luaX_syntaxerror(ls, msg);\n};\n\nconst check_match = function(ls, what, who, where) {\n    if (!testnext(ls, what)) {\n        if (where === ls.linenumber)\n            error_expected(ls, what);\n        else\n            llex.luaX_syntaxerror(ls, lobject.luaO_pushfstring(ls.L,\n                to_luastring(\"%s expected (to close %s at line %d)\"),\n                llex.luaX_token2str(ls, what), llex.luaX_token2str(ls, who), where));\n    }\n};\n\nconst str_checkname = function(ls) {\n    check(ls, R.TK_NAME);\n    let ts = ls.t.seminfo.ts;\n    llex.luaX_next(ls);\n    return ts;\n};\n\nconst init_exp = function(e, k, i) {\n    e.f = e.t = NO_JUMP;\n    e.k = k;\n    e.u.info = i;\n};\n\nconst codestring = function(ls, e, s) {\n    init_exp(e, expkind.VK, luaK_stringK(ls.fs, s));\n};\n\nconst checkname = function(ls, e) {\n    codestring(ls, e, str_checkname(ls));\n};\n\nconst registerlocalvar = function(ls, varname) {\n    let fs = ls.fs;\n    let f = fs.f;\n    f.locvars[fs.nlocvars] = new lobject.LocVar();\n    f.locvars[fs.nlocvars].varname = varname;\n    return fs.nlocvars++;\n};\n\nconst new_localvar = function(ls, name) {\n    let fs = ls.fs;\n    let dyd = ls.dyd;\n    let reg = registerlocalvar(ls, name);\n    checklimit(fs, dyd.actvar.n + 1 - fs.firstlocal, MAXVARS, to_luastring(\"local variables\", true));\n    dyd.actvar.arr[dyd.actvar.n] = new Vardesc();\n    dyd.actvar.arr[dyd.actvar.n].idx = reg;\n    dyd.actvar.n++;\n};\n\nconst new_localvarliteral = function(ls, name) {\n    new_localvar(ls, llex.luaX_newstring(ls, to_luastring(name, true)));\n};\n\nconst getlocvar = function(fs, i) {\n    let idx = fs.ls.dyd.actvar.arr[fs.firstlocal + i].idx;\n    lua_assert(idx < fs.nlocvars);\n    return fs.f.locvars[idx];\n};\n\nconst adjustlocalvars = function(ls, nvars) {\n    let fs = ls.fs;\n    fs.nactvar = fs.nactvar + nvars;\n    for (; nvars; nvars--)\n        getlocvar(fs, fs.nactvar - nvars).startpc = fs.pc;\n};\n\nconst removevars = function(fs, tolevel) {\n    fs.ls.dyd.actvar.n -= fs.nactvar - tolevel;\n    while (fs.nactvar > tolevel)\n        getlocvar(fs, --fs.nactvar).endpc = fs.pc;\n};\n\nconst searchupvalue = function(fs, name) {\n    let up = fs.f.upvalues;\n    for (let i = 0; i < fs.nups; i++) {\n        if (eqstr(up[i].name, name))\n            return i;\n    }\n    return -1;  /* not found */\n};\n\nconst newupvalue = function(fs, name, v) {\n    let f = fs.f;\n    checklimit(fs, fs.nups + 1, lfunc.MAXUPVAL, to_luastring(\"upvalues\", true));\n    f.upvalues[fs.nups] = {\n        instack: v.k === expkind.VLOCAL,\n        idx: v.u.info,\n        name: name\n    };\n    return fs.nups++;\n};\n\nconst searchvar = function(fs, n) {\n    for (let i = fs.nactvar - 1; i >= 0; i--) {\n        if (eqstr(n, getlocvar(fs, i).varname))\n            return i;\n    }\n\n    return -1;\n};\n\n/*\n** Mark block where variable at given level was defined\n** (to emit close instructions later).\n*/\nconst markupval = function(fs, level) {\n    let bl = fs.bl;\n    while (bl.nactvar > level)\n        bl = bl.previous;\n    bl.upval = 1;\n};\n\n/*\n** Find variable with given name 'n'. If it is an upvalue, add this\n** upvalue into all intermediate functions.\n*/\nconst singlevaraux = function(fs, n, vr, base) {\n    if (fs === null)  /* no more levels? */\n        init_exp(vr, expkind.VVOID, 0);  /* default is global */\n    else {\n        let v = searchvar(fs, n);  /* look up locals at current level */\n        if (v >= 0) {  /* found? */\n            init_exp(vr, expkind.VLOCAL, v);  /* variable is local */\n            if (!base)\n                markupval(fs, v);  /* local will be used as an upval */\n        } else {  /* not found as local at current level; try upvalues */\n            let idx = searchupvalue(fs, n);  /* try existing upvalues */\n            if (idx < 0) {  /* not found? */\n                singlevaraux(fs.prev, n, vr, 0);  /* try upper levels */\n                if (vr.k === expkind.VVOID)  /* not found? */\n                    return;  /* it is a global */\n                /* else was LOCAL or UPVAL */\n                idx = newupvalue(fs, n, vr);  /* will be a new upvalue */\n            }\n            init_exp(vr, expkind.VUPVAL, idx);  /* new or old upvalue */\n        }\n    }\n};\n\nconst singlevar = function(ls, vr) {\n    let varname = str_checkname(ls);\n    let fs = ls.fs;\n    singlevaraux(fs, varname, vr, 1);\n    if (vr.k === expkind.VVOID) {  /* is global name? */\n        let key = new expdesc();\n        singlevaraux(fs, ls.envn, vr, 1);  /* get environment variable */\n        lua_assert(vr.k !== expkind.VVOID);  /* this one must exist */\n        codestring(ls, key, varname);  /* key is variable name */\n        luaK_indexed(fs, vr, key);  /* env[varname] */\n    }\n};\n\nconst adjust_assign = function(ls, nvars, nexps, e) {\n    let fs = ls.fs;\n    let extra = nvars - nexps;\n    if (hasmultret(e.k)) {\n        extra++;  /* includes call itself */\n        if (extra < 0) extra = 0;\n        luaK_setreturns(fs, e, extra);  /* last exp. provides the difference */\n        if (extra > 1) luaK_reserveregs(fs, extra - 1);\n    } else {\n        if (e.k !== expkind.VVOID) luaK_exp2nextreg(fs, e);  /* close last expression */\n        if (extra > 0) {\n            let reg = fs.freereg;\n            luaK_reserveregs(fs, extra);\n            luaK_nil(fs, reg, extra);\n        }\n    }\n    if (nexps > nvars)\n        ls.fs.freereg -= nexps - nvars;  /* remove extra values */\n};\n\nconst enterlevel = function(ls) {\n    let L = ls.L;\n    ++L.nCcalls;\n    checklimit(ls.fs, L.nCcalls, LUAI_MAXCCALLS, to_luastring(\"JS levels\", true));\n};\n\nconst leavelevel = function(ls) {\n    return ls.L.nCcalls--;\n};\n\nconst closegoto = function(ls, g, label) {\n    let fs = ls.fs;\n    let gl = ls.dyd.gt;\n    let gt = gl.arr[g];\n    lua_assert(eqstr(gt.name, label.name));\n    if (gt.nactvar < label.nactvar) {\n        let vname = getlocvar(fs, gt.nactvar).varname;\n        let msg = lobject.luaO_pushfstring(ls.L,\n            to_luastring(\"<goto %s> at line %d jumps into the scope of local '%s'\"),\n            gt.name.getstr(), gt.line, vname.getstr());\n        semerror(ls, msg);\n    }\n    luaK_patchlist(fs, gt.pc, label.pc);\n    /* remove goto from pending list */\n    for (let i = g; i < gl.n - 1; i++)\n        gl.arr[i] = gl.arr[i + 1];\n    gl.n--;\n};\n\n/*\n** try to close a goto with existing labels; this solves backward jumps\n*/\nconst findlabel = function(ls, g) {\n    let bl = ls.fs.bl;\n    let dyd = ls.dyd;\n    let gt = dyd.gt.arr[g];\n    /* check labels in current block for a match */\n    for (let i = bl.firstlabel; i < dyd.label.n; i++) {\n        let lb = dyd.label.arr[i];\n        if (eqstr(lb.name, gt.name)) {  /* correct label? */\n            if (gt.nactvar > lb.nactvar && (bl.upval || dyd.label.n > bl.firstlabel))\n                luaK_patchclose(ls.fs, gt.pc, lb.nactvar);\n            closegoto(ls, g, lb);  /* close it */\n            return true;\n        }\n    }\n    return false;  /* label not found; cannot close goto */\n};\n\nconst newlabelentry = function(ls, l, name, line, pc) {\n    let n = l.n;\n    l.arr[n] = new Labeldesc();\n    l.arr[n].name = name;\n    l.arr[n].line = line;\n    l.arr[n].nactvar = ls.fs.nactvar;\n    l.arr[n].pc = pc;\n    l.n = n + 1;\n    return n;\n};\n\n/*\n** check whether new label 'lb' matches any pending gotos in current\n** block; solves forward jumps\n*/\nconst findgotos = function(ls, lb) {\n    let gl = ls.dyd.gt;\n    let i = ls.fs.bl.firstgoto;\n    while (i < gl.n) {\n        if (eqstr(gl.arr[i].name, lb.name))\n            closegoto(ls, i, lb);\n        else\n            i++;\n    }\n};\n\n/*\n** export pending gotos to outer level, to check them against\n** outer labels; if the block being exited has upvalues, and\n** the goto exits the scope of any variable (which can be the\n** upvalue), close those variables being exited.\n*/\nconst movegotosout = function(fs, bl) {\n    let i = bl.firstgoto;\n    let gl = fs.ls.dyd.gt;\n    /* correct pending gotos to current block and try to close it\n       with visible labels */\n    while (i < gl.n) {\n        let gt = gl.arr[i];\n        if (gt.nactvar > bl.nactvar) {\n            if (bl.upval)\n                luaK_patchclose(fs, gt.pc, bl.nactvar);\n            gt.nactvar = bl.nactvar;\n        }\n        if (!findlabel(fs.ls, i))\n            i++;  /* move to next one */\n    }\n};\n\nconst enterblock = function(fs, bl, isloop) {\n    bl.isloop = isloop;\n    bl.nactvar = fs.nactvar;\n    bl.firstlabel = fs.ls.dyd.label.n;\n    bl.firstgoto = fs.ls.dyd.gt.n;\n    bl.upval = 0;\n    bl.previous = fs.bl;\n    fs.bl = bl;\n    lua_assert(fs.freereg === fs.nactvar);\n};\n\n/*\n** create a label named 'break' to resolve break statements\n*/\nconst breaklabel = function(ls) {\n    let n = luaS_newliteral(ls.L, \"break\");\n    let l = newlabelentry(ls, ls.dyd.label, n, 0, ls.fs.pc);\n    findgotos(ls, ls.dyd.label.arr[l]);\n};\n\n/*\n** generates an error for an undefined 'goto'; choose appropriate\n** message when label name is a reserved word (which can only be 'break')\n*/\nconst undefgoto = function(ls, gt) {\n    let msg = llex.isreserved(gt.name)\n        ? \"<%s> at line %d not inside a loop\"\n        : \"no visible label '%s' for <goto> at line %d\";\n    msg = lobject.luaO_pushfstring(ls.L, to_luastring(msg), gt.name.getstr(), gt.line);\n    semerror(ls, msg);\n};\n\n/*\n** adds a new prototype into list of prototypes\n*/\nconst addprototype = function(ls) {\n    let L = ls.L;\n    let clp = new Proto(L);\n    let fs = ls.fs;\n    let f = fs.f;  /* prototype of current function */\n    f.p[fs.np++] = clp;\n    return clp;\n};\n\n/*\n** codes instruction to create new closure in parent function.\n*/\nconst codeclosure = function(ls, v) {\n    let fs = ls.fs.prev;\n    init_exp(v, expkind.VRELOCABLE, luaK_codeABx(fs, OP_CLOSURE, 0, fs.np -1));\n    luaK_exp2nextreg(fs, v);  /* fix it at the last register */\n};\n\nconst open_func = function(ls, fs, bl) {\n    fs.prev = ls.fs;  /* linked list of funcstates */\n    fs.ls = ls;\n    ls.fs = fs;\n    fs.pc = 0;\n    fs.lasttarget = 0;\n    fs.jpc = NO_JUMP;\n    fs.freereg = 0;\n    fs.nk = 0;\n    fs.np = 0;\n    fs.nups = 0;\n    fs.nlocvars = 0;\n    fs.nactvar = 0;\n    fs.firstlocal = ls.dyd.actvar.n;\n    fs.bl = null;\n    let f = fs.f;\n    f.source = ls.source;\n    f.maxstacksize = 2;  /* registers 0/1 are always valid */\n    enterblock(fs, bl, false);\n};\n\nconst leaveblock = function(fs) {\n    let bl = fs.bl;\n    let ls = fs.ls;\n    if (bl.previous && bl.upval) {\n        /* create a 'jump to here' to close upvalues */\n        let j = luaK_jump(fs);\n        luaK_patchclose(fs, j , bl.nactvar);\n        luaK_patchtohere(fs, j);\n    }\n\n    if (bl.isloop)\n        breaklabel(ls);  /* close pending breaks */\n\n    fs.bl = bl.previous;\n    removevars(fs, bl.nactvar);\n    lua_assert(bl.nactvar === fs.nactvar);\n    fs.freereg = fs.nactvar;  /* free registers */\n    ls.dyd.label.n = bl.firstlabel;  /* remove local labels */\n    if (bl.previous)  /* inner block? */\n        movegotosout(fs, bl);  /* update pending gotos to outer block */\n    else if (bl.firstgoto < ls.dyd.gt.n)  /* pending gotos in outer block? */\n        undefgoto(ls, ls.dyd.gt.arr[bl.firstgoto]);  /* error */\n};\n\nconst close_func = function(ls) {\n    let fs = ls.fs;\n    luaK_ret(fs, 0, 0);  /* final return */\n    leaveblock(fs);\n    lua_assert(fs.bl === null);\n    ls.fs = fs.prev;\n};\n\n/*============================================================*/\n/* GRAMMAR RULES */\n/*============================================================*/\n\nconst block_follow = function(ls, withuntil) {\n    switch (ls.t.token) {\n        case R.TK_ELSE: case R.TK_ELSEIF:\n        case R.TK_END: case R.TK_EOS:\n            return true;\n        case R.TK_UNTIL: return withuntil;\n        default: return false;\n    }\n};\n\nconst statlist = function(ls) {\n    /* statlist -> { stat [';'] } */\n    while (!block_follow(ls, 1)) {\n        if (ls.t.token === R.TK_RETURN) {\n            statement(ls);\n            return;  /* 'return' must be last statement */\n        }\n        statement(ls);\n    }\n};\n\nconst fieldsel = function(ls, v) {\n    /* fieldsel -> ['.' | ':'] NAME */\n    let fs = ls.fs;\n    let key = new expdesc();\n    luaK_exp2anyregup(fs, v);\n    llex.luaX_next(ls);  /* skip the dot or colon */\n    checkname(ls, key);\n    luaK_indexed(fs, v, key);\n};\n\nconst yindex = function(ls, v) {\n    /* index -> '[' expr ']' */\n    llex.luaX_next(ls);  /* skip the '[' */\n    expr(ls, v);\n    luaK_exp2val(ls.fs, v);\n    checknext(ls, 93 /* (']').charCodeAt(0) */);\n};\n\n/*\n** {======================================================================\n** Rules for Constructors\n** =======================================================================\n*/\n\nclass ConsControl {\n    constructor() {\n        this.v = new expdesc(); /* last list item read */\n        this.t = new expdesc(); /* table descriptor */\n        this.nh = NaN;          /* total number of 'record' elements */\n        this.na = NaN;          /* total number of array elements */\n        this.tostore = NaN;     /* number of array elements pending to be stored */\n    }\n}\n\nconst recfield = function(ls, cc) {\n    /* recfield -> (NAME | '['exp1']') = exp1 */\n    let fs = ls.fs;\n    let reg = ls.fs.freereg;\n    let key = new expdesc();\n    let val = new expdesc();\n\n    if (ls.t.token === R.TK_NAME) {\n        checklimit(fs, cc.nh, MAX_INT, to_luastring(\"items in a constructor\", true));\n        checkname(ls, key);\n    } else  /* ls->t.token === '[' */\n        yindex(ls, key);\n    cc.nh++;\n    checknext(ls, 61 /* ('=').charCodeAt(0) */);\n    let rkkey = luaK_exp2RK(fs, key);\n    expr(ls, val);\n    luaK_codeABC(fs, OP_SETTABLE, cc.t.u.info, rkkey, luaK_exp2RK(fs, val));\n    fs.freereg = reg;  /* free registers */\n};\n\nconst closelistfield = function(fs, cc) {\n    if (cc.v.k === expkind.VVOID) return;  /* there is no list item */\n    luaK_exp2nextreg(fs, cc.v);\n    cc.v.k = expkind.VVOID;\n    if (cc.tostore === LFIELDS_PER_FLUSH) {\n        luaK_setlist(fs, cc.t.u.info, cc.na, cc.tostore);  /* flush */\n        cc.tostore = 0;  /* no more items pending */\n    }\n};\n\nconst lastlistfield = function(fs, cc) {\n    if (cc.tostore === 0) return;\n    if (hasmultret(cc.v.k)) {\n        luaK_setmultret(fs, cc.v);\n        luaK_setlist(fs, cc.t.u.info, cc.na, LUA_MULTRET);\n        cc.na--;  /* do not count last expression (unknown number of elements) */\n    } else {\n        if (cc.v.k !== expkind.VVOID)\n            luaK_exp2nextreg(fs, cc.v);\n        luaK_setlist(fs, cc.t.u.info, cc.na, cc.tostore);\n    }\n};\n\nconst listfield = function(ls, cc) {\n    /* listfield -> exp */\n    expr(ls, cc.v);\n    checklimit(ls.fs, cc.na, MAX_INT, to_luastring(\"items in a constructor\", true));\n    cc.na++;\n    cc.tostore++;\n};\n\nconst field = function(ls, cc) {\n    /* field -> listfield | recfield */\n    switch (ls.t.token) {\n        case R.TK_NAME: {  /* may be 'listfield' or 'recfield' */\n            if (llex.luaX_lookahead(ls) !== 61 /* ('=').charCodeAt(0) */)  /* expression? */\n                listfield(ls, cc);\n            else\n                recfield(ls, cc);\n            break;\n        }\n        case 91 /* ('[').charCodeAt(0) */: {\n            recfield(ls, cc);\n            break;\n        }\n        default: {\n            listfield(ls, cc);\n            break;\n        }\n    }\n};\n\nconst constructor = function(ls, t) {\n    /* constructor -> '{' [ field { sep field } [sep] ] '}'\n       sep -> ',' | ';' */\n    let fs = ls.fs;\n    let line = ls.linenumber;\n    let pc = luaK_codeABC(fs, OP_NEWTABLE, 0, 0, 0);\n    let cc = new ConsControl();\n    cc.na = cc.nh = cc.tostore = 0;\n    cc.t = t;\n    init_exp(t, expkind.VRELOCABLE, pc);\n    init_exp(cc.v, expkind.VVOID, 0);  /* no value (yet) */\n    luaK_exp2nextreg(ls.fs, t);  /* fix it at stack top */\n    checknext(ls, 123 /* ('{').charCodeAt(0) */);\n    do {\n        lua_assert(cc.v.k === expkind.VVOID || cc.tostore > 0);\n        if (ls.t.token === 125 /* ('}').charCodeAt(0) */) break;\n        closelistfield(fs, cc);\n        field(ls, cc);\n    } while (testnext(ls, 44 /* (',').charCodeAt(0) */) || testnext(ls, 59 /* (';').charCodeAt(0) */));\n    check_match(ls, 125 /* ('}').charCodeAt(0) */, 123 /* ('{').charCodeAt(0) */, line);\n    lastlistfield(fs, cc);\n    SETARG_B(fs.f.code[pc], lobject.luaO_int2fb(cc.na));  /* set initial array size */\n    SETARG_C(fs.f.code[pc], lobject.luaO_int2fb(cc.nh));  /* set initial table size */\n};\n\n/* }====================================================================== */\n\nconst parlist = function(ls) {\n    /* parlist -> [ param { ',' param } ] */\n    let fs = ls.fs;\n    let f = fs.f;\n    let nparams = 0;\n    f.is_vararg = false;\n    if (ls.t.token !== 41 /* (')').charCodeAt(0) */) {  /* is 'parlist' not empty? */\n        do {\n            switch (ls.t.token) {\n                case R.TK_NAME: {  /* param -> NAME */\n                    new_localvar(ls, str_checkname(ls));\n                    nparams++;\n                    break;\n                }\n                case R.TK_DOTS: {  /* param -> '...' */\n                    llex.luaX_next(ls);\n                    f.is_vararg = true;  /* declared vararg */\n                    break;\n                }\n                default: llex.luaX_syntaxerror(ls, to_luastring(\"<name> or '...' expected\", true));\n            }\n        } while(!f.is_vararg && testnext(ls, 44 /* (',').charCodeAt(0) */));\n    }\n    adjustlocalvars(ls, nparams);\n    f.numparams = fs.nactvar;\n    luaK_reserveregs(fs, fs.nactvar);  /* reserve register for parameters */\n};\n\nconst body = function(ls, e, ismethod, line) {\n    /* body ->  '(' parlist ')' block END */\n    let new_fs = new FuncState();\n    let bl = new BlockCnt();\n    new_fs.f = addprototype(ls);\n    new_fs.f.linedefined = line;\n    open_func(ls, new_fs, bl);\n    checknext(ls, 40 /* ('(').charCodeAt(0) */);\n    if (ismethod) {\n        new_localvarliteral(ls, \"self\");  /* create 'self' parameter */\n        adjustlocalvars(ls, 1);\n    }\n    parlist(ls);\n    checknext(ls, 41 /* (')').charCodeAt(0) */);\n    statlist(ls);\n    new_fs.f.lastlinedefined = ls.linenumber;\n    check_match(ls, R.TK_END, R.TK_FUNCTION, line);\n    codeclosure(ls, e);\n    close_func(ls);\n};\n\nconst explist = function(ls, v) {\n    /* explist -> expr { ',' expr } */\n    let n = 1;  /* at least one expression */\n    expr(ls, v);\n    while (testnext(ls, 44 /* (',').charCodeAt(0) */)) {\n        luaK_exp2nextreg(ls.fs, v);\n        expr(ls, v);\n        n++;\n    }\n    return n;\n};\n\nconst funcargs = function(ls, f, line) {\n    let fs = ls.fs;\n    let args = new expdesc();\n    switch (ls.t.token) {\n        case 40 /* ('(').charCodeAt(0) */: {  /* funcargs -> '(' [ explist ] ')' */\n            llex.luaX_next(ls);\n            if (ls.t.token === 41 /* (')').charCodeAt(0) */)  /* arg list is empty? */\n                args.k = expkind.VVOID;\n            else {\n                explist(ls, args);\n                luaK_setmultret(fs, args);\n            }\n            check_match(ls, 41 /* (')').charCodeAt(0) */, 40 /* ('(').charCodeAt(0) */, line);\n            break;\n        }\n        case 123 /* ('{').charCodeAt(0) */: {  /* funcargs -> constructor */\n            constructor(ls, args);\n            break;\n        }\n        case R.TK_STRING: {  /* funcargs -> STRING */\n            codestring(ls, args, ls.t.seminfo.ts);\n            llex.luaX_next(ls);  /* must use 'seminfo' before 'next' */\n            break;\n        }\n        default: {\n            llex.luaX_syntaxerror(ls, to_luastring(\"function arguments expected\", true));\n        }\n    }\n    lua_assert(f.k === expkind.VNONRELOC);\n    let nparams;\n    let base = f.u.info;  /* base register for call */\n    if (hasmultret(args.k))\n        nparams = LUA_MULTRET;  /* open call */\n    else {\n        if (args.k !== expkind.VVOID)\n            luaK_exp2nextreg(fs, args);  /* close last argument */\n        nparams = fs.freereg - (base+1);\n    }\n    init_exp(f, expkind.VCALL, luaK_codeABC(fs, OP_CALL, base, nparams+1, 2));\n    luaK_fixline(fs, line);\n    fs.freereg = base + 1; /* call remove function and arguments and leaves (unless changed) one result */\n};\n\n/*\n** {======================================================================\n** Expression parsing\n** =======================================================================\n*/\n\nconst primaryexp = function(ls, v) {\n    /* primaryexp -> NAME | '(' expr ')' */\n    switch (ls.t.token) {\n        case 40 /* ('(').charCodeAt(0) */: {\n            let line = ls.linenumber;\n            llex.luaX_next(ls);\n            expr(ls, v);\n            check_match(ls, 41 /* (')').charCodeAt(0) */, 40 /* ('(').charCodeAt(0) */, line);\n            luaK_dischargevars(ls.fs, v);\n            return;\n        }\n        case R.TK_NAME: {\n            singlevar(ls, v);\n            return;\n        }\n        default: {\n            llex.luaX_syntaxerror(ls, to_luastring(\"unexpected symbol\", true));\n        }\n    }\n};\n\nconst suffixedexp = function(ls, v) {\n    /* suffixedexp ->\n       primaryexp { '.' NAME | '[' exp ']' | ':' NAME funcargs | funcargs } */\n    let fs = ls.fs;\n    let line = ls.linenumber;\n    primaryexp(ls, v);\n    for (;;) {\n        switch (ls.t.token) {\n            case 46 /* ('.').charCodeAt(0) */: {  /* fieldsel */\n                fieldsel(ls, v);\n                break;\n            }\n            case 91 /* ('[').charCodeAt(0) */: {  /* '[' exp1 ']' */\n                let key = new expdesc();\n                luaK_exp2anyregup(fs, v);\n                yindex(ls, key);\n                luaK_indexed(fs, v, key);\n                break;\n            }\n            case 58 /* (':').charCodeAt(0) */: {  /* ':' NAME funcargs */\n                let key = new expdesc();\n                llex.luaX_next(ls);\n                checkname(ls, key);\n                luaK_self(fs, v, key);\n                funcargs(ls, v, line);\n                break;\n            }\n            case 40 /* ('(').charCodeAt(0) */: case R.TK_STRING: case 123 /* ('{').charCodeAt(0) */: {  /* funcargs */\n                luaK_exp2nextreg(fs, v);\n                funcargs(ls, v, line);\n                break;\n            }\n            default: return;\n        }\n    }\n};\n\nconst simpleexp = function(ls, v) {\n    /* simpleexp -> FLT | INT | STRING | NIL | TRUE | FALSE | ... |\n       constructor | FUNCTION body | suffixedexp */\n    switch (ls.t.token) {\n        case R.TK_FLT: {\n            init_exp(v, expkind.VKFLT, 0);\n            v.u.nval = ls.t.seminfo.r;\n            break;\n        }\n        case R.TK_INT: {\n            init_exp(v, expkind.VKINT, 0);\n            v.u.ival = ls.t.seminfo.i;\n            break;\n        }\n        case R.TK_STRING: {\n            codestring(ls, v, ls.t.seminfo.ts);\n            break;\n        }\n        case R.TK_NIL: {\n            init_exp(v, expkind.VNIL, 0);\n            break;\n        }\n        case R.TK_TRUE: {\n            init_exp(v, expkind.VTRUE, 0);\n            break;\n        }\n        case R.TK_FALSE: {\n            init_exp(v, expkind.VFALSE, 0);\n            break;\n        }\n        case R.TK_DOTS: {  /* vararg */\n            let fs = ls.fs;\n            check_condition(ls, fs.f.is_vararg, to_luastring(\"cannot use '...' outside a vararg function\", true));\n            init_exp(v, expkind.VVARARG, luaK_codeABC(fs, OP_VARARG, 0, 1, 0));\n            break;\n        }\n        case 123 /* ('{').charCodeAt(0) */: {  /* constructor */\n            constructor(ls, v);\n            return;\n        }\n        case R.TK_FUNCTION: {\n            llex.luaX_next(ls);\n            body(ls, v, 0, ls.linenumber);\n            return;\n        }\n        default: {\n            suffixedexp(ls, v);\n            return;\n        }\n    }\n    llex.luaX_next(ls);\n};\n\nconst getunopr = function(op) {\n    switch (op) {\n        case R.TK_NOT: return OPR_NOT;\n        case 45 /* ('-').charCodeAt(0) */: return OPR_MINUS;\n        case 126 /* ('~').charCodeAt(0) */: return OPR_BNOT;\n        case 35 /* ('#').charCodeAt(0) */: return OPR_LEN;\n        default: return OPR_NOUNOPR;\n    }\n};\n\nconst getbinopr = function(op) {\n    switch (op) {\n        case 43 /* ('+').charCodeAt(0) */: return OPR_ADD;\n        case 45 /* ('-').charCodeAt(0) */: return OPR_SUB;\n        case 42 /* ('*').charCodeAt(0) */: return OPR_MUL;\n        case 37 /* ('%').charCodeAt(0) */: return OPR_MOD;\n        case 94 /* ('^').charCodeAt(0) */: return OPR_POW;\n        case 47 /* ('/').charCodeAt(0) */: return OPR_DIV;\n        case R.TK_IDIV:   return OPR_IDIV;\n        case 38 /* ('&').charCodeAt(0) */: return OPR_BAND;\n        case 124 /* ('|').charCodeAt(0) */: return OPR_BOR;\n        case 126 /* ('~').charCodeAt(0) */: return OPR_BXOR;\n        case R.TK_SHL:    return OPR_SHL;\n        case R.TK_SHR:    return OPR_SHR;\n        case R.TK_CONCAT: return OPR_CONCAT;\n        case R.TK_NE:     return OPR_NE;\n        case R.TK_EQ:     return OPR_EQ;\n        case 60 /* ('<').charCodeAt(0) */: return OPR_LT;\n        case R.TK_LE:     return OPR_LE;\n        case 62 /* ('>').charCodeAt(0) */: return OPR_GT;\n        case R.TK_GE:     return OPR_GE;\n        case R.TK_AND:    return OPR_AND;\n        case R.TK_OR:     return OPR_OR;\n        default:          return OPR_NOBINOPR;\n    }\n};\n\nconst priority = [  /* ORDER OPR */\n    {left: 10, right: 10}, {left: 10, right: 10},     /* '+' '-' */\n    {left: 11, right: 11}, {left: 11, right: 11},     /* '*' '%' */\n    {left: 14, right: 13},               /* '^' (right associative) */\n    {left: 11, right: 11}, {left: 11, right: 11},     /* '/' '//' */\n    {left: 6, right: 6}, {left: 4, right: 4}, {left: 5, right: 5}, /* '&' '|' '~' */\n    {left: 7, right: 7}, {left: 7, right: 7},         /* '<<' '>>' */\n    {left: 9, right: 8},                 /* '..' (right associative) */\n    {left: 3, right: 3}, {left: 3, right: 3}, {left: 3, right: 3}, /* ==, <, <= */\n    {left: 3, right: 3}, {left: 3, right: 3}, {left: 3, right: 3}, /* ~=, >, >= */\n    {left: 2, right: 2}, {left: 1, right: 1}          /* and, or */\n];\n\nconst UNARY_PRIORITY = 12;\n\n/*\n** subexpr -> (simpleexp | unop subexpr) { binop subexpr }\n** where 'binop' is any binary operator with a priority higher than 'limit'\n*/\nconst subexpr = function(ls, v, limit) {\n    enterlevel(ls);\n    let uop = getunopr(ls.t.token);\n    if (uop !== OPR_NOUNOPR) {\n        let line = ls.linenumber;\n        llex.luaX_next(ls);\n        subexpr(ls, v, UNARY_PRIORITY);\n        luaK_prefix(ls.fs, uop, v, line);\n    } else\n        simpleexp(ls, v);\n    /* expand while operators have priorities higher than 'limit' */\n    let op = getbinopr(ls.t.token);\n    while (op !== OPR_NOBINOPR && priority[op].left > limit) {\n        let v2 = new expdesc();\n        let line = ls.linenumber;\n        llex.luaX_next(ls);\n        luaK_infix(ls.fs, op, v);\n        /* read sub-expression with higher priority */\n        let nextop = subexpr(ls, v2, priority[op].right);\n        luaK_posfix(ls.fs, op, v, v2, line);\n        op = nextop;\n    }\n    leavelevel(ls);\n    return op;  /* return first untreated operator */\n};\n\nconst expr = function(ls, v) {\n    subexpr(ls, v, 0);\n};\n\n/* }==================================================================== */\n\n\n\n/*\n** {======================================================================\n** Rules for Statements\n** =======================================================================\n*/\n\nconst block = function(ls) {\n    /* block -> statlist */\n    let fs = ls.fs;\n    let bl = new BlockCnt();\n    enterblock(fs, bl, 0);\n    statlist(ls);\n    leaveblock(fs);\n};\n\n/*\n** structure to chain all variables in the left-hand side of an\n** assignment\n*/\nclass LHS_assign {\n    constructor() {\n        this.prev = null;\n        this.v = new expdesc();  /* variable (global, local, upvalue, or indexed) */\n    }\n}\n\n/*\n** check whether, in an assignment to an upvalue/local variable, the\n** upvalue/local variable is begin used in a previous assignment to a\n** table. If so, save original upvalue/local value in a safe place and\n** use this safe copy in the previous assignment.\n*/\nconst check_conflict = function(ls, lh, v) {\n    let fs = ls.fs;\n    let extra = fs.freereg;  /* eventual position to save local variable */\n    let conflict = false;\n    for (; lh; lh = lh.prev) {  /* check all previous assignments */\n        if (lh.v.k === expkind.VINDEXED) {  /* assigning to a table? */\n            /* table is the upvalue/local being assigned now? */\n            if (lh.v.u.ind.vt === v.k && lh.v.u.ind.t === v.u.info) {\n                conflict = true;\n                lh.v.u.ind.vt = expkind.VLOCAL;\n                lh.v.u.ind.t = extra;  /* previous assignment will use safe copy */\n            }\n            /* index is the local being assigned? (index cannot be upvalue) */\n            if (v.k === expkind.VLOCAL && lh.v.u.ind.idx === v.u.info) {\n                conflict = true;\n                lh.v.u.ind.idx = extra;  /* previous assignment will use safe copy */\n            }\n        }\n    }\n    if (conflict) {\n        /* copy upvalue/local value to a temporary (in position 'extra') */\n        let op = v.k === expkind.VLOCAL ? OP_MOVE : OP_GETUPVAL;\n        luaK_codeABC(fs, op, extra, v.u.info, 0);\n        luaK_reserveregs(fs, 1);\n    }\n};\n\nconst assignment = function(ls, lh, nvars) {\n    let e = new expdesc();\n    check_condition(ls, vkisvar(lh.v.k), to_luastring(\"syntax error\", true));\n    if (testnext(ls, 44 /* (',').charCodeAt(0) */)) {  /* assignment -> ',' suffixedexp assignment */\n        let nv = new LHS_assign();\n        nv.prev = lh;\n        suffixedexp(ls, nv.v);\n        if (nv.v.k !== expkind.VINDEXED)\n            check_conflict(ls, lh, nv.v);\n        checklimit(ls.fs, nvars + ls.L.nCcalls, LUAI_MAXCCALLS, to_luastring(\"JS levels\", true));\n        assignment(ls, nv, nvars + 1);\n    } else {  /* assignment -> '=' explist */\n        checknext(ls, 61 /* ('=').charCodeAt(0) */);\n        let nexps = explist(ls, e);\n        if (nexps !== nvars)\n            adjust_assign(ls, nvars, nexps, e);\n        else {\n            luaK_setoneret(ls.fs, e);  /* close last expression */\n            luaK_storevar(ls.fs, lh.v, e);\n            return;  /* avoid default */\n        }\n    }\n    init_exp(e, expkind.VNONRELOC, ls.fs.freereg-1);  /* default assignment */\n    luaK_storevar(ls.fs, lh.v, e);\n};\n\nconst cond = function(ls) {\n    /* cond -> exp */\n    let v = new expdesc();\n    expr(ls, v);  /* read condition */\n    if (v.k === expkind.VNIL) v.k = expkind.VFALSE;  /* 'falses' are all equal here */\n    luaK_goiftrue(ls.fs, v);\n    return v.f;\n};\n\nconst gotostat = function(ls, pc) {\n    let line = ls.linenumber;\n    let label;\n    if (testnext(ls, R.TK_GOTO))\n        label = str_checkname(ls);\n    else {\n        llex.luaX_next(ls);  /* skip break */\n        label = luaS_newliteral(ls.L, \"break\");\n    }\n    let g = newlabelentry(ls, ls.dyd.gt, label, line, pc);\n    findlabel(ls, g);  /* close it if label already defined */\n};\n\n/* check for repeated labels on the same block */\nconst checkrepeated = function(fs, ll, label) {\n    for (let i = fs.bl.firstlabel; i < ll.n; i++) {\n        if (eqstr(label, ll.arr[i].name)) {\n            let msg = lobject.luaO_pushfstring(fs.ls.L,\n                to_luastring(\"label '%s' already defined on line %d\", true),\n                label.getstr(), ll.arr[i].line);\n            semerror(fs.ls, msg);\n        }\n    }\n};\n\n/* skip no-op statements */\nconst skipnoopstat = function(ls) {\n    while (ls.t.token === 59 /* (';').charCodeAt(0) */ || ls.t.token === R.TK_DBCOLON)\n        statement(ls);\n};\n\nconst labelstat = function(ls, label, line) {\n    /* label -> '::' NAME '::' */\n    let fs = ls.fs;\n    let ll = ls.dyd.label;\n    let l;  /* index of new label being created */\n    checkrepeated(fs, ll, label);  /* check for repeated labels */\n    checknext(ls, R.TK_DBCOLON);  /* skip double colon */\n    /* create new entry for this label */\n    l = newlabelentry(ls, ll, label, line, luaK_getlabel(fs));\n    skipnoopstat(ls);  /* skip other no-op statements */\n    if (block_follow(ls, 0)) {  /* label is last no-op statement in the block? */\n        /* assume that locals are already out of scope */\n        ll.arr[l].nactvar = fs.bl.nactvar;\n    }\n    findgotos(ls, ll.arr[l]);\n};\n\nconst whilestat = function(ls, line) {\n    /* whilestat -> WHILE cond DO block END */\n    let fs = ls.fs;\n    let bl = new BlockCnt();\n    llex.luaX_next(ls);  /* skip WHILE */\n    let whileinit = luaK_getlabel(fs);\n    let condexit = cond(ls);\n    enterblock(fs, bl, 1);\n    checknext(ls, R.TK_DO);\n    block(ls);\n    luaK_jumpto(fs, whileinit);\n    check_match(ls, R.TK_END, R.TK_WHILE, line);\n    leaveblock(fs);\n    luaK_patchtohere(fs, condexit);  /* false conditions finish the loop */\n};\n\nconst repeatstat = function(ls, line) {\n    /* repeatstat -> REPEAT block UNTIL cond */\n    let fs = ls.fs;\n    let repeat_init = luaK_getlabel(fs);\n    let bl1 = new BlockCnt();\n    let bl2 = new BlockCnt();\n    enterblock(fs, bl1, 1);  /* loop block */\n    enterblock(fs, bl2, 0);  /* scope block */\n    llex.luaX_next(ls);  /* skip REPEAT */\n    statlist(ls);\n    check_match(ls, R.TK_UNTIL, R.TK_REPEAT, line);\n    let condexit = cond(ls);  /* read condition (inside scope block) */\n    if (bl2.upval)  /* upvalues? */\n        luaK_patchclose(fs, condexit, bl2.nactvar);\n    leaveblock(fs);  /* finish scope */\n    luaK_patchlist(fs, condexit, repeat_init);  /* close the loop */\n    leaveblock(fs);  /* finish loop */\n};\n\nconst exp1 = function(ls) {\n    let e = new expdesc();\n    expr(ls, e);\n    luaK_exp2nextreg(ls.fs, e);\n    lua_assert(e.k === expkind.VNONRELOC);\n    let reg = e.u.info;\n    return reg;\n};\n\nconst forbody = function(ls, base, line, nvars, isnum) {\n    /* forbody -> DO block */\n    let bl = new BlockCnt();\n    let fs = ls.fs;\n    let endfor;\n    adjustlocalvars(ls, 3);  /* control variables */\n    checknext(ls, R.TK_DO);\n    let prep = isnum ? luaK_codeAsBx(fs, OP_FORPREP, base, NO_JUMP) : luaK_jump(fs);\n    enterblock(fs, bl, 0);  /* scope for declared variables */\n    adjustlocalvars(ls, nvars);\n    luaK_reserveregs(fs, nvars);\n    block(ls);\n    leaveblock(fs);  /* end of scope for declared variables */\n    luaK_patchtohere(fs, prep);\n    if (isnum)  /* end of scope for declared variables */\n        endfor = luaK_codeAsBx(fs, OP_FORLOOP, base, NO_JUMP);\n    else {  /* generic for */\n        luaK_codeABC(fs, OP_TFORCALL, base, 0, nvars);\n        luaK_fixline(fs, line);\n        endfor = luaK_codeAsBx(fs, OP_TFORLOOP, base + 2, NO_JUMP);\n    }\n    luaK_patchlist(fs, endfor, prep + 1);\n    luaK_fixline(fs, line);\n};\n\nconst fornum = function(ls, varname, line) {\n    /* fornum -> NAME = exp1,exp1[,exp1] forbody */\n    let fs = ls.fs;\n    let base = fs.freereg;\n    new_localvarliteral(ls, \"(for index)\");\n    new_localvarliteral(ls, \"(for limit)\");\n    new_localvarliteral(ls, \"(for step)\");\n    new_localvar(ls, varname);\n    checknext(ls, 61 /* ('=').charCodeAt(0) */);\n    exp1(ls);  /* initial value */\n    checknext(ls, 44 /* (',').charCodeAt(0) */);\n    exp1(ls);  /* limit */\n    if (testnext(ls, 44 /* (',').charCodeAt(0) */))\n        exp1(ls);  /* optional step */\n    else {  /* default step = 1 */\n        luaK_codek(fs, fs.freereg, luaK_intK(fs, 1));\n        luaK_reserveregs(fs, 1);\n    }\n    forbody(ls, base, line, 1, 1);\n};\n\nconst forlist = function(ls, indexname) {\n    /* forlist -> NAME {,NAME} IN explist forbody */\n    let fs = ls.fs;\n    let e = new expdesc();\n    let nvars = 4;  /* gen, state, control, plus at least one declared var */\n    let base = fs.freereg;\n    /* create control variables */\n    new_localvarliteral(ls, \"(for generator)\");\n    new_localvarliteral(ls, \"(for state)\");\n    new_localvarliteral(ls, \"(for control)\");\n    /* create declared variables */\n    new_localvar(ls, indexname);\n    while (testnext(ls, 44 /* (',').charCodeAt(0) */)) {\n        new_localvar(ls, str_checkname(ls));\n        nvars++;\n    }\n    checknext(ls, R.TK_IN);\n    let line = ls.linenumber;\n    adjust_assign(ls, 3, explist(ls, e), e);\n    luaK_checkstack(fs, 3);  /* extra space to call generator */\n    forbody(ls, base, line, nvars - 3, 0);\n};\n\nconst forstat = function(ls, line) {\n    /* forstat -> FOR (fornum | forlist) END */\n    let fs = ls.fs;\n    let bl = new BlockCnt();\n    enterblock(fs, bl, 1);  /* scope for loop and control variables */\n    llex.luaX_next(ls);  /* skip 'for' */\n    let varname = str_checkname(ls);  /* first variable name */\n    switch (ls.t.token) {\n        case 61 /* ('=').charCodeAt(0) */: fornum(ls, varname, line); break;\n        case 44 /* (',').charCodeAt(0) */: case R.TK_IN: forlist(ls, varname); break;\n        default: llex.luaX_syntaxerror(ls, to_luastring(\"'=' or 'in' expected\", true));\n    }\n    check_match(ls, R.TK_END, R.TK_FOR, line);\n    leaveblock(fs);  /* loop scope ('break' jumps to this point) */\n};\n\nconst test_then_block = function(ls, escapelist) {\n    /* test_then_block -> [IF | ELSEIF] cond THEN block */\n    let bl = new BlockCnt();\n    let fs = ls.fs;\n    let v = new expdesc();\n    let jf;  /* instruction to skip 'then' code (if condition is false) */\n\n    llex.luaX_next(ls);  /* skip IF or ELSEIF */\n    expr(ls, v);  /* read condition */\n    checknext(ls, R.TK_THEN);\n\n    if (ls.t.token === R.TK_GOTO || ls.t.token === R.TK_BREAK) {\n        luaK_goiffalse(ls.fs, v);  /* will jump to label if condition is true */\n        enterblock(fs, bl, false);  /* must enter block before 'goto' */\n        gotostat(ls, v.t);   /* handle goto/break */\n        while (testnext(ls, 59 /* (';').charCodeAt(0) */));  /* skip colons */\n        if (block_follow(ls, 0)) {  /* 'goto' is the entire block? */\n            leaveblock(fs);\n            return escapelist;  /* and that is it */\n        } else  /* must skip over 'then' part if condition is false */\n            jf = luaK_jump(fs);\n    } else {  /* regular case (not goto/break) */\n        luaK_goiftrue(ls.fs, v);  /* skip over block if condition is false */\n        enterblock(fs, bl, false);\n        jf = v.f;\n    }\n\n    statlist(ls);  /* 'then' part */\n    leaveblock(fs);\n    if (ls.t.token === R.TK_ELSE || ls.t.token === R.TK_ELSEIF)  /* followed by 'else'/'elseif'? */\n        escapelist = luaK_concat(fs, escapelist, luaK_jump(fs));  /* must jump over it */\n    luaK_patchtohere(fs, jf);\n\n    return escapelist;\n};\n\nconst ifstat = function(ls, line) {\n    /* ifstat -> IF cond THEN block {ELSEIF cond THEN block} [ELSE block] END */\n    let fs = ls.fs;\n    let escapelist = NO_JUMP;  /* exit list for finished parts */\n    escapelist = test_then_block(ls, escapelist);  /* IF cond THEN block */\n    while (ls.t.token === R.TK_ELSEIF)\n        escapelist = test_then_block(ls, escapelist);  /* ELSEIF cond THEN block */\n    if (testnext(ls, R.TK_ELSE))\n        block(ls);  /* 'else' part */\n    check_match(ls, R.TK_END, R.TK_IF, line);\n    luaK_patchtohere(fs, escapelist);  /* patch escape list to 'if' end */\n};\n\nconst localfunc = function(ls) {\n    let b = new expdesc();\n    let fs = ls.fs;\n    new_localvar(ls, str_checkname(ls));  /* new local variable */\n    adjustlocalvars(ls, 1);  /* enter its scope */\n    body(ls, b, 0, ls.linenumber);  /* function created in next register */\n    /* debug information will only see the variable after this point! */\n    getlocvar(fs, b.u.info).startpc = fs.pc;\n};\n\nconst localstat = function(ls) {\n    /* stat -> LOCAL NAME {',' NAME} ['=' explist] */\n    let nvars = 0;\n    let nexps;\n    let e = new expdesc();\n    do {\n        new_localvar(ls, str_checkname(ls));\n        nvars++;\n    } while (testnext(ls, 44 /* (',').charCodeAt(0) */));\n    if (testnext(ls, 61 /* ('=').charCodeAt(0) */))\n        nexps = explist(ls, e);\n    else {\n        e.k = expkind.VVOID;\n        nexps = 0;\n    }\n    adjust_assign(ls, nvars, nexps, e);\n    adjustlocalvars(ls, nvars);\n};\n\nconst funcname = function(ls, v) {\n    /* funcname -> NAME {fieldsel} [':' NAME] */\n    let ismethod = 0;\n    singlevar(ls, v);\n    while (ls.t.token === 46 /* ('.').charCodeAt(0) */)\n        fieldsel(ls, v);\n    if (ls.t.token === 58 /* (':').charCodeAt(0) */) {\n        ismethod = 1;\n        fieldsel(ls, v);\n    }\n    return ismethod;\n};\n\nconst funcstat = function(ls, line) {\n    /* funcstat -> FUNCTION funcname body */\n    let v = new expdesc();\n    let b = new expdesc();\n    llex.luaX_next(ls);  /* skip FUNCTION */\n    let ismethod = funcname(ls, v);\n    body(ls, b, ismethod, line);\n    luaK_storevar(ls.fs, v, b);\n    luaK_fixline(ls.fs, line);  /* definition \"happens\" in the first line */\n};\n\nconst exprstat= function(ls) {\n    /* stat -> func | assignment */\n    let fs = ls.fs;\n    let v = new LHS_assign();\n    suffixedexp(ls, v.v);\n    if (ls.t.token === 61 /* ('=').charCodeAt(0) */ || ls.t.token === 44 /* (',').charCodeAt(0) */) { /* stat . assignment ? */\n        v.prev = null;\n        assignment(ls, v, 1);\n    }\n    else {  /* stat -> func */\n        check_condition(ls, v.v.k === expkind.VCALL, to_luastring(\"syntax error\", true));\n        SETARG_C(getinstruction(fs, v.v), 1);  /* call statement uses no results */\n    }\n};\n\nconst retstat = function(ls) {\n    /* stat -> RETURN [explist] [';'] */\n    let fs = ls.fs;\n    let e = new expdesc();\n    let first, nret;  /* registers with returned values */\n    if (block_follow(ls, 1) || ls.t.token === 59 /* (';').charCodeAt(0) */)\n        first = nret = 0;  /* return no values */\n    else {\n        nret = explist(ls, e);  /* optional return values */\n        if (hasmultret(e.k)) {\n            luaK_setmultret(fs, e);\n            if (e.k === expkind.VCALL && nret === 1) {  /* tail call? */\n                SET_OPCODE(getinstruction(fs, e), OP_TAILCALL);\n                lua_assert(getinstruction(fs, e).A === fs.nactvar);\n            }\n            first = fs.nactvar;\n            nret = LUA_MULTRET;  /* return all values */\n        } else {\n            if (nret === 1)  /* only one single value? */\n                first = luaK_exp2anyreg(fs, e);\n            else {\n                luaK_exp2nextreg(fs, e);  /* values must go to the stack */\n                first = fs.nactvar;  /* return all active values */\n                lua_assert(nret === fs.freereg - first);\n            }\n        }\n    }\n    luaK_ret(fs, first, nret);\n    testnext(ls, 59 /* (';').charCodeAt(0) */);  /* skip optional semicolon */\n};\n\nconst statement = function(ls) {\n    let line = ls.linenumber;  /* may be needed for error messages */\n    enterlevel(ls);\n    switch(ls.t.token) {\n        case 59 /* (';').charCodeAt(0) */: {  /* stat -> ';' (empty statement) */\n            llex.luaX_next(ls);  /* skip ';' */\n            break;\n        }\n        case R.TK_IF: {  /* stat -> ifstat */\n            ifstat(ls, line);\n            break;\n        }\n        case R.TK_WHILE: {  /* stat -> whilestat */\n            whilestat(ls, line);\n            break;\n        }\n        case R.TK_DO: {  /* stat -> DO block END */\n            llex.luaX_next(ls);  /* skip DO */\n            block(ls);\n            check_match(ls, R.TK_END, R.TK_DO, line);\n            break;\n        }\n        case R.TK_FOR: {  /* stat -> forstat */\n            forstat(ls, line);\n            break;\n        }\n        case R.TK_REPEAT: {  /* stat -> repeatstat */\n            repeatstat(ls, line);\n            break;\n        }\n        case R.TK_FUNCTION: {  /* stat -> funcstat */\n            funcstat(ls, line);\n            break;\n        }\n        case R.TK_LOCAL: {  /* stat -> localstat */\n            llex.luaX_next(ls);  /* skip LOCAL */\n            if (testnext(ls, R.TK_FUNCTION))  /* local function? */\n                localfunc(ls);\n            else\n                localstat(ls);\n            break;\n        }\n        case R.TK_DBCOLON: {  /* stat -> label */\n            llex.luaX_next(ls);  /* skip double colon */\n            labelstat(ls, str_checkname(ls), line);\n            break;\n        }\n        case R.TK_RETURN: {  /* skip double colon */\n            llex.luaX_next(ls);  /* skip RETURN */\n            retstat(ls);\n            break;\n        }\n        case R.TK_BREAK:   /* stat -> breakstat */\n        case R.TK_GOTO: {  /* stat -> 'goto' NAME */\n            gotostat(ls, luaK_jump(ls.fs));\n            break;\n        }\n        default: {  /* stat -> func | assignment */\n            exprstat(ls);\n            break;\n        }\n    }\n    lua_assert(ls.fs.f.maxstacksize >= ls.fs.freereg && ls.fs.freereg >= ls.fs.nactvar);\n    ls.fs.freereg = ls.fs.nactvar;  /* free registers */\n    leavelevel(ls);\n};\n\n/*\n** compiles the main function, which is a regular vararg function with an\n** upvalue named LUA_ENV\n*/\nconst mainfunc = function(ls, fs) {\n    let bl = new BlockCnt();\n    let v = new expdesc();\n    open_func(ls, fs, bl);\n    fs.f.is_vararg = true;  /* main function is always declared vararg */\n    init_exp(v, expkind.VLOCAL, 0);  /* create and... */\n    newupvalue(fs, ls.envn, v);  /* ...set environment upvalue */\n    llex.luaX_next(ls);  /* read first token */\n    statlist(ls);  /* parse main body */\n    check(ls, R.TK_EOS);\n    close_func(ls);\n};\n\nconst luaY_parser = function(L, z, buff, dyd, name, firstchar) {\n    let lexstate = new llex.LexState();\n    let funcstate = new FuncState();\n    let cl = lfunc.luaF_newLclosure(L, 1);  /* create main closure */\n    ldo.luaD_inctop(L);\n    L.stack[L.top-1].setclLvalue(cl);\n    lexstate.h = ltable.luaH_new(L);  /* create table for scanner */\n    ldo.luaD_inctop(L);\n    L.stack[L.top-1].sethvalue(lexstate.h);\n    funcstate.f = cl.p = new Proto(L);\n    funcstate.f.source = luaS_new(L, name);\n    lexstate.buff = buff;\n    lexstate.dyd = dyd;\n    dyd.actvar.n = dyd.gt.n = dyd.label.n = 0;\n    llex.luaX_setinput(L, lexstate, z, funcstate.f.source, firstchar);\n    mainfunc(lexstate, funcstate);\n    lua_assert(!funcstate.prev && funcstate.nups === 1 && !lexstate.fs);\n    /* all scopes should be correctly finished */\n    lua_assert(dyd.actvar.n === 0 && dyd.gt.n === 0 && dyd.label.n === 0);\n    delete L.stack[--L.top];  /* remove scanner's table */\n    return cl;  /* closure is on the stack, too */\n};\n\n\nmodule.exports.Dyndata     = Dyndata;\nmodule.exports.expkind     = expkind;\nmodule.exports.expdesc     = expdesc;\nmodule.exports.luaY_parser = luaY_parser;\nmodule.exports.vkisinreg   = vkisinreg;\n","\"use strict\";\n\nconst {\n    LUA_MINSTACK,\n    LUA_RIDX_GLOBALS,\n    LUA_RIDX_MAINTHREAD,\n    constant_types: {\n        LUA_NUMTAGS,\n        LUA_TNIL,\n        LUA_TTABLE,\n        LUA_TTHREAD\n    },\n    thread_status: {\n        LUA_OK\n    }\n} = require('./defs.js');\nconst lobject              = require('./lobject.js');\nconst ldo                  = require('./ldo.js');\nconst lapi                 = require('./lapi.js');\nconst ltable               = require('./ltable.js');\nconst ltm                  = require('./ltm.js');\n\nconst EXTRA_STACK = 5;\n\nconst BASIC_STACK_SIZE = 2 * LUA_MINSTACK;\n\nclass CallInfo {\n\n    constructor() {\n        this.func = null;\n        this.funcOff = NaN;\n        this.top = NaN;\n        this.previous = null;\n        this.next = null;\n\n        /* only for Lua functions */\n        this.l_base = NaN; /* base for this function */\n        this.l_code = null; /* reference to this.func.p.code */\n        this.l_savedpc = NaN; /* offset into l_code */\n        /* only for JS functions */\n        this.c_k = null;  /* continuation in case of yields */\n        this.c_old_errfunc = null;\n        this.c_ctx = null;  /* context info. in case of yields */\n\n        this.nresults = NaN;\n        this.callstatus = NaN;\n    }\n\n}\n\nclass lua_State {\n\n    constructor(g) {\n        this.id = g.id_counter++;\n\n        this.base_ci = new CallInfo(); /* CallInfo for first level (C calling Lua) */\n        this.top = NaN; /* first free slot in the stack */\n        this.stack_last = NaN; /* last free slot in the stack */\n        this.oldpc = NaN; /* last pc traced */\n\n        /* preinit_thread */\n        this.l_G = g;\n        this.stack = null;\n        this.ci = null;\n        this.errorJmp = null;\n        this.nCcalls = 0;\n        this.hook = null;\n        this.hookmask = 0;\n        this.basehookcount = 0;\n        this.allowhook = 1;\n        this.hookcount = this.basehookcount;\n        this.nny = 1;\n        this.status = LUA_OK;\n        this.errfunc = 0;\n    }\n\n}\n\nclass global_State {\n\n    constructor() {\n        this.id_counter = 1; /* used to give objects unique ids */\n        this.ids = new WeakMap();\n\n        this.mainthread = null;\n        this.l_registry = new lobject.TValue(LUA_TNIL, null);\n        this.panic = null;\n        this.atnativeerror = null;\n        this.version = null;\n        this.tmname = new Array(ltm.TMS.TM_N);\n        this.mt = new Array(LUA_NUMTAGS);\n    }\n\n}\n\nconst luaE_extendCI = function(L) {\n    let ci = new CallInfo();\n    L.ci.next = ci;\n    ci.previous = L.ci;\n    ci.next = null;\n    L.ci = ci;\n    return ci;\n};\n\nconst luaE_freeCI = function(L) {\n    let ci = L.ci;\n    ci.next = null;\n};\n\nconst stack_init = function(L1, L) {\n    L1.stack = new Array(BASIC_STACK_SIZE);\n    L1.top = 0;\n    L1.stack_last = BASIC_STACK_SIZE - EXTRA_STACK;\n    /* initialize first ci */\n    let ci = L1.base_ci;\n    ci.next = ci.previous = null;\n    ci.callstatus = 0;\n    ci.funcOff = L1.top;\n    ci.func = L1.stack[L1.top];\n    L1.stack[L1.top++] = new lobject.TValue(LUA_TNIL, null);\n    ci.top = L1.top + LUA_MINSTACK;\n    L1.ci = ci;\n};\n\nconst freestack = function(L) {\n    L.ci = L.base_ci;\n    luaE_freeCI(L);\n    L.stack = null;\n};\n\n/*\n** Create registry table and its predefined values\n*/\nconst init_registry = function(L, g) {\n    let registry = ltable.luaH_new(L);\n    g.l_registry.sethvalue(registry);\n    ltable.luaH_setint(registry, LUA_RIDX_MAINTHREAD, new lobject.TValue(LUA_TTHREAD, L));\n    ltable.luaH_setint(registry, LUA_RIDX_GLOBALS, new lobject.TValue(LUA_TTABLE, ltable.luaH_new(L)));\n};\n\n/*\n** open parts of the state that may cause memory-allocation errors.\n** ('g->version' !== NULL flags that the state was completely build)\n*/\nconst f_luaopen = function(L) {\n    let g = L.l_G;\n    stack_init(L, L);\n    init_registry(L, g);\n    ltm.luaT_init(L);\n    g.version = lapi.lua_version(null);\n};\n\nconst lua_newthread = function(L) {\n    let g = L.l_G;\n    let L1 = new lua_State(g);\n    L.stack[L.top] = new lobject.TValue(LUA_TTHREAD, L1);\n    lapi.api_incr_top(L);\n    L1.hookmask = L.hookmask;\n    L1.basehookcount = L.basehookcount;\n    L1.hook = L.hook;\n    L1.hookcount = L1.basehookcount;\n    stack_init(L1, L);\n    return L1;\n};\n\nconst luaE_freethread = function(L, L1) {\n    freestack(L1);\n};\n\nconst lua_newstate = function() {\n    let g = new global_State();\n    let L = new lua_State(g);\n    g.mainthread = L;\n\n    if (ldo.luaD_rawrunprotected(L, f_luaopen, null) !== LUA_OK) {\n        L = null;\n    }\n\n    return L;\n};\n\nconst close_state = function(L) {\n    freestack(L);\n};\n\nconst lua_close = function(L) {\n    L = L.l_G.mainthread;  /* only the main thread can be closed */\n    close_state(L);\n};\n\nmodule.exports.lua_State       = lua_State;\nmodule.exports.CallInfo        = CallInfo;\nmodule.exports.CIST_OAH        = (1<<0);  /* original value of 'allowhook' */\nmodule.exports.CIST_LUA        = (1<<1);  /* call is running a Lua function */\nmodule.exports.CIST_HOOKED     = (1<<2);  /* call is running a debug hook */\nmodule.exports.CIST_FRESH      = (1<<3);  /* call is running on a fresh invocation of luaV_execute */\nmodule.exports.CIST_YPCALL     = (1<<4);  /* call is a yieldable protected call */\nmodule.exports.CIST_TAIL       = (1<<5);  /* call was tail called */\nmodule.exports.CIST_HOOKYIELD  = (1<<6);  /* last hook called yielded */\nmodule.exports.CIST_LEQ        = (1<<7);  /* using __lt for __le */\nmodule.exports.CIST_FIN        = (1<<8);   /* call is running a finalizer */\nmodule.exports.EXTRA_STACK     = EXTRA_STACK;\nmodule.exports.lua_close       = lua_close;\nmodule.exports.lua_newstate    = lua_newstate;\nmodule.exports.lua_newthread   = lua_newthread;\nmodule.exports.luaE_extendCI   = luaE_extendCI;\nmodule.exports.luaE_freeCI     = luaE_freeCI;\nmodule.exports.luaE_freethread = luaE_freethread;\n","\"use strict\";\n\nconst {\n    is_luastring,\n    luastring_eq,\n    luastring_from,\n    to_luastring\n} = require('./defs.js');\nconst { lua_assert } = require(\"./llimits.js\");\n\nclass TString {\n\n    constructor(L, str) {\n        this.hash = null;\n        this.realstring = str;\n    }\n\n    getstr() {\n        return this.realstring;\n    }\n\n    tsslen() {\n        return this.realstring.length;\n    }\n\n}\n\nconst luaS_eqlngstr = function(a, b) {\n    lua_assert(a instanceof TString);\n    lua_assert(b instanceof TString);\n    return a == b || luastring_eq(a.realstring, b.realstring);\n};\n\n/* converts strings (arrays) to a consistent map key\n   make sure this doesn't conflict with any of the anti-collision strategies in ltable */\nconst luaS_hash = function(str) {\n    lua_assert(is_luastring(str));\n    let len = str.length;\n    let s = \"|\";\n    for (let i=0; i<len; i++)\n        s += str[i].toString(16);\n    return s;\n};\n\nconst luaS_hashlongstr = function(ts) {\n    lua_assert(ts instanceof TString);\n    if(ts.hash === null) {\n        ts.hash = luaS_hash(ts.getstr());\n    }\n    return ts.hash;\n};\n\n/* variant that takes ownership of array */\nconst luaS_bless = function(L, str) {\n    lua_assert(str instanceof Uint8Array);\n    return new TString(L, str);\n};\n\n/* makes a copy */\nconst luaS_new = function(L, str) {\n    return luaS_bless(L, luastring_from(str));\n};\n\n/* takes a js string */\nconst luaS_newliteral = function(L, str) {\n    return luaS_bless(L, to_luastring(str));\n};\n\nmodule.exports.luaS_eqlngstr    = luaS_eqlngstr;\nmodule.exports.luaS_hash        = luaS_hash;\nmodule.exports.luaS_hashlongstr = luaS_hashlongstr;\nmodule.exports.luaS_bless       = luaS_bless;\nmodule.exports.luaS_new         = luaS_new;\nmodule.exports.luaS_newliteral  = luaS_newliteral;\nmodule.exports.TString          = TString;\n","\"use strict\";\n\nconst {\n    constant_types: {\n        LUA_TBOOLEAN,\n        LUA_TCCL,\n        LUA_TLCF,\n        LUA_TLCL,\n        LUA_TLIGHTUSERDATA,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TSHRSTR,\n        LUA_TTABLE,\n        LUA_TTHREAD,\n        LUA_TUSERDATA\n    },\n    to_luastring\n} = require('./defs.js');\nconst { lua_assert } = require('./llimits.js');\nconst ldebug  = require('./ldebug.js');\nconst lobject = require('./lobject.js');\nconst {\n    luaS_hashlongstr,\n    TString\n} = require('./lstring.js');\nconst lstate  = require('./lstate.js');\n\n/* used to prevent conflicts with lightuserdata keys */\nlet lightuserdata_hashes = new WeakMap();\nconst get_lightuserdata_hash = function(v) {\n    let hash = lightuserdata_hashes.get(v);\n    if (!hash) {\n        /* Hash should be something unique that is a valid WeakMap key\n           so that it ends up in dead_weak when removed from a table */\n        hash = {};\n        lightuserdata_hashes.set(v, hash);\n    }\n    return hash;\n};\n\nconst table_hash = function(L, key) {\n    switch(key.type) {\n        case LUA_TNIL:\n            return ldebug.luaG_runerror(L, to_luastring(\"table index is nil\", true));\n        case LUA_TNUMFLT:\n            if (isNaN(key.value))\n                return ldebug.luaG_runerror(L, to_luastring(\"table index is NaN\", true));\n            /* fall through */\n        case LUA_TNUMINT: /* takes advantage of floats and integers being same in JS */\n        case LUA_TBOOLEAN:\n        case LUA_TTABLE:\n        case LUA_TLCL:\n        case LUA_TLCF:\n        case LUA_TCCL:\n        case LUA_TUSERDATA:\n        case LUA_TTHREAD:\n            return key.value;\n        case LUA_TSHRSTR:\n        case LUA_TLNGSTR:\n            return luaS_hashlongstr(key.tsvalue());\n        case LUA_TLIGHTUSERDATA: {\n            let v = key.value;\n            switch(typeof v) {\n                case \"string\":\n                    /* possible conflict with LUA_TSTRING.\n                       prefix this string with \"*\" so they don't clash */\n                    return \"*\" + v;\n                case \"number\":\n                    /* possible conflict with LUA_TNUMBER.\n                       turn into string and prefix with \"#\" to avoid clash with other strings */\n                    return \"#\" + v;\n                case \"boolean\":\n                    /* possible conflict with LUA_TBOOLEAN. use strings ?true and ?false instead */\n                    return v?\"?true\":\"?false\";\n                case \"function\":\n                    /* possible conflict with LUA_TLCF.\n                       indirect via a weakmap */\n                    return get_lightuserdata_hash(v);\n                case \"object\":\n                    /* v could be a lua_State, CClosure, LClosure, Table or Userdata from this state as returned by lua_topointer */\n                    if ((v instanceof lstate.lua_State && v.l_G === L.l_G) ||\n                        v instanceof Table ||\n                        v instanceof lobject.Udata ||\n                        v instanceof lobject.LClosure ||\n                        v instanceof lobject.CClosure) {\n                        /* indirect via a weakmap */\n                        return get_lightuserdata_hash(v);\n                    }\n                    /* fall through */\n                default:\n                    return v;\n            }\n        }\n        default:\n            throw new Error(\"unknown key type: \" + key.type);\n    }\n};\n\nclass Table {\n    constructor(L) {\n        this.id = L.l_G.id_counter++;\n        this.strong = new Map();\n        this.dead_strong = new Map();\n        this.dead_weak = void 0; /* initialised when needed */\n        this.f = void 0; /* first entry */\n        this.l = void 0; /* last entry */\n        this.metatable = null;\n        this.flags = ~0;\n    }\n}\n\nconst invalidateTMcache = function(t) {\n    t.flags = 0;\n};\n\nconst add = function(t, hash, key, value) {\n    t.dead_strong.clear();\n    t.dead_weak = void 0;\n    let prev = null;\n    let entry = {\n        key: key,\n        value: value,\n        p: prev = t.l,\n        n: void 0\n    };\n    if (!t.f) t.f = entry;\n    if (prev) prev.n = entry;\n    t.strong.set(hash, entry);\n    t.l = entry;\n};\n\nconst is_valid_weakmap_key = function(k) {\n    return typeof k === 'object' ? k !== null : typeof k === 'function';\n};\n\n/* Move out of 'strong' part and into 'dead' part. */\nconst mark_dead = function(t, hash) {\n    let e = t.strong.get(hash);\n    if (e) {\n        e.key.setdeadvalue();\n        e.value = void 0;\n        let next = e.n;\n        let prev = e.p;\n        e.p = void 0; /* no need to know previous item any more */\n        if(prev) prev.n = next;\n        if(next) next.p = prev;\n        if(t.f === e) t.f = next;\n        if(t.l === e) t.l = prev;\n        t.strong.delete(hash);\n        if (is_valid_weakmap_key(hash)) {\n            if (!t.dead_weak) t.dead_weak = new WeakMap();\n            t.dead_weak.set(hash, e);\n        } else {\n            /* can't be used as key in weakmap */\n            t.dead_strong.set(hash, e);\n        }\n    }\n};\n\nconst luaH_new = function(L) {\n    return new Table(L);\n};\n\nconst getgeneric = function(t, hash) {\n    let v = t.strong.get(hash);\n    return v ? v.value : lobject.luaO_nilobject;\n};\n\nconst luaH_getint = function(t, key) {\n    lua_assert(typeof key == \"number\" && (key|0) === key);\n    return getgeneric(t, key);\n};\n\nconst luaH_getstr = function(t, key) {\n    lua_assert(key instanceof TString);\n    return getgeneric(t, luaS_hashlongstr(key));\n};\n\nconst luaH_get = function(L, t, key) {\n    lua_assert(key instanceof lobject.TValue);\n    if (key.ttisnil() || (key.ttisfloat() && isNaN(key.value)))\n        return lobject.luaO_nilobject;\n    return getgeneric(t, table_hash(L, key));\n};\n\nconst luaH_setint = function(t, key, value) {\n    lua_assert(typeof key == \"number\" && (key|0) === key && value instanceof lobject.TValue);\n    let hash = key; /* table_hash known result */\n    if (value.ttisnil()) {\n        mark_dead(t, hash);\n        return;\n    }\n    let e = t.strong.get(hash);\n    if (e) {\n        let tv = e.value;\n        tv.setfrom(value);\n    } else {\n        let k = new lobject.TValue(LUA_TNUMINT, key);\n        let v = new lobject.TValue(value.type, value.value);\n        add(t, hash, k, v);\n    }\n};\n\nconst luaH_setfrom = function(L, t, key, value) {\n    lua_assert(key instanceof lobject.TValue);\n    let hash = table_hash(L, key);\n    if (value.ttisnil()) { /* delete */\n        mark_dead(t, hash);\n        return;\n    }\n\n    let e = t.strong.get(hash);\n    if (e) {\n        e.value.setfrom(value);\n    } else {\n        let k;\n        let kv = key.value;\n        if ((key.ttisfloat() && (kv|0) === kv)) { /* does index fit in an integer? */\n            /* insert it as an integer */\n            k = new lobject.TValue(LUA_TNUMINT, kv);\n        } else {\n            k = new lobject.TValue(key.type, kv);\n        }\n        let v = new lobject.TValue(value.type, value.value);\n        add(t, hash, k, v);\n    }\n};\n\n/*\n** Try to find a boundary in table 't'. A 'boundary' is an integer index\n** such that t[i] is non-nil and t[i+1] is nil (and 0 if t[1] is nil).\n*/\nconst luaH_getn = function(t) {\n    let i = 0;\n    let j = t.strong.size + 1; /* use known size of Map to bound search */\n    /* now do a binary search between them */\n    while (j - i > 1) {\n        let m = Math.floor((i+j)/2);\n        if (luaH_getint(t, m).ttisnil()) j = m;\n        else i = m;\n    }\n    return i;\n};\n\nconst luaH_next = function(L, table, keyI) {\n    let keyO = L.stack[keyI];\n\n    let entry;\n    if (keyO.type === LUA_TNIL) {\n        entry = table.f;\n        if (!entry)\n            return false;\n    } else {\n        /* First find current key */\n        let hash = table_hash(L, keyO);\n        /* Look in main part of table */\n        entry = table.strong.get(hash);\n        if (entry) {\n            entry = entry.n;\n            if (!entry)\n                return false;\n        } else {\n            /* Try dead keys */\n            entry = (table.dead_weak && table.dead_weak.get(hash)) || table.dead_strong.get(hash);\n            if (!entry)\n                /* item not in table */\n                return ldebug.luaG_runerror(L, to_luastring(\"invalid key to 'next'\"));\n            /* Iterate until either out of keys, or until finding a non-dead key */\n            do {\n                entry = entry.n;\n                if (!entry)\n                    return false;\n            } while (entry.key.ttisdeadkey());\n        }\n    }\n    lobject.setobj2s(L, keyI, entry.key);\n    lobject.setobj2s(L, keyI+1, entry.value);\n    return true;\n};\n\nmodule.exports.invalidateTMcache = invalidateTMcache;\nmodule.exports.luaH_get     = luaH_get;\nmodule.exports.luaH_getint  = luaH_getint;\nmodule.exports.luaH_getn    = luaH_getn;\nmodule.exports.luaH_getstr  = luaH_getstr;\nmodule.exports.luaH_setfrom = luaH_setfrom;\nmodule.exports.luaH_setint  = luaH_setint;\nmodule.exports.luaH_new     = luaH_new;\nmodule.exports.luaH_next    = luaH_next;\nmodule.exports.Table        = Table;\n","\"use strict\";\n\nconst {\n    constant_types: {\n        LUA_TTABLE,\n        LUA_TUSERDATA\n    },\n    to_luastring\n} = require('./defs.js');\nconst { lua_assert } = require('./llimits.js');\nconst lobject = require('./lobject.js');\nconst ldo     = require('./ldo.js');\nconst lstate  = require('./lstate.js');\nconst {\n    luaS_bless,\n    luaS_new\n} = require('./lstring.js');\nconst ltable  = require('./ltable.js');\nconst ldebug  = require('./ldebug.js');\nconst lvm     = require('./lvm.js');\n\nconst luaT_typenames_ = [\n    \"no value\",\n    \"nil\",\n    \"boolean\",\n    \"userdata\",\n    \"number\",\n    \"string\",\n    \"table\",\n    \"function\",\n    \"userdata\",\n    \"thread\",\n    \"proto\" /* this last case is used for tests only */\n].map(e => to_luastring(e));\n\nconst ttypename = function(t) {\n    return luaT_typenames_[t + 1];\n};\n\n\n/*\n* WARNING: if you change the order of this enumeration,\n* grep \"ORDER TM\" and \"ORDER OP\"\n*/\nconst TMS = {\n    TM_INDEX:    0,\n    TM_NEWINDEX: 1,\n    TM_GC:       2,\n    TM_MODE:     3,\n    TM_LEN:      4,\n    TM_EQ:       5,  /* last tag method with fast access */\n    TM_ADD:      6,\n    TM_SUB:      7,\n    TM_MUL:      8,\n    TM_MOD:      9,\n    TM_POW:     10,\n    TM_DIV:     11,\n    TM_IDIV:    12,\n    TM_BAND:    13 ,\n    TM_BOR:     14,\n    TM_BXOR:    15,\n    TM_SHL:     16,\n    TM_SHR:     17,\n    TM_UNM:     18,\n    TM_BNOT:    19,\n    TM_LT:      20,\n    TM_LE:      21,\n    TM_CONCAT:  22,\n    TM_CALL:    23,\n    TM_N:       24  /* number of elements in the enum */\n};\n\nconst luaT_init = function(L) {\n    L.l_G.tmname[TMS.TM_INDEX]    = new luaS_new(L, to_luastring(\"__index\", true));\n    L.l_G.tmname[TMS.TM_NEWINDEX] = new luaS_new(L, to_luastring(\"__newindex\", true));\n    L.l_G.tmname[TMS.TM_GC]       = new luaS_new(L, to_luastring(\"__gc\", true));\n    L.l_G.tmname[TMS.TM_MODE]     = new luaS_new(L, to_luastring(\"__mode\", true));\n    L.l_G.tmname[TMS.TM_LEN]      = new luaS_new(L, to_luastring(\"__len\", true));\n    L.l_G.tmname[TMS.TM_EQ]       = new luaS_new(L, to_luastring(\"__eq\", true));\n    L.l_G.tmname[TMS.TM_ADD]      = new luaS_new(L, to_luastring(\"__add\", true));\n    L.l_G.tmname[TMS.TM_SUB]      = new luaS_new(L, to_luastring(\"__sub\", true));\n    L.l_G.tmname[TMS.TM_MUL]      = new luaS_new(L, to_luastring(\"__mul\", true));\n    L.l_G.tmname[TMS.TM_MOD]      = new luaS_new(L, to_luastring(\"__mod\", true));\n    L.l_G.tmname[TMS.TM_POW]      = new luaS_new(L, to_luastring(\"__pow\", true));\n    L.l_G.tmname[TMS.TM_DIV]      = new luaS_new(L, to_luastring(\"__div\", true));\n    L.l_G.tmname[TMS.TM_IDIV]     = new luaS_new(L, to_luastring(\"__idiv\", true));\n    L.l_G.tmname[TMS.TM_BAND]     = new luaS_new(L, to_luastring(\"__band\", true));\n    L.l_G.tmname[TMS.TM_BOR]      = new luaS_new(L, to_luastring(\"__bor\", true));\n    L.l_G.tmname[TMS.TM_BXOR]     = new luaS_new(L, to_luastring(\"__bxor\", true));\n    L.l_G.tmname[TMS.TM_SHL]      = new luaS_new(L, to_luastring(\"__shl\", true));\n    L.l_G.tmname[TMS.TM_SHR]      = new luaS_new(L, to_luastring(\"__shr\", true));\n    L.l_G.tmname[TMS.TM_UNM]      = new luaS_new(L, to_luastring(\"__unm\", true));\n    L.l_G.tmname[TMS.TM_BNOT]     = new luaS_new(L, to_luastring(\"__bnot\", true));\n    L.l_G.tmname[TMS.TM_LT]       = new luaS_new(L, to_luastring(\"__lt\", true));\n    L.l_G.tmname[TMS.TM_LE]       = new luaS_new(L, to_luastring(\"__le\", true));\n    L.l_G.tmname[TMS.TM_CONCAT]   = new luaS_new(L, to_luastring(\"__concat\", true));\n    L.l_G.tmname[TMS.TM_CALL]     = new luaS_new(L, to_luastring(\"__call\", true));\n};\n\n/*\n** Return the name of the type of an object. For tables and userdata\n** with metatable, use their '__name' metafield, if present.\n*/\nconst __name = to_luastring('__name', true);\nconst luaT_objtypename = function(L, o) {\n    let mt;\n    if ((o.ttistable() && (mt = o.value.metatable) !== null) ||\n        (o.ttisfulluserdata() && (mt = o.value.metatable) !== null)) {\n        let name = ltable.luaH_getstr(mt, luaS_bless(L, __name));\n        if (name.ttisstring())\n            return name.svalue();\n    }\n    return ttypename(o.ttnov());\n};\n\nconst luaT_callTM = function(L, f, p1, p2, p3, hasres) {\n    let func = L.top;\n\n    lobject.pushobj2s(L, f); /* push function (assume EXTRA_STACK) */\n    lobject.pushobj2s(L, p1); /* 1st argument */\n    lobject.pushobj2s(L, p2); /* 2nd argument */\n\n    if (!hasres)  /* no result? 'p3' is third argument */\n        lobject.pushobj2s(L, p3); /* 3rd argument */\n\n    if (L.ci.callstatus & lstate.CIST_LUA)\n        ldo.luaD_call(L, func, hasres);\n    else\n        ldo.luaD_callnoyield(L, func, hasres);\n\n    if (hasres) {  /* if has result, move it to its place */\n        let tv = L.stack[L.top-1];\n        delete L.stack[--L.top];\n        p3.setfrom(tv);\n    }\n};\n\nconst luaT_callbinTM = function(L, p1, p2, res, event) {\n    let tm = luaT_gettmbyobj(L, p1, event);\n    if (tm.ttisnil())\n        tm = luaT_gettmbyobj(L, p2, event);\n    if (tm.ttisnil()) return false;\n    luaT_callTM(L, tm, p1, p2, res, 1);\n    return true;\n};\n\nconst luaT_trybinTM = function(L, p1, p2, res, event) {\n    if (!luaT_callbinTM(L, p1, p2, res, event)) {\n        switch (event) {\n            case TMS.TM_CONCAT:\n                return ldebug.luaG_concaterror(L, p1, p2);\n            case TMS.TM_BAND: case TMS.TM_BOR: case TMS.TM_BXOR:\n            case TMS.TM_SHL: case TMS.TM_SHR: case TMS.TM_BNOT: {\n                let n1 = lvm.tonumber(p1);\n                let n2 = lvm.tonumber(p2);\n                if (n1 !== false && n2 !== false)\n                    return ldebug.luaG_tointerror(L, p1, p2);\n                else\n                    return ldebug.luaG_opinterror(L, p1, p2, to_luastring(\"perform bitwise operation on\", true));\n            }\n            default:\n                return ldebug.luaG_opinterror(L, p1, p2, to_luastring(\"perform arithmetic on\", true));\n        }\n    }\n};\n\nconst luaT_callorderTM = function(L, p1, p2, event) {\n    let res = new lobject.TValue();\n    if (!luaT_callbinTM(L, p1, p2, res, event))\n        return null;\n    else\n        return !res.l_isfalse();\n};\n\nconst fasttm = function(l, et, e) {\n    return et === null ? null :\n        (et.flags & (1 << e)) ? null : luaT_gettm(et, e, l.l_G.tmname[e]);\n};\n\nconst luaT_gettm = function(events, event, ename) {\n    const tm = ltable.luaH_getstr(events, ename);\n    lua_assert(event <= TMS.TM_EQ);\n    if (tm.ttisnil()) {  /* no tag method? */\n        events.flags |= 1<<event;  /* cache this fact */\n        return null;\n    }\n    else return tm;\n};\n\nconst luaT_gettmbyobj = function(L, o, event) {\n    let mt;\n    switch(o.ttnov()) {\n        case LUA_TTABLE:\n        case LUA_TUSERDATA:\n            mt = o.value.metatable;\n            break;\n        default:\n            mt = L.l_G.mt[o.ttnov()];\n    }\n\n    return mt ? ltable.luaH_getstr(mt, L.l_G.tmname[event]) : lobject.luaO_nilobject;\n};\n\nmodule.exports.fasttm           = fasttm;\nmodule.exports.TMS              = TMS;\nmodule.exports.luaT_callTM      = luaT_callTM;\nmodule.exports.luaT_callbinTM   = luaT_callbinTM;\nmodule.exports.luaT_trybinTM    = luaT_trybinTM;\nmodule.exports.luaT_callorderTM = luaT_callorderTM;\nmodule.exports.luaT_gettm       = luaT_gettm;\nmodule.exports.luaT_gettmbyobj  = luaT_gettmbyobj;\nmodule.exports.luaT_init        = luaT_init;\nmodule.exports.luaT_objtypename = luaT_objtypename;\nmodule.exports.ttypename        = ttypename;\n","\"use strict\";\n\nconst defs   = require(\"./defs.js\");\nconst lapi   = require(\"./lapi.js\");\nconst ldebug = require(\"./ldebug.js\");\nconst ldo    = require(\"./ldo.js\");\nconst lstate = require(\"./lstate.js\");\n\nmodule.exports.LUA_AUTHORS             = defs.LUA_AUTHORS;\nmodule.exports.LUA_COPYRIGHT           = defs.LUA_COPYRIGHT;\nmodule.exports.LUA_ERRERR              = defs.thread_status.LUA_ERRERR;\nmodule.exports.LUA_ERRGCMM             = defs.thread_status.LUA_ERRGCMM;\nmodule.exports.LUA_ERRMEM              = defs.thread_status.LUA_ERRMEM;\nmodule.exports.LUA_ERRRUN              = defs.thread_status.LUA_ERRRUN;\nmodule.exports.LUA_ERRSYNTAX           = defs.thread_status.LUA_ERRSYNTAX;\nmodule.exports.LUA_HOOKCALL            = defs.LUA_HOOKCALL;\nmodule.exports.LUA_HOOKCOUNT           = defs.LUA_HOOKCOUNT;\nmodule.exports.LUA_HOOKLINE            = defs.LUA_HOOKLINE;\nmodule.exports.LUA_HOOKRET             = defs.LUA_HOOKRET;\nmodule.exports.LUA_HOOKTAILCALL        = defs.LUA_HOOKTAILCALL;\nmodule.exports.LUA_MASKCALL            = defs.LUA_MASKCALL;\nmodule.exports.LUA_MASKCOUNT           = defs.LUA_MASKCOUNT;\nmodule.exports.LUA_MASKLINE            = defs.LUA_MASKLINE;\nmodule.exports.LUA_MASKRET             = defs.LUA_MASKRET;\nmodule.exports.LUA_MINSTACK            = defs.LUA_MINSTACK;\nmodule.exports.LUA_MULTRET             = defs.LUA_MULTRET;\nmodule.exports.LUA_NUMTAGS             = defs.constant_types.LUA_NUMTAGS;\nmodule.exports.LUA_OK                  = defs.thread_status.LUA_OK;\nmodule.exports.LUA_OPADD               = defs.LUA_OPADD;\nmodule.exports.LUA_OPBAND              = defs.LUA_OPBAND;\nmodule.exports.LUA_OPBNOT              = defs.LUA_OPBNOT;\nmodule.exports.LUA_OPBOR               = defs.LUA_OPBOR;\nmodule.exports.LUA_OPBXOR              = defs.LUA_OPBXOR;\nmodule.exports.LUA_OPDIV               = defs.LUA_OPDIV;\nmodule.exports.LUA_OPEQ                = defs.LUA_OPEQ;\nmodule.exports.LUA_OPIDIV              = defs.LUA_OPIDIV;\nmodule.exports.LUA_OPLE                = defs.LUA_OPLE;\nmodule.exports.LUA_OPLT                = defs.LUA_OPLT;\nmodule.exports.LUA_OPMOD               = defs.LUA_OPMOD;\nmodule.exports.LUA_OPMUL               = defs.LUA_OPMUL;\nmodule.exports.LUA_OPPOW               = defs.LUA_OPPOW;\nmodule.exports.LUA_OPSHL               = defs.LUA_OPSHL;\nmodule.exports.LUA_OPSHR               = defs.LUA_OPSHR;\nmodule.exports.LUA_OPSUB               = defs.LUA_OPSUB;\nmodule.exports.LUA_OPUNM               = defs.LUA_OPUNM;\nmodule.exports.LUA_REGISTRYINDEX       = defs.LUA_REGISTRYINDEX;\nmodule.exports.LUA_RELEASE             = defs.LUA_RELEASE;\nmodule.exports.LUA_RIDX_GLOBALS        = defs.LUA_RIDX_GLOBALS;\nmodule.exports.LUA_RIDX_LAST           = defs.LUA_RIDX_LAST;\nmodule.exports.LUA_RIDX_MAINTHREAD     = defs.LUA_RIDX_MAINTHREAD;\nmodule.exports.LUA_SIGNATURE           = defs.LUA_SIGNATURE;\nmodule.exports.LUA_TNONE               = defs.constant_types.LUA_TNONE;\nmodule.exports.LUA_TNIL                = defs.constant_types.LUA_TNIL;\nmodule.exports.LUA_TBOOLEAN            = defs.constant_types.LUA_TBOOLEAN;\nmodule.exports.LUA_TLIGHTUSERDATA      = defs.constant_types.LUA_TLIGHTUSERDATA;\nmodule.exports.LUA_TNUMBER             = defs.constant_types.LUA_TNUMBER;\nmodule.exports.LUA_TSTRING             = defs.constant_types.LUA_TSTRING;\nmodule.exports.LUA_TTABLE              = defs.constant_types.LUA_TTABLE;\nmodule.exports.LUA_TFUNCTION           = defs.constant_types.LUA_TFUNCTION;\nmodule.exports.LUA_TUSERDATA           = defs.constant_types.LUA_TUSERDATA;\nmodule.exports.LUA_TTHREAD             = defs.constant_types.LUA_TTHREAD;\nmodule.exports.LUA_VERSION             = defs.LUA_VERSION;\nmodule.exports.LUA_VERSION_MAJOR       = defs.LUA_VERSION_MAJOR;\nmodule.exports.LUA_VERSION_MINOR       = defs.LUA_VERSION_MINOR;\nmodule.exports.LUA_VERSION_NUM         = defs.LUA_VERSION_NUM;\nmodule.exports.LUA_VERSION_RELEASE     = defs.LUA_VERSION_RELEASE;\nmodule.exports.LUA_YIELD               = defs.thread_status.LUA_YIELD;\nmodule.exports.lua_Debug               = defs.lua_Debug;\nmodule.exports.lua_upvalueindex        = defs.lua_upvalueindex;\nmodule.exports.lua_absindex            = lapi.lua_absindex;\nmodule.exports.lua_arith               = lapi.lua_arith;\nmodule.exports.lua_atpanic             = lapi.lua_atpanic;\nmodule.exports.lua_atnativeerror       = lapi.lua_atnativeerror;\nmodule.exports.lua_call                = lapi.lua_call;\nmodule.exports.lua_callk               = lapi.lua_callk;\nmodule.exports.lua_checkstack          = lapi.lua_checkstack;\nmodule.exports.lua_close               = lstate.lua_close;\nmodule.exports.lua_compare             = lapi.lua_compare;\nmodule.exports.lua_concat              = lapi.lua_concat;\nmodule.exports.lua_copy                = lapi.lua_copy;\nmodule.exports.lua_createtable         = lapi.lua_createtable;\nmodule.exports.lua_dump                = lapi.lua_dump;\nmodule.exports.lua_error               = lapi.lua_error;\nmodule.exports.lua_gc                  = lapi.lua_gc;\nmodule.exports.lua_getallocf           = lapi.lua_getallocf;\nmodule.exports.lua_getextraspace       = lapi.lua_getextraspace;\nmodule.exports.lua_getfield            = lapi.lua_getfield;\nmodule.exports.lua_getglobal           = lapi.lua_getglobal;\nmodule.exports.lua_gethook             = ldebug.lua_gethook;\nmodule.exports.lua_gethookcount        = ldebug.lua_gethookcount;\nmodule.exports.lua_gethookmask         = ldebug.lua_gethookmask;\nmodule.exports.lua_geti                = lapi.lua_geti;\nmodule.exports.lua_getinfo             = ldebug.lua_getinfo;\nmodule.exports.lua_getlocal            = ldebug.lua_getlocal;\nmodule.exports.lua_getmetatable        = lapi.lua_getmetatable;\nmodule.exports.lua_getstack            = ldebug.lua_getstack;\nmodule.exports.lua_gettable            = lapi.lua_gettable;\nmodule.exports.lua_gettop              = lapi.lua_gettop;\nmodule.exports.lua_getupvalue          = lapi.lua_getupvalue;\nmodule.exports.lua_getuservalue        = lapi.lua_getuservalue;\nmodule.exports.lua_insert              = lapi.lua_insert;\nmodule.exports.lua_isboolean           = lapi.lua_isboolean;\nmodule.exports.lua_iscfunction         = lapi.lua_iscfunction;\nmodule.exports.lua_isfunction          = lapi.lua_isfunction;\nmodule.exports.lua_isinteger           = lapi.lua_isinteger;\nmodule.exports.lua_islightuserdata     = lapi.lua_islightuserdata;\nmodule.exports.lua_isnil               = lapi.lua_isnil;\nmodule.exports.lua_isnone              = lapi.lua_isnone;\nmodule.exports.lua_isnoneornil         = lapi.lua_isnoneornil;\nmodule.exports.lua_isnumber            = lapi.lua_isnumber;\nmodule.exports.lua_isproxy             = lapi.lua_isproxy;\nmodule.exports.lua_isstring            = lapi.lua_isstring;\nmodule.exports.lua_istable             = lapi.lua_istable;\nmodule.exports.lua_isthread            = lapi.lua_isthread;\nmodule.exports.lua_isuserdata          = lapi.lua_isuserdata;\nmodule.exports.lua_isyieldable         = ldo.lua_isyieldable;\nmodule.exports.lua_len                 = lapi.lua_len;\nmodule.exports.lua_load                = lapi.lua_load;\nmodule.exports.lua_newstate            = lstate.lua_newstate;\nmodule.exports.lua_newtable            = lapi.lua_newtable;\nmodule.exports.lua_newthread           = lstate.lua_newthread;\nmodule.exports.lua_newuserdata         = lapi.lua_newuserdata;\nmodule.exports.lua_next                = lapi.lua_next;\nmodule.exports.lua_pcall               = lapi.lua_pcall;\nmodule.exports.lua_pcallk              = lapi.lua_pcallk;\nmodule.exports.lua_pop                 = lapi.lua_pop;\nmodule.exports.lua_pushboolean         = lapi.lua_pushboolean;\nmodule.exports.lua_pushcclosure        = lapi.lua_pushcclosure;\nmodule.exports.lua_pushcfunction       = lapi.lua_pushcfunction;\nmodule.exports.lua_pushfstring         = lapi.lua_pushfstring;\nmodule.exports.lua_pushglobaltable     = lapi.lua_pushglobaltable;\nmodule.exports.lua_pushinteger         = lapi.lua_pushinteger;\nmodule.exports.lua_pushjsclosure       = lapi.lua_pushjsclosure;\nmodule.exports.lua_pushjsfunction      = lapi.lua_pushjsfunction;\nmodule.exports.lua_pushlightuserdata   = lapi.lua_pushlightuserdata;\nmodule.exports.lua_pushliteral         = lapi.lua_pushliteral;\nmodule.exports.lua_pushlstring         = lapi.lua_pushlstring;\nmodule.exports.lua_pushnil             = lapi.lua_pushnil;\nmodule.exports.lua_pushnumber          = lapi.lua_pushnumber;\nmodule.exports.lua_pushstring          = lapi.lua_pushstring;\nmodule.exports.lua_pushthread          = lapi.lua_pushthread;\nmodule.exports.lua_pushvalue           = lapi.lua_pushvalue;\nmodule.exports.lua_pushvfstring        = lapi.lua_pushvfstring;\nmodule.exports.lua_rawequal            = lapi.lua_rawequal;\nmodule.exports.lua_rawget              = lapi.lua_rawget;\nmodule.exports.lua_rawgeti             = lapi.lua_rawgeti;\nmodule.exports.lua_rawgetp             = lapi.lua_rawgetp;\nmodule.exports.lua_rawlen              = lapi.lua_rawlen;\nmodule.exports.lua_rawset              = lapi.lua_rawset;\nmodule.exports.lua_rawseti             = lapi.lua_rawseti;\nmodule.exports.lua_rawsetp             = lapi.lua_rawsetp;\nmodule.exports.lua_register            = lapi.lua_register;\nmodule.exports.lua_remove              = lapi.lua_remove;\nmodule.exports.lua_replace             = lapi.lua_replace;\nmodule.exports.lua_resume              = ldo.lua_resume;\nmodule.exports.lua_rotate              = lapi.lua_rotate;\nmodule.exports.lua_setallof            = ldo.lua_setallof;\nmodule.exports.lua_setfield            = lapi.lua_setfield;\nmodule.exports.lua_setglobal           = lapi.lua_setglobal;\nmodule.exports.lua_sethook             = ldebug.lua_sethook;\nmodule.exports.lua_seti                = lapi.lua_seti;\nmodule.exports.lua_setlocal            = ldebug.lua_setlocal;\nmodule.exports.lua_setmetatable        = lapi.lua_setmetatable;\nmodule.exports.lua_settable            = lapi.lua_settable;\nmodule.exports.lua_settop              = lapi.lua_settop;\nmodule.exports.lua_setupvalue          = lapi.lua_setupvalue;\nmodule.exports.lua_setuservalue        = lapi.lua_setuservalue;\nmodule.exports.lua_status              = lapi.lua_status;\nmodule.exports.lua_stringtonumber      = lapi.lua_stringtonumber;\nmodule.exports.lua_toboolean           = lapi.lua_toboolean;\nmodule.exports.lua_todataview          = lapi.lua_todataview;\nmodule.exports.lua_tointeger           = lapi.lua_tointeger;\nmodule.exports.lua_tointegerx          = lapi.lua_tointegerx;\nmodule.exports.lua_tojsstring          = lapi.lua_tojsstring;\nmodule.exports.lua_tolstring           = lapi.lua_tolstring;\nmodule.exports.lua_tonumber            = lapi.lua_tonumber;\nmodule.exports.lua_tonumberx           = lapi.lua_tonumberx;\nmodule.exports.lua_topointer           = lapi.lua_topointer;\nmodule.exports.lua_toproxy             = lapi.lua_toproxy;\nmodule.exports.lua_tostring            = lapi.lua_tostring;\nmodule.exports.lua_tothread            = lapi.lua_tothread;\nmodule.exports.lua_touserdata          = lapi.lua_touserdata;\nmodule.exports.lua_type                = lapi.lua_type;\nmodule.exports.lua_typename            = lapi.lua_typename;\nmodule.exports.lua_upvalueid           = lapi.lua_upvalueid;\nmodule.exports.lua_upvaluejoin         = lapi.lua_upvaluejoin;\nmodule.exports.lua_version             = lapi.lua_version;\nmodule.exports.lua_xmove               = lapi.lua_xmove;\nmodule.exports.lua_yield               = ldo.lua_yield;\nmodule.exports.lua_yieldk              = ldo.lua_yieldk;\nmodule.exports.lua_tocfunction         = lapi.lua_tocfunction;\n","\"use strict\";\n\nconst conf = (process.env.FENGARICONF ? JSON.parse(process.env.FENGARICONF) : {});\n\nconst {\n    LUA_VERSION_MAJOR,\n    LUA_VERSION_MINOR,\n    to_luastring\n} = require('./defs.js');\n\n/*\n** LUA_PATH_SEP is the character that separates templates in a path.\n** LUA_PATH_MARK is the string that marks the substitution points in a\n** template.\n** LUA_EXEC_DIR in a Windows path is replaced by the executable's\n** directory.\n*/\nconst LUA_PATH_SEP  = \";\";\nmodule.exports.LUA_PATH_SEP = LUA_PATH_SEP;\n\nconst LUA_PATH_MARK = \"?\";\nmodule.exports.LUA_PATH_MARK = LUA_PATH_MARK;\n\nconst LUA_EXEC_DIR  = \"!\";\nmodule.exports.LUA_EXEC_DIR = LUA_EXEC_DIR;\n\n/*\n@@ LUA_PATH_DEFAULT is the default path that Lua uses to look for\n** Lua libraries.\n@@ LUA_JSPATH_DEFAULT is the default path that Lua uses to look for\n** JS libraries.\n** CHANGE them if your machine has a non-conventional directory\n** hierarchy or if you want to install your libraries in\n** non-conventional directories.\n*/\nconst LUA_VDIR = LUA_VERSION_MAJOR + \".\" + LUA_VERSION_MINOR;\nmodule.exports.LUA_VDIR = LUA_VDIR;\n\nif (typeof process === \"undefined\") {\n    const LUA_DIRSEP = \"/\";\n    module.exports.LUA_DIRSEP = LUA_DIRSEP;\n\n    const LUA_LDIR = \"./lua/\" + LUA_VDIR + \"/\";\n    module.exports.LUA_LDIR = LUA_LDIR;\n\n    const LUA_JSDIR = LUA_LDIR;\n    module.exports.LUA_JSDIR = LUA_JSDIR;\n\n    const LUA_PATH_DEFAULT = to_luastring(\n        LUA_LDIR + \"?.lua;\" + LUA_LDIR + \"?/init.lua;\" +\n        /* LUA_JSDIR excluded as it is equal to LUA_LDIR */\n        \"./?.lua;./?/init.lua\"\n    );\n    module.exports.LUA_PATH_DEFAULT = LUA_PATH_DEFAULT;\n\n    const LUA_JSPATH_DEFAULT = to_luastring(\n        LUA_JSDIR + \"?.js;\" + LUA_JSDIR + \"loadall.js;./?.js\"\n    );\n    module.exports.LUA_JSPATH_DEFAULT = LUA_JSPATH_DEFAULT;\n} else if (require('os').platform() === 'win32') {\n    const LUA_DIRSEP = \"\\\\\";\n    module.exports.LUA_DIRSEP = LUA_DIRSEP;\n\n    /*\n    ** In Windows, any exclamation mark ('!') in the path is replaced by the\n    ** path of the directory of the executable file of the current process.\n    */\n    const LUA_LDIR = \"!\\\\lua\\\\\";\n    module.exports.LUA_LDIR = LUA_LDIR;\n\n    const LUA_JSDIR = \"!\\\\\";\n    module.exports.LUA_JSDIR = LUA_JSDIR;\n\n    const LUA_SHRDIR = \"!\\\\..\\\\share\\\\lua\\\\\" + LUA_VDIR + \"\\\\\";\n    module.exports.LUA_SHRDIR = LUA_SHRDIR;\n\n    const LUA_PATH_DEFAULT = to_luastring(\n        LUA_LDIR + \"?.lua;\" + LUA_LDIR + \"?\\\\init.lua;\" +\n        LUA_JSDIR + \"?.lua;\" + LUA_JSDIR + \"?\\\\init.lua;\" +\n        LUA_SHRDIR + \"?.lua;\" + LUA_SHRDIR + \"?\\\\init.lua;\" +\n        \".\\\\?.lua;.\\\\?\\\\init.lua\"\n    );\n    module.exports.LUA_PATH_DEFAULT = LUA_PATH_DEFAULT;\n\n    const LUA_JSPATH_DEFAULT = to_luastring(\n        LUA_JSDIR + \"?.js;\" +\n        LUA_JSDIR + \"..\\\\share\\\\lua\\\\\" + LUA_VDIR + \"\\\\?.js;\" +\n        LUA_JSDIR + \"loadall.js;.\\\\?.js\"\n    );\n    module.exports.LUA_JSPATH_DEFAULT = LUA_JSPATH_DEFAULT;\n} else {\n    const LUA_DIRSEP = \"/\";\n    module.exports.LUA_DIRSEP = LUA_DIRSEP;\n\n    const LUA_ROOT = \"/usr/local/\";\n    module.exports.LUA_ROOT = LUA_ROOT;\n    const LUA_ROOT2 = \"/usr/\";\n\n    const LUA_LDIR = LUA_ROOT + \"share/lua/\" + LUA_VDIR + \"/\";\n    const LUA_LDIR2 = LUA_ROOT2 + \"share/lua/\" + LUA_VDIR + \"/\";\n    module.exports.LUA_LDIR = LUA_LDIR;\n\n    const LUA_JSDIR = LUA_LDIR;\n    module.exports.LUA_JSDIR = LUA_JSDIR;\n    const LUA_JSDIR2 = LUA_LDIR2;\n\n    const LUA_PATH_DEFAULT = to_luastring(\n        LUA_LDIR + \"?.lua;\" + LUA_LDIR + \"?/init.lua;\" +\n        LUA_LDIR2 + \"?.lua;\" + LUA_LDIR2 + \"?/init.lua;\" +\n        /* LUA_JSDIR(2) excluded as it is equal to LUA_LDIR(2) */\n        \"./?.lua;./?/init.lua\"\n    );\n    module.exports.LUA_PATH_DEFAULT = LUA_PATH_DEFAULT;\n\n    const LUA_JSPATH_DEFAULT = to_luastring(\n        LUA_JSDIR + \"?.js;\" + LUA_JSDIR + \"loadall.js;\" +\n        LUA_JSDIR2 + \"?.js;\" + LUA_JSDIR2 + \"loadall.js;\" +\n        \"./?.js\"\n    );\n    module.exports.LUA_JSPATH_DEFAULT = LUA_JSPATH_DEFAULT;\n}\n\n/*\n@@ LUA_COMPAT_FLOATSTRING makes Lua format integral floats without a\n@@ a float mark ('.0').\n** This macro is not on by default even in compatibility mode,\n** because this is not really an incompatibility.\n*/\nconst LUA_COMPAT_FLOATSTRING = conf.LUA_COMPAT_FLOATSTRING || false;\n\nconst LUA_MAXINTEGER = 2147483647;\nconst LUA_MININTEGER = -2147483648;\n\n/*\n@@ LUAI_MAXSTACK limits the size of the Lua stack.\n** CHANGE it if you need a different limit. This limit is arbitrary;\n** its only purpose is to stop Lua from consuming unlimited stack\n** space (and to reserve some numbers for pseudo-indices).\n*/\nconst LUAI_MAXSTACK = conf.LUAI_MAXSTACK || 1000000;\n\n/*\n@@ LUA_IDSIZE gives the maximum size for the description of the source\n@@ of a function in debug information.\n** CHANGE it if you want a different size.\n*/\nconst LUA_IDSIZE = conf.LUA_IDSIZE || (60-1); /* fengari uses 1 less than lua as we don't embed the null byte */\n\nconst lua_integer2str = function(n) {\n    return String(n); /* should match behaviour of LUA_INTEGER_FMT */\n};\n\nconst lua_number2str = function(n) {\n    return String(Number(n.toPrecision(14))); /* should match behaviour of LUA_NUMBER_FMT */\n};\n\nconst lua_numbertointeger = function(n) {\n    return n >= LUA_MININTEGER && n < -LUA_MININTEGER ? n : false;\n};\n\nconst LUA_INTEGER_FRMLEN = \"\";\nconst LUA_NUMBER_FRMLEN = \"\";\n\nconst LUA_INTEGER_FMT = `%${LUA_INTEGER_FRMLEN}d`;\nconst LUA_NUMBER_FMT  = \"%.14g\";\n\nconst lua_getlocaledecpoint = function() {\n    /* we hard-code the decimal point to '.' as a user cannot change the\n       locale in most JS environments, and in that you can, a multi-byte\n       locale is common.\n    */\n    return 46 /* '.'.charCodeAt(0) */;\n};\n\nconst luai_apicheck = function(l, e) {\n    if (!e) throw Error(e);\n};\n\n/*\n@@ LUAL_BUFFERSIZE is the buffer size used by the lauxlib buffer system.\n*/\nconst LUAL_BUFFERSIZE = conf.LUAL_BUFFERSIZE || 8192;\n\n// See: http://croquetweak.blogspot.fr/2014/08/deconstructing-floats-frexp-and-ldexp.html\nconst frexp = function(value) {\n    if (value === 0) return [value, 0];\n    var data = new DataView(new ArrayBuffer(8));\n    data.setFloat64(0, value);\n    var bits = (data.getUint32(0) >>> 20) & 0x7FF;\n    if (bits === 0) { // denormal\n        data.setFloat64(0, value * Math.pow(2, 64));  // exp + 64\n        bits = ((data.getUint32(0) >>> 20) & 0x7FF) - 64;\n    }\n    var exponent = bits - 1022;\n    var mantissa = ldexp(value, -exponent);\n    return [mantissa, exponent];\n};\n\nconst ldexp = function(mantissa, exponent) {\n    var steps = Math.min(3, Math.ceil(Math.abs(exponent) / 1023));\n    var result = mantissa;\n    for (var i = 0; i < steps; i++)\n        result *= Math.pow(2, Math.floor((exponent + i) / steps));\n    return result;\n};\n\nmodule.exports.LUAI_MAXSTACK          = LUAI_MAXSTACK;\nmodule.exports.LUA_COMPAT_FLOATSTRING = LUA_COMPAT_FLOATSTRING;\nmodule.exports.LUA_IDSIZE             = LUA_IDSIZE;\nmodule.exports.LUA_INTEGER_FMT        = LUA_INTEGER_FMT;\nmodule.exports.LUA_INTEGER_FRMLEN     = LUA_INTEGER_FRMLEN;\nmodule.exports.LUA_MAXINTEGER         = LUA_MAXINTEGER;\nmodule.exports.LUA_MININTEGER         = LUA_MININTEGER;\nmodule.exports.LUA_NUMBER_FMT         = LUA_NUMBER_FMT;\nmodule.exports.LUA_NUMBER_FRMLEN      = LUA_NUMBER_FRMLEN;\nmodule.exports.LUAL_BUFFERSIZE        = LUAL_BUFFERSIZE;\nmodule.exports.frexp                  = frexp;\nmodule.exports.ldexp                  = ldexp;\nmodule.exports.lua_getlocaledecpoint  = lua_getlocaledecpoint;\nmodule.exports.lua_integer2str        = lua_integer2str;\nmodule.exports.lua_number2str         = lua_number2str;\nmodule.exports.lua_numbertointeger    = lua_numbertointeger;\nmodule.exports.luai_apicheck          = luai_apicheck;\n","\"use strict\";\n\nconst {\n    LUA_SIGNATURE,\n    constant_types: {\n        LUA_TBOOLEAN,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TSHRSTR\n    },\n    thread_status: { LUA_ERRSYNTAX },\n    is_luastring,\n    luastring_eq,\n    to_luastring\n} = require('./defs.js');\nconst ldo      = require('./ldo.js');\nconst lfunc    = require('./lfunc.js');\nconst lobject  = require('./lobject.js');\nconst {\n    MAXARG_sBx,\n    POS_A,\n    POS_Ax,\n    POS_B,\n    POS_Bx,\n    POS_C,\n    POS_OP,\n    SIZE_A,\n    SIZE_Ax,\n    SIZE_B,\n    SIZE_Bx,\n    SIZE_C,\n    SIZE_OP\n} = require('./lopcodes.js');\nconst { lua_assert } = require(\"./llimits.js\");\nconst { luaS_bless } = require('./lstring.js');\nconst {\n    luaZ_read,\n    ZIO\n} = require('./lzio.js');\n\nlet LUAC_DATA = [0x19, 0x93, 13, 10, 0x1a, 10];\n\nclass BytecodeParser {\n\n    constructor(L, Z, name) {\n        this.intSize = 4;\n        this.size_tSize = 4;\n        this.instructionSize = 4;\n        this.integerSize = 4;\n        this.numberSize = 8;\n\n        lua_assert(Z instanceof ZIO, \"BytecodeParser only operates on a ZIO\");\n        lua_assert(is_luastring(name));\n\n        if (name[0] === 64 /* ('@').charCodeAt(0) */ || name[0] === 61 /* ('=').charCodeAt(0) */)\n            this.name = name.subarray(1);\n        else if (name[0] == LUA_SIGNATURE[0])\n            this.name = to_luastring(\"binary string\", true);\n        else\n            this.name = name;\n\n        this.L = L;\n        this.Z = Z;\n\n        // Used to do buffer to number conversions\n        this.arraybuffer = new ArrayBuffer(\n            Math.max(this.intSize, this.size_tSize, this.instructionSize, this.integerSize, this.numberSize)\n        );\n        this.dv = new DataView(this.arraybuffer);\n        this.u8 = new Uint8Array(this.arraybuffer);\n    }\n\n    read(size) {\n        let u8 = new Uint8Array(size);\n        if(luaZ_read(this.Z, u8, 0, size) !== 0)\n            this.error(\"truncated\");\n        return u8;\n    }\n\n    LoadByte() {\n        if (luaZ_read(this.Z, this.u8, 0, 1) !== 0)\n            this.error(\"truncated\");\n        return this.u8[0];\n    }\n\n    LoadInt() {\n        if (luaZ_read(this.Z, this.u8, 0, this.intSize) !== 0)\n            this.error(\"truncated\");\n        return this.dv.getInt32(0, true);\n    }\n\n    LoadNumber() {\n        if (luaZ_read(this.Z, this.u8, 0, this.numberSize) !== 0)\n            this.error(\"truncated\");\n        return this.dv.getFloat64(0, true);\n    }\n\n    LoadInteger() {\n        if (luaZ_read(this.Z, this.u8, 0, this.integerSize) !== 0)\n            this.error(\"truncated\");\n        return this.dv.getInt32(0, true);\n    }\n\n    LoadSize_t() {\n        return this.LoadInteger();\n    }\n\n    LoadString() {\n        let size = this.LoadByte();\n        if (size === 0xFF)\n            size = this.LoadSize_t();\n        if (size === 0)\n            return null;\n        return luaS_bless(this.L, this.read(size-1));\n    }\n\n    /* creates a mask with 'n' 1 bits at position 'p' */\n    static MASK1(n, p) {\n        return ((~((~0)<<(n)))<<(p));\n    }\n\n    LoadCode(f) {\n        let n = this.LoadInt();\n        let p = BytecodeParser;\n\n        for (let i = 0; i < n; i++) {\n            if (luaZ_read(this.Z, this.u8, 0, this.instructionSize) !== 0)\n                this.error(\"truncated\");\n            let ins = this.dv.getUint32(0, true);\n            f.code[i] = {\n                code:   ins,\n                opcode: (ins >> POS_OP) & p.MASK1(SIZE_OP, 0),\n                A:      (ins >> POS_A)  & p.MASK1(SIZE_A,  0),\n                B:      (ins >> POS_B)  & p.MASK1(SIZE_B,  0),\n                C:      (ins >> POS_C)  & p.MASK1(SIZE_C,  0),\n                Bx:     (ins >> POS_Bx) & p.MASK1(SIZE_Bx, 0),\n                Ax:     (ins >> POS_Ax) & p.MASK1(SIZE_Ax, 0),\n                sBx:    ((ins >> POS_Bx) & p.MASK1(SIZE_Bx, 0)) - MAXARG_sBx\n            };\n        }\n    }\n\n    LoadConstants(f) {\n        let n = this.LoadInt();\n\n        for (let i = 0; i < n; i++) {\n            let t = this.LoadByte();\n\n            switch (t) {\n                case LUA_TNIL:\n                    f.k.push(new lobject.TValue(LUA_TNIL, null));\n                    break;\n                case LUA_TBOOLEAN:\n                    f.k.push(new lobject.TValue(LUA_TBOOLEAN, this.LoadByte() !== 0));\n                    break;\n                case LUA_TNUMFLT:\n                    f.k.push(new lobject.TValue(LUA_TNUMFLT, this.LoadNumber()));\n                    break;\n                case LUA_TNUMINT:\n                    f.k.push(new lobject.TValue(LUA_TNUMINT, this.LoadInteger()));\n                    break;\n                case LUA_TSHRSTR:\n                case LUA_TLNGSTR:\n                    f.k.push(new lobject.TValue(LUA_TLNGSTR, this.LoadString()));\n                    break;\n                default:\n                    this.error(`unrecognized constant '${t}'`);\n            }\n        }\n    }\n\n    LoadProtos(f) {\n        let n = this.LoadInt();\n\n        for (let i = 0; i < n; i++) {\n            f.p[i] = new lfunc.Proto(this.L);\n            this.LoadFunction(f.p[i], f.source);\n        }\n    }\n\n    LoadUpvalues(f) {\n        let n = this.LoadInt();\n\n        for (let i = 0; i < n; i++) {\n            f.upvalues[i] = {\n                name:    null,\n                instack: this.LoadByte(),\n                idx:     this.LoadByte()\n            };\n        }\n    }\n\n    LoadDebug(f) {\n        let n = this.LoadInt();\n        for (let i = 0; i < n; i++)\n            f.lineinfo[i] = this.LoadInt();\n\n        n = this.LoadInt();\n        for (let i = 0; i < n; i++) {\n            f.locvars[i] = {\n                varname: this.LoadString(),\n                startpc: this.LoadInt(),\n                endpc:   this.LoadInt()\n            };\n        }\n\n        n = this.LoadInt();\n        for (let i = 0; i < n; i++) {\n            f.upvalues[i].name = this.LoadString();\n        }\n    }\n\n    LoadFunction(f, psource) {\n        f.source = this.LoadString();\n        if (f.source === null)  /* no source in dump? */\n            f.source = psource;  /* reuse parent's source */\n        f.linedefined = this.LoadInt();\n        f.lastlinedefined = this.LoadInt();\n        f.numparams = this.LoadByte();\n        f.is_vararg = this.LoadByte() !== 0;\n        f.maxstacksize = this.LoadByte();\n        this.LoadCode(f);\n        this.LoadConstants(f);\n        this.LoadUpvalues(f);\n        this.LoadProtos(f);\n        this.LoadDebug(f);\n    }\n\n    checkliteral(s, msg) {\n        let buff = this.read(s.length);\n        if (!luastring_eq(buff, s))\n            this.error(msg);\n    }\n\n    checkHeader() {\n        this.checkliteral(LUA_SIGNATURE.subarray(1), \"not a\"); /* 1st char already checked */\n\n        if (this.LoadByte() !== 0x53)\n            this.error(\"version mismatch in\");\n\n        if (this.LoadByte() !== 0)\n            this.error(\"format mismatch in\");\n\n        this.checkliteral(LUAC_DATA, \"corrupted\");\n\n        this.intSize         = this.LoadByte();\n        this.size_tSize      = this.LoadByte();\n        this.instructionSize = this.LoadByte();\n        this.integerSize     = this.LoadByte();\n        this.numberSize      = this.LoadByte();\n\n        this.checksize(this.intSize, 4, \"int\");\n        this.checksize(this.size_tSize, 4, \"size_t\");\n        this.checksize(this.instructionSize, 4, \"instruction\");\n        this.checksize(this.integerSize, 4, \"integer\");\n        this.checksize(this.numberSize, 8, \"number\");\n\n        if (this.LoadInteger() !== 0x5678)\n            this.error(\"endianness mismatch in\");\n\n        if (this.LoadNumber() !== 370.5)\n            this.error(\"float format mismatch in\");\n\n    }\n\n    error(why) {\n        lobject.luaO_pushfstring(this.L, to_luastring(\"%s: %s precompiled chunk\"), this.name, to_luastring(why));\n        ldo.luaD_throw(this.L, LUA_ERRSYNTAX);\n    }\n\n    checksize(byte, size, tname) {\n        if (byte !== size)\n            this.error(`${tname} size mismatch in`);\n    }\n}\n\nconst luaU_undump = function(L, Z, name) {\n    let S = new BytecodeParser(L, Z, name);\n    S.checkHeader();\n    let cl = lfunc.luaF_newLclosure(L, S.LoadByte());\n    ldo.luaD_inctop(L);\n    L.stack[L.top-1].setclLvalue(cl);\n    cl.p = new lfunc.Proto(L);\n    S.LoadFunction(cl.p, null);\n    lua_assert(cl.nupvalues === cl.p.upvalues.length);\n    /* luai_verifycode */\n    return cl;\n};\n\nmodule.exports.luaU_undump = luaU_undump;\n","\"use strict\";\n\nconst {\n    LUA_MASKLINE,\n    LUA_MASKCOUNT,\n    LUA_MULTRET,\n    constant_types: {\n        LUA_TBOOLEAN,\n        LUA_TLCF,\n        LUA_TLIGHTUSERDATA,\n        LUA_TLNGSTR,\n        LUA_TNIL,\n        LUA_TNUMBER,\n        LUA_TNUMFLT,\n        LUA_TNUMINT,\n        LUA_TSHRSTR,\n        LUA_TTABLE,\n        LUA_TUSERDATA\n    },\n    to_luastring\n} = require('./defs.js');\nconst {\n    INDEXK,\n    ISK,\n    LFIELDS_PER_FLUSH,\n    OpCodesI: {\n        OP_ADD,\n        OP_BAND,\n        OP_BNOT,\n        OP_BOR,\n        OP_BXOR,\n        OP_CALL,\n        OP_CLOSURE,\n        OP_CONCAT,\n        OP_DIV,\n        OP_EQ,\n        OP_EXTRAARG,\n        OP_FORLOOP,\n        OP_FORPREP,\n        OP_GETTABLE,\n        OP_GETTABUP,\n        OP_GETUPVAL,\n        OP_IDIV,\n        OP_JMP,\n        OP_LE,\n        OP_LEN,\n        OP_LOADBOOL,\n        OP_LOADK,\n        OP_LOADKX,\n        OP_LOADNIL,\n        OP_LT,\n        OP_MOD,\n        OP_MOVE,\n        OP_MUL,\n        OP_NEWTABLE,\n        OP_NOT,\n        OP_POW,\n        OP_RETURN,\n        OP_SELF,\n        OP_SETLIST,\n        OP_SETTABLE,\n        OP_SETTABUP,\n        OP_SETUPVAL,\n        OP_SHL,\n        OP_SHR,\n        OP_SUB,\n        OP_TAILCALL,\n        OP_TEST,\n        OP_TESTSET,\n        OP_TFORCALL,\n        OP_TFORLOOP,\n        OP_UNM,\n        OP_VARARG\n    }\n} = require('./lopcodes.js');\nconst {\n    LUA_MAXINTEGER,\n    LUA_MININTEGER,\n    lua_numbertointeger\n} = require('./luaconf.js');\nconst {\n    lua_assert,\n    luai_nummod\n} = require('./llimits.js');\nconst lobject = require('./lobject.js');\nconst lfunc   = require('./lfunc.js');\nconst lstate  = require('./lstate.js');\nconst {\n    luaS_bless,\n    luaS_eqlngstr,\n    luaS_hashlongstr\n} = require('./lstring.js');\nconst ldo     = require('./ldo.js');\nconst ltm     = require('./ltm.js');\nconst ltable  = require('./ltable.js');\nconst ldebug  = require('./ldebug.js');\n\n/*\n** finish execution of an opcode interrupted by an yield\n*/\nconst luaV_finishOp = function(L) {\n    let ci = L.ci;\n    let base = ci.l_base;\n    let inst = ci.l_code[ci.l_savedpc - 1];  /* interrupted instruction */\n    let op = inst.opcode;\n\n    switch (op) {  /* finish its execution */\n        case OP_ADD: case OP_SUB: case OP_MUL: case OP_DIV: case OP_IDIV:\n        case OP_BAND: case OP_BOR: case OP_BXOR: case OP_SHL: case OP_SHR:\n        case OP_MOD: case OP_POW:\n        case OP_UNM: case OP_BNOT: case OP_LEN:\n        case OP_GETTABUP: case OP_GETTABLE: case OP_SELF: {\n            lobject.setobjs2s(L, base + inst.A, L.top-1);\n            delete L.stack[--L.top];\n            break;\n        }\n        case OP_LE: case OP_LT: case OP_EQ: {\n            let res = !L.stack[L.top - 1].l_isfalse();\n            delete L.stack[--L.top];\n            if (ci.callstatus & lstate.CIST_LEQ) {  /* \"<=\" using \"<\" instead? */\n                lua_assert(op === OP_LE);\n                ci.callstatus ^= lstate.CIST_LEQ;  /* clear mark */\n                res = !res;  /* negate result */\n            }\n            lua_assert(ci.l_code[ci.l_savedpc].opcode === OP_JMP);\n            if (res !== (inst.A ? true : false))  /* condition failed? */\n                ci.l_savedpc++;  /* skip jump instruction */\n            break;\n        }\n        case OP_CONCAT: {\n            let top = L.top - 1;  /* top when 'luaT_trybinTM' was called */\n            let b = inst.B;  /* first element to concatenate */\n            let total = top - 1 - (base + b);  /* yet to concatenate */\n            lobject.setobjs2s(L, top - 2, top);  /* put TM result in proper position */\n            if (total > 1) {  /* are there elements to concat? */\n                L.top = top - 1;  /* top is one after last element (at top-2) */\n                luaV_concat(L, total);  /* concat them (may yield again) */\n            }\n            /* move final result to final position */\n            lobject.setobjs2s(L, ci.l_base + inst.A, L.top - 1);\n            ldo.adjust_top(L, ci.top);  /* restore top */\n            break;\n        }\n        case OP_TFORCALL: {\n            lua_assert(ci.l_code[ci.l_savedpc].opcode === OP_TFORLOOP);\n            ldo.adjust_top(L, ci.top);  /* correct top */\n            break;\n        }\n        case OP_CALL: {\n            if (inst.C - 1 >= 0)  /* nresults >= 0? */\n                ldo.adjust_top(L, ci.top);  /* adjust results */\n            break;\n        }\n    }\n};\n\nconst RA = function(L, base, i) {\n    return base + i.A;\n};\n\nconst RB = function(L, base, i) {\n    return base + i.B;\n};\n\n// const RC = function(L, base, i) {\n//     return base + i.C;\n// };\n\nconst RKB = function(L, base, k, i) {\n    return ISK(i.B) ? k[INDEXK(i.B)] : L.stack[base + i.B];\n};\n\nconst RKC = function(L, base, k, i) {\n    return ISK(i.C) ? k[INDEXK(i.C)] : L.stack[base + i.C];\n};\n\nconst luaV_execute = function(L) {\n    let ci = L.ci;\n\n    ci.callstatus |= lstate.CIST_FRESH;\n    newframe:\n    for (;;) {\n        lua_assert(ci === L.ci);\n        let cl = ci.func.value;\n        let k = cl.p.k;\n        let base = ci.l_base;\n\n        let i = ci.l_code[ci.l_savedpc++];\n\n        if (L.hookmask & (LUA_MASKLINE | LUA_MASKCOUNT)) {\n            ldebug.luaG_traceexec(L);\n        }\n\n        let ra = RA(L, base, i);\n        let opcode = i.opcode;\n\n        switch (opcode) {\n            case OP_MOVE: {\n                lobject.setobjs2s(L, ra, RB(L, base, i));\n                break;\n            }\n            case OP_LOADK: {\n                let konst = k[i.Bx];\n                lobject.setobj2s(L, ra, konst);\n                break;\n            }\n            case OP_LOADKX: {\n                lua_assert(ci.l_code[ci.l_savedpc].opcode === OP_EXTRAARG);\n                let konst = k[ci.l_code[ci.l_savedpc++].Ax];\n                lobject.setobj2s(L, ra, konst);\n                break;\n            }\n            case OP_LOADBOOL: {\n                L.stack[ra].setbvalue(i.B !== 0);\n\n                if (i.C !== 0)\n                    ci.l_savedpc++; /* skip next instruction (if C) */\n\n                break;\n            }\n            case OP_LOADNIL: {\n                for (let j = 0; j <= i.B; j++)\n                    L.stack[ra + j].setnilvalue();\n                break;\n            }\n            case OP_GETUPVAL: {\n                let b = i.B;\n                lobject.setobj2s(L, ra, cl.upvals[b]);\n                break;\n            }\n            case OP_GETTABUP: {\n                let upval = cl.upvals[i.B];\n                let rc = RKC(L, base, k, i);\n                luaV_gettable(L, upval, rc, ra);\n                break;\n            }\n            case OP_GETTABLE: {\n                let rb = L.stack[RB(L, base, i)];\n                let rc = RKC(L, base, k, i);\n                luaV_gettable(L, rb, rc, ra);\n                break;\n            }\n            case OP_SETTABUP: {\n                let upval = cl.upvals[i.A];\n                let rb = RKB(L, base, k, i);\n                let rc = RKC(L, base, k, i);\n                settable(L, upval, rb, rc);\n                break;\n            }\n            case OP_SETUPVAL: {\n                let uv = cl.upvals[i.B];\n                uv.setfrom(L.stack[ra]);\n                break;\n            }\n            case OP_SETTABLE: {\n                let table = L.stack[ra];\n                let key = RKB(L, base, k, i);\n                let v = RKC(L, base, k, i);\n\n                settable(L, table, key, v);\n                break;\n            }\n            case OP_NEWTABLE: {\n                L.stack[ra].sethvalue(ltable.luaH_new(L));\n                break;\n            }\n            case OP_SELF: {\n                let rb = RB(L, base, i);\n                let rc = RKC(L, base, k, i);\n                lobject.setobjs2s(L, ra + 1, rb);\n                luaV_gettable(L, L.stack[rb], rc, ra);\n                break;\n            }\n            case OP_ADD: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if (op1.ttisinteger() && op2.ttisinteger()) {\n                    L.stack[ra].setivalue((op1.value + op2.value)|0);\n                } else if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(numberop1 + numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_ADD);\n                }\n                break;\n            }\n            case OP_SUB: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if (op1.ttisinteger() && op2.ttisinteger()) {\n                    L.stack[ra].setivalue((op1.value - op2.value)|0);\n                } else if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(numberop1 - numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_SUB);\n                }\n                break;\n            }\n            case OP_MUL: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if (op1.ttisinteger() && op2.ttisinteger()) {\n                    L.stack[ra].setivalue(luaV_imul(op1.value, op2.value));\n                } else if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(numberop1 * numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_MUL);\n                }\n                break;\n            }\n            case OP_MOD: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if (op1.ttisinteger() && op2.ttisinteger()) {\n                    L.stack[ra].setivalue(luaV_mod(L, op1.value, op2.value));\n                } else if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(luai_nummod(L, numberop1, numberop2));\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_MOD);\n                }\n                break;\n            }\n            case OP_POW: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(Math.pow(numberop1, numberop2));\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_POW);\n                }\n                break;\n            }\n            case OP_DIV: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(numberop1 / numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_DIV);\n                }\n                break;\n            }\n            case OP_IDIV: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if (op1.ttisinteger() && op2.ttisinteger()) {\n                    L.stack[ra].setivalue(luaV_div(L, op1.value, op2.value));\n                } else if ((numberop1 = tonumber(op1)) !== false && (numberop2 = tonumber(op2)) !== false) {\n                    L.stack[ra].setfltvalue(Math.floor(numberop1 / numberop2));\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_IDIV);\n                }\n                break;\n            }\n            case OP_BAND: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tointeger(op1)) !== false && (numberop2 = tointeger(op2)) !== false) {\n                    L.stack[ra].setivalue(numberop1 & numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_BAND);\n                }\n                break;\n            }\n            case OP_BOR: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tointeger(op1)) !== false && (numberop2 = tointeger(op2)) !== false) {\n                    L.stack[ra].setivalue(numberop1 | numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_BOR);\n                }\n                break;\n            }\n            case OP_BXOR: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tointeger(op1)) !== false && (numberop2 = tointeger(op2)) !== false) {\n                    L.stack[ra].setivalue(numberop1 ^ numberop2);\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_BXOR);\n                }\n                break;\n            }\n            case OP_SHL: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tointeger(op1)) !== false && (numberop2 = tointeger(op2)) !== false) {\n                    L.stack[ra].setivalue(luaV_shiftl(numberop1, numberop2));\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_SHL);\n                }\n                break;\n            }\n            case OP_SHR: {\n                let op1 = RKB(L, base, k, i);\n                let op2 = RKC(L, base, k, i);\n                let numberop1, numberop2;\n\n                if ((numberop1 = tointeger(op1)) !== false && (numberop2 = tointeger(op2)) !== false) {\n                    L.stack[ra].setivalue(luaV_shiftl(numberop1, -numberop2));\n                } else {\n                    ltm.luaT_trybinTM(L, op1, op2, L.stack[ra], ltm.TMS.TM_SHR);\n                }\n                break;\n            }\n            case OP_UNM: {\n                let op = L.stack[RB(L, base, i)];\n                let numberop;\n\n                if (op.ttisinteger()) {\n                    L.stack[ra].setivalue((-op.value)|0);\n                } else if ((numberop = tonumber(op)) !== false) {\n                    L.stack[ra].setfltvalue(-numberop);\n                } else {\n                    ltm.luaT_trybinTM(L, op, op, L.stack[ra], ltm.TMS.TM_UNM);\n                }\n                break;\n            }\n            case OP_BNOT: {\n                let op = L.stack[RB(L, base, i)];\n\n                if (op.ttisinteger()) {\n                    L.stack[ra].setivalue(~op.value);\n                } else {\n                    ltm.luaT_trybinTM(L, op, op, L.stack[ra], ltm.TMS.TM_BNOT);\n                }\n                break;\n            }\n            case OP_NOT: {\n                let op = L.stack[RB(L, base, i)];\n                L.stack[ra].setbvalue(op.l_isfalse());\n                break;\n            }\n            case OP_LEN: {\n                luaV_objlen(L, L.stack[ra], L.stack[RB(L, base, i)]);\n                break;\n            }\n            case OP_CONCAT: {\n                let b = i.B;\n                let c = i.C;\n                L.top = base + c + 1; /* mark the end of concat operands */\n                luaV_concat(L, c - b + 1);\n                let rb = base + b;\n                lobject.setobjs2s(L, ra, rb);\n                ldo.adjust_top(L, ci.top); /* restore top */\n                break;\n            }\n            case OP_JMP: {\n                dojump(L, ci, i, 0);\n                break;\n            }\n            case OP_EQ: {\n                if (luaV_equalobj(L, RKB(L, base, k, i), RKC(L, base, k, i)) !== i.A)\n                    ci.l_savedpc++;\n                else\n                    donextjump(L, ci);\n                break;\n            }\n            case OP_LT: {\n                if (luaV_lessthan(L, RKB(L, base, k, i), RKC(L, base, k, i)) !== i.A)\n                    ci.l_savedpc++;\n                else\n                    donextjump(L, ci);\n                break;\n            }\n            case OP_LE: {\n                if (luaV_lessequal(L, RKB(L, base, k, i), RKC(L, base, k, i)) !== i.A)\n                    ci.l_savedpc++;\n                else\n                    donextjump(L, ci);\n                break;\n            }\n            case OP_TEST: {\n                if (i.C ? L.stack[ra].l_isfalse() : !L.stack[ra].l_isfalse())\n                    ci.l_savedpc++;\n                else\n                    donextjump(L, ci);\n                break;\n            }\n            case OP_TESTSET: {\n                let rbIdx = RB(L, base, i);\n                let rb = L.stack[rbIdx];\n                if (i.C ? rb.l_isfalse() : !rb.l_isfalse())\n                    ci.l_savedpc++;\n                else {\n                    lobject.setobjs2s(L, ra, rbIdx);\n                    donextjump(L, ci);\n                }\n                break;\n            }\n            case OP_CALL: {\n                let b = i.B;\n                let nresults = i.C - 1;\n                if (b !== 0) ldo.adjust_top(L, ra+b);  /* else previous instruction set top */\n                if (ldo.luaD_precall(L, ra, nresults)) {\n                    if (nresults >= 0)\n                        ldo.adjust_top(L, ci.top);  /* adjust results */\n                } else {\n                    ci = L.ci;\n                    continue newframe;\n                }\n\n                break;\n            }\n            case OP_TAILCALL: {\n                let b = i.B;\n                if (b !== 0) ldo.adjust_top(L, ra+b);  /* else previous instruction set top */\n                if (ldo.luaD_precall(L, ra, LUA_MULTRET)) { // JS function\n                } else {\n                    /* tail call: put called frame (n) in place of caller one (o) */\n                    let nci = L.ci;\n                    let oci = nci.previous;\n                    let nfunc = nci.func;\n                    let nfuncOff = nci.funcOff;\n                    let ofuncOff = oci.funcOff;\n                    let lim = nci.l_base + nfunc.value.p.numparams;\n                    if (cl.p.p.length > 0) lfunc.luaF_close(L, oci.l_base);\n                    for (let aux = 0; nfuncOff + aux < lim; aux++)\n                        lobject.setobjs2s(L, ofuncOff + aux, nfuncOff + aux);\n                    oci.l_base = ofuncOff + (nci.l_base - nfuncOff);\n                    oci.top = ofuncOff + (L.top - nfuncOff);\n                    ldo.adjust_top(L, oci.top);  /* correct top */\n                    oci.l_code = nci.l_code;\n                    oci.l_savedpc = nci.l_savedpc;\n                    oci.callstatus |= lstate.CIST_TAIL;\n                    oci.next = null;\n                    ci = L.ci = oci;\n\n                    lua_assert(L.top === oci.l_base + L.stack[ofuncOff].value.p.maxstacksize);\n\n                    continue newframe;\n                }\n                break;\n            }\n            case OP_RETURN: {\n                if (cl.p.p.length > 0) lfunc.luaF_close(L, base);\n                let b = ldo.luaD_poscall(L, ci, ra, (i.B !== 0 ? i.B - 1 : L.top - ra));\n\n                if (ci.callstatus & lstate.CIST_FRESH)\n                    return; /* external invocation: return */\n                /* invocation via reentry: continue execution */\n                ci = L.ci;\n                if (b) ldo.adjust_top(L, ci.top);\n                lua_assert(ci.callstatus & lstate.CIST_LUA);\n                lua_assert(ci.l_code[ci.l_savedpc - 1].opcode === OP_CALL);\n                continue newframe;\n            }\n            case OP_FORLOOP: {\n                if (L.stack[ra].ttisinteger()) { /* integer loop? */\n                    let step = L.stack[ra + 2].value;\n                    let idx = (L.stack[ra].value + step)|0;\n                    let limit = L.stack[ra + 1].value;\n\n                    if (0 < step ? idx <= limit : limit <= idx) {\n                        ci.l_savedpc += i.sBx;\n                        L.stack[ra].chgivalue(idx);  /* update internal index... */\n                        L.stack[ra + 3].setivalue(idx);\n                    }\n                } else { /* floating loop */\n                    let step = L.stack[ra + 2].value;\n                    let idx = L.stack[ra].value + step;\n                    let limit = L.stack[ra + 1].value;\n\n                    if (0 < step ? idx <= limit : limit <= idx) {\n                        ci.l_savedpc += i.sBx;\n                        L.stack[ra].chgfltvalue(idx);  /* update internal index... */\n                        L.stack[ra + 3].setfltvalue(idx);\n                    }\n                }\n                break;\n            }\n            case OP_FORPREP: {\n                let init = L.stack[ra];\n                let plimit = L.stack[ra + 1];\n                let pstep = L.stack[ra + 2];\n                let forlim;\n\n                if (init.ttisinteger() && pstep.ttisinteger() && (forlim = forlimit(plimit, pstep.value))) {\n                    /* all values are integer */\n                    let initv = forlim.stopnow ? 0 : init.value;\n                    plimit.value = forlim.ilimit;\n                    init.value = (initv - pstep.value)|0;\n                } else { /* try making all values floats */\n                    let nlimit, nstep, ninit;\n                    if ((nlimit = tonumber(plimit)) === false)\n                        ldebug.luaG_runerror(L, to_luastring(\"'for' limit must be a number\", true));\n                    L.stack[ra + 1].setfltvalue(nlimit);\n                    if ((nstep = tonumber(pstep)) === false)\n                        ldebug.luaG_runerror(L, to_luastring(\"'for' step must be a number\", true));\n                    L.stack[ra + 2].setfltvalue(nstep);\n                    if ((ninit = tonumber(init)) === false)\n                        ldebug.luaG_runerror(L, to_luastring(\"'for' initial value must be a number\", true));\n                    L.stack[ra].setfltvalue(ninit - nstep);\n                }\n\n                ci.l_savedpc += i.sBx;\n                break;\n            }\n            case OP_TFORCALL: {\n                let cb = ra + 3; /* call base */\n                lobject.setobjs2s(L, cb+2, ra+2);\n                lobject.setobjs2s(L, cb+1, ra+1);\n                lobject.setobjs2s(L, cb, ra);\n                ldo.adjust_top(L, cb+3);  /* func. + 2 args (state and index) */\n                ldo.luaD_call(L, cb, i.C);\n                ldo.adjust_top(L, ci.top);\n                /* go straight to OP_TFORLOOP */\n                i = ci.l_code[ci.l_savedpc++];\n                ra = RA(L, base, i);\n                lua_assert(i.opcode === OP_TFORLOOP);\n            }\n            /* fall through */\n            case OP_TFORLOOP: {\n                if (!L.stack[ra + 1].ttisnil()) { /* continue loop? */\n                    lobject.setobjs2s(L, ra, ra + 1); /* save control variable */\n                    ci.l_savedpc += i.sBx; /* jump back */\n                }\n                break;\n            }\n            case OP_SETLIST: {\n                let n = i.B;\n                let c = i.C;\n\n                if (n === 0) n = L.top - ra - 1;\n\n                if (c === 0) {\n                    lua_assert(ci.l_code[ci.l_savedpc].opcode === OP_EXTRAARG);\n                    c = ci.l_code[ci.l_savedpc++].Ax;\n                }\n\n                let h = L.stack[ra].value;\n                let last = ((c - 1) * LFIELDS_PER_FLUSH) + n;\n\n                for (; n > 0; n--) {\n                    ltable.luaH_setint(h, last--, L.stack[ra + n]);\n                }\n                ldo.adjust_top(L, ci.top);  /* correct top (in case of previous open call) */\n                break;\n            }\n            case OP_CLOSURE: {\n                let p = cl.p.p[i.Bx];\n                let ncl = getcached(p, cl.upvals, L.stack, base);  /* cached closure */\n                if (ncl === null)  /* no match? */\n                    pushclosure(L, p, cl.upvals, base, ra);  /* create a new one */\n                else\n                    L.stack[ra].setclLvalue(ncl);\n                break;\n            }\n            case OP_VARARG: {\n                let b = i.B - 1;\n                let n = base - ci.funcOff - cl.p.numparams - 1;\n                let j;\n\n                if (n < 0) /* less arguments than parameters? */\n                    n = 0; /* no vararg arguments */\n\n                if (b < 0) {\n                    b = n;  /* get all var. arguments */\n                    ldo.luaD_checkstack(L, n);\n                    ldo.adjust_top(L, ra + n);\n                }\n\n                for (j = 0; j < b && j < n; j++)\n                    lobject.setobjs2s(L, ra + j, base - n + j);\n\n                for (; j < b; j++) /* complete required results with nil */\n                    L.stack[ra + j].setnilvalue();\n                break;\n            }\n            case OP_EXTRAARG: {\n                throw Error(\"invalid opcode\");\n            }\n        }\n    }\n};\n\nconst dojump = function(L, ci, i, e) {\n    let a = i.A;\n    if (a !== 0) lfunc.luaF_close(L, ci.l_base + a - 1);\n    ci.l_savedpc += i.sBx + e;\n};\n\nconst donextjump = function(L, ci) {\n    dojump(L, ci, ci.l_code[ci.l_savedpc], 1);\n};\n\n\nconst luaV_lessthan = function(L, l, r) {\n    if (l.ttisnumber() && r.ttisnumber())\n        return LTnum(l, r) ? 1 : 0;\n    else if (l.ttisstring() && r.ttisstring())\n        return l_strcmp(l.tsvalue(), r.tsvalue()) < 0 ? 1 : 0;\n    else {\n        let res = ltm.luaT_callorderTM(L, l, r, ltm.TMS.TM_LT);\n        if (res === null)\n            ldebug.luaG_ordererror(L, l, r);\n        return res ? 1 : 0;\n    }\n};\n\nconst luaV_lessequal = function(L, l, r) {\n    let res;\n\n    if (l.ttisnumber() && r.ttisnumber())\n        return LEnum(l, r) ? 1 : 0;\n    else if (l.ttisstring() && r.ttisstring())\n        return l_strcmp(l.tsvalue(), r.tsvalue()) <= 0 ? 1 : 0;\n    else {\n        res = ltm.luaT_callorderTM(L, l, r, ltm.TMS.TM_LE);\n        if (res !== null)\n            return res ? 1 : 0;\n    }\n    /* try 'lt': */\n    L.ci.callstatus |= lstate.CIST_LEQ; /* mark it is doing 'lt' for 'le' */\n    res = ltm.luaT_callorderTM(L, r, l, ltm.TMS.TM_LT);\n    L.ci.callstatus ^= lstate.CIST_LEQ; /* clear mark */\n    if (res === null)\n        ldebug.luaG_ordererror(L, l, r);\n    return res ? 0 : 1; /* result is negated */\n};\n\nconst luaV_equalobj = function(L, t1, t2) {\n    if (t1.ttype() !== t2.ttype()) { /* not the same variant? */\n        if (t1.ttnov() !== t2.ttnov() || t1.ttnov() !== LUA_TNUMBER)\n            return 0; /* only numbers can be equal with different variants */\n        else { /* two numbers with different variants */\n            /* OPTIMIZATION: instead of calling luaV_tointeger we can just let JS do the comparison */\n            return (t1.value === t2.value) ? 1 : 0;\n        }\n    }\n\n    let tm;\n\n    /* values have same type and same variant */\n    switch(t1.ttype()) {\n        case LUA_TNIL:\n            return 1;\n        case LUA_TBOOLEAN:\n            return t1.value == t2.value ? 1 : 0; // Might be 1 or true\n        case LUA_TLIGHTUSERDATA:\n        case LUA_TNUMINT:\n        case LUA_TNUMFLT:\n        case LUA_TLCF:\n            return t1.value === t2.value ? 1 : 0;\n        case LUA_TSHRSTR:\n        case LUA_TLNGSTR: {\n            return luaS_eqlngstr(t1.tsvalue(), t2.tsvalue()) ? 1 : 0;\n        }\n        case LUA_TUSERDATA:\n        case LUA_TTABLE:\n            if (t1.value === t2.value) return 1;\n            else if (L === null) return 0;\n\n            tm = ltm.fasttm(L, t1.value.metatable, ltm.TMS.TM_EQ);\n            if (tm === null)\n                tm = ltm.fasttm(L, t2.value.metatable, ltm.TMS.TM_EQ);\n            break;\n        default:\n            return t1.value === t2.value ? 1 : 0;\n    }\n\n    if (tm === null) /* no TM? */\n        return 0;\n\n    let tv = new lobject.TValue(); /* doesn't use the stack */\n    ltm.luaT_callTM(L, tm, t1, t2, tv, 1);\n    return tv.l_isfalse() ? 0 : 1;\n};\n\nconst luaV_rawequalobj = function(t1, t2) {\n    return luaV_equalobj(null, t1, t2);\n};\n\nconst forlimit = function(obj, step) {\n    let stopnow = false;\n    let ilimit = luaV_tointeger(obj, step < 0 ? 2 : 1);\n    if (ilimit === false) {\n        let n = tonumber(obj);\n        if (n === false)\n            return false;\n\n        if (0 < n) {\n            ilimit = LUA_MAXINTEGER;\n            if (step < 0) stopnow = true;\n        } else {\n            ilimit = LUA_MININTEGER;\n            if (step >= 0) stopnow = true;\n        }\n    }\n\n    return {\n        stopnow: stopnow,\n        ilimit: ilimit\n    };\n};\n\n/*\n** try to convert a value to an integer, rounding according to 'mode':\n** mode === 0: accepts only integral values\n** mode === 1: takes the floor of the number\n** mode === 2: takes the ceil of the number\n*/\nconst luaV_tointeger = function(obj, mode) {\n    if (obj.ttisfloat()) {\n        let n = obj.value;\n        let f = Math.floor(n);\n\n        if (n !== f) { /* not an integral value? */\n            if (mode === 0)\n                return false;  /* fails if mode demands integral value */\n            else if (mode > 1)  /* needs ceil? */\n                f += 1;  /* convert floor to ceil (remember: n !== f) */\n        }\n\n        return lua_numbertointeger(f);\n    } else if (obj.ttisinteger()) {\n        return obj.value;\n    } else if (cvt2num(obj)) {\n        let v = new lobject.TValue();\n        if (lobject.luaO_str2num(obj.svalue(), v) === (obj.vslen() + 1))\n            return luaV_tointeger(v, mode);\n    }\n\n    return false;\n};\n\nconst tointeger = function(o) {\n    return o.ttisinteger() ? o.value : luaV_tointeger(o, 0);\n};\n\nconst tonumber = function(o) {\n    if (o.ttnov() === LUA_TNUMBER)\n        return o.value;\n\n    if (cvt2num(o)) {  /* string convertible to number? */\n        let v = new lobject.TValue();\n        if (lobject.luaO_str2num(o.svalue(), v) === (o.vslen() + 1))\n            return v.value;\n    }\n\n    return false;\n};\n\n/*\n** Return 'l < r', for numbers.\n** As fengari uses javascript numbers for both floats and integers and has\n** correct semantics, we can just compare values.\n*/\nconst LTnum = function(l, r) {\n    return l.value < r.value;\n};\n\n/*\n** Return 'l <= r', for numbers.\n*/\nconst LEnum = function(l, r) {\n    return l.value <= r.value;\n};\n\n/*\n** Compare two strings 'ls' x 'rs', returning an integer smaller-equal-\n** -larger than zero if 'ls' is smaller-equal-larger than 'rs'.\n*/\nconst l_strcmp = function(ls, rs) {\n    let l = luaS_hashlongstr(ls);\n    let r = luaS_hashlongstr(rs);\n    /* In fengari we assume string hash has same collation as byte values */\n    if (l === r)\n        return 0;\n    else if (l < r)\n        return -1;\n    else\n        return 1;\n};\n\n/*\n** Main operation 'ra' = #rb'.\n*/\nconst luaV_objlen = function(L, ra, rb) {\n    let tm;\n    switch(rb.ttype()) {\n        case LUA_TTABLE: {\n            let h = rb.value;\n            tm = ltm.fasttm(L, h.metatable, ltm.TMS.TM_LEN);\n            if (tm !== null) break; /* metamethod? break switch to call it */\n            ra.setivalue(ltable.luaH_getn(h)); /* else primitive len */\n            return;\n        }\n        case LUA_TSHRSTR:\n        case LUA_TLNGSTR:\n            ra.setivalue(rb.vslen());\n            return;\n        default: {\n            tm = ltm.luaT_gettmbyobj(L, rb, ltm.TMS.TM_LEN);\n            if (tm.ttisnil())\n                ldebug.luaG_typeerror(L, rb, to_luastring(\"get length of\", true));\n            break;\n        }\n    }\n\n    ltm.luaT_callTM(L, tm, rb, rb, ra, 1);\n};\n\n/* Shim taken from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/imul */\nconst luaV_imul = Math.imul || function(a, b) {\n    let aHi = (a >>> 16) & 0xffff;\n    let aLo = a & 0xffff;\n    let bHi = (b >>> 16) & 0xffff;\n    let bLo = b & 0xffff;\n    /*\n    ** the shift by 0 fixes the sign on the high part\n    ** the final |0 converts the unsigned value into a signed value\n    */\n    return ((aLo * bLo) + (((aHi * bLo + aLo * bHi) << 16) >>> 0) | 0);\n};\n\nconst luaV_div = function(L, m, n) {\n    if (n === 0)\n        ldebug.luaG_runerror(L, to_luastring(\"attempt to divide by zero\"));\n    return Math.floor(m / n)|0;\n};\n\n// % semantic on negative numbers is different in js\nconst luaV_mod = function(L, m, n) {\n    if (n === 0)\n        ldebug.luaG_runerror(L, to_luastring(\"attempt to perform 'n%%0'\"));\n    return (m - Math.floor(m / n) * n)|0;\n};\n\nconst NBITS = 32;\n\nconst luaV_shiftl = function(x, y) {\n    if (y < 0) {  /* shift right? */\n        if (y <= -NBITS) return 0;\n        else return x >>> -y;\n    }\n    else {  /* shift left */\n        if (y >= NBITS) return 0;\n        else return x << y;\n    }\n};\n\n/*\n** check whether cached closure in prototype 'p' may be reused, that is,\n** whether there is a cached closure with the same upvalues needed by\n** new closure to be created.\n*/\nconst getcached = function(p, encup, stack, base) {\n    let c = p.cache;\n    if (c !== null) {  /* is there a cached closure? */\n        let uv = p.upvalues;\n        let nup = uv.length;\n        for (let i = 0; i < nup; i++) {  /* check whether it has right upvalues */\n            let v = uv[i].instack ? stack[base + uv[i].idx] : encup[uv[i].idx];\n            if (c.upvals[i] !== v)\n                return null;  /* wrong upvalue; cannot reuse closure */\n        }\n    }\n    return c;  /* return cached closure (or NULL if no cached closure) */\n};\n\n/*\n** create a new Lua closure, push it in the stack, and initialize\n** its upvalues.\n*/\nconst pushclosure = function(L, p, encup, base, ra) {\n    let nup = p.upvalues.length;\n    let uv = p.upvalues;\n    let ncl = new lobject.LClosure(L, nup);\n    ncl.p = p;\n    L.stack[ra].setclLvalue(ncl);\n    for (let i = 0; i < nup; i++) {\n        if (uv[i].instack)\n            ncl.upvals[i] = lfunc.luaF_findupval(L, base + uv[i].idx);\n        else\n            ncl.upvals[i] = encup[uv[i].idx];\n    }\n    p.cache = ncl;  /* save it on cache for reuse */\n};\n\nconst cvt2str = function(o) {\n    return o.ttisnumber();\n};\n\nconst cvt2num = function(o) {\n    return o.ttisstring();\n};\n\nconst tostring = function(L, i) {\n    let o = L.stack[i];\n\n    if (o.ttisstring()) return true;\n\n    if (cvt2str(o)) {\n        lobject.luaO_tostring(L, o);\n        return true;\n    }\n\n    return false;\n};\n\nconst isemptystr = function(o) {\n    return o.ttisstring() && o.vslen() === 0;\n};\n\n/* copy strings in stack from top - n up to top - 1 to buffer */\nconst copy2buff = function(L, top, n, buff) {\n    let tl = 0;  /* size already copied */\n    do {\n        let tv = L.stack[top-n];\n        let l = tv.vslen();  /* length of string being copied */\n        let s = tv.svalue();\n        buff.set(s, tl);\n        tl += l;\n    } while (--n > 0);\n};\n\n/*\n** Main operation for concatenation: concat 'total' values in the stack,\n** from 'L->top - total' up to 'L->top - 1'.\n*/\nconst luaV_concat = function(L, total) {\n    lua_assert(total >= 2);\n    do {\n        let top = L.top;\n        let n = 2; /* number of elements handled in this pass (at least 2) */\n\n        if (!(L.stack[top-2].ttisstring() || cvt2str(L.stack[top-2])) || !tostring(L, top - 1)) {\n            ltm.luaT_trybinTM(L, L.stack[top-2], L.stack[top-1], L.stack[top-2], ltm.TMS.TM_CONCAT);\n        } else if (isemptystr(L.stack[top-1])) {\n            tostring(L, top - 2);\n        } else if (isemptystr(L.stack[top-2])) {\n            lobject.setobjs2s(L, top - 2, top - 1);\n        } else {\n            /* at least two non-empty string values; get as many as possible */\n            let tl = L.stack[top-1].vslen();\n            /* collect total length and number of strings */\n            for (n = 1; n < total && tostring(L, top - n - 1); n++) {\n                let l = L.stack[top - n - 1].vslen();\n                tl += l;\n            }\n            let buff = new Uint8Array(tl);\n            copy2buff(L, top, n, buff);\n            let ts = luaS_bless(L, buff);\n            lobject.setsvalue2s(L, top - n, ts);\n        }\n        total -= n - 1; /* got 'n' strings to create 1 new */\n        /* popped 'n' strings and pushed one */\n        for (; L.top > top-(n-1);)\n            delete L.stack[--L.top];\n    } while (total > 1); /* repeat until only 1 result left */\n};\n\nconst MAXTAGLOOP = 2000;\n\nconst luaV_gettable = function(L, t, key, ra) {\n    for (let loop = 0; loop < MAXTAGLOOP; loop++) {\n        let tm;\n\n        if (!t.ttistable()) {\n            tm = ltm.luaT_gettmbyobj(L, t, ltm.TMS.TM_INDEX);\n            if (tm.ttisnil())\n                ldebug.luaG_typeerror(L, t, to_luastring('index', true)); /* no metamethod */\n            /* else will try the metamethod */\n        } else {\n            let slot = ltable.luaH_get(L, t.value, key);\n            if (!slot.ttisnil()) {\n                lobject.setobj2s(L, ra, slot);\n                return;\n            } else { /* 't' is a table */\n                tm = ltm.fasttm(L, t.value.metatable, ltm.TMS.TM_INDEX);  /* table's metamethod */\n                if (tm === null) { /* no metamethod? */\n                    L.stack[ra].setnilvalue(); /* result is nil */\n                    return;\n                }\n            }\n            /* else will try the metamethod */\n        }\n        if (tm.ttisfunction()) { /* is metamethod a function? */\n            ltm.luaT_callTM(L, tm, t, key, L.stack[ra], 1); /* call it */\n            return;\n        }\n        t = tm;  /* else try to access 'tm[key]' */\n    }\n\n    ldebug.luaG_runerror(L, to_luastring(\"'__index' chain too long; possible loop\", true));\n};\n\nconst settable = function(L, t, key, val) {\n    for (let loop = 0; loop < MAXTAGLOOP; loop++) {\n        let tm;\n        if (t.ttistable()) {\n            let h = t.value; /* save 't' table */\n            let slot = ltable.luaH_get(L, h, key);\n            if (!slot.ttisnil() || (tm = ltm.fasttm(L, h.metatable, ltm.TMS.TM_NEWINDEX)) === null) {\n                ltable.luaH_setfrom(L, h, key, val);\n                ltable.invalidateTMcache(h);\n                return;\n            }\n            /* else will try the metamethod */\n        } else { /* not a table; check metamethod */\n            if ((tm = ltm.luaT_gettmbyobj(L, t, ltm.TMS.TM_NEWINDEX)).ttisnil())\n                ldebug.luaG_typeerror(L, t, to_luastring('index', true));\n        }\n        /* try the metamethod */\n        if (tm.ttisfunction()) {\n            ltm.luaT_callTM(L, tm, t, key, val, 0);\n            return;\n        }\n        t = tm;  /* else repeat assignment over 'tm' */\n    }\n\n    ldebug.luaG_runerror(L, to_luastring(\"'__newindex' chain too long; possible loop\", true));\n};\n\n\nmodule.exports.cvt2str          = cvt2str;\nmodule.exports.cvt2num          = cvt2num;\nmodule.exports.luaV_gettable    = luaV_gettable;\nmodule.exports.luaV_concat      = luaV_concat;\nmodule.exports.luaV_div         = luaV_div;\nmodule.exports.luaV_equalobj    = luaV_equalobj;\nmodule.exports.luaV_execute     = luaV_execute;\nmodule.exports.luaV_finishOp    = luaV_finishOp;\nmodule.exports.luaV_imul        = luaV_imul;\nmodule.exports.luaV_lessequal   = luaV_lessequal;\nmodule.exports.luaV_lessthan    = luaV_lessthan;\nmodule.exports.luaV_mod         = luaV_mod;\nmodule.exports.luaV_objlen      = luaV_objlen;\nmodule.exports.luaV_rawequalobj = luaV_rawequalobj;\nmodule.exports.luaV_shiftl      = luaV_shiftl;\nmodule.exports.luaV_tointeger   = luaV_tointeger;\nmodule.exports.settable         = settable;\nmodule.exports.tointeger        = tointeger;\nmodule.exports.tonumber         = tonumber;\n","\"use strict\";\n\nconst { lua_assert } = require(\"./llimits.js\");\n\nclass MBuffer {\n    constructor() {\n        this.buffer = null;\n        this.n = 0;\n    }\n}\n\nconst luaZ_buffer = function(buff) {\n    return buff.buffer.subarray(0, buff.n);\n};\n\nconst luaZ_buffremove = function(buff, i) {\n    buff.n -= i;\n};\n\nconst luaZ_resetbuffer = function(buff) {\n    buff.n = 0;\n};\n\nconst luaZ_resizebuffer = function(L, buff, size) {\n    let newbuff = new Uint8Array(size);\n    if (buff.buffer)\n        newbuff.set(buff.buffer);\n    buff.buffer = newbuff;\n};\n\nclass ZIO {\n    constructor(L, reader, data) {\n        this.L = L;           /* Lua state (for reader) */\n        lua_assert(typeof reader == \"function\", \"ZIO requires a reader\");\n        this.reader = reader; /* reader function */\n        this.data = data;     /* additional data */\n        this.n = 0;           /* bytes still unread */\n        this.buffer = null;\n        this.off = 0;         /* current position in buffer */\n    }\n\n    zgetc () {\n        return ((this.n--) > 0) ? this.buffer[this.off++] : luaZ_fill(this);\n    }\n}\n\nconst EOZ = -1;\n\nconst luaZ_fill = function(z) {\n    let buff = z.reader(z.L, z.data);\n    if (buff === null)\n        return EOZ;\n    lua_assert(buff instanceof Uint8Array, \"Should only load binary of array of bytes\");\n    let size = buff.length;\n    if (size === 0)\n        return EOZ;\n    z.buffer = buff;\n    z.off = 0;\n    z.n = size - 1;\n    return z.buffer[z.off++];\n};\n\n/* b should be an array-like that will be set to bytes\n * b_offset is the offset at which to start filling */\nconst luaZ_read = function(z, b, b_offset, n) {\n    while (n) {\n        if (z.n === 0) { /* no bytes in buffer? */\n            if (luaZ_fill(z) === EOZ)\n                return n; /* no more input; return number of missing bytes */\n            else {\n                z.n++;  /* luaZ_fill consumed first byte; put it back */\n                z.off--;\n            }\n        }\n        let m = (n <= z.n) ? n : z.n; /* min. between n and z->n */\n        for (let i=0; i<m; i++) {\n            b[b_offset++] = z.buffer[z.off++];\n        }\n        z.n -= m;\n        if (z.n === 0) // remove reference to input so it can get freed\n            z.buffer = null;\n        n -= m;\n    }\n\n    return 0;\n};\n\nmodule.exports.EOZ               = EOZ;\nmodule.exports.luaZ_buffer       = luaZ_buffer;\nmodule.exports.luaZ_buffremove   = luaZ_buffremove;\nmodule.exports.luaZ_fill         = luaZ_fill;\nmodule.exports.luaZ_read         = luaZ_read;\nmodule.exports.luaZ_resetbuffer  = luaZ_resetbuffer;\nmodule.exports.luaZ_resizebuffer = luaZ_resizebuffer;\nmodule.exports.MBuffer           = MBuffer;\nmodule.exports.ZIO               = ZIO;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 2x2 Matrix\r\n * @module mat2\r\n */\n\n/**\r\n * Creates a new identity mat2\r\n *\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat2} a matrix to clone\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Copy the values from one mat2 to another\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set a mat2 to the identity matrix\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @returns {mat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Create a new mat2 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out A new 2x2 matrix\r\n */\n\nexport function fromValues(m00, m01, m10, m11) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Set the components of a mat2 to the given values\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out\r\n */\n\nexport function set(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Transpose the values of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3]; // Calculate the determinant\n\n  var det = a0 * a3 - a2 * a1;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function adjoint(out, a) {\n  // Caching this value is nessecary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2\r\n *\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n/**\r\n * Multiplies two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n/**\r\n * Rotates a mat2 by the given angle\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n/**\r\n * Scales the mat2 by the dimensions in the given vec2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat2} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.scale(dest, dest, vec);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat2} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2\r\n *\r\n * @param {ReadonlyMat2} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat2\r\n *\r\n * @param {ReadonlyMat2} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3]);\n}\n/**\r\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n * @param {ReadonlyMat2} L the lower triangular matrix\r\n * @param {ReadonlyMat2} D the diagonal matrix\r\n * @param {ReadonlyMat2} U the upper triangular matrix\r\n * @param {ReadonlyMat2} a the input matrix to factorize\r\n */\n\nexport function LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n/**\r\n * Adds two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat2} a The first matrix.\r\n * @param {ReadonlyMat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat2} a The first matrix.\r\n * @param {ReadonlyMat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2} out the receiving vector\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Alias for {@link mat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2x3 Matrix\r\n * @module mat2d\r\n * @description\r\n * A mat2d contains six elements defined as:\r\n * <pre>\r\n * [a, b,\r\n *  c, d,\r\n *  tx, ty]\r\n * </pre>\r\n * This is a short form for the 3x3 matrix:\r\n * <pre>\r\n * [a, b, 0,\r\n *  c, d, 0,\r\n *  tx, ty, 1]\r\n * </pre>\r\n * The last column is ignored so the array is shorter and operations are faster.\r\n */\n\n/**\r\n * Creates a new identity mat2d\r\n *\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(6);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2d initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat2d} a matrix to clone\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Copy the values from one mat2d to another\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Set a mat2d to the identity matrix\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Create a new mat2d with the given values\r\n *\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} A new mat2d\r\n */\n\nexport function fromValues(a, b, c, d, tx, ty) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Set the components of a mat2d to the given values\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} out\r\n */\n\nexport function set(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Inverts a mat2d\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function invert(out, a) {\n  var aa = a[0],\n      ab = a[1],\n      ac = a[2],\n      ad = a[3];\n  var atx = a[4],\n      aty = a[5];\n  var det = aa * ad - ab * ac;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n/**\r\n * Multiplies two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n/**\r\n * Rotates a mat2d by the given angle\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Scales the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to translate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Translates the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to translate\r\n * @param {ReadonlyVec2} v the vec2 to translate the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function translate(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.scale(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.translate(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat2d(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], 1);\n}\n/**\r\n * Adds two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n/**\r\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2d} out the receiving vector\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat2d} a The first matrix.\r\n * @param {ReadonlyMat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat2d} a The first matrix.\r\n * @param {ReadonlyMat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n/**\r\n * Alias for {@link mat2d.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2d.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as quat from \"./quat.js\";\nimport * as mat4 from \"./mat4.js\";\n/**\r\n * Dual Quaternion<br>\r\n * Format: [real, dual]<br>\r\n * Quaternion format: XYZW<br>\r\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\r\n * @module quat2\r\n */\n\n/**\r\n * Creates a new identity dual quat\r\n *\r\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\r\n */\n\nexport function create() {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n\n  dq[3] = 1;\n  return dq;\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat2} a dual quaternion to clone\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function clone(a) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n/**\r\n * Creates a new dual quat initialized with the given values\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n/**\r\n * Creates a new dual quat from the given values (quat and translation)\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component (translation)\r\n * @param {Number} y2 Y component (translation)\r\n * @param {Number} z2 Z component (translation)\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n      ay = y2 * 0.5,\n      az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n/**\r\n * Creates a dual quat from a quaternion and a translation\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyQuat} q a normalized quaternion\r\n * @param {ReadonlyVec3} t tranlation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n      ay = t[1] * 0.5,\n      az = t[2] * 0.5,\n      bx = q[0],\n      by = q[1],\n      bz = q[2],\n      bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Creates a dual quat from a translation\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyVec3} t translation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a dual quat from a quaternion\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyQuat} q the quaternion\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a new dual quat from a matrix (4x4)\r\n *\r\n * @param {quat2} out the dual quaternion\r\n * @param {ReadonlyMat4} a the matrix\r\n * @returns {quat2} dual quat receiving operation result\r\n * @function\r\n */\n\nexport function fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = quat.create();\n  mat4.getRotation(outer, a);\n  var t = new glMatrix.ARRAY_TYPE(3);\n  mat4.getTranslation(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n/**\r\n * Copy the values from one dual quat to another\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the source dual quaternion\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Set a dual quat to the identity dual quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @returns {quat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Set the components of a dual quat to the given values\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n/**\r\n * Gets the real part of a dual quat\r\n * @param  {quat} out real part\r\n * @param  {ReadonlyQuat2} a Dual Quaternion\r\n * @return {quat} real part\r\n */\n\nexport var getReal = quat.copy;\n/**\r\n * Gets the dual part of a dual quat\r\n * @param  {quat} out dual part\r\n * @param  {ReadonlyQuat2} a Dual Quaternion\r\n * @return {quat} dual part\r\n */\n\nexport function getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n/**\r\n * Set the real component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat} q a quaternion representing the real part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport var setReal = quat.copy;\n/**\r\n * Set the dual component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat} q a quaternion representing the dual part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n/**\r\n * Gets the translation of a normalized dual quat\r\n * @param  {vec3} out translation\r\n * @param  {ReadonlyQuat2} a Dual Quaternion to be decomposed\r\n * @return {vec3} translation\r\n */\n\nexport function getTranslation(out, a) {\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n/**\r\n * Translates a dual quat by the given vector\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {quat2} out\r\n */\n\nexport function translate(out, a, v) {\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3],\n      bx1 = v[0] * 0.5,\n      by1 = v[1] * 0.5,\n      bz1 = v[2] * 0.5,\n      ax2 = a[4],\n      ay2 = a[5],\n      az2 = a[6],\n      aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the X axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateX(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Y axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateY(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Z axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateZ(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (a * q)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {ReadonlyQuat} q quaternion to rotate by\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (q * a)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat} q quaternion to rotate by\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      bx = a[0],\n      by = a[1],\n      bz = a[2],\n      bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around a given axis. Does the normalisation automatically\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @param {Number} rad how far the rotation should be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < glMatrix.EPSILON) {\n    return copy(out, a);\n  }\n\n  var axisLength = Math.hypot(axis[0], axis[1], axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Adds two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n/**\r\n * Multiplies two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {quat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax0 = a[0],\n      ay0 = a[1],\n      az0 = a[2],\n      aw0 = a[3],\n      bx1 = b[4],\n      by1 = b[5],\n      bz1 = b[6],\n      bw1 = b[7],\n      ax1 = a[4],\n      ay1 = a[5],\n      az1 = a[6],\n      aw1 = a[7],\n      bx0 = b[0],\n      by0 = b[1],\n      bz0 = b[2],\n      bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n/**\r\n * Alias for {@link quat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a dual quat by a scalar number\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {ReadonlyQuat2} a the dual quat to scale\r\n * @param {Number} b amount to scale the dual quat by\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n/**\r\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\r\n *\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = quat.dot;\n/**\r\n * Performs a linear interpolation between two dual quats's\r\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n/**\r\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a dual quat to calculate inverse of\r\n * @returns {quat2} out\r\n */\n\nexport function invert(out, a) {\n  var sqlen = squaredLength(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a dual quat\r\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat2} a quat to calculate conjugate of\r\n * @returns {quat2} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Calculates the length of a dual quat\r\n *\r\n * @param {ReadonlyQuat2} a dual quat to calculate length of\r\n * @returns {Number} length of a\r\n * @function\r\n */\n\nexport var length = quat.length;\n/**\r\n * Alias for {@link quat2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a dual quat\r\n *\r\n * @param {ReadonlyQuat2} a dual quat to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = quat.squaredLength;\n/**\r\n * Alias for {@link quat2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a dual quat\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a dual quaternion to normalize\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function normalize(out, a) {\n  var magnitude = squaredLength(a);\n\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n\n  return out;\n}\n/**\r\n * Returns a string representation of a dual quatenion\r\n *\r\n * @param {ReadonlyQuat2} a dual quaternion to represent as a string\r\n * @returns {String} string representation of the dual quat\r\n */\n\nexport function str(a) {\n  return \"quat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \")\";\n}\n/**\r\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat2} a the first dual quaternion.\r\n * @param {ReadonlyQuat2} b the second dual quaternion.\r\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n/**\r\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat2} a the first dual quat.\r\n * @param {ReadonlyQuat2} b the second dual quat.\r\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","import { vec3, vec4, quat, mat4 } from 'gl-matrix';\n\nexport const VEC3_UNIT_X = vec3.fromValues(1, 0, 0);\nexport const VEC3_UNIT_Y = vec3.fromValues(0, 1, 0);\nexport const VEC3_UNIT_Z = vec3.fromValues(0, 0, 1);\nexport const VEC3_ZERO = vec3.create();\nexport const VEC3_ONE = vec3.fromValues(1, 1, 1);\nexport const QUAT_ZERO = quat.fromValues(0, 0, 0, 0);\nexport const QUAT_DEFAULT = quat.create();\n\nconst vec4Heap = vec4.create();\n\nexport function unproject(out: vec3, v: vec3, inverseMatrix: mat4, viewport: vec4): vec3 {\n  const x = 2 * (v[0] - viewport[0]) / viewport[2] - 1;\n  const y = 1 - 2 * (v[1] - viewport[1]) / viewport[3];\n  const z = 2 * v[2] - 1;\n\n  vec4.set(vec4Heap, x, y, z, 1);\n  vec4.transformMat4(vec4Heap, vec4Heap, inverseMatrix);\n  vec3.set(out, vec4Heap[0] / vec4Heap[3], vec4Heap[1] / vec4Heap[3], vec4Heap[2] / vec4Heap[3]);\n\n  return out;\n}\n\n/**\n * Get the distance of a point from a plane.\n * \n *     dot(plane, vec4(point, 1))\n */\nexport function distanceToPlane(plane: vec4, point: vec3): number {\n  return plane[0] * point[0] + plane[1] * point[1] + plane[2] * point[2] + plane[3];\n}\n\n/**\n * Get the distance of a point from a plane.\n * \n *     dot(plane, vec4(x, y, 0, 1))\n */\nexport function distanceToPlane2(plane: vec4, x: number, y: number): number {\n  return plane[0] * x + plane[1] * y + plane[3];\n}\n\n/**\n * Get the distance of a point from a plane.\n * \n *     dot(plane, vec4(x, y, z, 1))\n */\nexport function distanceToPlane3(plane: vec4, x: number, y: number, z: number): number {\n  return plane[0] * x + plane[1] * y + plane[2] * z + plane[3];\n}\n\n/**\n * Test if a sphere with the given center and radius intersects the given planes.\n * If it doesn't, the index of the first plane that proved this is returned.\n * Otherwise returns -1.\n *\n * If first is given, the test will begin from the plane at that index.\n */\nexport function testSphere(planes: vec4[], x: number, y: number, z: number, r: number, first: number): number {\n  if (first === -1) {\n    first = 0;\n  }\n\n  for (let i = 0; i < 6; i++) {\n    const index = (first + i) % 6;\n\n    if (distanceToPlane3(planes[index], x, y, z) <= -r) {\n      return index;\n    }\n  }\n\n  return -1;\n}\n\n/**\n * Test if a cell with the given coordinates intersects the given planes.\n * If it doesn't, the index of the first plane that proved this is returned.\n * Otherwise returns -1.\n *\n * If first is given, the test will begin from the plane at that index.\n */\nexport function testCell(planes: vec4[], left: number, right: number, bottom: number, top: number, first: number): number {\n  if (first === -1) {\n    first = 0;\n  }\n\n  for (let i = 0; i < 6; i++) {\n    const index = (first + i) % 6;\n    const plane = planes[index];\n\n    if (distanceToPlane2(plane, left, bottom) < 0 &&\n      distanceToPlane2(plane, left, top) < 0 &&\n      distanceToPlane2(plane, right, top) < 0 &&\n      distanceToPlane2(plane, right, bottom) < 0) {\n      return index;\n    }\n  }\n\n  return -1;\n}\n\nexport function planeLength(plane: vec4): number {\n  return Math.hypot(plane[0], plane[1], plane[2]);\n}\n\n/**\n * Normalize a plane.\n * \n * Note that this is not the same as normalizing a vec4.\n */\nexport function normalizePlane(out: vec4, plane: vec4): void {\n  const len = planeLength(plane);\n\n  out[0] = plane[0] / len;\n  out[1] = plane[1] / len;\n  out[2] = plane[2] / len;\n  out[3] = plane[3] / len;\n}\n\n/**\n * Unpacks a matrix's planes.\n */\nexport function unpackPlanes(planes: vec4[], m: mat4): void {\n  // eslint-disable-next-line one-var\n  const a00 = m[0], a01 = m[4], a02 = m[8], a03 = m[12],\n    a10 = m[1], a11 = m[5], a12 = m[9], a13 = m[13],\n    a20 = m[2], a21 = m[6], a22 = m[10], a23 = m[14],\n    a30 = m[3], a31 = m[7], a32 = m[11], a33 = m[15];\n  let plane;\n\n  // Left clipping plane\n  plane = planes[0];\n  plane[0] = a30 + a00;\n  plane[1] = a31 + a01;\n  plane[2] = a32 + a02;\n  plane[3] = a33 + a03;\n\n  // Right clipping plane\n  plane = planes[1];\n  plane[0] = a30 - a00;\n  plane[1] = a31 - a01;\n  plane[2] = a32 - a02;\n  plane[3] = a33 - a03;\n\n  // Top clipping plane\n  plane = planes[2];\n  plane[0] = a30 - a10;\n  plane[1] = a31 - a11;\n  plane[2] = a32 - a12;\n  plane[3] = a33 - a13;\n\n  // Bottom clipping plane\n  plane = planes[3];\n  plane[0] = a30 + a10;\n  plane[1] = a31 + a11;\n  plane[2] = a32 + a12;\n  plane[3] = a33 + a13;\n\n  // Near clipping plane\n  plane = planes[4];\n  plane[0] = a30 + a20;\n  plane[1] = a31 + a21;\n  plane[2] = a32 + a22;\n  plane[3] = a33 + a23;\n\n  // Far clipping plane\n  plane = planes[5];\n  plane[0] = a30 - a20;\n  plane[1] = a31 - a21;\n  plane[2] = a32 - a22;\n  plane[3] = a33 - a23;\n\n  normalizePlane(planes[0], planes[0]);\n  normalizePlane(planes[1], planes[1]);\n  normalizePlane(planes[2], planes[2]);\n  normalizePlane(planes[3], planes[3]);\n  normalizePlane(planes[4], planes[4]);\n  normalizePlane(planes[5], planes[5]);\n}\n\nconst F = vec3.create();\nconst R = vec3.create();\nconst U = vec3.create();\n\n/**\n * A look-at matrix, but for quaternions.\n * \n * See https://stackoverflow.com/a/52551983/2503048\n */\nexport function quatLookAt(out: quat, from: vec3, to: vec3, worldUp: vec3): quat {\n  vec3.normalize(F, vec3.sub(F, to, from));\n  vec3.normalize(R, vec3.cross(R, worldUp, F));\n  vec3.cross(U, R, F);\n\n  const trace = R[0] + U[2] + F[1];\n\n  if (trace > 0.0) {\n    const s = 0.5 / Math.sqrt(trace + 1.0);\n\n    out[3] = 0.25 / s;\n    out[0] = (U[1] - F[2]) * s;\n    out[2] = (F[0] - R[1]) * s;\n    out[1] = (R[2] - U[0]) * s;\n  } else {\n    if (R[0] > U[2] && R[0] > F[1]) {\n      const s = 2.0 * Math.sqrt(1.0 + R[0] - U[2] - F[1]);\n\n      out[3] = (U[1] - F[2]) / s;\n      out[0] = 0.25 * s;\n      out[2] = (U[0] + R[2]) / s;\n      out[1] = (F[0] + R[1]) / s;\n    } else if (U[2] > F[1]) {\n      const s = 2.0 * Math.sqrt(1.0 + U[2] - R[0] - F[1]);\n\n      out[3] = (F[0] - R[1]) / s;\n      out[0] = (U[0] + R[2]) / s;\n      out[2] = 0.25 * s;\n      out[1] = (F[2] + U[1]) / s;\n    } else {\n      const s = 2.0 * Math.sqrt(1.0 + F[1] - R[0] - U[2]);\n\n      out[3] = (R[2] - U[0]) / s;\n      out[0] = (F[0] + R[1]) / s;\n      out[2] = (F[2] + U[1]) / s;\n      out[1] = 0.25 * s;\n    }\n  }\n\n  return out;\n}\n","/**\n * Convert from degrees to radians.\n */\nexport function degToRad(degrees: number): number {\n  return degrees * (Math.PI / 180);\n}\n\n/**\n * Convert from radians to degrees.\n */\nexport function radToDeg(radians: number): number {\n  return radians * (180 / Math.PI);\n}\n\n/**\n * Gets a random number between a range.\n */\nexport function randomInRange(a: number, b: number): number {\n  return a + Math.random() * (b - a);\n}\n\n/**\n * Clamp a number in a range.\n */\nexport function clamp(x: number, minVal: number, maxVal: number): number {\n  return Math.min(Math.max(x, minVal), maxVal);\n}\n\n/**\n * Linear interpolation.\n */\nexport function lerp(a: number, b: number, t: number): number {\n  return a + t * (b - a);\n}\n\n/**\n * Hermite interpolation.\n */\nexport function hermite(a: number, b: number, c: number, d: number, t: number): number {\n  const factorTimes2 = t * t;\n  const factor1 = factorTimes2 * (2 * t - 3) + 1;\n  const factor2 = factorTimes2 * (t - 2) + t;\n  const factor3 = factorTimes2 * (t - 1);\n  const factor4 = factorTimes2 * (3 - 2 * t);\n\n  return (a * factor1) + (b * factor2) + (c * factor3) + (d * factor4);\n}\n\n/**\n * Bezier interpolation.\n */\nexport function bezier(a: number, b: number, c: number, d: number, t: number): number {\n  const invt = 1 - t;\n  const factorTimes2 = t * t;\n  const inverseFactorTimesTwo = invt * invt;\n  const factor1 = inverseFactorTimesTwo * invt;\n  const factor2 = 3 * t * inverseFactorTimesTwo;\n  const factor3 = 3 * factorTimes2 * invt;\n  const factor4 = factorTimes2 * t;\n\n  return (a * factor1) + (b * factor2) + (c * factor3) + (d * factor4);\n}\n\n/**\n * Copies the sign of one number onto another.\n */\nexport function copysign(x: number, y: number): number {\n  const signy = Math.sign(y);\n\n  if (signy === 0) {\n    return 0;\n  }\n\n  const signx = Math.sign(x);\n\n  if (signx !== signy) {\n    return -x;\n  }\n\n  return x;\n}\n\n/**\n * Gets the closest power of two bigger or equal to the given number.\n */\nexport function powerOfTwo(x: number): number {\n  x--;\n  x |= x >> 1;\n  x |= x >> 2;\n  x |= x >> 4;\n  x |= x >> 8;\n  x |= x >> 16;\n  x++;\n\n  return x;\n}\n\n/**\n * Is this number a power of two?\n */\nexport function isPowerOfTwo(x: number): boolean {\n  if (x === 0) {\n    return false;\n  }\n\n  return ((x & (x - 1)) === 0);\n}\n","let canvas: HTMLCanvasElement;\nlet ctx: CanvasRenderingContext2D;\nlet canvas2: HTMLCanvasElement;\nlet ctx2: CanvasRenderingContext2D;\n\n// Only create the canvases and contexts in browsers.\nif (typeof window === 'object') {\n  canvas = document.createElement('canvas');\n  ctx = <CanvasRenderingContext2D>canvas.getContext('2d');\n  canvas2 = document.createElement('canvas');\n  ctx2 = <CanvasRenderingContext2D>canvas2.getContext('2d');\n}\n\nexport function blobToImage(blob: Blob): Promise<HTMLImageElement> {\n  return new Promise<HTMLImageElement>((resolve,  reject) => {\n    const url = URL.createObjectURL(blob);\n    const image = new Image();\n\n    image.onload = (): void => {\n      resolve(image);\n    };\n\n    image.onerror = (e): void => {\n      reject(e);\n    };\n\n    image.src = url;\n  });\n}\n\nexport function blobToImageData(blob: Blob): Promise<ImageData> {\n  return new Promise<ImageData>((resolve, reject) => {\n    const url = URL.createObjectURL(blob);\n    const image = new Image();\n\n    image.onload = (): void => {\n      URL.revokeObjectURL(url);\n\n      canvas.width = image.width;\n      canvas.height = image.height;\n\n      ctx.drawImage(image, 0, 0);\n\n      resolve(ctx.getImageData(0, 0, image.width, image.height));\n    };\n\n    image.onerror = (e): void => {\n      reject(e);\n    };\n\n    image.src = url;\n  });\n}\n\nexport function imageDataToBlob(imageData: ImageData): Promise<Blob | null> {\n  return new Promise((resolve: BlobCallback) => {\n    canvas.width = imageData.width;\n    canvas.height = imageData.height;\n\n    ctx.putImageData(imageData, 0, 0);\n\n    canvas.toBlob((blob) => {\n      resolve(blob);\n    });\n  });\n}\n\nexport function imageDataToDataUrl(imageData: ImageData): string {\n  canvas.width = imageData.width;\n  canvas.height = imageData.height;\n\n  ctx.putImageData(imageData, 0, 0);\n\n  return canvas.toDataURL();\n}\n\nexport function imageDataToImage(imageData: ImageData): HTMLImageElement {\n  const image = new Image();\n\n  image.src = imageDataToDataUrl(imageData);\n\n  return image;\n}\n\nexport function imageToImageData(image: TexImageSource): ImageData {\n  const width = image.width;\n  const height = image.height;\n\n  canvas.width = width;\n  canvas.height = height;\n\n  ctx.drawImage(<CanvasImageSource>image, 0, 0);\n\n  return ctx.getImageData(0, 0, width, height);\n}\n\nexport function resizeImageData(data: TexImageSource, width: number, height: number): ImageData {\n  if (data instanceof ImageData) {\n    canvas.width = data.width;\n    canvas.height = data.height;\n\n    ctx.putImageData(data, 0, 0);\n\n    canvas2.width = width;\n    canvas2.height = height;\n\n    ctx2.drawImage(canvas, 0, 0, width, height);\n\n    return ctx2.getImageData(0, 0, width, height);\n  } else {\n    canvas.width = width;\n    canvas.height = height;\n\n    ctx.drawImage(data, 0, 0, width, height);\n\n    return ctx.getImageData(0, 0, width, height);\n  }\n}\n","const decoder = new TextDecoder();\nconst encoder = new TextEncoder();\n\n/**\n * Decode bytes as a UTF8 string.\n */\nexport function decodeUtf8(buffer: ArrayBuffer | Uint8Array): string {\n  return decoder.decode(buffer);\n}\n\n/**\n * Encode a UTF8 string to bytes.\n */\nexport function encodeUtf8(utf8: string): Uint8Array {\n  return encoder.encode(utf8);\n}\n\n/**\n * Get the byte length of a UTF8 string.\n * \n * @see https://stackoverflow.com/a/23329386\n */\nexport function byteLengthUtf8(str: string): number {\n  // returns the byte length of an utf8 string\n  let s = str.length;\n  for (let i = str.length - 1; i >= 0; i--) {\n    const code = str.charCodeAt(i);\n    if (code > 0x7f && code <= 0x7ff) s++;\n    else if (code > 0x7ff && code <= 0xffff) s += 2;\n    if (code >= 0xDC00 && code <= 0xDFFF) i--; //trail surrogate\n  }\n  return s;\n}\n\n/**\n * Splits the given string into an array of strings.\n * \n * Each string will have a byte length smaller or equal to chunkBytelength when encoded as UTF8.\n * \n * @see https://stackoverflow.com/a/18729931\n */\nexport function splitUtf8ByteLength(str: string, chunkBytelength: number): string[] {\n  const chunks = [];\n  let pos = 0;\n  let bytes = 0;\n\n  for (let i = 0, l = str.length; i < l; i++) {\n    const code = str.charCodeAt(i);\n\n    if (code < 0x80) {\n      bytes += 1;\n    } else if (code < 0x800) {\n      bytes += 2;\n    } else if (code < 0xd800 || code >= 0xe000) {\n      bytes += 3;\n    } else {\n      i++;\n      bytes += 4;\n    }\n\n    if (bytes >= chunkBytelength - 3) {\n      chunks.push(str.substr(pos, i));\n\n      pos += i;\n      bytes = 0;\n    }\n  }\n\n  if (bytes > 0) {\n    chunks.push(str.substr(pos));\n  }\n\n  return chunks;\n}\n","import { encodeUtf8 } from './utf8';\n\n/**\n * Return the given buffer as a Uint8Array.\n * \n * Strings are encoded as UTF8.\n */\nexport function bytesOf(buffer: ArrayBuffer | Uint8Array | string | number[]): Uint8Array {\n  if (buffer instanceof Uint8Array) {\n    return buffer;\n  } else if (typeof buffer === 'string') {\n    return encodeUtf8(buffer);\n  } else {\n    return new Uint8Array(buffer);\n  }\n}\n","export function isStringInBytes(buffer: Uint8Array, target: string, offset = 0, length = Infinity): boolean {\n  const start = Math.max(offset, 0);\n  const end = Math.min(start + length, buffer.length);\n  let whichByte = 0;\n  let targetByte = target.charCodeAt(0);\n\n  for (let i = start; i < end; i++) {\n    const byte = buffer[i];\n\n    if (byte === targetByte) {\n      whichByte += 1;\n\n      if (whichByte === target.length) {\n        return true;\n      }\n\n      targetByte = target.charCodeAt(whichByte);\n    } else if (whichByte > 0) {\n      whichByte = 0;\n      targetByte = target.charCodeAt(0);\n    }\n  }\n\n  return false;\n}\n\nexport function isStringInString(buffer: string, target: string, offset = 0, length = Infinity): boolean {\n  const start = Math.max(offset, 0);\n  const end = Math.min(start + length, buffer.length);\n  let whichByte = 0;\n  let targetByte = target[0];\n\n  for (let i = start; i < end; i++) {\n    const byte = buffer[i];\n\n    if (byte === targetByte) {\n      whichByte += 1;\n\n      if (whichByte === target.length) {\n        return true;\n      }\n\n      targetByte = target[whichByte];\n    } else if (whichByte > 0) {\n      whichByte = 0;\n      targetByte = target[0];\n    }\n  }\n\n  return false;\n}\n\nexport function boundIndexOf(buffer: Uint8Array, target: number, offset = 0, length = Infinity): number {\n  const start = Math.max(offset, 0);\n  const end = Math.min(start + length, buffer.length);\n\n  for (let i = start; i < end; i++) {\n    if (buffer[i] === target) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n","const buffer = new ArrayBuffer(8);\nconst int8 = new Int8Array(buffer);\nconst int16 = new Int16Array(buffer);\nconst int32 = new Int32Array(buffer);\nconst uint8 = new Uint8Array(buffer);\nconst uint16 = new Uint16Array(buffer);\nconst uint32 = new Uint32Array(buffer);\nconst float32 = new Float32Array(buffer);\nconst float64 = new Float64Array(buffer);\n\n/**\n * Typecast a 8 bit unsigned integer to a 8 bits signed integer.\n */\nexport function uint8ToInt8(a: number): number {\n  uint8[0] = a;\n\n  return int8[0];\n}\n\n/**\n * Typecast two 8 bit unsigned integers to a 16 bits signed integer.\n */\nexport function uint8ToInt16(a: number, b: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n\n  return int16[0];\n}\n\n/**\n * Typecast three 8 bit unsigned integers to a 24 bits signed integer.\n */\nexport function uint8ToInt24(a: number, b: number, c: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = 0;\n\n  return int32[0];\n}\n\n/**\n * Typecast four 8 bit unsigned integers to a 32 bits signed integer.\n */\nexport function uint8ToInt32(a: number, b: number, c: number, d: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n\n  return int32[0];\n}\n\n/**\n * Typecast two 8 bit unsigned integers to a 16 bits unsigned integer.\n */\nexport function uint8ToUint16(a: number, b: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n\n  return uint16[0];\n}\n\n/**\n * Typecast three 8 bit unsigned integers to a 24 bits unsigned integer.\n */\nexport function uint8ToUint24(a: number, b: number, c: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = 0;\n\n  return uint32[0];\n}\n\n/**\n * Typecast four 8 bit unsigned integers to a 32 bits unsigned integer.\n */\nexport function uint8ToUint32(a: number, b: number, c: number, d: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n\n  return uint32[0];\n}\n\n/**\n * Typecast four 8 bit unsigned integers to a 32 bits IEEE float.\n */\nexport function uint8ToFloat32(a: number, b: number, c: number, d: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n\n  return float32[0];\n}\n\n/**\n * Typecast eight 8 bit unsigned integers to a 64 bits IEEE float.\n */\nexport function uint8ToFloat64(a: number, b: number, c: number, d: number, e: number, f: number, g: number, h: number): number {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n  uint8[4] = e;\n  uint8[5] = f;\n  uint8[6] = g;\n  uint8[7] = h;\n\n  return float64[0];\n}\n\n/**\n * Typecast a 8 bit signed integer to a 8 bit unsigned integer.\n */\nexport function int8ToUint8(a: number): number {\n  uint8[0] = a;\n\n  return int8[0];\n}\n\n/**\n * Typecast a 16 bit signed integer to two 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function int16ToUint8(out: Uint8Array, a: number): Uint8Array {\n  int16[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n\n  return out;\n}\n\n/**\n * Typecast a 24 bit signed integer to three 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function int24ToUint8(out: Uint8Array, a: number): Uint8Array {\n  int32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n\n  return out;\n}\n\n/**\n * Typecast a 32 bit signed integer to four 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function int32ToUint8(out: Uint8Array, a: number): Uint8Array {\n  int32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n\n  return out;\n}\n\n/**\n * Typecast a 16 bit unsigned integer to two 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function uint16ToUint8(out: Uint8Array, a: number): Uint8Array {\n  uint16[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n\n  return out;\n}\n\n/**\n * Typecast a 24 bit unsigned integer to three 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function uint24ToUint8(out: Uint8Array, a: number): Uint8Array {\n  uint32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n\n  return out;\n}\n\n/**\n * Typecast a 32 bit unsigned integer to four 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function uint32ToUint8(out: Uint8Array, a: number): Uint8Array {\n  uint32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n\n  return out;\n}\n\n/**\n * Typecast a 32 bit IEEE float to four 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function float32ToUint8(out: Uint8Array, a: number): Uint8Array {\n  float32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n\n  return out;\n}\n\n/**\n * Typecast a 64 bit IEEE float to eight 8 bit unsigned integers.\n * \n * The result is stored in out.\n */\nexport function float64ToUint8(out: Uint8Array, a: number): Uint8Array {\n  float64[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n  out[4] = uint8[4];\n  out[5] = uint8[5];\n  out[6] = uint8[6];\n  out[7] = uint8[7];\n\n  return out;\n}\n\n/**\n * Typecast a normal JavaScript number to a 32 bits unsigned integer.\n */\nexport function numberToUint32(number: number): number {\n  uint32[0] = number;\n\n  return uint32[0];\n}\n\n/**\n * Interperts a string as a base 256 number.\n */\nexport function stringToBase256(string: string): number {\n  let number = 0;\n\n  for (const c of string) {\n    number = number * 256 + c.charCodeAt(0);\n  }\n\n  return number;\n}\n\n/**\n * Interperts a number as a base 256 string.\n */\nexport function base256ToString(number: number): string {\n  const array = [];\n\n  while (number > 0) {\n    array.push(String.fromCharCode(number % 256));\n    number = Math.floor(number / 256);\n  }\n\n  return array.reverse().join('');\n}\n","import { bytesOf } from './bytesof';\nimport { boundIndexOf } from './searches';\nimport { uint8ToInt8, uint8ToInt16, uint8ToInt32, uint8ToUint16, uint8ToUint32, uint8ToFloat32, uint8ToFloat64, int8ToUint8, int16ToUint8, int32ToUint8, uint16ToUint8, uint32ToUint8, float32ToUint8, float64ToUint8 } from './typecast';\nimport { decodeUtf8, encodeUtf8 } from './utf8';\n\n// Memory for all of the xxxToUint type casts.\nconst uint8 = new Uint8Array(8);\n\n/**\n * A binary stream.\n */\nexport default class BinaryStream {\n  buffer: ArrayBuffer;\n  uint8array: Uint8Array;\n  index = 0;\n  byteLength: number;\n  remaining: number;\n\n  constructor(buffer: ArrayBuffer | Uint8Array, byteOffset?: number, byteLength?: number) {\n    const bytes = bytesOf(buffer);\n\n    // For browsers not supporting the spec.\n    // Once upon a time I reported this issue on the Firefox tracker.\n    // Seems like Safari needs an issue report too.\n    byteOffset = byteOffset || 0;\n    byteLength = byteLength || bytes.length;\n\n    this.buffer = buffer;\n    this.uint8array = bytes.subarray(byteOffset, byteOffset + byteLength);\n    this.byteLength = byteLength;\n    this.remaining = byteLength;\n  }\n\n  /**\n   * Create a subreader of this reader, at its position, with the given byte length.\n   */\n  substream(byteLength: number): BinaryStream {\n    if (this.remaining < byteLength) {\n      throw new Error(`ByteStream: substream: want ${byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n\n    this.index += byteLength;\n\n    return new BinaryStream(this.uint8array.subarray(index, index + byteLength));\n  }\n\n  /**\n   * Skip a number of bytes.\n   */\n  skip(bytes: number): void {\n    if (this.remaining < bytes) {\n      throw new Error(`ByteStream: skip: premature end - want ${bytes} bytes but have ${this.remaining}`);\n    }\n\n    this.index += bytes;\n    this.remaining -= bytes;\n  }\n\n  /**\n   * Set the reader's index.\n   */\n  seek(index: number): void {\n    this.index = index;\n    this.remaining = this.byteLength - index;\n  }\n\n  /**\n   * Read a UTF8 string with the given number of bytes.\n   * \n   * The entire size will be read, however the string returned is NULL terminated in its memory block.\n   * \n   * For example, the MDX format has many strings that have a constant maximum size, where any bytes after the string are NULLs.\n   * Such strings will be loaded correctly given the maximum size.\n   */\n  read(bytes: number): string {\n    if (this.remaining < bytes) {\n      throw new Error(`ByteStream: read: premature end - want ${bytes} bytes but have ${this.remaining}`);\n    }\n\n    const uint8array = this.uint8array;\n    const start = this.index;\n    let end = boundIndexOf(uint8array, 0, start, bytes);\n\n    if (end === -1) {\n      end = start + bytes;\n    }\n\n    this.index += bytes;\n    this.remaining -= bytes;\n\n    return decodeUtf8(uint8array.subarray(start, end));\n  }\n\n  /**\n   * Read a UTF8 NULL terminated string.\n   */\n  readNull(): string {\n    if (this.remaining < 1) {\n      throw new Error(`ByteStream: readNull: premature end - want at least 1 byte but have 0`);\n    }\n\n    const uint8array = this.uint8array;\n    const start = this.index;\n    let end = uint8array.indexOf(0, start);\n\n    if (end === -1) {\n      end = uint8array.length - 1;\n    }\n\n    const bytes = end - start + 1;\n\n    this.index += bytes;\n    this.remaining -= bytes;\n\n    return decodeUtf8(uint8array.subarray(start, end));\n  }\n\n  /**\n   * Read a binary string with the given number of bytes.\n   */\n  readBinary(bytes: number): string {\n    if (this.remaining < bytes) {\n      throw new Error(`ByteStream: readBinary: premature end - want ${bytes} bytes but have ${this.remaining}`);\n    }\n\n    const uint8array = this.uint8array;\n    const index = this.index;\n    let data = '';\n\n    for (let i = 0; i < bytes; i++) {\n      data += String.fromCharCode(uint8array[index + i]);\n    }\n\n    this.index += bytes;\n    this.remaining -= bytes;\n\n    return data;\n  }\n\n  /**\n   * Read a 8 bit signed integer.\n   */\n  readInt8(): number {\n    if (this.remaining < 1) {\n      throw new Error(`ByteStream: readInt8: premature end - want 1 byte but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToInt8(uint8array[index]);\n\n    this.index += 1;\n    this.remaining -= 1;\n\n    return data;\n  }\n\n  /**\n   * Read a 16 bit signed integer.\n   */\n  readInt16(): number {\n    if (this.remaining < 2) {\n      throw new Error(`ByteStream: readInt16: premature end - want 2 bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToInt16(uint8array[index], uint8array[index + 1]);\n\n    this.index += 2;\n    this.remaining -= 2;\n\n    return data;\n  }\n\n  /**\n   * Read a 32 bit signed integer.\n   */\n  readInt32(): number {\n    if (this.remaining < 4) {\n      throw new Error(`ByteStream: readInt32: premature end - want 4 bytes but have ${this.remaining}`);\n    }\n\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToInt32(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3]);\n\n    this.index += 4;\n    this.remaining -= 4;\n\n    return data;\n  }\n\n  /**\n   * Read a 8 bit unsigned integer.\n   */\n  readUint8(): number {\n    if (this.remaining < 1) {\n      throw new Error(`ByteStream: readUint8: premature end - want 1 byte but have ${this.remaining}`);\n    }\n\n    const data = this.uint8array[this.index];\n\n    this.index += 1;\n    this.remaining -= 1;\n\n    return data;\n  }\n\n  /**\n   * Read a 16 bit unsigned integer.\n   */\n  readUint16(): number {\n    if (this.remaining < 2) {\n      throw new Error(`ByteStream: readUint16: premature end - want 2 bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToUint16(uint8array[index], uint8array[index + 1]);\n\n    this.index += 2;\n    this.remaining -= 2;\n\n    return data;\n  }\n\n  /**\n   * Read a 32 bit unsigned integer.\n   */\n  readUint32(): number {\n    if (this.remaining < 4) {\n      throw new Error(`ByteStream: readUint32: premature end - want 4 bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToUint32(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3]);\n\n    this.index += 4;\n    this.remaining -= 4;\n\n    return data;\n  }\n\n  /**\n   * Read a 32 bit float.\n   */\n  readFloat32(): number {\n    if (this.remaining < 4) {\n      throw new Error(`ByteStream: readFloat32: premature end - want 4 bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToFloat32(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3]);\n\n    this.index += 4;\n    this.remaining -= 4;\n\n    return data;\n  }\n\n  /**\n   * Read a 64 bit float.\n   */\n  readFloat64(): number {\n    if (this.remaining < 8) {\n      throw new Error(`ByteStream: readFloat64: premature end - want 8 bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const data = uint8ToFloat64(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3], uint8array[index + 4], uint8array[index + 5], uint8array[index + 6], uint8array[index + 7]);\n\n    this.index += 8;\n    this.remaining -= 8;\n\n    return data;\n  }\n\n  /**\n   * Read an array of 8 bit signed integers.\n   */\n  readInt8Array(view: number | Int8Array): Int8Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Int8Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readInt8Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = uint8ToInt8(uint8array[index + i]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 16 bit signed integers.\n   */\n  readInt16Array(view: number | Int16Array): Int16Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Int16Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readInt16Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 2;\n\n      view[i] = uint8ToInt16(uint8array[offset], uint8array[offset + 1]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 32 bit signed integers.\n   */\n  readInt32Array(view: number | Int32Array): Int32Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Int32Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readInt32Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 4;\n\n      view[i] = uint8ToInt32(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 8 bit unsigned integers.\n   */\n  readUint8Array(view: number | Uint8Array): Uint8Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Uint8Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readUint8Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = uint8array[index + i];\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 16 bit unsigned integers.\n   */\n  readUint16Array(view: number | Uint16Array): Uint16Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Uint16Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readUint16Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 2;\n\n      view[i] = uint8ToUint16(uint8array[offset], uint8array[offset + 1]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 32 bit unsigned integers.\n   */\n  readUint32Array(view: number | Uint32Array): Uint32Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Uint32Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readUint32Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 4;\n\n      view[i] = uint8ToUint32(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 32 bit floats.\n   */\n  readFloat32Array(view: number | Float32Array): Float32Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Float32Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readFloat32Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 4;\n\n      view[i] = uint8ToFloat32(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 64 bit floats.\n   */\n  readFloat64Array(view: number | Float64Array): Float64Array {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Float64Array(view);\n    }\n\n    if (this.remaining < view.byteLength) {\n      throw new Error(`ByteStream: readFloat64Array: premature end - want ${view.byteLength} bytes but have ${this.remaining}`);\n    }\n\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 8;\n\n      view[i] = uint8ToFloat64(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3], uint8array[offset + 4], uint8array[offset + 5], uint8array[offset + 6], uint8array[offset + 7]);\n    }\n\n    this.index += view.byteLength;\n    this.remaining -= view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Write a UTF8 string.\n   * \n   * Returns the number of bytes that were written,\n   */\n  write(utf8: string): number {\n    const bytes = encodeUtf8(utf8);\n\n    this.writeUint8Array(bytes);\n\n    return bytes.length;\n  }\n\n  /**\n   * Write a UTF8 string as a NULL terminated string.\n   * \n   * Returns the number of bytes that were written, including the terminating NULL.\n   */\n  writeNull(utf8: string): number {\n    const bytes = this.write(utf8);\n\n    this.index++;\n    this.remaining--;\n\n    return bytes + 1;\n  }\n\n  /**\n   * Write a binary string.\n   */\n  writeBinary(value: string): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n    const count = value.length;\n\n    for (let i = 0; i < count; i++) {\n      uint8array[index + i] = value.charCodeAt(i);\n    }\n\n    this.index += count;\n  }\n\n  /**\n   * Write a 8 bit signed integer.\n   */\n  writeInt8(value: number): void {\n    this.uint8array[this.index] = int8ToUint8(value);\n    this.index += 1;\n  }\n\n  /**\n   * Write a 16 bit signed integer.\n   */\n  writeInt16(value: number): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    int16ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n\n    this.index += 2;\n  }\n\n  /**\n   * Write a 32 bit signed integer.\n   */\n  writeInt32(value: number): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    int32ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n\n    this.index += 4;\n  }\n\n  /**\n   * Write a 8 bit unsigned integer.\n   */\n  writeUint8(value: number): void {\n    this.uint8array[this.index] = value;\n    this.index += 1;\n  }\n\n  /**\n   * Write a 16 bit unsigned integer.\n   */\n  writeUint16(value: number): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    uint16ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n\n    this.index += 2;\n  }\n\n  /**\n   * Write a 32 bit unsigned integer.\n   */\n  writeUint32(value: number): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    uint32ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n\n    this.index += 4;\n  }\n\n  /**\n   * Write a 32 bit float.\n   */\n  writeFloat32(value: number): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    float32ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n\n    this.index += 4;\n  }\n\n  /**\n   * Write a 64 bit float.\n   */\n  writeFloat64(value: number): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    float64ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n    uint8array[index + 4] = uint8[4];\n    uint8array[index + 5] = uint8[5];\n    uint8array[index + 6] = uint8[6];\n    uint8array[index + 7] = uint8[7];\n\n    this.index += 8;\n  }\n\n  /**\n   * Write an array of 8 bit signed integers.\n   */\n  writeInt8Array(view: Int8Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      uint8array[index + i] = int8ToUint8(view[i]);\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 16 bit signed integers.\n   */\n  writeInt16Array(view: Int16Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 2;\n\n      int16ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 32 bit signed integers.\n   */\n  writeInt32Array(view: Int32Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 4;\n\n      int32ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 8 bit unsigned integers.\n   */\n  writeUint8Array(view: Uint8Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      uint8array[index + i] = view[i];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 16 bit unsigned integers.\n   */\n  writeUint16Array(view: Uint16Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 2;\n\n      uint16ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 32 bit unsigned integers.\n   */\n  writeUint32Array(view: Uint32Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 4;\n\n      uint32ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 32 bit floats.\n   */\n  writeFloat32Array(view: Float32Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 4;\n\n      float32ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 64 bit floats.\n   */\n  writeFloat64Array(view: Float64Array): void {\n    const index = this.index;\n    const uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      const offset = index + i * 8;\n\n      float64ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n      uint8array[offset + 4] = uint8[4];\n      uint8array[offset + 5] = uint8[5];\n      uint8array[offset + 6] = uint8[6];\n      uint8array[offset + 7] = uint8[7];\n    }\n\n    this.index += view.byteLength;\n  }\n}\n","import { bytesOf } from './bytesof';\n\n/**\n * A bit stream.\n */\nexport default class BitStream {\n  buffer: ArrayBuffer;\n  uint8array: Uint8Array;\n  index = 0;\n  byteLength: number;\n  bitBuffer = 0;\n  bits = 0;\n\n  constructor(buffer: ArrayBuffer | Uint8Array, byteOffset?: number, byteLength?: number) {\n    const bytes = bytesOf(buffer);\n\n    // For browsers not supporting the spec.\n    // Once upon a time I reported this issue on the Firefox tracker.\n    // Seems like Safari needs an issue report too.\n    byteOffset = byteOffset || 0;\n    byteLength = byteLength || bytes.length;\n\n    this.buffer = buffer;\n    this.uint8array = bytes.subarray(byteOffset, byteOffset + byteLength);\n    this.byteLength = buffer.byteLength;\n  }\n\n  /**\n   * Peek a number of bits.\n   */\n  peekBits(bits: number): number {\n    this.loadBits(bits);\n\n    return this.bitBuffer & ((1 << bits) - 1);\n  }\n\n  /**\n   * Read a number of bits.\n   */\n  readBits(bits: number): number {\n    const data = this.peekBits(bits);\n\n    this.bitBuffer >>>= bits;\n    this.bits -= bits;\n\n    return data;\n  }\n\n  /**\n   * Skip a number of bits.\n   */\n  skipBits(bits: number): void {\n    this.loadBits(bits);\n\n    this.bitBuffer >>>= bits;\n    this.bits -= bits;\n  }\n\n  /**\n   * Load more bits into the buffer.\n   */\n  loadBits(bits: number): void {\n    while (this.bits < bits) {\n      this.bitBuffer += this.uint8array[this.index] << this.bits;\n      this.bits += 8;\n      this.index += 1;\n    }\n  }\n}\n","/**\n * Returns the base name of a file path.\n * \n * Path/To/My/File.ext => File.ext\n */\nexport function basename(path: string): string {\n  if (path && path.length) {\n    let index = path.lastIndexOf('/');\n\n    if (index !== -1) {\n      path = path.slice(index + 1);\n    }\n\n    index = path.lastIndexOf('\\\\');\n\n    if (index !== -1) {\n      path = path.slice(index + 1);\n    }\n\n    return path;\n  }\n\n  return '';\n}\n\n/**\n * Returns the extension name of a file path.\n * \n * Path/To/My/File.ext => .ext\n */\nexport function extname(path: string): string {\n  if (path && path.length) {\n    const index = path.lastIndexOf('.');\n\n    if (index !== -1) {\n      path = path.slice(index).toLowerCase();\n    }\n\n    return path;\n  }\n\n  return '';\n}\n\n/**\n * Returns the base name of a file path without the extension.\n * \n * Path/To/My/File.ext => File\n */\nexport function filename(path: string): string {\n  path = basename(path);\n\n  const index = path.lastIndexOf('.');\n\n  if (index !== -1) {\n    path = path.slice(0, index);\n  }\n\n  return path;\n}\n","/**\n * Detects if the given object is a PNG source.\n * \n * PNG starts with [89 50 4E 47 0D 0A 1A 0A]\n */\nexport function isPng(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x89 && bytes[1] === 0x50 && bytes[2] === 0x4e && bytes[3] === 0x47 && bytes[4] === 0x0d && bytes[5] === 0x0a && bytes[6] === 0x1a && bytes[7] === 0x0a) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Detects if the given object is a JPG source.\n * \n * JPG starts with [FF D8] and ends with [FF D9]\n */\nexport function isJpeg(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0xff && bytes[1] === 0xd8 && bytes[bytes.length - 2] === 0xff && bytes[bytes.length - 1] === 0xd9) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Detects if the given object is a GIF source.\n * \n * GIF starts with [47 49 46 38 37 61] or [47 49 46 38 39 61]\n */\nexport function isGif(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x47 && bytes[1] === 0x49 && bytes[2] === 0x46 && bytes[3] === 0x38 && (bytes[4] === 0x37 || bytes[4] === 0x39) && bytes[5] === 0x61) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Detects if the given object is a WebP source.\n * \n * WebP starts with [52 49 46 46] followed by the file size - 8 followed by [57 45 42 50]\n */\nexport function isWebP(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x52 && bytes[1] === 0x49 && bytes[2] === 0x46 && bytes[3] === 0x46 && bytes[8] === 0x57 && bytes[9] === 0x45 && bytes[10] === 0x42 && bytes[11] === 0x50) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","/**\n * An INI section.\n */\nexport type IniSection = Map<string, string>;\n\n/**\n * An INI file.\n */\nexport class IniFile {\n  properties: Map<string, string> = new Map();\n  sections: Map<string, IniSection> = new Map();\n\n  load(buffer: string): void {\n    // All properties added until a section is reached are added to the properties map.\n    // Once a section is reached, any further properties will be added to it until matching another section, etc.\n    let section: IniSection | null = this.properties;\n    const sections = this.sections;\n\n    for (const line of buffer.split('\\r\\n')) {\n      // INI defines comments as starting with a semicolon ';'.\n      // However, Warcraft 3 INI files use normal C comments '//'.\n      // In addition, Warcraft 3 files have empty lines.\n      // Therefore, ignore any line matching any of these conditions.\n      if (line.length && !line.startsWith('//') && !line.startsWith(';')) {\n        let match = line.match(/^\\[(.+?)\\]/);\n\n        if (match) {\n          const name = match[1].trim();\n\n          section = <IniSection | null>sections.get(name);\n\n          if (!section) {\n            section = new Map();\n\n            sections.set(name, section);\n          }\n        } else {\n          match = line.match(/^(.+?)=(.*?)$/);\n\n          if (match) {\n            let value = match[2];\n\n            if (value[0] === '\"') {\n              value = value.slice(1, -1);\n            }\n\n            section.set(match[1], value);\n          }\n        }\n      }\n    }\n  }\n\n  save(): string {\n    const lines = [];\n\n    for (const [key, value] of this.properties) {\n      lines.push(`${key}=${value}`);\n    }\n\n    for (const [name, section] of this.sections) {\n      lines.push(`[${name}]`);\n\n      for (const [key, value] of section) {\n        lines.push(`${key}=${value}`);\n      }\n    }\n\n    return lines.join('\\r\\n');\n  }\n\n  getSection(name: string): IniSection | undefined {\n    return this.sections.get(name);\n  }\n}\n","/**\n * A SLK table file.\n */\nexport default class SlkFile {\n  rows: string[][] = [];\n\n  load(buffer: string): void {\n    if (!buffer.startsWith('ID')) {\n      throw new Error('WrongMagicNumber');\n    }\n\n    const rows = this.rows;\n    let x = 0;\n    let y = 0;\n\n    for (const line of buffer.split('\\n')) {\n      // The B command is supposed to define the total number of columns and rows, however in UbetSplatData.slk it gives wrong information\n      // Therefore, just ignore it, since JavaScript arrays grow as they want either way\n      if (line[0] !== 'B') {\n        for (const token of line.split(';')) {\n          const op = token[0];\n          const valueString = token.substring(1).trim();\n          let value;\n\n          if (op === 'X') {\n            x = parseInt(valueString, 10) - 1;\n          } else if (op === 'Y') {\n            y = parseInt(valueString, 10) - 1;\n          } else if (op === 'K') {\n            if (!rows[y]) {\n              rows[y] = [];\n            }\n\n            if (valueString[0] === '\"') {\n              value = valueString.slice(1, -1);\n            } else {\n              value = valueString;\n            }\n\n            rows[y][x] = value;\n          }\n        }\n      }\n    }\n  }\n\n  save(): string {\n    const rows = this.rows;\n    const rowCount = rows.length;\n    const lines = [];\n    let biggestColumn = 0;\n\n    for (let y = 0; y < rowCount; y++) {\n      const row = rows[y];\n      const columnCount = row.length;\n\n      if (columnCount > biggestColumn) {\n        biggestColumn = columnCount;\n      }\n\n      let firstOfRow = true;\n\n      for (let x = 0; x < columnCount; x++) {\n        const value = row[x];\n\n        if (value !== undefined) {\n          let encoded;\n\n          if (typeof value === 'string') {\n            encoded = `\"${value}\"`;\n          } else if (typeof value === 'boolean') {\n            if (value) {\n              encoded = 'TRUE';\n            } else {\n              encoded = 'FALSE';\n            }\n          } else {\n            encoded = `${value}`;\n          }\n\n          if (firstOfRow) {\n            firstOfRow = false;\n\n            lines.push(`C;X${x + 1};Y${y + 1};K${encoded}`);\n          } else {\n            lines.push(`C;X${x + 1};K${encoded}`);\n          }\n        }\n      }\n    }\n\n    return `ID;P\\r\\nB;X${biggestColumn};Y${rowCount}\\r\\n${lines.join('\\r\\n')}\\r\\nE`;\n  }\n}\n","/**\n * Reverses a string.\n */\nexport default function reverse(s: string): string {\n  return [...s].reverse().join('');\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry, { EntryType, SingleEntryType } from './indexentry';\n\n/**\n * A reference.\n */\nexport default class Reference {\n  index: IndexEntry[] | null = null;\n  entries = 0;\n  id = 0;\n  flags = 0;\n\n  load(stream: BinaryStream, index: IndexEntry[]): void {\n    this.index = index;\n    this.entries = stream.readUint32();\n    this.id = stream.readUint32();\n    this.flags = stream.readUint32();\n  }\n\n  /**\n   * Get the entries this index entry references.\n   */\n  get(): EntryType | undefined {\n    if (this.index && this.id !== 0 && this.entries !== 0) {\n      return this.index[this.id].entries;\n    }\n\n    return;\n  }\n\n  /**\n   * Get the first entry this index entry references.\n   */\n  first(): SingleEntryType | undefined {\n    const entries = this.get();\n\n    if (entries) {\n      return entries[0];\n    }\n\n    return;\n  }\n}\n","import reverse from '../../common/stringreverse';\nimport BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * The M3 header.\n */\nexport default class Md34 {\n  version = -1;\n  tag = '';\n  offset = 0;\n  entries = 0;\n  model = new Reference();\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.tag = reverse(stream.readBinary(4));\n    this.offset = stream.readUint32();\n    this.entries = stream.readUint32();\n    this.model.load(stream, index);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\n\n/**\n * A bounding sphere.\n */\nexport default class BoundingSphere {\n  min = new Float32Array(3);\n  max = new Float32Array(3);\n  radius = 0;\n\n  load(stream: BinaryStream): void {\n    stream.readFloat32Array(this.min);\n    stream.readFloat32Array(this.max);\n    this.radius = stream.readFloat32();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\n\n/**\n * A bounding shape.\n */\nexport default class BoundingShape {\n  shape = -1;\n  bone = -1;\n  unknown0 = 0;\n  matrix = new Float32Array(16);\n  unknown1 = 0;\n  unknown2 = 0;\n  unknown3 = 0;\n  unknown4 = 0;\n  unknown5 = 0;\n  unknown6 = 0;\n  size = new Float32Array(3);\n\n  load(stream: BinaryStream): void {\n    this.shape = stream.readUint32();\n    this.bone = stream.readInt16();\n    this.unknown0 = stream.readUint16();\n    stream.readFloat32Array(this.matrix);\n    this.unknown1 = stream.readUint32();\n    this.unknown2 = stream.readUint32();\n    this.unknown3 = stream.readUint32();\n    this.unknown4 = stream.readUint32();\n    this.unknown5 = stream.readUint32();\n    this.unknown6 = stream.readUint32();\n    stream.readFloat32Array(this.size);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\n\n/**\n * The base class to all animation references.\n */\nexport abstract class AnimationReference {\n  interpolationType = 0;\n  animFlags = 0;\n  animId = -1;\n  initValue: number | Uint8Array | Float32Array | null = null;\n  nullValue: number | Uint8Array | Float32Array | null = null;\n\n  abstract readInitNullValues(stream: BinaryStream): void;\n\n  load(stream: BinaryStream): void {\n    this.interpolationType = stream.readUint16();\n    this.animFlags = stream.readUint16();\n    this.animId = stream.readUint32();\n\n    this.readInitNullValues(stream);\n\n    stream.skip(4); // ?\n  }\n}\n\n/**\n * A pixel animation reference.\n */\nexport class PixelAnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readUint8Array(4);\n    this.nullValue = stream.readUint8Array(4);\n  }\n}\n\n/**\n * A uint16 animation reference.\n */\nexport class Uint16AnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readUint16();\n    this.nullValue = stream.readUint16();\n  }\n}\n\n/**\n * A uint32 animation reference.\n */\nexport class Uint32AnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readUint32();\n    this.nullValue = stream.readUint32();\n  }\n}\n\n/**\n * A float32 animation reference.\n */\nexport class Float32AnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readFloat32();\n    this.nullValue = stream.readFloat32();\n  }\n}\n\n/**\n * A vec2 animation reference.\n */\nexport class Vector2AnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readFloat32Array(2);\n    this.nullValue = stream.readFloat32Array(2);\n  }\n}\n\n/**\n * A vec3 animation reference.\n */\nexport class Vector3AnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readFloat32Array(3);\n    this.nullValue = stream.readFloat32Array(3);\n  }\n}\n\n/**\n * A quat animation reference.\n */\nexport class Vector4AnimationReference extends AnimationReference {\n  readInitNullValues(stream: BinaryStream): void {\n    this.initValue = stream.readFloat32Array(4);\n    this.nullValue = stream.readFloat32Array(4);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * Sequence data.\n */\nexport default class Sd {\n  version = -1;\n  keys = new Reference();\n  flags = 0;\n  biggestKey = -1;\n  values = new Reference();\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.keys.load(stream, index);\n    this.flags = stream.readUint32();\n    this.biggestKey = stream.readUint32();\n    this.values.load(stream, index);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\n\n/**\n * An unsupported entry.\n * \n * This is used for entries that have known structures (or at least sizes), but this parser isn't going to actually parse.\n * The entry will contain its own reader and version, in case the client code wants to do anything with it.\n */\nexport default class UnsupportedEntry {\n  stream: BinaryStream;\n  version: number;\n  index: IndexEntry[];\n\n  constructor(stream: BinaryStream, version: number, index: IndexEntry[]) {\n    this.stream = stream;\n    this.version = version;\n    this.index = index;\n  }\n}\n","import reverse from '../../common/stringreverse';\nimport BinaryStream from '../../common/binarystream';\nimport Md34 from './md34';\nimport ModelHeader from './modelheader';\nimport Sequence from './sequence';\nimport Stc from './stc';\nimport Stg from './stg';\nimport Sts from './sts';\nimport Bone from './bone';\nimport Division from './division';\nimport Region from './region';\nimport Batch from './batch';\nimport MaterialReference from './materialreference';\nimport StandardMaterial from './standardmaterial';\nimport Layer from './layer';\nimport Event from './event';\nimport BoundingSphere from './boundingsphere';\nimport AttachmentPoint from './attachmentpoint';\nimport Camera from './camera';\nimport Sd from './sd';\nimport UnsupportedEntry from './unsupportedentry';\n\n\n// Mapping from entry tags, to their constructors and known version->size values.\nconst tagMapping = {\n  // Objects\n  MD34: [Md34, { 11: 24 }],\n  MODL: [ModelHeader, { 23: 784, 25: 808, 26: 820, 28: 844, 29: 856 }],\n  SEQS: [Sequence, { 1: 96, 2: 92 }],\n  STC_: [Stc, { 4: 204 }],\n  STG_: [Stg, { 0: 24 }],\n  STS_: [Sts, { 0: 28 }],\n  BONE: [Bone, { 1: 160 }],\n  DIV_: [Division, { 2: 52 }],\n  REGN: [Region, { 3: 36, 4: 40, 5: 48 }],\n  BAT_: [Batch, { 1: 14 }],\n  MATM: [MaterialReference, { 0: 8 }],\n  MAT_: [StandardMaterial, { 15: 268, 16: 280, 17: 280, 18: 280, 19: 340 }],\n  LAYR: [Layer, { 22: 356, 24: 436, 25: 468, 26: 464 }],\n  EVNT: [Event, { 0: 96, 1: 104, 2: 108 }],\n  BNDS: [BoundingSphere, { 0: 28 }],\n  ATT_: [AttachmentPoint, { 1: 20 }],\n  CAM_: [Camera, { 3: 180, 5: 264 }],\n  SDEV: [Sd, { 0: 32 }],\n  SDU6: [Sd, { 0: 32 }],\n  SDFG: [Sd, { 0: 32 }],\n  SDS6: [Sd, { 0: 32 }],\n  SDR3: [Sd, { 0: 32 }],\n  SD2V: [Sd, { 0: 32 }],\n  SD3V: [Sd, { 0: 32 }],\n  SD4Q: [Sd, { 0: 32 }],\n  SDCC: [Sd, { 0: 32 }],\n  SDMB: [Sd, { 0: 32 }],\n  FLAG: [Sd, { 0: 32 }],\n  // Unsupported entries\n  MSEC: [UnsupportedEntry, { 1: 72 }],\n  LITE: [UnsupportedEntry, { 7: 212 }],\n  ATVL: [UnsupportedEntry, { 0: 116 }],\n  PATU: [UnsupportedEntry, { 4: 152 }],\n  TRGD: [UnsupportedEntry, { 0: 24 }],\n  DIS_: [UnsupportedEntry, { 4: 68 }],\n  CMS_: [UnsupportedEntry, { 0: 24 }],\n  CMP_: [UnsupportedEntry, { 2: 28 }],\n  TER_: [UnsupportedEntry, { 0: 24, 1: 28 }],\n  VOL_: [UnsupportedEntry, { 0: 84 }],\n  VON_: [UnsupportedEntry, { 0: 268 }],\n  CREP: [UnsupportedEntry, { 0: 24, 1: 28 }],\n  STBM: [UnsupportedEntry, { 0: 48 }],\n  LFSB: [UnsupportedEntry, { 2: 56 }],\n  LFLR: [UnsupportedEntry, { 2: 80, 3: 152 }],\n  PAR_: [UnsupportedEntry, { 12: 1316, 17: 1460, 18: 1464, 19: 1464, 21: 1464, 22: 1484, 23: 1492, 24: 1496 }],\n  PARC: [UnsupportedEntry, { 0: 40 }],\n  PROJ: [UnsupportedEntry, { 4: 388, 5: 382 }],\n  PHYJ: [UnsupportedEntry, { 0: 180 }],\n  PHCC: [UnsupportedEntry, { 0: 76 }],\n  PHAC: [UnsupportedEntry, { 0: 32 }],\n  PHCL: [UnsupportedEntry, { 2: 128 }],\n  FOR_: [UnsupportedEntry, { 1: 104, 2: 104 }],\n  DMSE: [UnsupportedEntry, { 0: 4 }],\n  PHSH: [UnsupportedEntry, { 1: 132, 3: 300 }],\n  PHRB: [UnsupportedEntry, { 2: 104, 4: 80 }],\n  SSGS: [UnsupportedEntry, { 1: 108 }],\n  BBSC: [UnsupportedEntry, { 0: 48 }],\n  SRIB: [UnsupportedEntry, { 0: 272 }],\n  RIB_: [UnsupportedEntry, { 6: 748, 8: 756, 9: 760 }],\n  IKJT: [UnsupportedEntry, { 0: 32 }],\n  SHBX: [UnsupportedEntry, { 0: 64 }],\n  WRP_: [UnsupportedEntry, { 1: 132 }],\n};\n\nexport type EntryType = Md34[] | ModelHeader[] | Sequence[] | Stc[] | Stg[] | Sts[] | Bone[] | Division[] | Region[] | Batch[] | MaterialReference[] | StandardMaterial[] | Layer[] | Event[] | BoundingSphere[] | AttachmentPoint[] | Camera[] | Sd[] | UnsupportedEntry[] | string | Int16Array | Int32Array | Uint8Array | Uint16Array | Uint32Array | Float32Array | Float32Array[];\nexport type SingleEntryType = Md34 | ModelHeader | Sequence | Stc | Stg | Sts | Bone | Division | Region | Batch | MaterialReference | StandardMaterial | Layer | Event | BoundingSphere | AttachmentPoint | Camera | Sd | UnsupportedEntry | string | number | Float32Array;\n\n/**\n * An index entry.\n */\nexport default class IndexEntry {\n  index: IndexEntry[];\n  tag: string;\n  offset: number;\n  version: number;\n  entries: EntryType;\n\n  constructor(stream: BinaryStream, index: IndexEntry[]) {\n    const tag = reverse(stream.readBinary(4));\n    const offset = stream.readUint32();\n    const entriesCount = stream.readUint32();\n    const version = stream.readUint32();\n\n    this.index = index;\n    this.tag = tag;\n    this.offset = offset;\n    this.version = version;\n\n    const mapping = tagMapping[tag];\n    const readerOffset = stream.index;\n\n    stream.seek(offset);\n\n    // This is an object\n    if (mapping) {\n      const constructor = mapping[0];\n      const entrySize = mapping[1][version];\n\n      if (!entrySize) {\n        // Yey found a new version!\n        throw new Error(': Unsupported object version - tag ' + tag + ' and version ' + version);\n      }\n\n      this.entries = [];\n\n      for (let i = 0, l = entriesCount; i < l; i++) {\n        // A sub stream is given for each object constructor.\n        // This allows for parsing to work consistently, even if we don't quite know exactly how the structures look.\n        // If some bytes aren't read, the error will not carry to the next object.\n        // Since new versions of objects usually add data to the end, this allows the parser to work, even if trying to load newer versions.\n        // Of course, the new version size needs to be added to IndexEntry.tagMapping, when finding one.\n        if (constructor === UnsupportedEntry) {\n          this.entries[i] = new UnsupportedEntry(stream.substream(entrySize), version, index);\n        } else {\n          const entry = new constructor();\n\n          entry.load(stream.substream(entrySize), version, index);\n\n          this.entries[i] = entry;\n        }\n      }\n      // This is maybe a typed array?\n    } else if (tag === 'CHAR' || tag === 'SCHR') {\n      this.entries = stream.read(entriesCount);\n    } else if (tag === 'U8__') {\n      this.entries = stream.readUint8Array(entriesCount);\n    } else if (tag === 'U16_') {\n      this.entries = stream.readUint16Array(entriesCount);\n    } else if (tag === 'U32_') {\n      this.entries = stream.readUint32Array(entriesCount);\n    } else if (tag === 'I16_') {\n      this.entries = stream.readInt16Array(entriesCount);\n    } else if (tag === 'I32_') {\n      this.entries = stream.readInt32Array(entriesCount);\n    } else if (tag === 'REAL') {\n      this.entries = stream.readFloat32Array(entriesCount);\n    } else if (tag === 'VEC2') {\n      this.entries = [];\n\n      for (let i = 0; i < entriesCount; i++) {\n        this.entries[i] = stream.readFloat32Array(2);\n      }\n    } else if (tag === 'VEC3' || tag === 'SVC3') {\n      this.entries = [];\n\n      for (let i = 0; i < entriesCount; i++) {\n        this.entries[i] = stream.readFloat32Array(3);\n      }\n    } else if (tag === 'VEC4' || tag === 'QUAT') {\n      this.entries = [];\n\n      for (let i = 0; i < entriesCount; i++) {\n        this.entries[i] = stream.readFloat32Array(4);\n      }\n    } else if (tag === 'IREF') {\n      this.entries = [];\n\n      for (let i = 0; i < entriesCount; i++) {\n        this.entries[i] = stream.readFloat32Array(16);\n      }\n    } else {\n      this.entries = [];\n\n      throw new Error(': Unsupported object tag - tag ' + tag + ' and version ' + version);\n    }\n\n    stream.seek(readerOffset);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\nimport BoundingSphere from './boundingsphere';\nimport BoundingShape from './boundingshape';\n\n/**\n * The model information structure.\n */\nexport default class ModelHeader {\n  version = -1;\n  modelName = new Reference();\n  flags = 0;\n  sequences = new Reference();\n  stc = new Reference();\n  stg = new Reference();\n  unknown0 = 0;\n  unknown1 = 0;\n  unknown2 = 0;\n  unknown3 = 0;\n  sts = new Reference();\n  bones = new Reference();\n  numberOfBonesToCheckForSkin = 0;\n  vertexFlags = 0;\n  vertices = new Reference();\n  divisions = new Reference();\n  boneLookup = new Reference();\n  boundings = new BoundingSphere();\n  unknown4To20 = new Uint32Array(16);\n  attachmentPoints = new Reference();\n  attachmentPointAddons = new Reference();\n  ligts = new Reference();\n  shbxData = new Reference();\n  cameras = new Reference();\n  unknown21 = new Reference();\n  materialReferences = new Reference();\n  materials: Reference[] = [];\n  particleEmitters = new Reference();\n  particleEmitterCopies = new Reference();\n  ribbonEmitters = new Reference();\n  projections = new Reference();\n  forces = new Reference();\n  warps = new Reference();\n  unknown22 = new Reference();\n  rigidBodies = new Reference();\n  unknown23 = new Reference();\n  physicsJoints = new Reference();\n  clothBehavior = new Reference();\n  unknown24 = new Reference();\n  ikjtData = new Reference();\n  unknown25 = new Reference();\n  unknown26 = new Reference();\n  partsOfTurrentBehaviors = new Reference();\n  turrentBehaviors = new Reference();\n  absoluteInverseBoneRestPositions = new Reference();\n  tightHitTest = new BoundingShape();\n  fuzzyHitTestObjects = new Reference();\n  attachmentVolumes = new Reference();\n  attachmentVolumesAddon0 = new Reference();\n  attachmentVolumesAddon1 = new Reference();\n  billboardBehaviors = new Reference();\n  tmdData = new Reference();\n  unknown27 = 0;\n  unknown28 = new Reference();\n\n  constructor() {\n    for (let i = 0; i < 11; i++) {\n      this.materials[i] = new Reference();\n    }\n  }\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.modelName.load(stream, index);\n    this.flags = stream.readUint32();\n    this.sequences.load(stream, index);\n    this.stc.load(stream, index);\n    this.stg.load(stream, index);\n    this.unknown0 = stream.readFloat32();\n    this.unknown1 = stream.readFloat32();\n    this.unknown2 = stream.readFloat32();\n    this.unknown3 = stream.readFloat32();\n    this.sts.load(stream, index);\n    this.bones.load(stream, index);\n    this.numberOfBonesToCheckForSkin = stream.readUint32();\n    this.vertexFlags = stream.readUint32();\n    this.vertices.load(stream, index);\n    this.divisions.load(stream, index);\n    this.boneLookup.load(stream, index);\n    this.boundings.load(stream);\n    stream.readUint32Array(this.unknown4To20);\n    this.attachmentPoints.load(stream, index);\n    this.attachmentPointAddons.load(stream, index);\n    this.ligts.load(stream, index);\n    this.shbxData.load(stream, index);\n    this.cameras.load(stream, index);\n    this.unknown21.load(stream, index);\n    this.materialReferences.load(stream, index);\n\n    for (let i = 0; i < 7; i++) {\n      this.materials[i].load(stream, index); // Standard, Displacement, Composite, Terrain, Volume, ?, Creep\n    }\n\n    if (version > 24) {\n      this.materials[7].load(stream, index); // Volume noise\n    }\n\n    if (version > 25) {\n      this.materials[8].load(stream, index); // Splat terrain bake\n    }\n\n    if (version > 27) {\n      this.materials[9].load(stream, index); // ?\n    }\n\n    if (version > 28) {\n      this.materials[10].load(stream, index); // Lens flare\n    }\n\n    this.particleEmitters.load(stream, index);\n    this.particleEmitterCopies.load(stream, index);\n    this.ribbonEmitters.load(stream, index);\n    this.projections.load(stream, index);\n    this.forces.load(stream, index);\n    this.warps.load(stream, index);\n    this.unknown22.load(stream, index); // ?\n    this.rigidBodies.load(stream, index);\n    this.unknown23.load(stream, index); // ?\n    this.physicsJoints.load(stream, index);\n\n    if (version > 27) {\n      this.clothBehavior.load(stream, index);\n    }\n\n    this.unknown24.load(stream, index); // ?\n    this.ikjtData.load(stream, index);\n    this.unknown25.load(stream, index); // ?\n\n    if (version > 24) {\n      this.unknown26.load(stream, index); // ?\n    }\n\n    this.partsOfTurrentBehaviors.load(stream, index);\n    this.turrentBehaviors.load(stream, index);\n    this.absoluteInverseBoneRestPositions.load(stream, index);\n    this.tightHitTest.load(stream);\n    this.fuzzyHitTestObjects.load(stream, index);\n    this.attachmentVolumes.load(stream, index);\n    this.attachmentVolumesAddon0.load(stream, index);\n    this.attachmentVolumesAddon1.load(stream, index);\n    this.billboardBehaviors.load(stream, index);\n    this.tmdData.load(stream, index);\n    this.unknown27 = stream.readUint32(); // ?\n    this.unknown28.load(stream, index); // ?\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\nimport BoundingSphere from './boundingsphere';\n\n/**\n * A sequence.\n */\nexport default class Sequence {\n  version = -1;\n  name = new Reference();\n  interval = new Uint32Array(2);\n  movementSpeed = 0;\n  flags = 0;\n  frequency = 0;\n  boundingSphere = new BoundingSphere();\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n\n    stream.skip(8); // ?\n\n    this.name.load(stream, index);\n    stream.readUint32Array(this.interval);\n    this.movementSpeed = stream.readFloat32();\n    this.flags = stream.readUint32();\n    this.frequency = stream.readUint32();\n\n    stream.skip(12); // ?\n\n    if (version < 2) {\n      stream.skip(4); // ?\n    }\n\n    this.boundingSphere.load(stream);\n\n    stream.skip(12); // ?\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * An animation timeline.\n */\nexport default class Stc {\n  version = -1;\n  name = new Reference();\n  runsConcurrent = 0;\n  priority = 0;\n  stsIndex = -1;\n  stsIndexCopy = -1;\n  animIds = new Reference();\n  animRefs = new Reference();\n  sd: Reference[] = [];\n\n  constructor() {\n    for (let i = 0; i < 13; i++) {\n      this.sd[i] = new Reference();\n    }\n  }\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.name.load(stream, index);\n    this.runsConcurrent = stream.readUint16();\n    this.priority = stream.readUint16();\n    this.stsIndex = stream.readUint16();\n    this.stsIndexCopy = stream.readUint16(); // ?\n    this.animIds.load(stream, index);\n    this.animRefs.load(stream, index);\n\n    stream.skip(4); // ?\n\n    for (let i = 0; i < 13; i++) {\n      this.sd[i].load(stream, index);\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * An animation getter.\n */\nexport default class Stg {\n  version = -1;\n  name = new Reference();\n  stcIndices = new Reference();\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.name.load(stream, index);\n    this.stcIndices.load(stream, index);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * An animation validator.\n */\nexport default class Sts {\n  version = -1;\n  animIds = new Reference();\n\n  load(reader: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.animIds.load(reader, index);\n\n    reader.skip(16); // ?\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\nimport { Uint32AnimationReference, Vector3AnimationReference, Vector4AnimationReference } from './animationreference';\n\n/**\n * A bone.\n */\nexport default class Bone {\n  version = -1;\n  unknown0 = 0;\n  name = new Reference();\n  flags = 0;\n  parent = -1;\n  unknown1 = 0;\n  location = new Vector3AnimationReference();\n  rotation = new Vector4AnimationReference();\n  scale = new Vector3AnimationReference();\n  visibility = new Uint32AnimationReference();\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.unknown0 = stream.readInt32();\n    this.name.load(stream, index);\n    this.flags = stream.readUint32();\n    this.parent = stream.readInt16();\n    this.unknown1 = stream.readUint16();\n    this.location.load(stream);\n    this.rotation.load(stream);\n    this.scale.load(stream);\n    this.visibility.load(stream);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * A division.\n */\nexport default class Division {\n  version = -1;\n  triangles = new Reference();\n  regions = new Reference();\n  batches = new Reference();\n  MSEC = new Reference();\n  unknown0 = 0;\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.triangles.load(stream, index);\n    this.regions.load(stream, index);\n    this.batches.load(stream, index);\n    this.MSEC.load(stream, index);\n    this.unknown0 = stream.readUint32();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\n\n/**\n * A region.\n */\nexport default class Region {\n  version = -1;\n  unknown0 = 0;\n  unknown1 = 0;\n  firstVertexIndex = -1;\n  verticesCount = 0;\n  firstTriangleIndex = -1;\n  triangleIndicesCount = 0;\n  bonesCount = 0;\n  firstBoneLookupIndex = -1;\n  boneLookupIndicesCount = 0;\n  unknown2 = 0;\n  boneWeightPairsCount = 0;\n  unknown3 = 0;\n  rootBoneIndex = -1;\n  unknown4 = 0;\n  unknown5 = new Uint8Array(8);\n\n  load(stream: BinaryStream, version: number, _index: IndexEntry[]): void {\n    this.version = version;\n    this.unknown0 = stream.readUint32();\n    this.unknown1 = stream.readUint32();\n    this.firstVertexIndex = stream.readUint32();\n    this.verticesCount = stream.readUint32();\n    this.firstTriangleIndex = stream.readUint32();\n    this.triangleIndicesCount = stream.readUint32();\n    this.bonesCount = stream.readUint16();\n    this.firstBoneLookupIndex = stream.readUint16();\n    this.boneLookupIndicesCount = stream.readUint16();\n    this.unknown2 = stream.readUint16();\n    this.boneWeightPairsCount = stream.readUint8();\n    this.unknown3 = stream.readUint8();\n    this.rootBoneIndex = stream.readUint16();\n\n    if (version > 3) {\n      this.unknown4 = stream.readUint32();\n    }\n\n    if (version > 4) {\n      stream.readUint8Array(this.unknown5);\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\n\n/**\n * A batch.\n */\nexport default class Batch {\n  version = -1;\n  unknown0 = 0;\n  regionIndex = -1;\n  unknown1 = 0;\n  materialReferenceIndex = -1;\n  unknown2 = 0;\n\n  load(stream: BinaryStream, version: number, _index: IndexEntry[]): void {\n    this.version = version;\n    this.unknown0 = stream.readUint32();\n    this.regionIndex = stream.readUint16();\n    this.unknown1 = stream.readUint32();\n    this.materialReferenceIndex = stream.readUint16();\n    this.unknown2 = stream.readUint16();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\n\n/**\n * A material reference.\n */\nexport default class MaterialReference {\n  version = -1;\n  materialType = 0;\n  materialIndex = -1;\n\n  load(stream: BinaryStream, version: number, _index: IndexEntry[]): void {\n    this.version = version;\n    this.materialType = stream.readUint32();\n    this.materialIndex = stream.readUint32();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\nimport { Float32AnimationReference, Uint32AnimationReference } from './animationreference';\n\n/**\n * A standard material.\n */\nexport default class StandardMaterial {\n  version = -1;\n  name = new Reference();\n  additionalFlags = 0;\n  flags = 0;\n  blendMode = 0;\n  priority = 0;\n  usedRTTChannels = 0;\n  specularity = 0;\n  depthBlendFalloff = 0;\n  cutoutThreshold = 0;\n  unknown1 = 0;\n  unknown2 = 0;\n  unknown3 = 0;\n  specMult = 0;\n  emisMult = 0;\n  diffuseLayer = new Reference();\n  decalLayer = new Reference();\n  specularLayer = new Reference();\n  glossLayer = new Reference();\n  emissiveLayer = new Reference();\n  emissive2Layer = new Reference();\n  evioLayer = new Reference();\n  evioMaskLayer = new Reference();\n  alphaMaskLayer = new Reference();\n  alphaMask2Layer = new Reference();\n  normalLayer = new Reference();\n  heightLayer = new Reference();\n  lightMapLayer = new Reference();\n  ambientOcclusionLayer = new Reference();\n  unknown4 = new Reference();\n  unknown5 = new Reference();\n  unknown6 = new Reference();\n  unknown7 = new Reference();\n  unknown8 = 0;\n  layerBlendType = 0;\n  emisBlendType = 0;\n  emisMode = 0;\n  specType = 0;\n  unknown9 = new Float32AnimationReference();\n  unknown10 = new Uint32AnimationReference();\n  unknown11 = new Uint8Array(12);\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.name.load(stream, index);\n    this.additionalFlags = stream.readUint32();\n    this.flags = stream.readUint32();\n    this.blendMode = stream.readUint32();\n    this.priority = stream.readInt32();\n    this.usedRTTChannels = stream.readUint32();\n    this.specularity = stream.readFloat32();\n    this.depthBlendFalloff = stream.readFloat32();\n    this.cutoutThreshold = stream.readUint8();\n    this.unknown1 = stream.readUint8(); // ?\n    this.unknown2 = stream.readUint8(); // ?\n    this.unknown3 = stream.readUint8(); // ?\n    this.specMult = stream.readFloat32();\n    this.emisMult = stream.readFloat32();\n    this.diffuseLayer.load(stream, index);\n    this.decalLayer.load(stream, index);\n    this.specularLayer.load(stream, index);\n\n    if (version > 15) {\n      this.glossLayer.load(stream, index);\n    }\n\n    this.emissiveLayer.load(stream, index);\n    this.emissive2Layer.load(stream, index);\n    this.evioLayer.load(stream, index);\n    this.evioMaskLayer.load(stream, index);\n    this.alphaMaskLayer.load(stream, index);\n    this.alphaMask2Layer.load(stream, index);\n    this.normalLayer.load(stream, index);\n    this.heightLayer.load(stream, index);\n    this.lightMapLayer.load(stream, index);\n    this.ambientOcclusionLayer.load(stream, index);\n\n    if (version > 18) {\n      this.unknown4.load(stream, index); // Unknown layer\n      this.unknown5.load(stream, index); // Unknown layer\n      this.unknown6.load(stream, index); // Unknown layer\n      this.unknown7.load(stream, index); // Unknown layer\n    }\n\n    this.unknown8 = stream.readUint32(); // ?\n    this.layerBlendType = stream.readUint32();\n    this.emisBlendType = stream.readUint32();\n    this.emisMode = stream.readUint32();\n    this.specType = stream.readUint32();\n\n    this.unknown9.load(stream); // ?\n    this.unknown10.load(stream); // ?\n\n    if (version > 18) {\n      this.unknown11 = stream.readUint8Array(this.unknown11); // ?\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\nimport { PixelAnimationReference, Uint16AnimationReference, Uint32AnimationReference, Float32AnimationReference, Vector2AnimationReference, Vector3AnimationReference } from './animationreference';\n\n/**\n * A layer.\n */\nexport default class Layer {\n  version = -1;\n  unknown0 = 0;\n  imagePath = new Reference();\n  color = new PixelAnimationReference();\n  flags = 0;\n  uvSource = -1;\n  colorChannelSetting = 0;\n  brightMult = new Float32AnimationReference();\n  midtoneOffset = new Float32AnimationReference();\n  unknown1 = 0;\n  noiseAmp = 0;\n  noiseFreq = 0;\n  rttChannel = 0;\n  videoFrameRate = 0;\n  videoStartFrame = 0;\n  videoEndFrame = 0;\n  videoMode = 0;\n  videoSyncTiming = 0;\n  videoPlay = new Uint32AnimationReference();\n  videoRestart = new Uint32AnimationReference();\n  flipBookRows = 0;\n  flipBookColumns = 0;\n  flipBookFrame = new Uint16AnimationReference();\n  uvOffset = new Vector2AnimationReference();\n  uvAngle = new Vector3AnimationReference();\n  uvTiling = new Vector2AnimationReference();\n  unknown2 = new Uint32AnimationReference();\n  unknown3 = new Float32AnimationReference();\n  brightness = new Float32AnimationReference();\n  triPlanarOffset = new Vector3AnimationReference();\n  triPlanarScale = new Vector3AnimationReference();\n  unknown4 = 0;\n  fresnelType = 0;\n  fresnelExponent = 0;\n  fresnelMin = 0;\n  fresnelMaxOffset = 0;\n  unknown5 = 0;\n  unknown6 = new Uint8Array(8);\n  fresnelInvertedMaskX = 0;\n  fresnelInvertedMaskY = 0;\n  fresnelInvertedMaskZ = 0;\n  fresnelRotationYaw = 0;\n  fresnelRotationPitch = 0;\n  unknown7 = 0;\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.unknown0 = stream.readUint32();\n    this.imagePath.load(stream, index);\n    this.color.load(stream);\n    this.flags = stream.readUint32();\n    this.uvSource = stream.readUint32();\n    this.colorChannelSetting = stream.readUint32();\n    this.brightMult.load(stream);\n    this.midtoneOffset.load(stream);\n    this.unknown1 = stream.readUint32();\n\n    if (version > 23) {\n      this.noiseAmp = stream.readFloat32();\n      this.noiseFreq = stream.readFloat32();\n    }\n\n    this.rttChannel = stream.readInt32();\n    this.videoFrameRate = stream.readUint32();\n    this.videoStartFrame = stream.readUint32();\n    this.videoEndFrame = stream.readInt32();\n    this.videoMode = stream.readUint32();\n    this.videoSyncTiming = stream.readUint32();\n    this.videoPlay.load(stream);\n    this.videoRestart.load(stream);\n    this.flipBookRows = stream.readUint32();\n    this.flipBookColumns = stream.readUint32();\n    this.flipBookFrame.load(stream);\n    this.uvOffset.load(stream);\n    this.uvAngle.load(stream);\n    this.uvTiling.load(stream);\n    this.unknown2.load(stream);\n    this.unknown3.load(stream);\n    this.brightness.load(stream);\n\n    if (version > 23) {\n      this.triPlanarOffset.load(stream);\n      this.triPlanarScale.load(stream);\n    }\n\n    this.unknown4 = stream.readInt32();\n    this.fresnelType = stream.readUint32();\n    this.fresnelExponent = stream.readFloat32();\n    this.fresnelMin = stream.readFloat32();\n    this.fresnelMaxOffset = stream.readFloat32();\n    this.unknown5 = stream.readFloat32();\n\n    if (version > 24) {\n      this.unknown6 = stream.readUint8Array(8);\n      this.fresnelInvertedMaskX = stream.readFloat32();\n      this.fresnelInvertedMaskY = stream.readFloat32();\n      this.fresnelInvertedMaskZ = stream.readFloat32();\n      this.fresnelRotationYaw = stream.readFloat32();\n      this.fresnelRotationPitch = stream.readFloat32();\n      this.unknown7 = stream.readUint32();\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * An event.\n */\nexport default class Event {\n  version = -1;\n  name = new Reference();\n  unknown0 = 0;\n  unknown1 = 0;\n  unknown2 = 0;\n  matrix = new Float32Array(16);\n  unknown3 = 0;\n  unknown4 = 0;\n  unknown5 = 0;\n  unknown6 = 0;\n  unknown7 = 0;\n  unknown8 = 0;\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.name.load(stream, index);\n    this.unknown0 = stream.readInt32();\n    this.unknown1 = stream.readInt16();\n    this.unknown2 = stream.readUint16();\n    stream.readFloat32Array(this.matrix);\n    this.unknown3 = stream.readInt32();\n    this.unknown4 = stream.readInt32();\n    this.unknown5 = stream.readInt32();\n\n    if (version > 0) {\n      this.unknown6 = stream.readInt32();\n      this.unknown7 = stream.readInt32();\n    }\n\n    if (version > 1) {\n      this.unknown8 = stream.readInt32();\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\n\n/**\n * An attachment point.\n */\nexport default class AttachmentPoint {\n  version = -1;\n  unknown = 0;\n  name = new Reference();\n  bone = -1;\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.unknown = stream.readInt32();\n    this.name.load(stream, index);\n    this.bone = stream.readUint32();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Reference from './reference';\nimport { Float32AnimationReference } from './animationreference';\n\n/**\n * A camera.\n */\nexport default class Camera {\n  version = -1;\n  bone = -1;\n  name = new Reference();\n  fieldOfView = new Float32AnimationReference();\n  unknown0 = 0;\n  farClip = new Float32AnimationReference();\n  nearClip = new Float32AnimationReference();\n  clip2 = new Float32AnimationReference();\n  focalDepth = new Float32AnimationReference();\n  falloffStart = new Float32AnimationReference();\n  falloffEnd = new Float32AnimationReference();\n  depthOfField = new Float32AnimationReference();\n\n  load(stream: BinaryStream, version: number, index: IndexEntry[]): void {\n    this.version = version;\n    this.bone = stream.readUint32();\n    this.name.load(stream, index);\n    this.fieldOfView.load(stream);\n    this.unknown0 = stream.readUint32();\n    this.farClip.load(stream);\n    this.nearClip.load(stream);\n    this.clip2.load(stream);\n    this.focalDepth.load(stream);\n    this.falloffStart.load(stream);\n    this.falloffEnd.load(stream);\n    this.depthOfField.load(stream);\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport IndexEntry from './indexentry';\nimport Md34 from './md34';\nimport ModelHeader from './modelheader';\n\n/**\n * A model.\n */\nexport default class Model {\n  index: IndexEntry[] = [];\n  model: ModelHeader | null = null;\n\n  load(src: ArrayBuffer | Uint8Array): void {\n    const stream = new BinaryStream(src);\n    const header = new Md34();\n\n    header.load(stream, 11, this.index);\n\n    if (header.tag !== 'MD34') {\n      throw new Error('WrongMagicNumber');\n    }\n\n    stream.seek(header.offset);\n\n    // Read the index entries\n    for (let i = 0, l = header.entries; i < l; i++) {\n      this.index[i] = new IndexEntry(stream, this.index);\n    }\n\n    const modelEntries = this.index[header.model.id].entries;\n\n    if (modelEntries) {\n      this.model = <ModelHeader>modelEntries[0];\n    }\n  }\n}\n","/**\n * Detects if the given object is an M3 source.\n */\nexport default function isM3(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x34 && bytes[1] === 0x33 && bytes[2] === 0x44 && bytes[3] === 0x4d) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","/**\n * Used to read and write MDL tokens.\n */\nexport default class TokenStream {\n  buffer: string;\n  index = 0;\n  ident = 0;\n  indentSpaces = 4;\n  precision = 1000000; // 6 digits after the decimal point.\n\n  constructor(buffer?: string) {\n    this.buffer = buffer || '';\n  }\n\n  /**\n   * Clear the stream from whatever buffer it had.\n   */\n  clear(): void {\n    this.buffer = '';\n    this.index = 0;\n    this.ident = 0;\n  }\n\n  /**\n   * Reads the next token in the stream.\n   * Whitespaces are ignored outside of strings in the form of \"\".\n   * Comments in the form of // are ignored.\n   * Commas and colons are ignored as well.\n   * Curly braces are used as separators, generally to denote text blocks.\n   *\n   * For example, given the following string:\n   *\n   *     Header \"A String\" {\n   *         Name Value, // A Comment\n   *     }\n   *\n   * Read will return the values in order:\n   *\n   *     Header\n   *     \"A String\"\n   *     {\n   *     Name\n   *     Value\n   *     }\n   *\n   * There are wrappers around read, below, that help to read structured code, check them out!\n   */\n  readToken(): string | undefined {\n    const buffer = this.buffer;\n    const length = buffer.length;\n    let inComment = false;\n    let inString = false;\n    let token = '';\n\n    while (this.index < length) {\n      const c = buffer[this.index++];\n\n      if (inComment) {\n        if (c === '\\n') {\n          inComment = false;\n        }\n      } else if (inString) {\n        if (c === '\\\\') {\n          token += c + buffer[this.index++];\n        } else if (c === '\\n') {\n          token += '\\\\n';\n        } else if (c === '\\r') {\n          token += '\\\\r';\n        } else if (c === '\"') {\n          return token;\n        } else {\n          token += c;\n        }\n      } else if (c === ' ' || c === ',' || c === '\\t' || c === '\\n' || c === ':' || c === '\\r') {\n        if (token.length) {\n          return token;\n        }\n      } else if (c === '{' || c === '}') {\n        if (token.length) {\n          this.index--;\n          return token;\n        } else {\n          return c;\n        }\n      } else if (c === '/' && buffer[this.index] === '/') {\n        if (token.length) {\n          this.index--;\n          return token;\n        } else {\n          inComment = true;\n        }\n      } else if (c === '\"') {\n        if (token.length) {\n          this.index--;\n          return token;\n        } else {\n          inString = true;\n        }\n      } else {\n        token += c;\n      }\n    }\n\n    return;\n  }\n\n  /**\n   * Same as readToken, but if the end of the stream was encountered, an exception will be thrown.\n   */\n  read(): string {\n    const value = this.readToken();\n\n    if (value === undefined) {\n      throw new Error('End of stream reached prematurely');\n    }\n\n    return value;\n  }\n\n  /**\n   * Reads the next token without advancing the stream.\n   */\n  peek(): string {\n    const index = this.index;\n    const value = this.read();\n\n    this.index = index;\n\n    return value;\n  }\n\n  /**\n   * Reads the next token, and parses it as an integer.\n   */\n  readInt(): number {\n    return parseInt(this.read());\n  }\n\n  /**\n   * Reads the next token, and parses it as a float.\n   */\n  readFloat(): number {\n    return parseFloat(this.read());\n  }\n\n  /**\n   * { Number0, Number1, ..., NumberN }\n   */\n  readVector<T extends Uint8Array | Uint16Array | Uint32Array | Float32Array>(view: T): T {\n    this.read(); // {\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = this.readFloat();\n    }\n\n    this.read(); // }\n\n    return view;\n  }\n\n  /**\n   * {\n   *     { Value1, Value2, ..., ValueSize },\n   *     { Value1, Value2, ..., ValueSize },\n   *     ...\n   * }\n   */\n  readVectorsBlock<T extends Uint16Array | Float32Array>(view: T, size: number): T {\n    this.read(); // {\n\n    for (let i = 0, l = view.length; i < l; i += size) {\n      this.readVector(view.subarray(i, i + size));\n    }\n\n    this.read(); // }\n\n    return view;\n  }\n\n  /**\n   * Reads a color in the form:\n   *\n   *      { R, G, B }\n   *\n   * The color is sizzled to BGR.\n   */\n  readColor(view: Float32Array): Float32Array {\n    this.read(); // {\n\n    view[2] = this.readFloat();\n    view[1] = this.readFloat();\n    view[0] = this.readFloat();\n\n    this.read(); // }\n\n    return view;\n  }\n\n  /**\n   * Helper generator for block reading.\n   * Let's say we have a block like so:\n   * \n   *     {\n   *         Key1 Value1\n   *         Key2 Value2\n   *         ...\n   *         KeyN ValueN\n   *     }\n   * \n   * The generator yields the keys one by one, and the caller needs to read the values based on the keys.\n   * It is used for most MDL blocks.\n   */\n  * readBlock(): Generator<string> {\n    this.read(); // {\n\n    let token = this.read();\n\n    while (token !== '}') {\n      yield token;\n\n      token = this.read();\n    }\n  }\n\n  /**\n   * Adds the given string to the buffer.\n   * The current indentation level is prepended, and the stream goes to the next line after the write.\n   */\n  writeLine(line: string): void {\n    this.buffer += `${' '.repeat(this.ident * this.indentSpaces)}${line}\\n`;\n  }\n\n  /**\n   * Flag,\n   */\n  writeFlag(flag: string): void {\n    this.writeLine(`${flag},`);\n  }\n\n  /**\n   * Name Flag,\n   */\n  writeFlagAttrib(name: string, flag: string): void {\n    this.writeLine(`${name} ${flag},`);\n  }\n\n  /**\n   * Name Value,\n   */\n  writeNumberAttrib(name: string, value: number): void {\n    this.writeLine(`${name} ${this.floatDecimals(value)},`);\n  }\n\n  /**\n   * Name \"Value\",\n   */\n  writeStringAttrib(name: string, value: string): void {\n    this.writeLine(`${name} \"${value}\",`);\n  }\n\n  /**\n   * Name { Value0, Value1, ..., ValueN }\n   */\n  writeVectorAttrib(name: string, value: Uint8Array | Uint32Array | Float32Array): void {\n    this.writeLine(`${name} { ${this.floatArrayDecimals(value)} },`);\n  }\n\n  /**\n   * Writes a color in the form:\n   *\n   *      { B, G, R }\n   *\n   * The color is sizzled to RGB.\n   * The name can be either \"Color\" or \"static Color\", depending on the context.\n   */\n  writeColor(name: string, value: Float32Array): void {\n    const b = this.floatDecimals(value[0]);\n    const g = this.floatDecimals(value[1]);\n    const r = this.floatDecimals(value[2]);\n\n    this.writeLine(`${name} { ${r}, ${g}, ${b} },`);\n  }\n\n  /**\n   * { Value0, Value1, ..., ValueN },\n   */\n  writeVector(value: Uint16Array | Float32Array): void {\n    this.writeLine(`{ ${this.floatArrayDecimals(value)} },`);\n  }\n\n  /**\n   * Name Vectors {\n   *     { Value1, Value2, ..., ValueSize },\n   *     { Value1, Value2, ..., ValueSize },\n   *     ...\n   * }\n   */\n  writeVectorArrayBlock(name: string, view: Float32Array, size: number): void {\n    this.startBlock(name, view.length / size);\n\n    for (let i = 0, l = view.length; i < l; i += size) {\n      this.writeVector(view.subarray(i, i + size));\n    }\n\n    this.endBlock();\n  }\n\n  /**\n   * Starts a new block in the form:\n   *\n   *      Header1 Header2 ... HeaderN {\n   *          ...\n   *      }\n   */\n  startBlock(name: string, ...headers: (string | number)[]): void {\n    if (headers.length) {\n      name = `${name} ${headers.join(' ')}`;\n    }\n\n    this.writeLine(`${name} {`);\n    this.ident += 1;\n  }\n\n  /**\n   * Starts a new block in the form:\n   *\n   *      Header \"Name\" {\n   *          ...\n   *      }\n   */\n  startObjectBlock(header: string, name: string): void {\n    // Turns out you can have quotation marks in object names.\n    this.writeLine(`${header} \"${name.replace(/\"/g, '\\\\\"')}\" {`);\n    this.ident += 1;\n  }\n\n  /**\n   * Ends a previously started block, and handles the indentation.\n   */\n  endBlock(): void {\n    this.ident -= 1;\n    this.writeLine('}');\n  }\n\n  /**\n   * Ends a previously started block, and handles the indentation.\n   * Adds a comma after the block end.\n   */\n  endBlockComma(): void {\n    this.ident -= 1;\n    this.writeLine('},');\n  }\n\n  /**\n   * Increases the indentation level for following line writes.\n   */\n  indent(): void {\n    this.ident += 1;\n  }\n\n  /**\n   * Decreases the indentation level for following line writes.\n   */\n  unindent(): void {\n    this.ident -= 1;\n  }\n\n  /**\n * Given a number, truncates digits after the decimal point.\n * The given precision should be in base 10.\n * E.g. for a precision of two digits after the decimal point, the precision should be 100.\n * The result is returned as a string.\n */\n  floatDecimals(value: number): string {\n    return `${Math.trunc(value * this.precision) / this.precision}`;\n  }\n\n  /**\n   * Uses floatDecimals on a typed array, and returns its string representation. \n   */\n  floatArrayDecimals(value: Uint8Array | Uint16Array | Uint32Array | Float32Array): string {\n    if (value instanceof Float32Array) {\n      const array = [];\n\n      for (let i = 0, l = value.length; i < l; i++) {\n        array[i] = this.floatDecimals(value[i]);\n      }\n\n      return array.join(', ');\n    } else {\n      return value.join(', ');\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\n\n/**\n * An extent.\n */\nexport default class Extent {\n  boundsRadius = 0;\n  min = new Float32Array(3);\n  max = new Float32Array(3);\n\n  readMdx(stream: BinaryStream): void {\n    this.boundsRadius = stream.readFloat32();\n    stream.readFloat32Array(this.min);\n    stream.readFloat32Array(this.max);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeFloat32(this.boundsRadius);\n    stream.writeFloat32Array(this.min);\n    stream.writeFloat32Array(this.max);\n  }\n\n  writeMdl(stream: TokenStream): void {\n    if (this.min[0] !== 0 || this.min[1] !== 0 || this.min[2] !== 0) {\n      stream.writeVectorAttrib('MinimumExtent', this.min);\n    }\n\n    if (this.max[0] !== 0 || this.max[1] !== 0 || this.max[2] !== 0) {\n      stream.writeVectorAttrib('MaximumExtent', this.max);\n    }\n\n    if (this.boundsRadius !== 0) {\n      stream.writeNumberAttrib('BoundsRadius', this.boundsRadius);\n    }\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport Extent from './extent';\n\n/**\n * A sequence.\n */\nexport default class Sequence {\n  name = '';\n  interval = new Uint32Array(2);\n  moveSpeed = 0;\n  nonLooping = 0;\n  rarity = 0;\n  syncPoint = 0;\n  extent = new Extent();\n\n  readMdx(stream: BinaryStream): void {\n    this.name = stream.read(80);\n    stream.readUint32Array(this.interval);\n    this.moveSpeed = stream.readFloat32();\n    this.nonLooping = stream.readUint32();\n    this.rarity = stream.readFloat32();\n    this.syncPoint = stream.readUint32();\n    this.extent.readMdx(stream);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.skip(80 - stream.write(this.name));\n    stream.writeUint32Array(this.interval);\n    stream.writeFloat32(this.moveSpeed);\n    stream.writeUint32(this.nonLooping);\n    stream.writeFloat32(this.rarity);\n    stream.writeUint32(this.syncPoint);\n    this.extent.writeMdx(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    this.name = stream.read();\n\n    for (const token of stream.readBlock()) {\n      if (token === 'Interval') {\n        stream.readVector(this.interval);\n      } else if (token === 'NonLooping') {\n        this.nonLooping = 1;\n      } else if (token === 'MoveSpeed') {\n        this.moveSpeed = stream.readFloat();\n      } else if (token === 'Rarity') {\n        this.rarity = stream.readFloat();\n      } else if (token === 'MinimumExtent') {\n        stream.readVector(this.extent.min);\n      } else if (token === 'MaximumExtent') {\n        stream.readVector(this.extent.max);\n      } else if (token === 'BoundsRadius') {\n        this.extent.boundsRadius = stream.readFloat();\n      } else {\n        throw new Error(`Unknown token in Sequence: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('Anim', this.name);\n    stream.writeVectorAttrib('Interval', this.interval);\n\n    if (this.nonLooping === 1) {\n      stream.writeFlag('NonLooping');\n    }\n\n    if (this.moveSpeed !== 0) {\n      stream.writeNumberAttrib('MoveSpeed', this.moveSpeed);\n    }\n\n    if (this.rarity !== 0) {\n      stream.writeNumberAttrib('Rarity', this.rarity);\n    }\n\n    this.extent.writeMdl(stream);\n    stream.endBlock();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\n\nexport const enum InterpolationType {\n  DontInterp = 0,\n  Linear = 1,\n  Hermite = 2,\n  Bezier = 3,\n}\n/**\n * An animation.\n */\nexport abstract class Animation {\n  name = '';\n  interpolationType = InterpolationType.DontInterp;\n  globalSequenceId = -1;\n  frames: number[] = [];\n  values: (Uint32Array | Float32Array)[] = [];\n  inTans: (Uint32Array | Float32Array)[] = [];\n  outTans: (Uint32Array | Float32Array)[] = [];\n\n  abstract readMdxValue(stream: BinaryStream): Uint32Array | Float32Array;\n  abstract writeMdxValue(stream: BinaryStream, value: Uint32Array | Float32Array): void;\n  abstract readMdlValue(stream: TokenStream): Uint32Array | Float32Array;\n  abstract writeMdlValue(stream: TokenStream, name: string, value: Uint32Array | Float32Array): void;\n\n  readMdx(stream: BinaryStream, name: string): void {\n    const frames = this.frames;\n    const values = this.values;\n    const inTans = this.inTans;\n    const outTans = this.outTans;\n    const tracksCount = stream.readUint32();\n    const interpolationType = stream.readUint32();\n\n    this.name = name;\n    this.interpolationType = interpolationType;\n    this.globalSequenceId = stream.readInt32();\n\n    for (let i = 0; i < tracksCount; i++) {\n      frames.push(stream.readInt32());\n      values.push(this.readMdxValue(stream));\n\n      if (interpolationType > 1) {\n        inTans.push(this.readMdxValue(stream));\n        outTans.push(this.readMdxValue(stream));\n      }\n    }\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    const interpolationType = this.interpolationType;\n    const frames = this.frames;\n    const values = this.values;\n    const inTans = this.inTans;\n    const outTans = this.outTans;\n    const tracksCount = frames.length;\n\n    stream.writeBinary(this.name);\n    stream.writeUint32(tracksCount);\n    stream.writeUint32(interpolationType);\n    stream.writeInt32(this.globalSequenceId);\n\n    for (let i = 0; i < tracksCount; i++) {\n      stream.writeInt32(frames[i]);\n      this.writeMdxValue(stream, values[i]);\n\n      if (interpolationType > InterpolationType.Linear) {\n        this.writeMdxValue(stream, inTans[i]);\n        this.writeMdxValue(stream, outTans[i]);\n      }\n    }\n  }\n\n  readMdl(stream: TokenStream, name: string): void {\n    const frames = this.frames;\n    const values = this.values;\n    const inTans = this.inTans;\n    const outTans = this.outTans;\n\n    this.name = name;\n\n    const tracksCount = stream.readInt();\n\n    stream.read(); // {\n\n    let interpolationType = 0;\n    const token = stream.read();\n\n    if (token === 'DontInterp') {\n      interpolationType = InterpolationType.DontInterp;\n    } else if (token === 'Linear') {\n      interpolationType = InterpolationType.Linear;\n    } else if (token === 'Hermite') {\n      interpolationType = InterpolationType.Hermite;\n    } else if (token === 'Bezier') {\n      interpolationType = InterpolationType.Bezier;\n    }\n\n    this.interpolationType = interpolationType;\n\n    // GlobalSeqId only exists if it's not -1.\n    if (stream.peek() === 'GlobalSeqId') {\n      stream.read();\n\n      this.globalSequenceId = stream.readInt();\n    }\n\n    for (let i = 0; i < tracksCount; i++) {\n      frames[i] = stream.readInt();\n      values[i] = this.readMdlValue(stream);\n\n      if (interpolationType > InterpolationType.Linear) {\n        stream.read(); // InTan\n        inTans[i] = this.readMdlValue(stream);\n        stream.read(); // OutTan\n        outTans[i] = this.readMdlValue(stream);\n      }\n    }\n\n    stream.read(); // }\n  }\n\n  writeMdl(stream: TokenStream, name: string): void {\n    const interpolationType = this.interpolationType;\n    const frames = this.frames;\n    const values = this.values;\n    const inTans = this.inTans;\n    const outTans = this.outTans;\n    const tracksCount = frames.length;\n\n    stream.startBlock(name, this.frames.length);\n\n    let token = '';\n\n    if (this.interpolationType === InterpolationType.DontInterp) {\n      token = 'DontInterp';\n    } else if (this.interpolationType === InterpolationType.Linear) {\n      token = 'Linear';\n    } else if (this.interpolationType === InterpolationType.Hermite) {\n      token = 'Hermite';\n    } else if (this.interpolationType === InterpolationType.Bezier) {\n      token = 'Bezier';\n    }\n\n    stream.writeFlag(token);\n\n    if (this.globalSequenceId !== -1) {\n      stream.writeNumberAttrib('GlobalSeqId', this.globalSequenceId);\n    }\n\n    for (let i = 0; i < tracksCount; i++) {\n      this.writeMdlValue(stream, `${frames[i]}:`, values[i]);\n\n      if (interpolationType > InterpolationType.Linear) {\n        stream.indent();\n        this.writeMdlValue(stream, 'InTan', inTans[i]);\n        this.writeMdlValue(stream, 'OutTan', outTans[i]);\n        stream.unindent();\n      }\n    }\n\n    stream.endBlock();\n  }\n\n  getByteLength(): number {\n    const tracksCount = this.frames.length;\n    let size = 16;\n\n    if (tracksCount) {\n      const bytesPerValue = this.values[0].byteLength;\n      let valuesPerTrack = 1;\n\n      if (this.interpolationType > InterpolationType.Linear) {\n        valuesPerTrack = 3;\n      }\n\n      size += (4 + valuesPerTrack * bytesPerValue) * tracksCount;\n    }\n\n    return size;\n  }\n}\n\n/**\n * A uint animation.\n */\nexport class UintAnimation extends Animation {\n  readMdxValue(stream: BinaryStream): Uint32Array {\n    return stream.readUint32Array(1);\n  }\n\n  writeMdxValue(stream: BinaryStream, value: Uint32Array): void {\n    stream.writeUint32(value[0]);\n  }\n\n  readMdlValue(stream: TokenStream): Uint32Array {\n    return new Uint32Array([stream.readInt()]);\n  }\n\n  writeMdlValue(stream: TokenStream, name: string, value: Uint32Array): void {\n    stream.writeNumberAttrib(name, value[0]);\n  }\n}\n\n/**\n * A float animation\n */\nexport class FloatAnimation extends Animation {\n  readMdxValue(stream: BinaryStream): Float32Array {\n    return stream.readFloat32Array(1);\n  }\n\n  writeMdxValue(stream: BinaryStream, value: Float32Array): void {\n    stream.writeFloat32(value[0]);\n  }\n\n  readMdlValue(stream: TokenStream): Float32Array {\n    return new Float32Array([stream.readFloat()]);\n  }\n\n  writeMdlValue(stream: TokenStream, name: string, value: Float32Array): void {\n    stream.writeNumberAttrib(name, value[0]);\n  }\n}\n\n/**\n * A vector 3 animation.\n */\nexport class Vector3Animation extends Animation {\n  readMdxValue(stream: BinaryStream): Float32Array {\n    return stream.readFloat32Array(3);\n  }\n\n  writeMdxValue(stream: BinaryStream, value: Float32Array): void {\n    stream.writeFloat32Array(value);\n  }\n\n  readMdlValue(stream: TokenStream): Float32Array {\n    return stream.readVector(new Float32Array(3));\n  }\n\n  writeMdlValue(stream: TokenStream, name: string, value: Float32Array): void {\n    stream.writeVectorAttrib(name, value);\n  }\n}\n\n/**\n * A vector 4 animation.\n */\nexport class Vector4Animation extends Animation {\n  readMdxValue(stream: BinaryStream): Float32Array {\n    return stream.readFloat32Array(4);\n  }\n\n  writeMdxValue(stream: BinaryStream, value: Float32Array): void {\n    stream.writeFloat32Array(value);\n  }\n\n  readMdlValue(stream: TokenStream): Float32Array {\n    return stream.readVector(new Float32Array(4));\n  }\n\n  writeMdlValue(stream: TokenStream, name: string, value: Float32Array): void {\n    stream.writeVectorAttrib(name, value);\n  }\n}\n","import { UintAnimation, FloatAnimation, Vector3Animation, Vector4Animation } from './animations';\n\n// A map from MDX animation tags to their equivalent MDL tokens, and the implementation objects.\nexport default {\n  // Layer\n  KMTF: ['TextureID', UintAnimation],\n  KMTA: ['Alpha', FloatAnimation],\n  KMTE: ['EmissiveGain', FloatAnimation],\n  KFC3: ['FresnelColor', Vector3Animation],\n  KFCA: ['FresnelOpacity', FloatAnimation],\n  KFTC: ['FresnelTeamColor', UintAnimation],\n  // TextureAnimation\n  KTAT: ['Translation', Vector3Animation],\n  KTAR: ['Rotation', Vector4Animation],\n  KTAS: ['Scaling', Vector3Animation],\n  // GeosetAnimation\n  KGAO: ['Alpha', FloatAnimation],\n  KGAC: ['Color', Vector3Animation],\n  // GenericObject\n  KGTR: ['Translation', Vector3Animation],\n  KGRT: ['Rotation', Vector4Animation],\n  KGSC: ['Scaling', Vector3Animation],\n  // Light\n  KLAS: ['AttenuationStart', FloatAnimation],\n  KLAE: ['AttenuationEnd', FloatAnimation],\n  KLAC: ['Color', Vector3Animation],\n  KLAI: ['Intensity', FloatAnimation],\n  KLBI: ['AmbIntensity', FloatAnimation],\n  KLBC: ['AmbColor', Vector3Animation],\n  KLAV: ['Visibility', FloatAnimation],\n  // Attachment\n  KATV: ['Visibility', FloatAnimation],\n  // ParticleEmitter\n  KPEE: ['EmissionRate', FloatAnimation],\n  KPEG: ['Gravity', FloatAnimation],\n  KPLN: ['Longitude', FloatAnimation],\n  KPLT: ['Latitude', FloatAnimation],\n  KPEL: ['LifeSpan', FloatAnimation],\n  KPES: ['InitVelocity', FloatAnimation],\n  KPEV: ['Visibility', FloatAnimation],\n  // ParticleEmitter2\n  KP2S: ['Speed', FloatAnimation],\n  KP2R: ['Variation', FloatAnimation],\n  KP2L: ['Latitude', FloatAnimation],\n  KP2G: ['Gravity', FloatAnimation],\n  KP2E: ['EmissionRate', FloatAnimation],\n  KP2N: ['Width', FloatAnimation],\n  KP2W: ['Length', FloatAnimation],\n  KP2V: ['Visibility', FloatAnimation],\n  // ParticleEmitterCorn\n  KPPA: ['Alpha', FloatAnimation],\n  KPPC: ['Color', Vector3Animation],\n  KPPE: ['EmissionRate', FloatAnimation],\n  KPPL: ['LifeSpan', FloatAnimation],\n  KPPS: ['Speed', FloatAnimation],\n  KPPV: ['Visibility', FloatAnimation],\n  // RibbonEmitter\n  KRHA: ['HeightAbove', FloatAnimation],\n  KRHB: ['HeightBelow', FloatAnimation],\n  KRAL: ['Alpha', FloatAnimation],\n  KRCO: ['Color', Vector3Animation],\n  KRTX: ['TextureSlot', UintAnimation],\n  KRVS: ['Visibility', FloatAnimation],\n  // Camera\n  KCTR: ['Translation', Vector3Animation],\n  KTTR: ['Translation', Vector3Animation],\n  KCRL: ['Rotation', FloatAnimation],\n};\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport { Animation } from './animations';\nimport animationMap from './animationmap';\n\n/**\n * The parent class for all objects that have animated data in them.\n */\nexport default class AnimatedObject {\n  animations: Animation[] = [];\n\n  readAnimations(stream: BinaryStream, size: number): void {\n    const end = stream.index + size;\n\n    while (stream.index < end) {\n      const name = stream.readBinary(4);\n      const animation = new animationMap[name][1]();\n\n      animation.readMdx(stream, name);\n\n      this.animations.push(animation);\n    }\n  }\n\n  writeAnimations(stream: BinaryStream): void {\n    for (const animation of this.animations) {\n      animation.writeMdx(stream);\n    }\n  }\n\n  /**\n   * A wrapper around readBlock() which merges static tokens.\n   * E.g.: static Color\n   * This makes the condition blocks in the parent objects linear and simple.\n   */\n  * readAnimatedBlock(stream: TokenStream): Generator<string> {\n    for (const token of stream.readBlock()) {\n      if (token === 'static') {\n        yield `static ${stream.read()}`;\n      } else {\n        yield token;\n      }\n    }\n  }\n\n  readAnimation(stream: TokenStream, name: string): void {\n    const animation = new animationMap[name][1]();\n\n    animation.readMdl(stream, name);\n\n    this.animations.push(animation);\n  }\n\n  writeAnimation(stream: TokenStream, name: string): boolean {\n    for (const animation of this.animations) {\n      if (animation.name === name) {\n        animation.writeMdl(stream, animationMap[name][0]);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * AnimatedObject itself doesn't care about versions, however objects that inherit it do.\n   */\n  getByteLength(_version = 0): number {\n    let size = 0;\n\n    for (const animation of this.animations) {\n      size += animation.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport AnimatedObject from './animatedobject';\n\nexport const enum FilterMode {\n  None = 0,\n  Transparent = 1,\n  Blend = 2,\n  Additive = 3,\n  AddAlpha = 4,\n  Modulate = 5,\n  Modulate2x = 6,\n}\n\nexport const enum Flags {\n  None = 0x0,\n  Unshaded = 0x1,\n  SphereEnvMap = 0x2,\n  TwoSided = 0x10,\n  Unfogged = 0x20,\n  NoDepthTest = 0x40,\n  NoDepthSet = 0x80,\n  Unlit = 0x100,\n}\n\n// These two functions are needed because I am using const enums, which lets TS completely remove them from the output.\n// I think it's worth it for the price of these two functions that effectively were always here either way.\nfunction stringToMode(s: string): FilterMode {\n  if (s === 'None') return FilterMode.None;\n  if (s === 'Transparent') return FilterMode.Transparent;\n  if (s === 'Blend') return FilterMode.Blend;\n  if (s === 'Additive') return FilterMode.Additive;\n  if (s === 'AddAlpha') return FilterMode.AddAlpha;\n  if (s === 'Modulate') return FilterMode.Modulate;\n  if (s === 'Modulate2x') return FilterMode.Modulate2x;\n  return FilterMode.None;\n}\n\nfunction modeToString(m: FilterMode): string {\n  if (m === FilterMode.None) return 'None';\n  if (m === FilterMode.Transparent) return 'Transparent';\n  if (m === FilterMode.Blend) return 'Blend';\n  if (m === FilterMode.Additive) return 'Additive';\n  if (m === FilterMode.AddAlpha) return 'AddAlpha';\n  if (m === FilterMode.Modulate) return 'Modulate';\n  if (m === FilterMode.Modulate2x) return 'Modulate2x';\n  return 'None';\n}\n\n/**\n * A layer.\n */\nexport default class Layer extends AnimatedObject {\n  filterMode = FilterMode.None;\n  flags = Flags.None;\n  textureId = -1;\n  textureAnimationId = -1;\n  coordId = 0;\n  alpha = 1;\n  /** \n   * @since 900\n   */\n  emissiveGain = 1;\n  /** \n   * @since 1000\n   */\n  fresnelColor = new Float32Array([1, 1, 1]);\n  /** \n   * @since 1000\n   */\n  fresnelOpacity = 0;\n  /** \n   * @since 1000\n   */\n  fresnelTeamColor = 0;\n\n  readMdx(stream: BinaryStream, version: number): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    this.filterMode = stream.readUint32();\n    this.flags = stream.readUint32();\n    this.textureId = stream.readInt32();\n    this.textureAnimationId = stream.readInt32();\n    this.coordId = stream.readUint32();\n    this.alpha = stream.readFloat32();\n\n    // Note that even though these fields were introduced in versions 900 and 1000 separately, the game does not offer backwards compatibility.\n    if (version > 800) {\n      this.emissiveGain = stream.readFloat32();\n      stream.readFloat32Array(this.fresnelColor);\n      this.fresnelOpacity = stream.readFloat32();\n      this.fresnelTeamColor = stream.readFloat32();\n    }\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  writeMdx(stream: BinaryStream, version: number): void {\n    stream.writeUint32(this.getByteLength(version));\n    stream.writeUint32(this.filterMode);\n    stream.writeUint32(this.flags);\n    stream.writeInt32(this.textureId);\n    stream.writeInt32(this.textureAnimationId);\n    stream.writeUint32(this.coordId);\n    stream.writeFloat32(this.alpha);\n\n    // See note above in readMdx.\n    if (version > 800) {\n      stream.writeFloat32(this.emissiveGain);\n      stream.writeFloat32Array(this.fresnelColor);\n      stream.writeFloat32(this.fresnelOpacity);\n      stream.writeFloat32(this.fresnelTeamColor);\n    }\n\n    this.writeAnimations(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readAnimatedBlock(stream)) {\n      if (token === 'FilterMode') {\n        this.filterMode = stringToMode(stream.read());\n      } else if (token === 'Unshaded') {\n        this.flags |= Flags.Unshaded;\n      } else if (token === 'SphereEnvMap') {\n        this.flags |= Flags.SphereEnvMap;\n      } else if (token === 'TwoSided') {\n        this.flags |= Flags.TwoSided;\n      } else if (token === 'Unfogged') {\n        this.flags |= Flags.Unfogged;\n      } else if (token === 'NoDepthTest') {\n        this.flags |= Flags.NoDepthTest;\n      } else if (token === 'NoDepthSet') {\n        this.flags |= Flags.NoDepthSet;\n      } else if (token === 'Unlit') {\n        this.flags |= Flags.Unlit;\n      } else if (token === 'static TextureID') {\n        this.textureId = stream.readInt();\n      } else if (token === 'TextureID') {\n        this.readAnimation(stream, 'KMTF');\n      } else if (token === 'TVertexAnimId') {\n        this.textureAnimationId = stream.readInt();\n      } else if (token === 'CoordId') {\n        this.coordId = stream.readInt();\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KMTA');\n      } else if (token === 'static EmissiveGain') {\n        this.emissiveGain = stream.readFloat();\n      } else if (token === 'EmissiveGain') {\n        this.readAnimation(stream, 'KMTE');\n      } else if (token === 'static FresnelColor') {\n        stream.readVector(this.fresnelColor);\n      } else if (token === 'FresnelColor') {\n        this.readAnimation(stream, 'KFC3');\n      } else if (token === 'static FresnelOpacity') {\n        this.fresnelOpacity = stream.readFloat();\n      } else if (token === 'FresnelOpacity') {\n        this.readAnimation(stream, 'KFCA');\n      } else if (token === 'static FresnelTeamColor') {\n        this.fresnelTeamColor = stream.readFloat();\n      } else if (token === 'FresnelTeamColor') {\n        this.readAnimation(stream, 'KFTC');\n      } else {\n        throw new Error(`Unknown token in Layer: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream, version: number): void {\n    stream.startBlock('Layer');\n\n    stream.writeFlagAttrib('FilterMode', modeToString(this.filterMode));\n\n    if (this.flags & Flags.Unshaded) {\n      stream.writeFlag('Unshaded');\n    }\n\n    if (this.flags & Flags.SphereEnvMap) {\n      stream.writeFlag('SphereEnvMap');\n    }\n\n    if (this.flags & Flags.TwoSided) {\n      stream.writeFlag('TwoSided');\n    }\n\n    if (this.flags & Flags.Unfogged) {\n      stream.writeFlag('Unfogged');\n    }\n\n    if (this.flags & Flags.NoDepthTest) {\n      stream.writeFlag('NoDepthTest');\n    }\n\n    if (this.flags & Flags.NoDepthSet) {\n      stream.writeFlag('NoDepthSet');\n    }\n\n    if (version > 800) {\n      if (this.flags & Flags.Unlit) {\n        stream.writeFlag('Unlit');\n      }\n    }\n\n    if (!this.writeAnimation(stream, 'KMTF')) {\n      stream.writeNumberAttrib('static TextureID', this.textureId);\n    }\n\n    if (this.textureAnimationId !== -1) {\n      stream.writeNumberAttrib('TVertexAnimId', this.textureAnimationId);\n    }\n\n    if (this.coordId !== 0) {\n      stream.writeNumberAttrib('CoordId', this.coordId);\n    }\n\n    if (!this.writeAnimation(stream, 'KMTA') && this.alpha !== 1) {\n      stream.writeNumberAttrib('static Alpha', this.alpha);\n    }\n\n    if (version > 800) {\n      if (!this.writeAnimation(stream, 'KMTE') && this.emissiveGain !== 1) {\n        stream.writeNumberAttrib('static EmissiveGain', this.emissiveGain);\n      }\n\n      if (!this.writeAnimation(stream, 'KFC3') && (this.fresnelColor[0] !== 1 || this.fresnelColor[1] !== 1 || this.fresnelColor[2] !== 1)) {\n        stream.writeVectorAttrib('static FresnelColor', this.fresnelColor);\n      }\n\n      if (!this.writeAnimation(stream, 'KFCA') && this.fresnelOpacity !== 0) {\n        stream.writeNumberAttrib('static FresnelOpacity', this.fresnelOpacity);\n      }\n\n      if (!this.writeAnimation(stream, 'KFTC') && this.fresnelTeamColor !== 0) {\n        stream.writeNumberAttrib('static FresnelTeamColor', this.fresnelTeamColor);\n      }\n    }\n\n    stream.endBlock();\n  }\n\n  override getByteLength(version: number): number {\n    let size = 28 + super.getByteLength();\n\n    // See note above in readMdx.\n    if (version > 800) {\n      size += 24;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport Layer from './layer';\n\nexport const enum Flags {\n  None = 0x0,\n  ConstantColor = 0x1,\n  TwoSided = 0x2,\n  SortPrimsNearZ = 0x8,\n  SortPrimsFarZ = 0x10,\n  FullResolution = 0x20,\n}\n\n/**\n * A material.\n */\nexport default class Material {\n  priorityPlane = 0;\n  flags = Flags.None;\n  /** \n   * @since 900\n   */\n  shader = '';\n  layers: Layer[] = [];\n\n  readMdx(stream: BinaryStream, version: number): void {\n    stream.readUint32(); // Don't care about the size.\n\n    this.priorityPlane = stream.readInt32();\n    this.flags = stream.readUint32();\n\n    if (version > 800) {\n      this.shader = stream.read(80);\n    }\n\n    stream.skip(4); // LAYS\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const layer = new Layer();\n\n      layer.readMdx(stream, version);\n\n      this.layers.push(layer);\n    }\n  }\n\n  writeMdx(stream: BinaryStream, version: number): void {\n    stream.writeUint32(this.getByteLength(version));\n    stream.writeInt32(this.priorityPlane);\n    stream.writeUint32(this.flags);\n\n    if (version > 800) {\n      stream.skip(80 - stream.write(this.shader));\n    }\n\n    stream.writeBinary('LAYS');\n    stream.writeUint32(this.layers.length);\n\n    for (const layer of this.layers) {\n      layer.writeMdx(stream, version);\n    }\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of stream.readBlock()) {\n      if (token === 'ConstantColor') {\n        this.flags |= Flags.ConstantColor;\n      } else if (token === 'TwoSided') {\n        this.flags |= Flags.TwoSided;\n      } else if (token === 'SortPrimsNearZ') {\n        this.flags |= Flags.SortPrimsNearZ;\n      } else if (token === 'SortPrimsFarZ') {\n        this.flags |= Flags.SortPrimsFarZ;\n      } else if (token === 'FullResolution') {\n        this.flags |= Flags.FullResolution;\n      } else if (token === 'PriorityPlane') {\n        this.priorityPlane = stream.readInt();\n      } else if (token === 'Shader') {\n        this.shader = stream.read();\n      } else if (token === 'Layer') {\n        const layer = new Layer();\n\n        layer.readMdl(stream);\n\n        this.layers.push(layer);\n      } else {\n        throw new Error(`Unknown token in Material: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream, version: number): void {\n    stream.startBlock('Material');\n\n    if (this.flags & Flags.ConstantColor) {\n      stream.writeFlag('ConstantColor');\n    }\n\n    if (version > 800) {\n      if (this.flags & Flags.TwoSided) {\n        stream.writeFlag('TwoSided');\n      }\n    }\n\n    if (this.flags & Flags.SortPrimsNearZ) {\n      stream.writeFlag('SortPrimsNearZ');\n    }\n\n    if (this.flags & Flags.SortPrimsFarZ) {\n      stream.writeFlag('SortPrimsFarZ');\n    }\n\n    if (this.flags & Flags.FullResolution) {\n      stream.writeFlag('FullResolution');\n    }\n\n    if (this.priorityPlane !== 0) {\n      stream.writeNumberAttrib('PriorityPlane', this.priorityPlane);\n    }\n\n    if (version > 800) {\n      stream.writeStringAttrib('Shader', this.shader);\n    }\n\n    for (const layer of this.layers) {\n      layer.writeMdl(stream, version);\n    }\n\n    stream.endBlock();\n  }\n\n  getByteLength(version: number): number {\n    let size = 20;\n\n    if (version > 800) {\n      size += 80;\n    }\n\n    for (const layer of this.layers) {\n      size += layer.getByteLength(version);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\n\nexport const enum WrapMode {\n  RepeatBoth = 0,\n  WrapWidth = 1,\n  WrapHeight = 2,\n  WrapBoth = 3,\n}\n\n/**\n * A texture.\n */\nexport default class Texture {\n  replaceableId = 0;\n  path = '';\n  wrapMode = WrapMode.RepeatBoth;\n\n  readMdx(stream: BinaryStream): void {\n    this.replaceableId = stream.readUint32();\n    this.path = stream.read(260);\n    this.wrapMode = stream.readUint32();\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.replaceableId);\n    stream.skip(260 - stream.write(this.path));\n    stream.writeUint32(this.wrapMode);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of stream.readBlock()) {\n      if (token === 'Image') {\n        this.path = stream.read();\n      } else if (token === 'ReplaceableId') {\n        this.replaceableId = stream.readInt();\n      } else if (token === 'WrapWidth') {\n        this.wrapMode |= WrapMode.WrapWidth;\n      } else if (token === 'WrapHeight') {\n        this.wrapMode |= WrapMode.WrapHeight;\n      } else {\n        throw new Error(`Unknown token in Texture: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startBlock('Bitmap');\n\n    if (this.path.length) {\n      stream.writeStringAttrib('Image', this.path);\n    }\n\n    if (this.replaceableId !== 0) {\n      stream.writeNumberAttrib('ReplaceableId', this.replaceableId);\n    }\n\n    if (this.wrapMode & WrapMode.WrapWidth) {\n      stream.writeFlag(`WrapWidth`);\n    }\n\n    if (this.wrapMode & WrapMode.WrapHeight) {\n      stream.writeFlag(`WrapHeight`);\n    }\n\n    stream.endBlock();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport AnimatedObject from './animatedobject';\n\n/**\n * A texture animation.\n */\nexport default class TextureAnimation extends AnimatedObject {\n  readMdx(stream: BinaryStream): void {\n    const size = stream.readUint32();\n\n    this.readAnimations(stream, size - 4);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n    this.writeAnimations(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of stream.readBlock()) {\n      if (token === 'Translation') {\n        this.readAnimation(stream, 'KTAT');\n      } else if (token === 'Rotation') {\n        this.readAnimation(stream, 'KTAR');\n      } else if (token === 'Scaling') {\n        this.readAnimation(stream, 'KTAS');\n      } else {\n        throw new Error(`Unknown token in TextureAnimation: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startBlock('TVertexAnim ');\n    this.writeAnimation(stream, 'KTAT');\n    this.writeAnimation(stream, 'KTAR');\n    this.writeAnimation(stream, 'KTAS');\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 4 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport Extent from './extent';\n\n/**\n * A geoset.\n */\nexport default class Geoset {\n  vertices = new Float32Array(0);\n  normals = new Float32Array(0);\n  faceTypeGroups = new Uint32Array(0);\n  faceGroups = new Uint32Array(0);\n  faces = new Uint16Array(0);\n  vertexGroups = new Uint8Array(0);\n  matrixGroups = new Uint32Array(0);\n  matrixIndices = new Uint32Array(0);\n  materialId = 0;\n  selectionGroup = 0;\n  selectionFlags = 0;\n  /** \n   * @since 900\n   */\n  lod = -1;\n  /** \n   * @since 900\n   */\n  lodName = '';\n  extent = new Extent();\n  sequenceExtents: Extent[] = [];\n  /** \n   * @since 900\n   */\n  tangents = new Float32Array(0);\n  /**\n   * An array of bone indices and weights.\n   * Every 8 consecutive elements describe the following:\n   *    [B0, B1, B2, B3, W0, W1, W2, W3]\n   * Where:\n   *     Bn is a bone index.\n   *     Wn is a weight, which can be normalized with Wn/255.\n   *\n   * @since 900\n   */\n  skin = new Uint8Array(0);\n  uvSets: Float32Array[] = [];\n\n  readMdx(stream: BinaryStream, version: number): void {\n    stream.readUint32(); // Don't care about the size.\n\n    stream.skip(4); // VRTX\n    this.vertices = stream.readFloat32Array(stream.readUint32() * 3);\n    stream.skip(4); // NRMS\n    this.normals = stream.readFloat32Array(stream.readUint32() * 3);\n    stream.skip(4); // PTYP\n    this.faceTypeGroups = stream.readUint32Array(stream.readUint32());\n    stream.skip(4); // PCNT\n    this.faceGroups = stream.readUint32Array(stream.readUint32());\n    stream.skip(4); // PVTX\n    this.faces = stream.readUint16Array(stream.readUint32());\n    stream.skip(4); // GNDX\n    this.vertexGroups = stream.readUint8Array(stream.readUint32());\n    stream.skip(4); // MTGC\n    this.matrixGroups = stream.readUint32Array(stream.readUint32());\n    stream.skip(4); // MATS\n    this.matrixIndices = stream.readUint32Array(stream.readUint32());\n    this.materialId = stream.readUint32();\n    this.selectionGroup = stream.readUint32();\n    this.selectionFlags = stream.readUint32();\n\n    if (version > 800) {\n      this.lod = stream.readInt32();\n      this.lodName = stream.read(80);\n    }\n\n    this.extent.readMdx(stream);\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const extent = new Extent();\n\n      extent.readMdx(stream);\n\n      this.sequenceExtents.push(extent);\n    }\n\n    // Non-reforged models that come with reforged are saved with version >800, however they don't have TANG and SKIN.\n    if (version > 800) {\n      if (stream.readBinary(4) === 'TANG') {\n        this.tangents = stream.readFloat32Array(stream.readUint32() * 4);\n      } else {\n        stream.skip(-4);\n      }\n\n      if (stream.readBinary(4) === 'SKIN') {\n        this.skin = stream.readUint8Array(stream.readUint32());\n      } else {\n        stream.skip(-4);\n      }\n    }\n\n    stream.skip(4); // UVAS\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      stream.skip(4); // UVBS\n      this.uvSets.push(stream.readFloat32Array(stream.readUint32() * 2));\n    }\n  }\n\n  writeMdx(stream: BinaryStream, version: number): void {\n    stream.writeUint32(this.getByteLength(version));\n    stream.writeBinary('VRTX');\n    stream.writeUint32(this.vertices.length / 3);\n    stream.writeFloat32Array(this.vertices);\n    stream.writeBinary('NRMS');\n    stream.writeUint32(this.normals.length / 3);\n    stream.writeFloat32Array(this.normals);\n    stream.writeBinary('PTYP');\n    stream.writeUint32(this.faceTypeGroups.length);\n    stream.writeUint32Array(this.faceTypeGroups);\n    stream.writeBinary('PCNT');\n    stream.writeUint32(this.faceGroups.length);\n    stream.writeUint32Array(this.faceGroups);\n    stream.writeBinary('PVTX');\n    stream.writeUint32(this.faces.length);\n    stream.writeUint16Array(this.faces);\n    stream.writeBinary('GNDX');\n    stream.writeUint32(this.vertexGroups.length);\n    stream.writeUint8Array(this.vertexGroups);\n    stream.writeBinary('MTGC');\n    stream.writeUint32(this.matrixGroups.length);\n    stream.writeUint32Array(this.matrixGroups);\n    stream.writeBinary('MATS');\n    stream.writeUint32(this.matrixIndices.length);\n    stream.writeUint32Array(this.matrixIndices);\n    stream.writeUint32(this.materialId);\n    stream.writeUint32(this.selectionGroup);\n    stream.writeUint32(this.selectionFlags);\n\n    if (version > 800) {\n      stream.writeInt32(this.lod);\n      stream.skip(80 - stream.write(this.lodName));\n    }\n\n    this.extent.writeMdx(stream);\n\n    stream.writeUint32(this.sequenceExtents.length);\n\n    for (const sequenceExtent of this.sequenceExtents) {\n      sequenceExtent.writeMdx(stream);\n    }\n\n    if (version > 800) {\n      if (this.tangents.length) {\n        stream.writeBinary('TANG');\n        stream.writeUint32(this.tangents.length / 4);\n        stream.writeFloat32Array(this.tangents);\n      }\n\n      if (this.skin.length) {\n        stream.writeBinary('SKIN');\n        stream.writeUint32(this.skin.length);\n        stream.writeUint8Array(this.skin);\n      }\n    }\n\n    stream.writeBinary('UVAS');\n    stream.writeUint32(this.uvSets.length);\n\n    for (const uvSet of this.uvSets) {\n      stream.writeBinary('UVBS');\n      stream.writeUint32(uvSet.length / 2);\n      stream.writeFloat32Array(uvSet);\n    }\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (let token of stream.readBlock()) {\n      if (token === 'Vertices') {\n        this.vertices = stream.readVectorsBlock(new Float32Array(stream.readInt() * 3), 3);\n      } else if (token === 'Normals') {\n        this.normals = stream.readVectorsBlock(new Float32Array(stream.readInt() * 3), 3);\n      } else if (token === 'TVertices') {\n        this.uvSets.push(stream.readVectorsBlock(new Float32Array(stream.readInt() * 2), 2));\n      } else if (token === 'VertexGroup') {\n        // Vertex groups are stored in a block with no count, can't allocate the buffer yet.\n        const vertexGroups = [];\n\n        for (const vertexGroup of stream.readBlock()) {\n          vertexGroups.push(parseInt(vertexGroup));\n        }\n\n        this.vertexGroups = new Uint8Array(vertexGroups);\n      } else if (token === 'Tangents') {\n        this.tangents = stream.readVectorsBlock(new Float32Array(stream.readInt() * 4), 4);\n      } else if (token === 'SkinWeights') {\n        this.skin = stream.readVector(new Uint8Array(stream.readInt() * 8));\n      } else if (token === 'Faces') {\n        // For now hardcoded for triangles, until I see a model with something different.\n        this.faceTypeGroups = new Uint32Array([4]);\n\n        // Number of vectors the indices are spread over.\n        const vectors = stream.readInt();\n\n        // Total number of indices.\n        const count = stream.readInt();\n\n        stream.read(); // {\n        stream.read(); // Triangles\n\n        this.faces = stream.readVectorsBlock(new Uint16Array(count), count / vectors);\n\n        // Declare that all of the faces are in one group to conform with MDX.\n        this.faceGroups = new Uint32Array([count]);\n\n        stream.read(); // }\n      } else if (token === 'Groups') {\n        const indices = [];\n        const groups = [];\n\n        stream.readInt(); // matrices count\n        stream.readInt(); // total indices\n\n        for (const _ of stream.readBlock()) {\n          let size = 0;\n\n          for (const index of stream.readBlock()) {\n            indices.push(parseInt(index));\n            size += 1;\n          }\n\n          groups.push(size);\n        }\n\n        this.matrixIndices = new Uint32Array(indices);\n        this.matrixGroups = new Uint32Array(groups);\n      } else if (token === 'MinimumExtent') {\n        stream.readVector(this.extent.min);\n      } else if (token === 'MaximumExtent') {\n        stream.readVector(this.extent.max);\n      } else if (token === 'BoundsRadius') {\n        this.extent.boundsRadius = stream.readFloat();\n      } else if (token === 'Anim') {\n        const extent = new Extent();\n\n        for (token of stream.readBlock()) {\n          if (token === 'MinimumExtent') {\n            stream.readVector(extent.min);\n          } else if (token === 'MaximumExtent') {\n            stream.readVector(extent.max);\n          } else if (token === 'BoundsRadius') {\n            extent.boundsRadius = stream.readFloat();\n          }\n        }\n\n        this.sequenceExtents.push(extent);\n      } else if (token === 'MaterialID') {\n        this.materialId = stream.readInt();\n      } else if (token === 'SelectionGroup') {\n        this.selectionGroup = stream.readInt();\n      } else if (token === 'Unselectable') {\n        this.selectionFlags = 4;\n      } else if (token === 'LevelOfDetail') {\n        this.lod = stream.readInt();\n      } else if (token === 'Name') {\n        this.lodName = stream.read();\n      } else {\n        throw new Error(`Unknown token in Geoset: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream, version: number): void {\n    stream.startBlock('Geoset');\n\n    stream.writeVectorArrayBlock('Vertices', this.vertices, 3);\n    stream.writeVectorArrayBlock('Normals', this.normals, 3);\n\n    for (const uvSet of this.uvSets) {\n      stream.writeVectorArrayBlock('TVertices', uvSet, 2);\n    }\n\n    if (version > 800 && this.tangents.length) {\n      stream.writeVectorArrayBlock('Tangents', this.tangents, 4);\n    }\n\n    // Always write vertex groups if they exist.\n    if (this.vertexGroups.length) {\n      stream.startBlock('VertexGroup');\n\n      for (let i = 0, l = this.vertexGroups.length; i < l; i++) {\n        stream.writeLine(`${this.vertexGroups[i]},`);\n      }\n\n      stream.endBlock();\n    }\n\n    // If this is a Reforged HD geoset, write the skin.\n    if (version > 800 && this.skin.length) {\n      stream.startBlock('SkinWeights', this.skin.length / 8);\n\n      for (let i = 0, l = this.skin.length; i < l; i += 8) {\n        stream.writeLine(`${this.skin.subarray(i, i + 8).join(', ')},`);\n      }\n\n      stream.endBlock();\n    }\n\n    // For now hardcoded for triangles, until I see a model with something different.\n    stream.startBlock('Faces', 1, this.faces.length);\n    stream.startBlock('Triangles');\n    stream.writeVector(this.faces);\n    stream.endBlock();\n    stream.endBlock();\n\n    stream.startBlock('Groups', this.matrixGroups.length, this.matrixIndices.length);\n    let index = 0;\n    for (const groupSize of this.matrixGroups) {\n      stream.writeVectorAttrib('Matrices', this.matrixIndices.subarray(index, index + groupSize));\n      index += groupSize;\n    }\n    stream.endBlock();\n\n    this.extent.writeMdl(stream);\n\n    for (const sequenceExtent of this.sequenceExtents) {\n      stream.startBlock('Anim');\n      sequenceExtent.writeMdl(stream);\n      stream.endBlock();\n    }\n\n    stream.writeNumberAttrib('MaterialID', this.materialId);\n    stream.writeNumberAttrib('SelectionGroup', this.selectionGroup);\n\n    if (this.selectionFlags === 4) {\n      stream.writeFlag('Unselectable');\n    }\n\n    if (version > 800) {\n      stream.writeNumberAttrib('LevelOfDetail', this.lod);\n\n      if (this.lodName.length) {\n        stream.writeStringAttrib('Name', this.lodName);\n      }\n    }\n\n    stream.endBlock();\n  }\n\n  getByteLength(version: number): number {\n    let size = 120 + this.vertices.byteLength + this.normals.byteLength + this.faceTypeGroups.byteLength + this.faceGroups.byteLength + this.faces.byteLength + this.vertexGroups.byteLength + this.matrixGroups.byteLength + this.matrixIndices.byteLength + this.sequenceExtents.length * 28;\n\n    if (version > 800) {\n      size += 84;\n\n      if (this.tangents.length) {\n        size += 8 + this.tangents.byteLength;\n      }\n\n      if (this.skin.length) {\n        size += 8 + this.skin.byteLength;\n      }\n    }\n\n    for (const uvSet of this.uvSets) {\n      size += 8 + uvSet.byteLength;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport AnimatedObject from './animatedobject';\n\n/**\n * A geoset animation.\n */\nexport default class GeosetAnimation extends AnimatedObject {\n  alpha = 1;\n  flags = 0;\n  color = new Float32Array([1, 1, 1]);\n  geosetId = -1;\n\n  readMdx(stream: BinaryStream): void {\n    const size = stream.readUint32();\n\n    this.alpha = stream.readFloat32();\n    this.flags = stream.readUint32();\n    stream.readFloat32Array(this.color);\n    this.geosetId = stream.readInt32();\n\n    this.readAnimations(stream, size - 28);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n    stream.writeFloat32(this.alpha);\n    stream.writeUint32(this.flags);\n    stream.writeFloat32Array(this.color);\n    stream.writeInt32(this.geosetId);\n\n    this.writeAnimations(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readAnimatedBlock(stream)) {\n      if (token === 'DropShadow') {\n        this.flags |= 0x1;\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KGAO');\n      } else if (token === 'static Color') {\n        this.flags |= 0x2;\n        stream.readColor(this.color);\n      } else if (token === 'Color') {\n        this.flags |= 0x2;\n        this.readAnimation(stream, 'KGAC');\n      } else if (token === 'GeosetId') {\n        this.geosetId = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in GeosetAnimation: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startBlock('GeosetAnim');\n\n    if (this.flags & 0x1) {\n      stream.writeFlag('DropShadow');\n    }\n\n    if (!this.writeAnimation(stream, 'KGAO')) {\n      stream.writeNumberAttrib('static Alpha', this.alpha);\n    }\n\n    if (this.flags & 0x2) {\n      if (!this.writeAnimation(stream, 'KGAC') && (this.color[0] !== 1 || this.color[1] !== 1 || this.color[2] !== 1)) {\n        stream.writeColor('static Color ', this.color);\n      }\n    }\n\n    stream.writeNumberAttrib('GeosetId', this.geosetId);\n\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 28 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport AnimatedObject from './animatedobject';\nimport { Animation } from './animations';\n\nexport const enum Flags {\n  None = 0x0,\n  DontInheritTranslation = 0x1,\n  DontInheritScaling = 0x2,\n  DontInheritRotation = 0x4,\n  Billboarded = 0x8,\n  BillboardedLockX = 0x10,\n  BillboardedLockY = 0x20,\n  BillboardedLockZ = 0x40,\n  CameraAnchored = 0x80,\n}\n\n/**\n * A generic object.\n *\n * The parent class for all objects that exist in the world, and may contain spatial animations.\n * This includes bones, particle emitters, and many other things.\n */\nexport default abstract class GenericObject extends AnimatedObject {\n  name = '';\n  objectId = -1;\n  parentId = -1;\n  flags: Flags;\n\n  constructor(flags = Flags.None) {\n    super();\n\n    this.flags = flags;\n  }\n\n  readMdx(stream: BinaryStream): void {\n    const size = stream.readUint32();\n\n    this.name = stream.read(80);\n    this.objectId = stream.readInt32();\n    this.parentId = stream.readInt32();\n    this.flags = stream.readUint32();\n\n    this.readAnimations(stream, size - 96);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getGenericByteLength());\n    stream.skip(80 - stream.write(this.name));\n    stream.writeInt32(this.objectId);\n    stream.writeInt32(this.parentId);\n    stream.writeUint32(this.flags);\n\n    for (const animation of this.eachAnimation(true)) {\n      animation.writeMdx(stream);\n    }\n  }\n\n  writeNonGenericAnimationChunks(stream: BinaryStream): void {\n    for (const animation of this.eachAnimation(false)) {\n      animation.writeMdx(stream);\n    }\n  }\n\n  * readGenericBlock(stream: TokenStream): Generator<string> {\n    this.name = stream.read();\n\n    for (let token of this.readAnimatedBlock(stream)) {\n      if (token === 'ObjectId') {\n        this.objectId = stream.readInt();\n      } else if (token === 'Parent') {\n        this.parentId = stream.readInt();\n      } else if (token === 'BillboardedLockZ') {\n        this.flags |= Flags.BillboardedLockZ;\n      } else if (token === 'BillboardedLockY') {\n        this.flags |= Flags.BillboardedLockY;\n      } else if (token === 'BillboardedLockX') {\n        this.flags |= Flags.BillboardedLockX;\n      } else if (token === 'Billboarded') {\n        this.flags |= Flags.Billboarded;\n      } else if (token === 'CameraAnchored') {\n        this.flags |= Flags.CameraAnchored;\n      } else if (token === 'DontInherit') {\n        for (token of stream.readBlock()) {\n          if (token === 'Rotation') {\n            this.flags |= Flags.DontInheritRotation;\n          } else if (token === 'Translation') {\n            this.flags |= Flags.DontInheritTranslation;\n          } else if (token === 'Scaling') {\n            this.flags |= Flags.DontInheritScaling;\n          }\n        }\n      } else if (token === 'Translation') {\n        this.readAnimation(stream, 'KGTR');\n      } else if (token === 'Rotation') {\n        this.readAnimation(stream, 'KGRT');\n      } else if (token === 'Scaling') {\n        this.readAnimation(stream, 'KGSC');\n      } else {\n        yield token;\n      }\n    }\n  }\n\n  writeGenericHeader(stream: TokenStream): void {\n    stream.writeNumberAttrib('ObjectId', this.objectId);\n\n    if (this.parentId !== -1) {\n      stream.writeNumberAttrib('Parent', this.parentId);\n    }\n\n    if (this.flags & Flags.BillboardedLockZ) {\n      stream.writeFlag('BillboardedLockZ');\n    }\n\n    if (this.flags & Flags.BillboardedLockY) {\n      stream.writeFlag('BillboardedLockY');\n    }\n\n    if (this.flags & Flags.BillboardedLockX) {\n      stream.writeFlag('BillboardedLockX');\n    }\n\n    if (this.flags & Flags.Billboarded) {\n      stream.writeFlag('Billboarded');\n    }\n\n    if (this.flags & Flags.CameraAnchored) {\n      stream.writeFlag('CameraAnchored');\n    }\n\n    if (this.flags & Flags.DontInheritRotation) {\n      stream.writeFlag(`DontInherit { Rotation }`);\n    }\n\n    if (this.flags & Flags.DontInheritTranslation) {\n      stream.writeFlag(`DontInherit { Translation }`);\n    }\n\n    if (this.flags & Flags.DontInheritScaling) {\n      stream.writeFlag(`DontInherit { Scaling }`);\n    }\n  }\n\n  writeGenericAnimations(stream: TokenStream): void {\n    this.writeAnimation(stream, 'KGTR');\n    this.writeAnimation(stream, 'KGRT');\n    this.writeAnimation(stream, 'KGSC');\n  }\n\n  /**\n   * Allows to easily iterate either the GenericObject animations or the parent object animations.\n   */\n  * eachAnimation(wantGeneric: boolean): Generator<Animation> {\n    for (const animation of this.animations) {\n      const name = animation.name;\n      const isGeneric = (name === 'KGTR' || name === 'KGRT' || name === 'KGSC');\n\n      if ((wantGeneric && isGeneric) || (!wantGeneric && !isGeneric)) {\n        yield animation;\n      }\n    }\n  }\n\n  /**\n   * Gets the byte length of the GenericObject part of whatever this object this.\n   * \n   * This is needed because only the KGTR, KGRT, and KGSC animations actually belong to it.\n   */\n  getGenericByteLength(): number {\n    let size = 96;\n\n    for (const animation of this.eachAnimation(true)) {\n      size += animation.getByteLength();\n    }\n\n    return size;\n  }\n\n  override getByteLength(): number {\n    return 96 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\n/**\n * A bone.\n */\nexport default class Bone extends GenericObject {\n  geosetId = -1;\n  geosetAnimationId = -1;\n\n  constructor() {\n    super(0x100);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    super.readMdx(stream);\n\n    this.geosetId = stream.readInt32();\n    this.geosetAnimationId = stream.readInt32();\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    super.writeMdx(stream);\n\n    stream.writeInt32(this.geosetId);\n    stream.writeInt32(this.geosetAnimationId);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (let token of super.readGenericBlock(stream)) {\n      if (token === 'GeosetId') {\n        token = stream.read();\n\n        if (token === 'Multiple') {\n          this.geosetId = -1;\n        } else {\n          this.geosetId = parseInt(token);\n        }\n      } else if (token === 'GeosetAnimId') {\n        token = stream.read();\n\n        if (token === 'None') {\n          this.geosetAnimationId = -1;\n        } else {\n          this.geosetAnimationId = parseInt(token);\n        }\n      } else {\n        throw new Error(`Unknown token in Bone ${this.name}: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('Bone', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.geosetId === -1) {\n      stream.writeFlagAttrib('GeosetId', 'Multiple');\n    } else {\n      stream.writeNumberAttrib('GeosetId', this.geosetId);\n    }\n\n    if (this.geosetAnimationId === -1) {\n      stream.writeFlagAttrib('GeosetAnimId', 'None');\n    } else {\n      stream.writeNumberAttrib('GeosetAnimId', this.geosetAnimationId);\n    }\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 8 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\nexport const enum LightType {\n  None = -1,\n  Omnidirectional = 0,\n  Directional = 1,\n  Ambient = 2,\n}\n\n/**\n * A light.\n */\nexport default class Light extends GenericObject {\n  type = LightType.None;\n  attenuation = new Float32Array(2);\n  color = new Float32Array(3);\n  intensity = 0;\n  ambientColor = new Float32Array(3);\n  ambientIntensity = 0;\n\n  constructor() {\n    super(0x200);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.type = stream.readUint32();\n    stream.readFloat32Array(this.attenuation);\n    stream.readFloat32Array(this.color);\n    this.intensity = stream.readFloat32();\n    stream.readFloat32Array(this.ambientColor);\n    this.ambientIntensity = stream.readFloat32();\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeUint32(this.type);\n    stream.writeFloat32Array(this.attenuation);\n    stream.writeFloat32Array(this.color);\n    stream.writeFloat32(this.intensity);\n    stream.writeFloat32Array(this.ambientColor);\n    stream.writeFloat32(this.ambientIntensity);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'Omnidirectional') {\n        this.type = LightType.Omnidirectional;\n      } else if (token === 'Directional') {\n        this.type = LightType.Directional;\n      } else if (token === 'Ambient') {\n        this.type = LightType.Ambient;\n      } else if (token === 'static AttenuationStart') {\n        this.attenuation[0] = stream.readFloat();\n      } else if (token === 'AttenuationStart') {\n        this.readAnimation(stream, 'KLAS');\n      } else if (token === 'static AttenuationEnd') {\n        this.attenuation[1] = stream.readFloat();\n      } else if (token === 'AttenuationEnd') {\n        this.readAnimation(stream, 'KLAE');\n      } else if (token === 'static Intensity') {\n        this.intensity = stream.readFloat();\n      } else if (token === 'Intensity') {\n        this.readAnimation(stream, 'KLAI');\n      } else if (token === 'static Color') {\n        stream.readColor(this.color);\n      } else if (token === 'Color') {\n        this.readAnimation(stream, 'KLAC');\n      } else if (token === 'static AmbIntensity') {\n        this.ambientIntensity = stream.readFloat();\n      } else if (token === 'AmbIntensity') {\n        this.readAnimation(stream, 'KLBI');\n      } else if (token === 'static AmbColor') {\n        stream.readColor(this.ambientColor);\n      } else if (token === 'AmbColor') {\n        this.readAnimation(stream, 'KLBC');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KLAV');\n      } else {\n        throw new Error(`Unknown token in Light: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('Light', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.type === LightType.Omnidirectional) {\n      stream.writeFlag('Omnidirectional');\n    } else if (this.type === LightType.Directional) {\n      stream.writeFlag('Directional');\n    } else if (this.type === LightType.Ambient) {\n      stream.writeFlag('Ambient');\n    }\n\n    if (!this.writeAnimation(stream, 'KLAS')) {\n      stream.writeNumberAttrib('static AttenuationStart', this.attenuation[0]);\n    }\n\n    if (!this.writeAnimation(stream, 'KLAE')) {\n      stream.writeNumberAttrib('static AttenuationEnd', this.attenuation[1]);\n    }\n\n    if (!this.writeAnimation(stream, 'KLAI')) {\n      stream.writeNumberAttrib('static Intensity', this.intensity);\n    }\n\n    if (!this.writeAnimation(stream, 'KLAC')) {\n      stream.writeColor('static Color', this.color);\n    }\n\n    if (!this.writeAnimation(stream, 'KLBI')) {\n      stream.writeNumberAttrib('static AmbIntensity', this.ambientIntensity);\n    }\n\n    if (!this.writeAnimation(stream, 'KLBC')) {\n      stream.writeColor('static AmbColor', this.ambientColor);\n    }\n\n    this.writeAnimation(stream, 'KLAV');\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 48 + super.getByteLength();\n  }\n}\n\n","import TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\n/**\n * A helper.\n */\nexport default class Helper extends GenericObject {\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      throw new Error(`Unknown token in Helper: \"${token}\"`);\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('Helper', this.name);\n    this.writeGenericHeader(stream);\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\n/**\n * An attachment.\n */\nexport default class Attachment extends GenericObject {\n  path = '';\n  attachmentId = 0;\n\n  constructor() {\n    super(0x800);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.path = stream.read(260);\n    this.attachmentId = stream.readInt32();\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.skip(260 - stream.write(this.path));\n    stream.writeInt32(this.attachmentId);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'AttachmentID') {\n        this.attachmentId = stream.readInt();\n      } else if (token === 'Path') {\n        this.path = stream.read();\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KATV');\n      } else {\n        throw new Error(`Unknown token in Attachment ${this.name}: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('Attachment', this.name);\n    this.writeGenericHeader(stream);\n\n    stream.writeNumberAttrib('AttachmentID', this.attachmentId); // Is this needed? MDX supplies it, but MdlxConv does not use it.\n\n    if (this.path.length) {\n      stream.writeStringAttrib('Path', this.path);\n    }\n\n    this.writeAnimation(stream, 'KATV');\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 268 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\nexport const enum Flags {\n  EmitterUsesMDL = 0x8000,\n  EmitterUsesTGA = 0x10000,\n}\n\n/**\n * A particle emitter.\n */\nexport default class ParticleEmitter extends GenericObject {\n  emissionRate = 0;\n  gravity = 0;\n  longitude = 0;\n  latitude = 0;\n  path = '';\n  lifeSpan = 0;\n  speed = 0;\n\n  constructor() {\n    super(0x1000);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.emissionRate = stream.readFloat32();\n    this.gravity = stream.readFloat32();\n    this.longitude = stream.readFloat32();\n    this.latitude = stream.readFloat32();\n    this.path = stream.read(260);\n    this.lifeSpan = stream.readFloat32();\n    this.speed = stream.readFloat32();\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.emissionRate);\n    stream.writeFloat32(this.gravity);\n    stream.writeFloat32(this.longitude);\n    stream.writeFloat32(this.latitude);\n    stream.skip(260 - stream.write(this.path));\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeFloat32(this.speed);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (let token of super.readGenericBlock(stream)) {\n      if (token === 'EmitterUsesMDL') {\n        this.flags |= Flags.EmitterUsesMDL;\n      } else if (token === 'EmitterUsesTGA') {\n        this.flags |= Flags.EmitterUsesTGA;\n      } else if (token === 'static EmissionRate') {\n        this.emissionRate = stream.readFloat();\n      } else if (token === 'EmissionRate') {\n        this.readAnimation(stream, 'KPEE');\n      } else if (token === 'static Gravity') {\n        this.gravity = stream.readFloat();\n      } else if (token === 'Gravity') {\n        this.readAnimation(stream, 'KPEG');\n      } else if (token === 'static Longitude') {\n        this.longitude = stream.readFloat();\n      } else if (token === 'Longitude') {\n        this.readAnimation(stream, 'KPLN');\n      } else if (token === 'static Latitude') {\n        this.latitude = stream.readFloat();\n      } else if (token === 'Latitude') {\n        this.readAnimation(stream, 'KPLT');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KPEV');\n      } else if (token === 'Particle') {\n        for (token of this.readAnimatedBlock(stream)) {\n          if (token === 'static LifeSpan') {\n            this.lifeSpan = stream.readFloat();\n          } else if (token === 'LifeSpan') {\n            this.readAnimation(stream, 'KPEL');\n          } else if (token === 'static InitVelocity') {\n            this.speed = stream.readFloat();\n          } else if (token === 'InitVelocity') {\n            this.readAnimation(stream, 'KPES');\n          } else if (token === 'Path') {\n            this.path = stream.read();\n          }\n        }\n      } else {\n        throw new Error(`Unknown token in ParticleEmitter: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('ParticleEmitter', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.flags & Flags.EmitterUsesMDL) {\n      stream.writeFlag('EmitterUsesMDL');\n    }\n\n    if (this.flags & Flags.EmitterUsesTGA) {\n      stream.writeFlag('EmitterUsesTGA');\n    }\n\n    if (!this.writeAnimation(stream, 'KPEE')) {\n      stream.writeNumberAttrib('static EmissionRate', this.emissionRate);\n    }\n\n    if (!this.writeAnimation(stream, 'KPEG')) {\n      stream.writeNumberAttrib('static Gravity', this.gravity);\n    }\n\n    if (!this.writeAnimation(stream, 'KPLN')) {\n      stream.writeNumberAttrib('static Longitude', this.longitude);\n    }\n\n    if (!this.writeAnimation(stream, 'KPLT')) {\n      stream.writeNumberAttrib('static Latitude', this.latitude);\n    }\n\n    this.writeAnimation(stream, 'KPEV');\n\n    stream.startBlock('Particle');\n\n    if (!this.writeAnimation(stream, 'KPEL')) {\n      stream.writeNumberAttrib('static LifeSpan', this.lifeSpan);\n    }\n\n    if (!this.writeAnimation(stream, 'KPES')) {\n      stream.writeNumberAttrib('static InitVelocity', this.speed);\n    }\n\n    if ((this.flags & Flags.EmitterUsesMDL) || (this.flags & Flags.EmitterUsesTGA)) {\n      stream.writeStringAttrib('Path', this.path);\n    }\n\n    stream.endBlock();\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 288 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\nexport const enum Flags {\n  Unshaded = 0x8000,\n  SortPrimsFarZ = 0x10000,\n  LineEmitter = 0x20000,\n  Unfogged = 0x40000,\n  ModelSpace = 0x80000,\n  XYQuad = 0x100000,\n}\n\nexport const enum FilterMode {\n  Blend = 0,\n  Additive = 1,\n  Modulate = 2,\n  Modulate2x = 3,\n  AlphaKey = 4,\n}\n\nexport const enum HeadOrTail {\n  Head = 0,\n  Tail = 1,\n  Both = 2,\n}\n\n/**\n * A particle emitter type 2.\n */\nexport default class ParticleEmitter2 extends GenericObject {\n  speed = 0;\n  variation = 0;\n  latitude = 0;\n  gravity = 0;\n  lifeSpan = 0;\n  emissionRate = 0;\n  width = 0;\n  length = 0;\n  filterMode = FilterMode.Blend;\n  rows = 0;\n  columns = 0;\n  headOrTail = HeadOrTail.Head;\n  tailLength = 0;\n  timeMiddle = 0;\n  segmentColors: Float32Array[] = [new Float32Array(3), new Float32Array(3), new Float32Array(3)];\n  segmentAlphas = new Uint8Array(3);\n  segmentScaling = new Float32Array(3);\n  headIntervals: Uint32Array[] = [new Uint32Array(3), new Uint32Array(3)];\n  tailIntervals: Uint32Array[] = [new Uint32Array(3), new Uint32Array(3)];\n  textureId = -1;\n  squirt = 0;\n  priorityPlane = 0;\n  replaceableId = 0;\n\n  override readMdx(stream: BinaryStream): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.speed = stream.readFloat32();\n    this.variation = stream.readFloat32();\n    this.latitude = stream.readFloat32();\n    this.gravity = stream.readFloat32();\n    this.lifeSpan = stream.readFloat32();\n    this.emissionRate = stream.readFloat32();\n    this.width = stream.readFloat32();\n    this.length = stream.readFloat32();\n    this.filterMode = stream.readUint32();\n    this.rows = stream.readUint32();\n    this.columns = stream.readUint32();\n    this.headOrTail = stream.readUint32();\n    this.tailLength = stream.readFloat32();\n    this.timeMiddle = stream.readFloat32();\n    stream.readFloat32Array(this.segmentColors[0]);\n    stream.readFloat32Array(this.segmentColors[1]);\n    stream.readFloat32Array(this.segmentColors[2]);\n    stream.readUint8Array(this.segmentAlphas);\n    stream.readFloat32Array(this.segmentScaling);\n    stream.readUint32Array(this.headIntervals[0]);\n    stream.readUint32Array(this.headIntervals[1]);\n    stream.readUint32Array(this.tailIntervals[0]);\n    stream.readUint32Array(this.tailIntervals[1]);\n    this.textureId = stream.readInt32();\n    this.squirt = stream.readUint32();\n    this.priorityPlane = stream.readInt32();\n    this.replaceableId = stream.readUint32();\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.speed);\n    stream.writeFloat32(this.variation);\n    stream.writeFloat32(this.latitude);\n    stream.writeFloat32(this.gravity);\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeFloat32(this.emissionRate);\n    stream.writeFloat32(this.width);\n    stream.writeFloat32(this.length);\n    stream.writeUint32(this.filterMode);\n    stream.writeUint32(this.rows);\n    stream.writeUint32(this.columns);\n    stream.writeUint32(this.headOrTail);\n    stream.writeFloat32(this.tailLength);\n    stream.writeFloat32(this.timeMiddle);\n    stream.writeFloat32Array(this.segmentColors[0]);\n    stream.writeFloat32Array(this.segmentColors[1]);\n    stream.writeFloat32Array(this.segmentColors[2]);\n    stream.writeUint8Array(this.segmentAlphas);\n    stream.writeFloat32Array(this.segmentScaling);\n    stream.writeUint32Array(this.headIntervals[0]);\n    stream.writeUint32Array(this.headIntervals[1]);\n    stream.writeUint32Array(this.tailIntervals[0]);\n    stream.writeUint32Array(this.tailIntervals[1]);\n    stream.writeInt32(this.textureId);\n    stream.writeUint32(this.squirt);\n    stream.writeInt32(this.priorityPlane);\n    stream.writeUint32(this.replaceableId);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'SortPrimsFarZ') {\n        this.flags |= Flags.SortPrimsFarZ;\n      } else if (token === 'Unshaded') {\n        this.flags |= Flags.Unshaded;\n      } else if (token === 'LineEmitter') {\n        this.flags |= Flags.LineEmitter;\n      } else if (token === 'Unfogged') {\n        this.flags |= Flags.Unfogged;\n      } else if (token === 'ModelSpace') {\n        this.flags |= Flags.ModelSpace;\n      } else if (token === 'XYQuad') {\n        this.flags |= Flags.XYQuad;\n      } else if (token === 'static Speed') {\n        this.speed = stream.readFloat();\n      } else if (token === 'Speed') {\n        this.readAnimation(stream, 'KP2S');\n      } else if (token === 'static Variation') {\n        this.variation = stream.readFloat();\n      } else if (token === 'Variation') {\n        this.readAnimation(stream, 'KP2R');\n      } else if (token === 'static Latitude') {\n        this.latitude = stream.readFloat();\n      } else if (token === 'Latitude') {\n        this.readAnimation(stream, 'KP2L');\n      } else if (token === 'static Gravity') {\n        this.gravity = stream.readFloat();\n      } else if (token === 'Gravity') {\n        this.readAnimation(stream, 'KP2G');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KP2V');\n      } else if (token === 'Squirt') {\n        this.squirt = 1;\n      } else if (token === 'LifeSpan') {\n        this.lifeSpan = stream.readFloat();\n      } else if (token === 'static EmissionRate') {\n        this.emissionRate = stream.readFloat();\n      } else if (token === 'EmissionRate') {\n        this.readAnimation(stream, 'KP2E');\n      } else if (token === 'static Width') {\n        this.width = stream.readFloat();\n      } else if (token === 'Width') {\n        this.readAnimation(stream, 'KP2N');\n      } else if (token === 'static Length') {\n        this.length = stream.readFloat();\n      } else if (token === 'Length') {\n        this.readAnimation(stream, 'KP2W');\n      } else if (token === 'Blend') {\n        this.filterMode = FilterMode.Blend;\n      } else if (token === 'Additive') {\n        this.filterMode = FilterMode.Additive;\n      } else if (token === 'Modulate') {\n        this.filterMode = FilterMode.Modulate;\n      } else if (token === 'Modulate2x') {\n        this.filterMode = FilterMode.Modulate2x;\n      } else if (token === 'AlphaKey') {\n        this.filterMode = FilterMode.AlphaKey;\n      } else if (token === 'Rows') {\n        this.rows = stream.readInt();\n      } else if (token === 'Columns') {\n        this.columns = stream.readInt();\n      } else if (token === 'Head') {\n        this.headOrTail = HeadOrTail.Head;\n      } else if (token === 'Tail') {\n        this.headOrTail = HeadOrTail.Tail;\n      } else if (token === 'Both') {\n        this.headOrTail = HeadOrTail.Both;\n      } else if (token === 'TailLength') {\n        this.tailLength = stream.readFloat();\n      } else if (token === 'Time') {\n        this.timeMiddle = stream.readFloat();\n      } else if (token === 'SegmentColor') {\n        stream.read(); // {\n\n        for (let i = 0; i < 3; i++) {\n          stream.read(); // Color\n          stream.readColor(this.segmentColors[i]);\n        }\n\n        stream.read(); // }\n      } else if (token === 'Alpha') {\n        stream.readVector(this.segmentAlphas);\n      } else if (token === 'ParticleScaling') {\n        stream.readVector(this.segmentScaling);\n      } else if (token === 'LifeSpanUVAnim') {\n        stream.readVector(this.headIntervals[0]);\n      } else if (token === 'DecayUVAnim') {\n        stream.readVector(this.headIntervals[1]);\n      } else if (token === 'TailUVAnim') {\n        stream.readVector(this.tailIntervals[0]);\n      } else if (token === 'TailDecayUVAnim') {\n        stream.readVector(this.tailIntervals[1]);\n      } else if (token === 'TextureID') {\n        this.textureId = stream.readInt();\n      } else if (token === 'ReplaceableId') {\n        this.replaceableId = stream.readInt();\n      } else if (token === 'PriorityPlane') {\n        this.priorityPlane = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in ParticleEmitter2: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('ParticleEmitter2', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.flags & Flags.SortPrimsFarZ) {\n      stream.writeFlag('SortPrimsFarZ');\n    }\n\n    if (this.flags & Flags.Unshaded) {\n      stream.writeFlag('Unshaded');\n    }\n\n    if (this.flags & Flags.LineEmitter) {\n      stream.writeFlag('LineEmitter');\n    }\n\n    if (this.flags & Flags.Unfogged) {\n      stream.writeFlag('Unfogged');\n    }\n\n    if (this.flags & Flags.ModelSpace) {\n      stream.writeFlag('ModelSpace');\n    }\n\n    if (this.flags & Flags.XYQuad) {\n      stream.writeFlag('XYQuad');\n    }\n\n    if (!this.writeAnimation(stream, 'KP2S')) {\n      stream.writeNumberAttrib('static Speed', this.speed);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2R')) {\n      stream.writeNumberAttrib('static Variation', this.variation);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2L')) {\n      stream.writeNumberAttrib('static Latitude', this.latitude);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2G')) {\n      stream.writeNumberAttrib('static Gravity', this.gravity);\n    }\n\n    this.writeAnimation(stream, 'KP2V');\n\n    if (this.squirt) {\n      stream.writeFlag('Squirt');\n    }\n\n    stream.writeNumberAttrib('LifeSpan', this.lifeSpan);\n\n    if (!this.writeAnimation(stream, 'KP2E')) {\n      stream.writeNumberAttrib('static EmissionRate', this.emissionRate);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2N')) {\n      stream.writeNumberAttrib('static Width', this.width);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2W')) {\n      stream.writeNumberAttrib('static Length', this.length);\n    }\n\n    if (this.filterMode === FilterMode.Blend) {\n      stream.writeFlag('Blend');\n    } else if (this.filterMode === FilterMode.Additive) {\n      stream.writeFlag('Additive');\n    } else if (this.filterMode === FilterMode.Modulate) {\n      stream.writeFlag('Modulate');\n    } else if (this.filterMode === FilterMode.Modulate2x) {\n      stream.writeFlag('Modulate2x');\n    } else if (this.filterMode === FilterMode.AlphaKey) {\n      stream.writeFlag('AlphaKey');\n    }\n\n    stream.writeNumberAttrib('Rows', this.rows);\n    stream.writeNumberAttrib('Columns', this.columns);\n\n    if (this.headOrTail === HeadOrTail.Head) {\n      stream.writeFlag('Head');\n    } else if (this.headOrTail === HeadOrTail.Tail) {\n      stream.writeFlag('Tail');\n    } else if (this.headOrTail === HeadOrTail.Both) {\n      stream.writeFlag('Both');\n    }\n\n    stream.writeNumberAttrib('TailLength', this.tailLength);\n    stream.writeNumberAttrib('Time', this.timeMiddle);\n\n    stream.startBlock('SegmentColor');\n    stream.writeColor('Color', this.segmentColors[0]);\n    stream.writeColor('Color', this.segmentColors[1]);\n    stream.writeColor('Color', this.segmentColors[2]);\n    stream.endBlockComma();\n\n    stream.writeVectorAttrib('Alpha', this.segmentAlphas);\n    stream.writeVectorAttrib('ParticleScaling', this.segmentScaling);\n    stream.writeVectorAttrib('LifeSpanUVAnim', this.headIntervals[0]);\n    stream.writeVectorAttrib('DecayUVAnim', this.headIntervals[1]);\n    stream.writeVectorAttrib('TailUVAnim', this.tailIntervals[0]);\n    stream.writeVectorAttrib('TailDecayUVAnim', this.tailIntervals[1]);\n    stream.writeNumberAttrib('TextureID', this.textureId);\n\n    if (this.replaceableId !== 0) {\n      stream.writeNumberAttrib('ReplaceableId', this.replaceableId);\n    }\n\n    if (this.priorityPlane !== 0) {\n      stream.writeNumberAttrib('PriorityPlane', this.priorityPlane);\n    }\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 175 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\nexport const enum Flags {\n  Unshaded = 0x8000,\n  SortPrimsFarZ = 0x10000,\n  Unfogged = 0x40000,\n}\n\n/**\n * A popcorn particle emitter.\n * References a pkfx file, which is used by the PopcornFX runtime.\n *\n * @since 900\n */\nexport default class ParticleEmitterPopcorn extends GenericObject {\n  lifeSpan = 0;\n  emissionRate = 0;\n  speed = 0;\n  color = new Float32Array(3);\n  alpha = 1;\n  replaceableId = 0;\n  path = '';\n  animationVisiblityGuide = '';\n\n  override readMdx(stream: BinaryStream): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.lifeSpan = stream.readFloat32();\n    this.emissionRate = stream.readFloat32();\n    this.speed = stream.readFloat32();\n    stream.readFloat32Array(this.color);\n    this.alpha = stream.readFloat32();\n    this.replaceableId = stream.readUint32();\n    this.path = stream.read(260);\n    this.animationVisiblityGuide = stream.read(260);\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeFloat32(this.emissionRate);\n    stream.writeFloat32(this.speed);\n    stream.writeFloat32Array(this.color);\n    stream.writeFloat32(this.alpha);\n    stream.writeUint32(this.replaceableId);\n    stream.skip(260 - stream.write(this.path));\n    stream.skip(260 - stream.write(this.animationVisiblityGuide));\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'SortPrimsFarZ') {\n        this.flags |= Flags.SortPrimsFarZ;\n      } else if (token === 'Unshaded') {\n        this.flags |= Flags.Unshaded;\n      } else if (token === 'Unfogged') {\n        this.flags |= Flags.Unfogged;\n      } else if (token === 'static LifeSpan') {\n        this.lifeSpan = stream.readFloat();\n      } else if (token === 'LifeSpan') {\n        this.readAnimation(stream, 'KPPL');\n      } else if (token === 'static EmissionRate') {\n        this.emissionRate = stream.readFloat();\n      } else if (token === 'EmissionRate') {\n        this.readAnimation(stream, 'KPPE');\n      } else if (token === 'static Speed') {\n        this.speed = stream.readFloat();\n      } else if (token === 'Speed') {\n        this.readAnimation(stream, 'KPPS');\n      } else if (token === 'static Color') {\n        stream.readVector(this.color);\n      } else if (token === 'Color') {\n        this.readAnimation(stream, 'KPPC');\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KPPA');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KPPV');\n      } else if (token === 'ReplaceableId') {\n        this.replaceableId = stream.readInt();\n      } else if (token === 'Path') {\n        this.path = stream.read();\n      } else if (token === 'AnimVisibilityGuide') {\n        this.animationVisiblityGuide = stream.read();\n      } else {\n        throw new Error(`Unknown token in ParticleEmitterPopcorn: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('ParticleEmitterPopcorn', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.flags & Flags.SortPrimsFarZ) {\n      stream.writeFlag('SortPrimsFarZ');\n    }\n\n    if (this.flags & Flags.Unshaded) {\n      stream.writeFlag('Unshaded');\n    }\n\n    if (this.flags & Flags.Unfogged) {\n      stream.writeFlag('Unfogged');\n    }\n\n    if (!this.writeAnimation(stream, 'KPPL')) {\n      stream.writeNumberAttrib('static LifeSpan', this.lifeSpan);\n    }\n\n    if (!this.writeAnimation(stream, 'KPPE')) {\n      stream.writeNumberAttrib('static EmissionRate', this.emissionRate);\n    }\n\n    if (!this.writeAnimation(stream, 'KPPS')) {\n      stream.writeNumberAttrib('static Speed', this.speed);\n    }\n\n    if (!this.writeAnimation(stream, 'KPPC')) {\n      stream.writeVectorAttrib('static Color', this.color);\n    }\n\n    if (!this.writeAnimation(stream, 'KPPA')) {\n      stream.writeNumberAttrib('static Alpha', this.alpha);\n    }\n\n    this.writeAnimation(stream, 'KPPV');\n\n    if (this.replaceableId !== 0) {\n      stream.writeNumberAttrib('ReplaceableId', this.replaceableId);\n    }\n\n    if (this.path.length) {\n      stream.writeStringAttrib('Path', this.path);\n    }\n\n    if (this.animationVisiblityGuide.length) {\n      stream.writeStringAttrib('AnimVisibilityGuide', this.animationVisiblityGuide);\n    }\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 556 + super.getByteLength();\n  }\n}\n\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\n/**\n * A ribbon emitter.\n */\nexport default class RibbonEmitter extends GenericObject {\n  heightAbove = 0;\n  heightBelow = 0;\n  alpha = 0;\n  color = new Float32Array(3);\n  lifeSpan = 0;\n  textureSlot = 0;\n  emissionRate = 0;\n  rows = 0;\n  columns = 0;\n  materialId = 0;\n  gravity = 0;\n\n  constructor() {\n    super(0x4000);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    const start = stream.index;\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.heightAbove = stream.readFloat32();\n    this.heightBelow = stream.readFloat32();\n    this.alpha = stream.readFloat32();\n    stream.readFloat32Array(this.color);\n    this.lifeSpan = stream.readFloat32();\n    this.textureSlot = stream.readUint32();\n    this.emissionRate = stream.readUint32();\n    this.rows = stream.readUint32();\n    this.columns = stream.readUint32();\n    this.materialId = stream.readInt32();\n    this.gravity = stream.readFloat32();\n\n    this.readAnimations(stream, size - (stream.index - start));\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.heightAbove);\n    stream.writeFloat32(this.heightBelow);\n    stream.writeFloat32(this.alpha);\n    stream.writeFloat32Array(this.color);\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeUint32(this.textureSlot);\n    stream.writeUint32(this.emissionRate);\n    stream.writeUint32(this.rows);\n    stream.writeUint32(this.columns);\n    stream.writeInt32(this.materialId);\n    stream.writeFloat32(this.gravity);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'static HeightAbove') {\n        this.heightAbove = stream.readFloat();\n      } else if (token === 'HeightAbove') {\n        this.readAnimation(stream, 'KRHA');\n      } else if (token === 'static HeightBelow') {\n        this.heightBelow = stream.readFloat();\n      } else if (token === 'HeightBelow') {\n        this.readAnimation(stream, 'KRHB');\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KRAL');\n      } else if (token === 'static Color') {\n        stream.readColor(this.color);\n      } else if (token === 'Color') {\n        this.readAnimation(stream, 'KRCO');\n      } else if (token === 'static TextureSlot') {\n        this.textureSlot = stream.readInt();\n      } else if (token === 'TextureSlot') {\n        this.readAnimation(stream, 'KRTX');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KRVS');\n      } else if (token === 'EmissionRate') {\n        this.emissionRate = stream.readInt();\n      } else if (token === 'LifeSpan') {\n        this.lifeSpan = stream.readFloat();\n      } else if (token === 'Gravity') {\n        this.gravity = stream.readFloat();\n      } else if (token === 'Rows') {\n        this.rows = stream.readInt();\n      } else if (token === 'Columns') {\n        this.columns = stream.readInt();\n      } else if (token === 'MaterialID') {\n        this.materialId = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in RibbonEmitter: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('RibbonEmitter', this.name);\n    this.writeGenericHeader(stream);\n\n    if (!this.writeAnimation(stream, 'KRHA')) {\n      stream.writeNumberAttrib('static HeightAbove', this.heightAbove);\n    }\n\n    if (!this.writeAnimation(stream, 'KRHB')) {\n      stream.writeNumberAttrib('static HeightBelow', this.heightBelow);\n    }\n\n    if (!this.writeAnimation(stream, 'KRAL')) {\n      stream.writeNumberAttrib('static Alpha', this.alpha);\n    }\n\n    if (!this.writeAnimation(stream, 'KRCO')) {\n      stream.writeColor('static Color', this.color);\n    }\n\n    if (!this.writeAnimation(stream, 'KRTX')) {\n      stream.writeNumberAttrib('static TextureSlot', this.textureSlot);\n    }\n\n    this.writeAnimation(stream, 'KRVS');\n\n    stream.writeNumberAttrib('EmissionRate', this.emissionRate);\n    stream.writeNumberAttrib('LifeSpan', this.lifeSpan);\n\n    if (this.gravity !== 0) {\n      stream.writeNumberAttrib('Gravity', this.gravity);\n    }\n\n    stream.writeNumberAttrib('Rows', this.rows);\n    stream.writeNumberAttrib('Columns', this.columns);\n    stream.writeNumberAttrib('MaterialID', this.materialId);\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 56 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport AnimatedObject from './animatedobject';\n\n/**\n * A camera.\n */\nexport default class Camera extends AnimatedObject {\n  name = '';\n  position = new Float32Array(3);\n  fieldOfView = 0;\n  farClippingPlane = 0;\n  nearClippingPlane = 0;\n  targetPosition = new Float32Array(3);\n\n  readMdx(stream: BinaryStream): void {\n    const size = stream.readUint32();\n\n    this.name = stream.read(80);\n    stream.readFloat32Array(this.position);\n    this.fieldOfView = stream.readFloat32();\n    this.farClippingPlane = stream.readFloat32();\n    this.nearClippingPlane = stream.readFloat32();\n    stream.readFloat32Array(this.targetPosition);\n\n    this.readAnimations(stream, size - 120);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeUint32(this.getByteLength());\n    stream.skip(80 - stream.write(this.name));\n    stream.writeFloat32Array(this.position);\n    stream.writeFloat32(this.fieldOfView);\n    stream.writeFloat32(this.farClippingPlane);\n    stream.writeFloat32(this.nearClippingPlane);\n    stream.writeFloat32Array(this.targetPosition);\n\n    this.writeAnimations(stream);\n  }\n\n  readMdl(stream: TokenStream): void {\n    this.name = stream.read();\n\n    for (let token of stream.readBlock()) {\n      if (token === 'Position') {\n        stream.readVector(this.position);\n      } else if (token === 'Translation') {\n        this.readAnimation(stream, 'KCTR');\n      } else if (token === 'Rotation') {\n        this.readAnimation(stream, 'KCRL');\n      } else if (token === 'FieldOfView') {\n        this.fieldOfView = stream.readFloat();\n      } else if (token === 'FarClip') {\n        this.farClippingPlane = stream.readFloat();\n      } else if (token === 'NearClip') {\n        this.nearClippingPlane = stream.readFloat();\n      } else if (token === 'Target') {\n        for (token of stream.readBlock()) {\n          if (token === 'Position') {\n            stream.readVector(this.targetPosition);\n          } else if (token === 'Translation') {\n            this.readAnimation(stream, 'KTTR');\n          } else {\n            throw new Error(`Unknown token in Camera ${this.name}'s Target: \"${token}\"`);\n          }\n        }\n      } else {\n        throw new Error(`Unknown token in Camera ${this.name}: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('Camera', this.name);\n\n    stream.writeVectorAttrib('Position', this.position);\n    this.writeAnimation(stream, 'KCTR');\n    this.writeAnimation(stream, 'KCRL');\n    stream.writeNumberAttrib('FieldOfView', this.fieldOfView);\n    stream.writeNumberAttrib('FarClip', this.farClippingPlane);\n    stream.writeNumberAttrib('NearClip', this.nearClippingPlane);\n\n    stream.startBlock('Target');\n    stream.writeVectorAttrib('Position', this.targetPosition);\n    this.writeAnimation(stream, 'KTTR');\n    stream.endBlock();\n\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 120 + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\n/**\n * An event object.\n */\nexport default class EventObject extends GenericObject {\n  globalSequenceId = -1;\n  tracks = new Uint32Array(0);\n\n  constructor() {\n    super(0x400);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    super.readMdx(stream);\n\n    stream.skip(4); // KEVT\n\n    const count = stream.readUint32();\n\n    this.globalSequenceId = stream.readInt32();\n    this.tracks = stream.readUint32Array(count);\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    super.writeMdx(stream);\n    stream.writeBinary('KEVT');\n    stream.writeUint32(this.tracks.length);\n    stream.writeInt32(this.globalSequenceId);\n    stream.writeUint32Array(this.tracks);\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'EventTrack') {\n        const count = stream.readInt();\n\n        this.tracks = new Uint32Array(count);\n\n        stream.read(); // {\n\n        if (stream.peek() === 'GlobalSeqId') {\n          stream.read();\n\n          this.globalSequenceId = stream.readInt();\n        }\n\n        for (let i = 0; i < count; i++) {\n          this.tracks[i] = stream.readInt();\n        }\n\n        stream.read(); // }\n      } else {\n        throw new Error(`Unknown token in EventObject: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('EventObject', this.name);\n    this.writeGenericHeader(stream);\n\n    stream.startBlock('EventTrack', this.tracks.length);\n\n    if (this.globalSequenceId !== -1) {\n      stream.writeNumberAttrib('GlobalSeqId', this.globalSequenceId);\n    }\n\n    for (const track of this.tracks) {\n      stream.writeFlag(`${track}`);\n    }\n\n    stream.endBlock();\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    return 12 + this.tracks.byteLength + super.getByteLength();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\nimport GenericObject from './genericobject';\n\nexport const enum Shape {\n  Box = 0,\n  Plane = 1,\n  Sphere = 2,\n  Cylinder = 3,\n}\n\n/**\n * A collision shape.\n */\nexport default class CollisionShape extends GenericObject {\n  type = Shape.Box;\n  vertices: Float32Array[] = [new Float32Array(3), new Float32Array(3)];\n  boundsRadius = 0;\n\n  constructor() {\n    super(0x2000);\n  }\n\n  override readMdx(stream: BinaryStream): void {\n    super.readMdx(stream);\n\n    this.type = stream.readUint32();\n\n    stream.readFloat32Array(this.vertices[0]);\n\n    if (this.type !== Shape.Sphere) {\n      stream.readFloat32Array(this.vertices[1]);\n    }\n\n    if (this.type === Shape.Sphere || this.type === Shape.Cylinder) {\n      this.boundsRadius = stream.readFloat32();\n    }\n  }\n\n  override writeMdx(stream: BinaryStream): void {\n    super.writeMdx(stream);\n\n    stream.writeUint32(this.type);\n    stream.writeFloat32Array(this.vertices[0]);\n\n    if (this.type !== Shape.Sphere) {\n      stream.writeFloat32Array(this.vertices[1]);\n    }\n\n    if (this.type === Shape.Sphere || this.type === Shape.Cylinder) {\n      stream.writeFloat32(this.boundsRadius);\n    }\n  }\n\n  readMdl(stream: TokenStream): void {\n    for (const token of super.readGenericBlock(stream)) {\n      if (token === 'Box') {\n        this.type = Shape.Box;\n      } else if (token === 'Plane') {\n        this.type = Shape.Plane;\n      } else if (token === 'Sphere') {\n        this.type = Shape.Sphere;\n      } else if (token === 'Cylinder') {\n        this.type = Shape.Cylinder;\n      } else if (token === 'Vertices') {\n        const count = stream.readInt();\n\n        stream.read(); // {\n\n        stream.readVector(this.vertices[0]);\n\n        if (count === 2) {\n          stream.readVector(this.vertices[1]);\n        }\n\n        stream.read(); // }\n      } else if (token === 'BoundsRadius') {\n        this.boundsRadius = stream.readFloat();\n      } else {\n        throw new Error(`Unknown token in CollisionShape: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('CollisionShape', this.name);\n    this.writeGenericHeader(stream);\n\n    let type = '';\n    let vertices = 2;\n    let boundsRadius = false;\n\n    if (this.type === Shape.Box) {\n      type = 'Box';\n    } else if (this.type === Shape.Plane) {\n      type = 'Plane';\n    } else if (this.type === Shape.Sphere) {\n      type = 'Sphere';\n      vertices = 1;\n      boundsRadius = true;\n    } else if (this.type === Shape.Cylinder) {\n      type = 'Cylinder';\n      boundsRadius = true;\n    }\n\n    stream.writeFlag(type);\n    stream.startBlock('Vertices', vertices);\n    stream.writeVector(this.vertices[0]);\n\n    if (vertices === 2) {\n      stream.writeVector(this.vertices[1]);\n    }\n\n    stream.endBlock();\n\n    if (boundsRadius) {\n      stream.writeNumberAttrib('BoundsRadius', this.boundsRadius);\n    }\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  override getByteLength(): number {\n    let size = 16 + super.getByteLength();\n\n    if (this.type !== Shape.Sphere) {\n      size += 12;\n    }\n\n    if (this.type === Shape.Sphere || this.type === Shape.Cylinder) {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from './tokenstream';\n\n/**\n * A face effect.\n */\nexport default class FaceEffect {\n  type = '';\n  path = '';\n\n  readMdx(stream: BinaryStream): void {\n    this.type = stream.read(80);\n    this.path = stream.read(260);\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.skip(80 - stream.write(this.type));\n    stream.skip(260 - stream.write(this.path));\n  }\n\n  readMdl(stream: TokenStream): void {\n    this.type = stream.read();\n\n    for (const token of stream.readBlock()) {\n      if (token === 'Path') {\n        this.path = stream.read();\n      } else {\n        throw new Error(`Unknown token in FaceEffect: \"${token}\"`);\n      }\n    }\n  }\n\n  writeMdl(stream: TokenStream): void {\n    stream.startObjectBlock('FaceFX', this.type);\n    stream.writeStringAttrib('Path', this.path);\n    stream.endBlock();\n  }\n}\n","import BinaryStream from '../../common/binarystream';\n\n/**\n * An unknown chunk.\n */\nexport default class UnknownChunk {\n  tag: string;\n  chunk: Uint8Array;\n\n  constructor(stream: BinaryStream, size: number, tag: string) {\n    this.tag = tag;\n    this.chunk = stream.readUint8Array(new Uint8Array(size));\n  }\n\n  writeMdx(stream: BinaryStream): void {\n    stream.writeBinary(this.tag);\n    stream.writeUint32(this.chunk.byteLength);\n    stream.writeUint8Array(this.chunk);\n  }\n\n  getByteLength(): number {\n    return 8 + this.chunk.byteLength;\n  }\n}\n","import { isStringInBytes, isStringInString } from '../../common/searches';\n\n/**\n * Detects if the given object is an MDX source.\n */\nexport function isMdx(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x4d && bytes[1] === 0x44 && bytes[2] === 0x4c && bytes[3] === 0x58) {\n      return true;\n    }\n  }\n\n  if (typeof bytes === 'string' && bytes.startsWith('MDLX')) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Detects if the given object is an MDL source.\n */\nexport function isMdl(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  // Look for FormatVersion in the first 4KB.\n  if (bytes instanceof Uint8Array && isStringInBytes(bytes, 'FormatVersion', 0, 4096)) {\n    return true;\n  }\n\n  // If the source is a string, look for FormatVersion same as above.\n  if (typeof bytes === 'string' && isStringInString(bytes, 'FormatVersion', 0, 4096)) {\n    return true;\n  }\n\n  return false;\n}\n","import BinaryStream from '../../common/binarystream';\nimport { decodeUtf8, encodeUtf8 } from '../../common/utf8';\nimport TokenStream from './tokenstream';\nimport Extent from './extent';\nimport Sequence from './sequence';\nimport Material from './material';\nimport Texture from './texture';\nimport TextureAnimation from './textureanimation';\nimport Geoset from './geoset';\nimport GeosetAnimation from './geosetanimation';\nimport GenericObject from './genericobject';\nimport Bone from './bone';\nimport Light from './light';\nimport Helper from './helper';\nimport Attachment from './attachment';\nimport ParticleEmitter from './particleemitter';\nimport ParticleEmitter2 from './particleemitter2';\nimport ParticleEmitterPopcorn from './particleemitterpopcorn';\nimport RibbonEmitter from './ribbonemitter';\nimport Camera from './camera';\nimport EventObject from './eventobject';\nimport CollisionShape from './collisionshape';\nimport FaceEffect from './faceeffect';\nimport UnknownChunk from './unknownchunk';\nimport { isMdl, isMdx } from './isformat';\n\n// Used below to get proper typings for the generic methods.\ntype MdxStaticObject = Sequence | Texture | FaceEffect;\ntype MdxDynamicObject = Material | TextureAnimation | Geoset | GeosetAnimation | Bone | Light | Helper | Attachment | ParticleEmitter | ParticleEmitter2 | RibbonEmitter | Camera | EventObject | CollisionShape | ParticleEmitterPopcorn;\ntype MdlNumberedObject = Sequence | Texture | Material | TextureAnimation;\ntype MdlObject = Geoset | GeosetAnimation | Bone | Light | Helper | Attachment | ParticleEmitter | ParticleEmitter2 | RibbonEmitter | Camera | EventObject | CollisionShape | FaceEffect;\n\n/**\n * A Warcraft 3 model.\n * Supports loading from and saving to both the binary MDX and text MDL file formats.\n */\nexport default class Model {\n  /**\n   * 800 for Warcraft 3: RoC and TFT.\n   * >800 for Warcraft 3: Reforged.\n   */\n  version = 800;\n  name = '';\n  /**\n   * To the best of my knowledge, this should always be left empty.\n   */\n  animationFile = '';\n  extent = new Extent();\n  /**\n   * This is only used by the now-defunct previewer that came with Art Tools.\n   */\n  blendTime = 0;\n  sequences: Sequence[] = [];\n  globalSequences: number[] = [];\n  materials: Material[] = [];\n  textures: Texture[] = [];\n  textureAnimations: TextureAnimation[] = [];\n  geosets: Geoset[] = [];\n  geosetAnimations: GeosetAnimation[] = [];\n  bones: Bone[] = [];\n  lights: Light[] = [];\n  helpers: Helper[] = [];\n  attachments: Attachment[] = [];\n  pivotPoints: Float32Array[] = [];\n  particleEmitters: ParticleEmitter[] = [];\n  particleEmitters2: ParticleEmitter2[] = [];\n  /**\n   * @since 900\n   */\n  particleEmittersPopcorn: ParticleEmitterPopcorn[] = [];\n  ribbonEmitters: RibbonEmitter[] = [];\n  cameras: Camera[] = [];\n  eventObjects: EventObject[] = [];\n  collisionShapes: CollisionShape[] = [];\n  /**\n   * @since 900\n   */\n  faceEffects: FaceEffect[] = [];\n  /**\n   * @since 900\n   */\n  bindPose: Float32Array[] = [];\n  /**\n   * The MDX format is chunk based, and Warcraft 3 does not mind there being unknown chunks in there.\n   * Some 3rd party tools use this to attach metadata to models.\n   * When an unknown chunk is encountered, it will be added here.\n   * These chunks will be saved when saving as MDX.\n   */\n  unknownChunks: UnknownChunk[] = [];\n\n  /**\n   * Load the model from MDX or MDL.\n   * The format is detected automatically.\n   */\n  load(buffer: ArrayBuffer | Uint8Array | string): void {\n    if (isMdx(buffer)) {\n      if (typeof buffer === 'string') {\n        buffer = encodeUtf8(buffer);\n      }\n\n      this.loadMdx(buffer);\n    } else if (isMdl(buffer)) {\n      if (typeof buffer !== 'string') {\n        buffer = decodeUtf8(buffer);\n      }\n\n      this.loadMdl(buffer);\n    } else {\n      throw new Error('Not a valid MDX/MDL buffer');\n    }\n  }\n\n  /**\n   * Load the model from MDX.\n   */\n  loadMdx(buffer: ArrayBuffer | Uint8Array): void {\n    const stream = new BinaryStream(buffer);\n    let tag;\n    let size;\n\n    stream.skip(4); // MDLX\n\n    while (stream.remaining > 0) {\n      tag = stream.readBinary(4);\n      size = stream.readUint32();\n\n      if (tag === 'VERS') {\n        this.loadVersionChunk(stream);\n      } else if (tag === 'MODL') {\n        this.loadModelChunk(stream);\n      } else if (tag === 'SEQS') {\n        this.loadStaticObjects(this.sequences, Sequence, stream, size / 132);\n      } else if (tag === 'GLBS') {\n        this.loadGlobalSequenceChunk(stream, size);\n      } else if (tag === 'MTLS') {\n        this.loadDynamicObjects(this.materials, Material, stream, size);\n      } else if (tag === 'TEXS') {\n        this.loadStaticObjects(this.textures, Texture, stream, size / 268);\n      } else if (tag === 'TXAN') {\n        this.loadDynamicObjects(this.textureAnimations, TextureAnimation, stream, size);\n      } else if (tag === 'GEOS') {\n        this.loadDynamicObjects(this.geosets, Geoset, stream, size);\n      } else if (tag === 'GEOA') {\n        this.loadDynamicObjects(this.geosetAnimations, GeosetAnimation, stream, size);\n      } else if (tag === 'BONE') {\n        this.loadDynamicObjects(this.bones, Bone, stream, size);\n      } else if (tag === 'LITE') {\n        this.loadDynamicObjects(this.lights, Light, stream, size);\n      } else if (tag === 'HELP') {\n        this.loadDynamicObjects(this.helpers, Helper, stream, size);\n      } else if (tag === 'ATCH') {\n        this.loadDynamicObjects(this.attachments, Attachment, stream, size);\n      } else if (tag === 'PIVT') {\n        this.loadPivotPointChunk(stream, size);\n      } else if (tag === 'PREM') {\n        this.loadDynamicObjects(this.particleEmitters, ParticleEmitter, stream, size);\n      } else if (tag === 'PRE2') {\n        this.loadDynamicObjects(this.particleEmitters2, ParticleEmitter2, stream, size);\n      } else if (tag === 'CORN') {\n        this.loadDynamicObjects(this.particleEmittersPopcorn, ParticleEmitterPopcorn, stream, size);\n      } else if (tag === 'RIBB') {\n        this.loadDynamicObjects(this.ribbonEmitters, RibbonEmitter, stream, size);\n      } else if (tag === 'CAMS') {\n        this.loadDynamicObjects(this.cameras, Camera, stream, size);\n      } else if (tag === 'EVTS') {\n        this.loadDynamicObjects(this.eventObjects, EventObject, stream, size);\n      } else if (tag === 'CLID') {\n        this.loadDynamicObjects(this.collisionShapes, CollisionShape, stream, size);\n      } else if (tag === 'FAFX') {\n        this.loadStaticObjects(this.faceEffects, FaceEffect, stream, size / 340);\n      } else if (tag === 'BPOS') {\n        this.loadBindPoseChunk(stream, size);\n      } else {\n        this.unknownChunks.push(new UnknownChunk(stream, size, tag));\n      }\n    }\n  }\n\n  loadVersionChunk(stream: BinaryStream): void {\n    this.version = stream.readUint32();\n  }\n\n  loadModelChunk(stream: BinaryStream): void {\n    this.name = stream.read(80);\n    this.animationFile = stream.read(260);\n    this.extent.readMdx(stream);\n    this.blendTime = stream.readUint32();\n  }\n\n  loadStaticObjects<T extends MdxStaticObject>(out: T[], constructor: new () => T, stream: BinaryStream, count: number): void {\n    for (let i = 0; i < count; i++) {\n      const object = new constructor();\n\n      object.readMdx(stream);\n\n      out.push(object);\n    }\n  }\n\n  loadGlobalSequenceChunk(stream: BinaryStream, size: number): void {\n    for (let i = 0, l = size / 4; i < l; i++) {\n      this.globalSequences.push(stream.readUint32());\n    }\n  }\n\n  loadDynamicObjects<T extends MdxDynamicObject>(out: T[], constructor: new () => T, stream: BinaryStream, size: number): void {\n    const end = stream.index + size;\n\n    while (stream.index < end) {\n      const object = new constructor();\n\n      object.readMdx(stream, this.version);\n\n      out.push(object);\n    }\n  }\n\n  loadPivotPointChunk(stream: BinaryStream, size: number): void {\n    for (let i = 0, l = size / 12; i < l; i++) {\n      this.pivotPoints.push(stream.readFloat32Array(3));\n    }\n  }\n\n  loadBindPoseChunk(stream: BinaryStream, _size: number): void {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      this.bindPose[i] = stream.readFloat32Array(12);\n    }\n  }\n\n  /**\n   * Save the model as MDX.\n   */\n  saveMdx(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeBinary('MDLX');\n    this.saveVersionChunk(stream);\n    this.saveModelChunk(stream);\n    this.saveStaticObjectChunk(stream, 'SEQS', this.sequences, 132);\n    this.saveGlobalSequenceChunk(stream);\n    this.saveDynamicObjectChunk(stream, 'MTLS', this.materials);\n    this.saveStaticObjectChunk(stream, 'TEXS', this.textures, 268);\n    this.saveDynamicObjectChunk(stream, 'TXAN', this.textureAnimations);\n    this.saveDynamicObjectChunk(stream, 'GEOS', this.geosets);\n    this.saveDynamicObjectChunk(stream, 'GEOA', this.geosetAnimations);\n    this.saveDynamicObjectChunk(stream, 'BONE', this.bones);\n    this.saveDynamicObjectChunk(stream, 'LITE', this.lights);\n    this.saveDynamicObjectChunk(stream, 'HELP', this.helpers);\n    this.saveDynamicObjectChunk(stream, 'ATCH', this.attachments);\n    this.savePivotPointChunk(stream);\n    this.saveDynamicObjectChunk(stream, 'PREM', this.particleEmitters);\n    this.saveDynamicObjectChunk(stream, 'PRE2', this.particleEmitters2);\n\n    if (this.version > 800) {\n      this.saveDynamicObjectChunk(stream, 'CORN', this.particleEmittersPopcorn);\n    }\n\n    this.saveDynamicObjectChunk(stream, 'RIBB', this.ribbonEmitters);\n    this.saveDynamicObjectChunk(stream, 'CAMS', this.cameras);\n    this.saveDynamicObjectChunk(stream, 'EVTS', this.eventObjects);\n    this.saveDynamicObjectChunk(stream, 'CLID', this.collisionShapes);\n\n    if (this.version > 800) {\n      this.saveStaticObjectChunk(stream, 'FAFX', this.faceEffects, 340);\n      this.saveBindPoseChunk(stream);\n    }\n\n    for (const chunk of this.unknownChunks) {\n      chunk.writeMdx(stream);\n    }\n\n    return stream.uint8array;\n  }\n\n  saveVersionChunk(stream: BinaryStream): void {\n    stream.writeBinary('VERS');\n    stream.writeUint32(4);\n    stream.writeUint32(this.version);\n  }\n\n  saveModelChunk(stream: BinaryStream): void {\n    stream.writeBinary('MODL');\n    stream.writeUint32(372);\n    stream.skip(80 - stream.write(this.name));\n    stream.skip(260 - stream.write(this.animationFile));\n    this.extent.writeMdx(stream);\n    stream.writeUint32(this.blendTime);\n  }\n\n  saveStaticObjectChunk(stream: BinaryStream, name: string, objects: (Sequence | Texture | FaceEffect)[], size: number): void {\n    if (objects.length) {\n      stream.writeBinary(name);\n      stream.writeUint32(objects.length * size);\n\n      for (const object of objects) {\n        object.writeMdx(stream);\n      }\n    }\n  }\n\n  saveGlobalSequenceChunk(stream: BinaryStream): void {\n    if (this.globalSequences.length) {\n      stream.writeBinary('GLBS');\n      stream.writeUint32(this.globalSequences.length * 4);\n\n      for (const globalSequence of this.globalSequences) {\n        stream.writeUint32(globalSequence);\n      }\n    }\n  }\n\n  saveDynamicObjectChunk(stream: BinaryStream, name: string, objects: (Material | TextureAnimation | Geoset | GeosetAnimation | GenericObject | Camera)[]): void {\n    if (objects.length) {\n      stream.writeBinary(name);\n      stream.writeUint32(this.getObjectsByteLength(objects));\n\n      for (const object of objects) {\n        object.writeMdx(stream, this.version);\n      }\n    }\n  }\n\n  savePivotPointChunk(stream: BinaryStream): void {\n    if (this.pivotPoints.length) {\n      stream.writeBinary('PIVT');\n      stream.writeUint32(this.pivotPoints.length * 12);\n\n      for (const pivotPoint of this.pivotPoints) {\n        stream.writeFloat32Array(pivotPoint);\n      }\n    }\n  }\n\n  saveBindPoseChunk(stream: BinaryStream): void {\n    if (this.bindPose.length) {\n      stream.writeBinary('BPOS');\n      stream.writeUint32(4 + this.bindPose.length * 48);\n      stream.writeUint32(this.bindPose.length);\n\n      for (const matrix of this.bindPose) {\n        stream.writeFloat32Array(matrix);\n      }\n    }\n  }\n\n  /**\n   * Load the model from MDL.\n   */\n  loadMdl(buffer: string): void {\n    let token: string;\n    const stream = new TokenStream(buffer);\n\n    while ((token = <string>stream.readToken())) {\n      if (token === 'Version') {\n        this.loadVersionBlock(stream);\n      } else if (token === 'Model') {\n        this.loadModelBlock(stream);\n      } else if (token === 'Sequences') {\n        this.loadNumberedObjectBlock(this.sequences, Sequence, 'Anim', stream);\n      } else if (token === 'GlobalSequences') {\n        this.loadGlobalSequenceBlock(stream);\n      } else if (token === 'Textures') {\n        this.loadNumberedObjectBlock(this.textures, Texture, 'Bitmap', stream);\n      } else if (token === 'Materials') {\n        this.loadNumberedObjectBlock(this.materials, Material, 'Material', stream);\n      } else if (token === 'TextureAnims') {\n        this.loadNumberedObjectBlock(this.textureAnimations, TextureAnimation, 'TVertexAnim', stream);\n      } else if (token === 'Geoset') {\n        this.loadObject(this.geosets, Geoset, stream);\n      } else if (token === 'GeosetAnim') {\n        this.loadObject(this.geosetAnimations, GeosetAnimation, stream);\n      } else if (token === 'Bone') {\n        this.loadObject(this.bones, Bone, stream);\n      } else if (token === 'Light') {\n        this.loadObject(this.lights, Light, stream);\n      } else if (token === 'Helper') {\n        this.loadObject(this.helpers, Helper, stream);\n      } else if (token === 'Attachment') {\n        this.loadObject(this.attachments, Attachment, stream);\n      } else if (token === 'PivotPoints') {\n        this.loadPivotPointBlock(stream);\n      } else if (token === 'ParticleEmitter') {\n        this.loadObject(this.particleEmitters, ParticleEmitter, stream);\n      } else if (token === 'ParticleEmitter2') {\n        this.loadObject(this.particleEmitters2, ParticleEmitter2, stream);\n      } else if (token === 'ParticleEmitterPopcorn') {\n        this.loadObject(this.particleEmittersPopcorn, ParticleEmitterPopcorn, stream);\n      } else if (token === 'RibbonEmitter') {\n        this.loadObject(this.ribbonEmitters, RibbonEmitter, stream);\n      } else if (token === 'Camera') {\n        this.loadObject(this.cameras, Camera, stream);\n      } else if (token === 'EventObject') {\n        this.loadObject(this.eventObjects, EventObject, stream);\n      } else if (token === 'CollisionShape') {\n        this.loadObject(this.collisionShapes, CollisionShape, stream);\n      } else if (token === 'FaceFX') {\n        this.loadObject(this.faceEffects, FaceEffect, stream);\n      } else if (token === 'BindPose') {\n        this.loadBindPoseBlock(stream);\n      } else {\n        throw new Error(`Unsupported block: ${token}`);\n      }\n    }\n  }\n\n  loadVersionBlock(stream: TokenStream): void {\n    for (const token of stream.readBlock()) {\n      if (token === 'FormatVersion') {\n        this.version = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in Version: \"${token}\"`);\n      }\n    }\n  }\n\n  loadModelBlock(stream: TokenStream): void {\n    this.name = stream.read();\n\n    for (const token of stream.readBlock()) {\n      if (token.startsWith('Num')) {\n        // Don't care about the number of things, the arrays will grow as they wish.\n        // This includes:\n        //      NumGeosets\n        //      NumGeosetAnims\n        //      NumHelpers\n        //      NumLights\n        //      NumBones\n        //      NumSoundEmitters (deprecated)\n        //      NumAttachments\n        //      NumParticleEmitters\n        //      NumParticleEmitters2\n        //      NumParticleEmittersPopcorn (>800)\n        //      NumRibbonEmitters\n        //      NumEvents\n        //      NumFaceFX (>800)\n        stream.read();\n      } else if (token === 'BlendTime') {\n        this.blendTime = stream.readInt();\n      } else if (token === 'MinimumExtent') {\n        stream.readVector(this.extent.min);\n      } else if (token === 'MaximumExtent') {\n        stream.readVector(this.extent.max);\n      } else if (token === 'BoundsRadius') {\n        this.extent.boundsRadius = stream.readFloat();\n      } else if (token === 'AnimationFile') {\n        this.animationFile = stream.read();\n      } else {\n        throw new Error(`Unknown token in Model: \"${token}\"`);\n      }\n    }\n  }\n\n  loadNumberedObjectBlock<T extends MdlNumberedObject>(out: T[], constructor: new () => T, name: string, stream: TokenStream): void {\n    stream.read(); // Don't care about the number, the array will grow.\n\n    for (const token of stream.readBlock()) {\n      if (token === name) {\n        const object = new constructor();\n\n        object.readMdl(stream);\n\n        out.push(object);\n      } else {\n        throw new Error(`Unknown token in ${name}: \"${token}\"`);\n      }\n    }\n  }\n\n  loadGlobalSequenceBlock(stream: TokenStream): void {\n    stream.read(); // Don't care about the number, the array will grow.\n\n    for (const token of stream.readBlock()) {\n      if (token === 'Duration') {\n        this.globalSequences.push(stream.readInt());\n      } else {\n        throw new Error(`Unknown token in GlobalSequences: \"${token}\"`);\n      }\n    }\n  }\n\n  loadObject<T extends MdlObject>(out: T[], constructor: new () => T, stream: TokenStream): void {\n    const object = new constructor();\n\n    object.readMdl(stream);\n\n    out.push(object);\n  }\n\n  loadPivotPointBlock(stream: TokenStream): void {\n    const count = stream.readInt();\n\n    stream.read(); // {\n\n    for (let i = 0; i < count; i++) {\n      this.pivotPoints.push(stream.readVector(new Float32Array(3)));\n    }\n\n    stream.read(); // }\n  }\n\n  loadBindPoseBlock(stream: TokenStream): void {\n    for (const token of stream.readBlock()) {\n      if (token === 'Matrices') {\n        const matrices = stream.readInt();\n\n        stream.read(); // {\n\n        for (let i = 0; i < matrices; i++) {\n          this.bindPose[i] = stream.readVector(new Float32Array(12));\n        }\n\n        stream.read(); // }\n      } else {\n        throw new Error(`Unknown token in BindPose: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * Save the model as MDL.\n   */\n  saveMdl(): string {\n    const stream = new TokenStream();\n\n    this.saveVersionBlock(stream);\n    this.saveModelBlock(stream);\n    this.saveStaticObjectsBlock(stream, 'Sequences', this.sequences);\n    this.saveGlobalSequenceBlock(stream);\n    this.saveStaticObjectsBlock(stream, 'Textures', this.textures);\n    this.saveStaticObjectsBlock(stream, 'Materials', this.materials);\n    this.saveStaticObjectsBlock(stream, 'TextureAnims', this.textureAnimations);\n    this.saveObjects(stream, this.geosets);\n    this.saveObjects(stream, this.geosetAnimations);\n    this.saveObjects(stream, this.bones);\n    this.saveObjects(stream, this.lights);\n    this.saveObjects(stream, this.helpers);\n    this.saveObjects(stream, this.attachments);\n    this.savePivotPointBlock(stream);\n    this.saveObjects(stream, this.particleEmitters);\n    this.saveObjects(stream, this.particleEmitters2);\n\n    if (this.version > 800) {\n      this.saveObjects(stream, this.particleEmittersPopcorn);\n    }\n\n    this.saveObjects(stream, this.ribbonEmitters);\n    this.saveObjects(stream, this.cameras);\n    this.saveObjects(stream, this.eventObjects);\n    this.saveObjects(stream, this.collisionShapes);\n\n    if (this.version > 800) {\n      this.saveObjects(stream, this.faceEffects);\n      this.saveBindPoseBlock(stream);\n    }\n\n    return stream.buffer;\n  }\n\n  saveVersionBlock(stream: TokenStream): void {\n    stream.startBlock('Version');\n    stream.writeNumberAttrib('FormatVersion', this.version);\n    stream.endBlock();\n  }\n\n  saveModelBlock(stream: TokenStream): void {\n    stream.startObjectBlock('Model', this.name);\n    stream.writeNumberAttrib('BlendTime', this.blendTime);\n\n    this.extent.writeMdl(stream);\n\n    if (this.animationFile.length) {\n      stream.writeStringAttrib('AnimationFile', this.animationFile);\n    }\n\n    stream.endBlock();\n  }\n\n  saveStaticObjectsBlock(stream: TokenStream, name: string, objects: (Sequence | Texture | Material | TextureAnimation)[]): void {\n    if (objects.length) {\n      stream.startBlock(name, objects.length);\n\n      for (const object of objects) {\n        object.writeMdl(stream, this.version);\n      }\n\n      stream.endBlock();\n    }\n  }\n\n  saveGlobalSequenceBlock(stream: TokenStream): void {\n    if (this.globalSequences.length) {\n      stream.startBlock('GlobalSequences', this.globalSequences.length);\n\n      for (const globalSequence of this.globalSequences) {\n        stream.writeNumberAttrib('Duration', globalSequence);\n      }\n\n      stream.endBlock();\n    }\n  }\n\n  saveObjects(stream: TokenStream, objects: (Geoset | GeosetAnimation | Bone | Light | Helper | Attachment | ParticleEmitter | ParticleEmitter2 | RibbonEmitter | Camera | EventObject | CollisionShape | FaceEffect)[]): void {\n    for (const object of objects) {\n      object.writeMdl(stream, this.version);\n    }\n  }\n\n  savePivotPointBlock(stream: TokenStream): void {\n    if (this.pivotPoints.length) {\n      stream.startBlock('PivotPoints', this.pivotPoints.length);\n\n      for (const pivotPoint of this.pivotPoints) {\n        stream.writeVector(pivotPoint);\n      }\n\n      stream.endBlock();\n    }\n  }\n\n  saveBindPoseBlock(stream: TokenStream): void {\n    if (this.bindPose.length) {\n      stream.startBlock('BindPose');\n\n      stream.startBlock('Matrices', this.bindPose.length);\n\n      for (const matrix of this.bindPose) {\n        stream.writeVector(matrix);\n      }\n\n      stream.endBlock();\n\n      stream.endBlock();\n    }\n  }\n\n  /**\n   * Calculate the size of the model as MDX.\n   */\n  getByteLength(): number {\n    let size = 396;\n\n    size += this.getStaticObjectsChunkByteLength(this.sequences, 132);\n    size += this.getStaticObjectsChunkByteLength(this.globalSequences, 4);\n    size += this.getDynamicObjectsChunkByteLength(this.materials);\n    size += this.getStaticObjectsChunkByteLength(this.textures, 268);\n    size += this.getDynamicObjectsChunkByteLength(this.textureAnimations);\n    size += this.getDynamicObjectsChunkByteLength(this.geosets);\n    size += this.getDynamicObjectsChunkByteLength(this.geosetAnimations);\n    size += this.getDynamicObjectsChunkByteLength(this.bones);\n    size += this.getDynamicObjectsChunkByteLength(this.lights);\n    size += this.getDynamicObjectsChunkByteLength(this.helpers);\n    size += this.getDynamicObjectsChunkByteLength(this.attachments);\n    size += this.getStaticObjectsChunkByteLength(this.pivotPoints, 12);\n    size += this.getDynamicObjectsChunkByteLength(this.particleEmitters);\n    size += this.getDynamicObjectsChunkByteLength(this.particleEmitters2);\n\n    if (this.version > 800) {\n      size += this.getDynamicObjectsChunkByteLength(this.particleEmittersPopcorn);\n    }\n\n    size += this.getDynamicObjectsChunkByteLength(this.ribbonEmitters);\n    size += this.getDynamicObjectsChunkByteLength(this.cameras);\n    size += this.getDynamicObjectsChunkByteLength(this.eventObjects);\n    size += this.getDynamicObjectsChunkByteLength(this.collisionShapes);\n\n    if (this.version > 800) {\n      size += this.getStaticObjectsChunkByteLength(this.faceEffects, 340);\n      size += this.getBindPoseChunkByteLength();\n    }\n\n    size += this.getObjectsByteLength(this.unknownChunks);\n\n    return size;\n  }\n\n  getObjectsByteLength(objects: (Material | TextureAnimation | Geoset | GeosetAnimation | GenericObject | Camera | UnknownChunk)[]): number {\n    let size = 0;\n\n    for (const object of objects) {\n      size += object.getByteLength(this.version);\n    }\n\n    return size;\n  }\n\n  getDynamicObjectsChunkByteLength(objects: (Material | TextureAnimation | Geoset | GeosetAnimation | GenericObject | Camera | UnknownChunk)[]): number {\n    if (objects.length) {\n      return 8 + this.getObjectsByteLength(objects);\n    }\n\n    return 0;\n  }\n\n  getStaticObjectsChunkByteLength(objects: (Sequence | number | Texture | Float32Array | FaceEffect)[], size: number): number {\n    if (objects.length) {\n      return 8 + objects.length * size;\n    }\n\n    return 0;\n  }\n\n  getBindPoseChunkByteLength(): number {\n    if (this.bindPose.length) {\n      return 12 + this.bindPose.length * 48;\n    }\n\n    return 0;\n  }\n}\n","/**\n * A block.\n */\nexport default class Block {\n  offset = 0;\n  compressedSize = 0;\n  normalSize = 0;\n  flags = 0;\n\n  load(bytes: Uint32Array): void {\n    this.offset = bytes[0];\n    this.compressedSize = bytes[1];\n    this.normalSize = bytes[2];\n    this.flags = bytes[3];\n  }\n\n  save(bytes: Uint32Array): void {\n    bytes[0] = this.offset;\n    bytes[1] = this.compressedSize;\n    bytes[2] = this.normalSize;\n    bytes[3] = this.flags;\n  }\n}\n","export const MAGIC = 0x1A51504D; // MPQ\\x1A reversed\nexport const HASH_TABLE_KEY = 0xC3AF3770; // Hash of (hashtable)\nexport const HASH_TABLE_INDEX = 0;\nexport const HASH_NAME_A = 1;\nexport const HASH_NAME_B = 2;\nexport const HASH_FILE_KEY = 3;\nexport const HASH_ENTRY_DELETED = 0xFFFFFFFE;\nexport const HASH_ENTRY_EMPTY = 0xFFFFFFFF;\nexport const BLOCK_TABLE_KEY = 0xEC83B3A3; // Hash of (blocktable)\nexport const FILE_IMPLODE = 0x00000100;\nexport const FILE_COMPRESSED = 0x00000200;\nexport const FILE_ENCRYPTED = 0x00010000;\nexport const FILE_OFFSET_ADJUSTED_KEY = 0x00020000;\nexport const FILE_PATCH_FILE = 0x00100000;\nexport const FILE_SINGLE_UNIT = 0x01000000;\nexport const FILE_DELETE_MARKER = 0x02000000;\nexport const FILE_SECTOR_CRC = 0x04000000;\nexport const FILE_EXISTS = 0x80000000;\nexport const COMPRESSION_HUFFMAN = 0x01;\nexport const COMPRESSION_DEFLATE = 0x02;\nexport const COMPRESSION_IMPLODE = 0x08;\nexport const COMPRESSION_BZIP2 = 0x10;\nexport const COMPRESSION_ADPCM_MONO = 0x40;\nexport const COMPRESSION_ADPCM_STEREO = 0x80;\n","import MpqCrypto from './crypto';\nimport MpqBlock from './block';\nimport { BLOCK_TABLE_KEY } from './constants';\n\n/**\n * A block table.\n */\nexport default class BlockTable {\n  c: MpqCrypto;\n  entries: MpqBlock[];\n\n  constructor(c: MpqCrypto) {\n    this.c = c;\n    this.entries = [];\n  }\n\n  add(buffer: ArrayBuffer): MpqBlock {\n    const block = new MpqBlock();\n\n    block.normalSize = buffer.byteLength;\n\n    this.entries.push(block);\n\n    return block;\n  }\n\n  clear(): void {\n    this.entries.length = 0;\n  }\n\n  addEmpties(howMany: number): void {\n    for (let i = 0; i < howMany; i++) {\n      this.entries.push(new MpqBlock());\n    }\n  }\n\n  load(bytes: Uint8Array): void {\n    const entriesCount = bytes.byteLength / 16;\n    const uint32array = new Uint32Array(this.c.decryptBlock(bytes, BLOCK_TABLE_KEY).buffer);\n    let offset = 0;\n\n    // Clear the table and add the needed empties.\n    this.clear();\n    this.addEmpties(entriesCount);\n\n    for (const block of this.entries) {\n      block.load(uint32array.subarray(offset, offset + 4));\n\n      offset += 4;\n    }\n  }\n\n  save(bytes: Uint8Array): void {\n    const uint32array = new Uint32Array(this.entries.length * 4);\n    let offset = 0;\n\n    for (const block of this.entries) {\n      block.save(uint32array.subarray(offset, offset + 4));\n\n      offset += 4;\n    }\n\n    const uint8array = new Uint8Array(uint32array.buffer);\n\n    this.c.encryptBlock(uint8array, BLOCK_TABLE_KEY);\n\n    bytes.set(uint8array);\n  }\n}\n","import MpqBlock from './block';\nimport { HASH_FILE_KEY, FILE_OFFSET_ADJUSTED_KEY } from './constants';\n\n// Global variables for this module.\nconst bytesHeap = new Uint8Array(4);\nconst longHeap = new Uint32Array(bytesHeap.buffer);\n\n/**\n * MPQ crypto.\n */\nexport default class MpqCrypto {\n  cryptTable = new Uint32Array(0x500);\n\n  constructor() {\n    let seed = 0x00100001;\n    let temp1 = 0;\n    let temp2 = 0;\n\n    for (let index1 = 0; index1 < 0x100; index1++) {\n      for (let index2 = index1, i = 0; i < 5; i += 1, index2 += 0x100) {\n        seed = (seed * 125 + 3) % 0x2AAAAB;\n        temp1 = (seed & 0xFFFF) << 0x10;\n\n        seed = (seed * 125 + 3) % 0x2AAAAB;\n        temp2 = (seed & 0xFFFF);\n\n        this.cryptTable[index2] = temp1 | temp2;\n      }\n    }\n  }\n\n  hash(name: string, key: number): number {\n    const cryptTable = this.cryptTable;\n    let seed1 = 0x7FED7FED;\n    let seed2 = 0xEEEEEEEE;\n\n    name = name.toUpperCase();\n\n    for (let i = 0; i < name.length; i++) {\n      const ch = name.charCodeAt(i);\n\n      seed1 = cryptTable[(key << 8) + ch] ^ (seed1 + seed2);\n      seed2 = ch + seed1 + seed2 + (seed2 << 5) + 3;\n    }\n\n    // Convert the seed to an unsigned integer\n    return seed1 >>> 0;\n  }\n\n  decryptBlock<T extends Uint8Array | Uint32Array>(data: T, key: number): T {\n    const cryptTable = this.cryptTable;\n    let seed = 0xEEEEEEEE;\n    const bytes = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n\n    for (let i = 0, l = data.byteLength >>> 2; i < l; i++) {\n      // Update the seed.\n      seed += cryptTable[0x400 + (key & 0xFF)];\n\n      // Get 4 encrypted bytes.\n      bytesHeap[0] = bytes[i * 4];\n      bytesHeap[1] = bytes[i * 4 + 1];\n      bytesHeap[2] = bytes[i * 4 + 2];\n      bytesHeap[3] = bytes[i * 4 + 3];\n\n      // Decrypted 32bit integer.\n      longHeap[0] ^= (key + seed);\n\n      // Update the seed.\n      key = ((~key << 0x15) + 0x11111111) | (key >>> 0x0B);\n      seed = longHeap[0] + seed + (seed << 5) + 3;\n\n      // Set 4 decryped bytes.\n      bytes[i * 4] = bytesHeap[0];\n      bytes[i * 4 + 1] = bytesHeap[1];\n      bytes[i * 4 + 2] = bytesHeap[2];\n      bytes[i * 4 + 3] = bytesHeap[3];\n    }\n\n    return data;\n  }\n\n  encryptBlock<T extends Uint8Array | Uint32Array>(data: T, key: number): T {\n    const cryptTable = this.cryptTable;\n    let seed = 0xEEEEEEEE;\n    const bytes = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n\n    for (let i = 0, l = data.byteLength >>> 2; i < l; i++) {\n      // Update the seed.\n      seed += cryptTable[0x400 + (key & 0xFF)];\n\n      // Get 4 decrypted bytes.\n      bytesHeap[0] = bytes[i * 4];\n      bytesHeap[1] = bytes[i * 4 + 1];\n      bytesHeap[2] = bytes[i * 4 + 2];\n      bytesHeap[3] = bytes[i * 4 + 3];\n\n      // Decrypted 32bit integer.\n      const decrypted = longHeap[0];\n\n      // Encrypted 32bit integer.\n      longHeap[0] ^= (key + seed);\n\n      // Update the seed.\n      key = ((~key << 0x15) + 0x11111111) | (key >>> 0x0B);\n      seed = decrypted + seed + (seed << 5) + 3;\n\n      // Set 4 encrypted bytes.\n      bytes[i * 4] = bytesHeap[0];\n      bytes[i * 4 + 1] = bytesHeap[1];\n      bytes[i * 4 + 2] = bytesHeap[2];\n      bytes[i * 4 + 3] = bytesHeap[3];\n    }\n\n    return data;\n  }\n\n  computeFileKey(name: string, block: MpqBlock): number {\n    const sepIndex = name.lastIndexOf('\\\\');\n    const pathlessName = name.substring(sepIndex + 1);\n    let encryptionKey = this.hash(pathlessName, HASH_FILE_KEY);\n\n    if (block.flags & FILE_OFFSET_ADJUSTED_KEY) {\n      encryptionKey = (encryptionKey + block.offset) ^ block.normalSize;\n    }\n\n    return encryptionKey;\n  }\n}\n","\n/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n/* eslint-disable space-unary-ops */\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\n\n//const Z_FILTERED          = 1;\n//const Z_HUFFMAN_ONLY      = 2;\n//const Z_RLE               = 3;\nconst Z_FIXED$1               = 4;\n//const Z_DEFAULT_STRATEGY  = 0;\n\n/* Possible values of the data_type field (though see inflate()) */\nconst Z_BINARY              = 0;\nconst Z_TEXT                = 1;\n//const Z_ASCII             = 1; // = Z_TEXT\nconst Z_UNKNOWN$1             = 2;\n\n/*============================================================================*/\n\n\nfunction zero$1(buf) { let len = buf.length; while (--len >= 0) { buf[len] = 0; } }\n\n// From zutil.h\n\nconst STORED_BLOCK = 0;\nconst STATIC_TREES = 1;\nconst DYN_TREES    = 2;\n/* The three kinds of block type */\n\nconst MIN_MATCH$1    = 3;\nconst MAX_MATCH$1    = 258;\n/* The minimum and maximum match lengths */\n\n// From deflate.h\n/* ===========================================================================\n * Internal compression state.\n */\n\nconst LENGTH_CODES$1  = 29;\n/* number of length codes, not counting the special END_BLOCK code */\n\nconst LITERALS$1      = 256;\n/* number of literal bytes 0..255 */\n\nconst L_CODES$1       = LITERALS$1 + 1 + LENGTH_CODES$1;\n/* number of Literal or Length codes, including the END_BLOCK code */\n\nconst D_CODES$1       = 30;\n/* number of distance codes */\n\nconst BL_CODES$1      = 19;\n/* number of codes used to transfer the bit lengths */\n\nconst HEAP_SIZE$1     = 2 * L_CODES$1 + 1;\n/* maximum heap size */\n\nconst MAX_BITS$1      = 15;\n/* All codes must not exceed MAX_BITS bits */\n\nconst Buf_size      = 16;\n/* size of bit buffer in bi_buf */\n\n\n/* ===========================================================================\n * Constants\n */\n\nconst MAX_BL_BITS = 7;\n/* Bit length codes must not exceed MAX_BL_BITS bits */\n\nconst END_BLOCK   = 256;\n/* end of block literal code */\n\nconst REP_3_6     = 16;\n/* repeat previous bit length 3-6 times (2 bits of repeat count) */\n\nconst REPZ_3_10   = 17;\n/* repeat a zero length 3-10 times  (3 bits of repeat count) */\n\nconst REPZ_11_138 = 18;\n/* repeat a zero length 11-138 times  (7 bits of repeat count) */\n\n/* eslint-disable comma-spacing,array-bracket-spacing */\nconst extra_lbits =   /* extra bits for each length code */\n  new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]);\n\nconst extra_dbits =   /* extra bits for each distance code */\n  new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]);\n\nconst extra_blbits =  /* extra bits for each bit length code */\n  new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]);\n\nconst bl_order =\n  new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);\n/* eslint-enable comma-spacing,array-bracket-spacing */\n\n/* The lengths of the bit length codes are sent in order of decreasing\n * probability, to avoid transmitting the lengths for unused bit length codes.\n */\n\n/* ===========================================================================\n * Local data. These are initialized only once.\n */\n\n// We pre-fill arrays with 0 to avoid uninitialized gaps\n\nconst DIST_CODE_LEN = 512; /* see definition of array dist_code below */\n\n// !!!! Use flat array instead of structure, Freq = i*2, Len = i*2+1\nconst static_ltree  = new Array((L_CODES$1 + 2) * 2);\nzero$1(static_ltree);\n/* The static literal tree. Since the bit lengths are imposed, there is no\n * need for the L_CODES extra codes used during heap construction. However\n * The codes 286 and 287 are needed to build a canonical tree (see _tr_init\n * below).\n */\n\nconst static_dtree  = new Array(D_CODES$1 * 2);\nzero$1(static_dtree);\n/* The static distance tree. (Actually a trivial tree since all codes use\n * 5 bits.)\n */\n\nconst _dist_code    = new Array(DIST_CODE_LEN);\nzero$1(_dist_code);\n/* Distance codes. The first 256 values correspond to the distances\n * 3 .. 258, the last 256 values correspond to the top 8 bits of\n * the 15 bit distances.\n */\n\nconst _length_code  = new Array(MAX_MATCH$1 - MIN_MATCH$1 + 1);\nzero$1(_length_code);\n/* length code for each normalized match length (0 == MIN_MATCH) */\n\nconst base_length   = new Array(LENGTH_CODES$1);\nzero$1(base_length);\n/* First normalized length for each code (0 = MIN_MATCH) */\n\nconst base_dist     = new Array(D_CODES$1);\nzero$1(base_dist);\n/* First normalized distance for each code (0 = distance of 1) */\n\n\nfunction StaticTreeDesc(static_tree, extra_bits, extra_base, elems, max_length) {\n\n  this.static_tree  = static_tree;  /* static tree or NULL */\n  this.extra_bits   = extra_bits;   /* extra bits for each code or NULL */\n  this.extra_base   = extra_base;   /* base index for extra_bits */\n  this.elems        = elems;        /* max number of elements in the tree */\n  this.max_length   = max_length;   /* max bit length for the codes */\n\n  // show if `static_tree` has data or dummy - needed for monomorphic objects\n  this.has_stree    = static_tree && static_tree.length;\n}\n\n\nlet static_l_desc;\nlet static_d_desc;\nlet static_bl_desc;\n\n\nfunction TreeDesc(dyn_tree, stat_desc) {\n  this.dyn_tree = dyn_tree;     /* the dynamic tree */\n  this.max_code = 0;            /* largest code with non zero frequency */\n  this.stat_desc = stat_desc;   /* the corresponding static tree */\n}\n\n\n\nconst d_code = (dist) => {\n\n  return dist < 256 ? _dist_code[dist] : _dist_code[256 + (dist >>> 7)];\n};\n\n\n/* ===========================================================================\n * Output a short LSB first on the stream.\n * IN assertion: there is enough room in pendingBuf.\n */\nconst put_short = (s, w) => {\n//    put_byte(s, (uch)((w) & 0xff));\n//    put_byte(s, (uch)((ush)(w) >> 8));\n  s.pending_buf[s.pending++] = (w) & 0xff;\n  s.pending_buf[s.pending++] = (w >>> 8) & 0xff;\n};\n\n\n/* ===========================================================================\n * Send a value on a given number of bits.\n * IN assertion: length <= 16 and value fits in length bits.\n */\nconst send_bits = (s, value, length) => {\n\n  if (s.bi_valid > (Buf_size - length)) {\n    s.bi_buf |= (value << s.bi_valid) & 0xffff;\n    put_short(s, s.bi_buf);\n    s.bi_buf = value >> (Buf_size - s.bi_valid);\n    s.bi_valid += length - Buf_size;\n  } else {\n    s.bi_buf |= (value << s.bi_valid) & 0xffff;\n    s.bi_valid += length;\n  }\n};\n\n\nconst send_code = (s, c, tree) => {\n\n  send_bits(s, tree[c * 2]/*.Code*/, tree[c * 2 + 1]/*.Len*/);\n};\n\n\n/* ===========================================================================\n * Reverse the first len bits of a code, using straightforward code (a faster\n * method would use a table)\n * IN assertion: 1 <= len <= 15\n */\nconst bi_reverse = (code, len) => {\n\n  let res = 0;\n  do {\n    res |= code & 1;\n    code >>>= 1;\n    res <<= 1;\n  } while (--len > 0);\n  return res >>> 1;\n};\n\n\n/* ===========================================================================\n * Flush the bit buffer, keeping at most 7 bits in it.\n */\nconst bi_flush = (s) => {\n\n  if (s.bi_valid === 16) {\n    put_short(s, s.bi_buf);\n    s.bi_buf = 0;\n    s.bi_valid = 0;\n\n  } else if (s.bi_valid >= 8) {\n    s.pending_buf[s.pending++] = s.bi_buf & 0xff;\n    s.bi_buf >>= 8;\n    s.bi_valid -= 8;\n  }\n};\n\n\n/* ===========================================================================\n * Compute the optimal bit lengths for a tree and update the total bit length\n * for the current block.\n * IN assertion: the fields freq and dad are set, heap[heap_max] and\n *    above are the tree nodes sorted by increasing frequency.\n * OUT assertions: the field len is set to the optimal bit length, the\n *     array bl_count contains the frequencies for each bit length.\n *     The length opt_len is updated; static_len is also updated if stree is\n *     not null.\n */\nconst gen_bitlen = (s, desc) => {\n//    deflate_state *s;\n//    tree_desc *desc;    /* the tree descriptor */\n\n  const tree            = desc.dyn_tree;\n  const max_code        = desc.max_code;\n  const stree           = desc.stat_desc.static_tree;\n  const has_stree       = desc.stat_desc.has_stree;\n  const extra           = desc.stat_desc.extra_bits;\n  const base            = desc.stat_desc.extra_base;\n  const max_length      = desc.stat_desc.max_length;\n  let h;              /* heap index */\n  let n, m;           /* iterate over the tree elements */\n  let bits;           /* bit length */\n  let xbits;          /* extra bits */\n  let f;              /* frequency */\n  let overflow = 0;   /* number of elements with bit length too large */\n\n  for (bits = 0; bits <= MAX_BITS$1; bits++) {\n    s.bl_count[bits] = 0;\n  }\n\n  /* In a first pass, compute the optimal bit lengths (which may\n   * overflow in the case of the bit length tree).\n   */\n  tree[s.heap[s.heap_max] * 2 + 1]/*.Len*/ = 0; /* root of the heap */\n\n  for (h = s.heap_max + 1; h < HEAP_SIZE$1; h++) {\n    n = s.heap[h];\n    bits = tree[tree[n * 2 + 1]/*.Dad*/ * 2 + 1]/*.Len*/ + 1;\n    if (bits > max_length) {\n      bits = max_length;\n      overflow++;\n    }\n    tree[n * 2 + 1]/*.Len*/ = bits;\n    /* We overwrite tree[n].Dad which is no longer needed */\n\n    if (n > max_code) { continue; } /* not a leaf node */\n\n    s.bl_count[bits]++;\n    xbits = 0;\n    if (n >= base) {\n      xbits = extra[n - base];\n    }\n    f = tree[n * 2]/*.Freq*/;\n    s.opt_len += f * (bits + xbits);\n    if (has_stree) {\n      s.static_len += f * (stree[n * 2 + 1]/*.Len*/ + xbits);\n    }\n  }\n  if (overflow === 0) { return; }\n\n  // Tracev((stderr,\"\\nbit length overflow\\n\"));\n  /* This happens for example on obj2 and pic of the Calgary corpus */\n\n  /* Find the first bit length which could increase: */\n  do {\n    bits = max_length - 1;\n    while (s.bl_count[bits] === 0) { bits--; }\n    s.bl_count[bits]--;      /* move one leaf down the tree */\n    s.bl_count[bits + 1] += 2; /* move one overflow item as its brother */\n    s.bl_count[max_length]--;\n    /* The brother of the overflow item also moves one step up,\n     * but this does not affect bl_count[max_length]\n     */\n    overflow -= 2;\n  } while (overflow > 0);\n\n  /* Now recompute all bit lengths, scanning in increasing frequency.\n   * h is still equal to HEAP_SIZE. (It is simpler to reconstruct all\n   * lengths instead of fixing only the wrong ones. This idea is taken\n   * from 'ar' written by Haruhiko Okumura.)\n   */\n  for (bits = max_length; bits !== 0; bits--) {\n    n = s.bl_count[bits];\n    while (n !== 0) {\n      m = s.heap[--h];\n      if (m > max_code) { continue; }\n      if (tree[m * 2 + 1]/*.Len*/ !== bits) {\n        // Tracev((stderr,\"code %d bits %d->%d\\n\", m, tree[m].Len, bits));\n        s.opt_len += (bits - tree[m * 2 + 1]/*.Len*/) * tree[m * 2]/*.Freq*/;\n        tree[m * 2 + 1]/*.Len*/ = bits;\n      }\n      n--;\n    }\n  }\n};\n\n\n/* ===========================================================================\n * Generate the codes for a given tree and bit counts (which need not be\n * optimal).\n * IN assertion: the array bl_count contains the bit length statistics for\n * the given tree and the field len is set for all tree elements.\n * OUT assertion: the field code is set for all tree elements of non\n *     zero code length.\n */\nconst gen_codes = (tree, max_code, bl_count) => {\n//    ct_data *tree;             /* the tree to decorate */\n//    int max_code;              /* largest code with non zero frequency */\n//    ushf *bl_count;            /* number of codes at each bit length */\n\n  const next_code = new Array(MAX_BITS$1 + 1); /* next code value for each bit length */\n  let code = 0;              /* running code value */\n  let bits;                  /* bit index */\n  let n;                     /* code index */\n\n  /* The distribution counts are first used to generate the code values\n   * without bit reversal.\n   */\n  for (bits = 1; bits <= MAX_BITS$1; bits++) {\n    code = (code + bl_count[bits - 1]) << 1;\n    next_code[bits] = code;\n  }\n  /* Check that the bit counts in bl_count are consistent. The last code\n   * must be all ones.\n   */\n  //Assert (code + bl_count[MAX_BITS]-1 == (1<<MAX_BITS)-1,\n  //        \"inconsistent bit counts\");\n  //Tracev((stderr,\"\\ngen_codes: max_code %d \", max_code));\n\n  for (n = 0;  n <= max_code; n++) {\n    let len = tree[n * 2 + 1]/*.Len*/;\n    if (len === 0) { continue; }\n    /* Now reverse the bits */\n    tree[n * 2]/*.Code*/ = bi_reverse(next_code[len]++, len);\n\n    //Tracecv(tree != static_ltree, (stderr,\"\\nn %3d %c l %2d c %4x (%x) \",\n    //     n, (isgraph(n) ? n : ' '), len, tree[n].Code, next_code[len]-1));\n  }\n};\n\n\n/* ===========================================================================\n * Initialize the various 'constant' tables.\n */\nconst tr_static_init = () => {\n\n  let n;        /* iterates over tree elements */\n  let bits;     /* bit counter */\n  let length;   /* length value */\n  let code;     /* code value */\n  let dist;     /* distance index */\n  const bl_count = new Array(MAX_BITS$1 + 1);\n  /* number of codes at each bit length for an optimal tree */\n\n  // do check in _tr_init()\n  //if (static_init_done) return;\n\n  /* For some embedded targets, global variables are not initialized: */\n/*#ifdef NO_INIT_GLOBAL_POINTERS\n  static_l_desc.static_tree = static_ltree;\n  static_l_desc.extra_bits = extra_lbits;\n  static_d_desc.static_tree = static_dtree;\n  static_d_desc.extra_bits = extra_dbits;\n  static_bl_desc.extra_bits = extra_blbits;\n#endif*/\n\n  /* Initialize the mapping length (0..255) -> length code (0..28) */\n  length = 0;\n  for (code = 0; code < LENGTH_CODES$1 - 1; code++) {\n    base_length[code] = length;\n    for (n = 0; n < (1 << extra_lbits[code]); n++) {\n      _length_code[length++] = code;\n    }\n  }\n  //Assert (length == 256, \"tr_static_init: length != 256\");\n  /* Note that the length 255 (match length 258) can be represented\n   * in two different ways: code 284 + 5 bits or code 285, so we\n   * overwrite length_code[255] to use the best encoding:\n   */\n  _length_code[length - 1] = code;\n\n  /* Initialize the mapping dist (0..32K) -> dist code (0..29) */\n  dist = 0;\n  for (code = 0; code < 16; code++) {\n    base_dist[code] = dist;\n    for (n = 0; n < (1 << extra_dbits[code]); n++) {\n      _dist_code[dist++] = code;\n    }\n  }\n  //Assert (dist == 256, \"tr_static_init: dist != 256\");\n  dist >>= 7; /* from now on, all distances are divided by 128 */\n  for (; code < D_CODES$1; code++) {\n    base_dist[code] = dist << 7;\n    for (n = 0; n < (1 << (extra_dbits[code] - 7)); n++) {\n      _dist_code[256 + dist++] = code;\n    }\n  }\n  //Assert (dist == 256, \"tr_static_init: 256+dist != 512\");\n\n  /* Construct the codes of the static literal tree */\n  for (bits = 0; bits <= MAX_BITS$1; bits++) {\n    bl_count[bits] = 0;\n  }\n\n  n = 0;\n  while (n <= 143) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 8;\n    n++;\n    bl_count[8]++;\n  }\n  while (n <= 255) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 9;\n    n++;\n    bl_count[9]++;\n  }\n  while (n <= 279) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 7;\n    n++;\n    bl_count[7]++;\n  }\n  while (n <= 287) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 8;\n    n++;\n    bl_count[8]++;\n  }\n  /* Codes 286 and 287 do not exist, but we must include them in the\n   * tree construction to get a canonical Huffman tree (longest code\n   * all ones)\n   */\n  gen_codes(static_ltree, L_CODES$1 + 1, bl_count);\n\n  /* The static distance tree is trivial: */\n  for (n = 0; n < D_CODES$1; n++) {\n    static_dtree[n * 2 + 1]/*.Len*/ = 5;\n    static_dtree[n * 2]/*.Code*/ = bi_reverse(n, 5);\n  }\n\n  // Now data ready and we can init static trees\n  static_l_desc = new StaticTreeDesc(static_ltree, extra_lbits, LITERALS$1 + 1, L_CODES$1, MAX_BITS$1);\n  static_d_desc = new StaticTreeDesc(static_dtree, extra_dbits, 0,          D_CODES$1, MAX_BITS$1);\n  static_bl_desc = new StaticTreeDesc(new Array(0), extra_blbits, 0,         BL_CODES$1, MAX_BL_BITS);\n\n  //static_init_done = true;\n};\n\n\n/* ===========================================================================\n * Initialize a new block.\n */\nconst init_block = (s) => {\n\n  let n; /* iterates over tree elements */\n\n  /* Initialize the trees. */\n  for (n = 0; n < L_CODES$1;  n++) { s.dyn_ltree[n * 2]/*.Freq*/ = 0; }\n  for (n = 0; n < D_CODES$1;  n++) { s.dyn_dtree[n * 2]/*.Freq*/ = 0; }\n  for (n = 0; n < BL_CODES$1; n++) { s.bl_tree[n * 2]/*.Freq*/ = 0; }\n\n  s.dyn_ltree[END_BLOCK * 2]/*.Freq*/ = 1;\n  s.opt_len = s.static_len = 0;\n  s.sym_next = s.matches = 0;\n};\n\n\n/* ===========================================================================\n * Flush the bit buffer and align the output on a byte boundary\n */\nconst bi_windup = (s) =>\n{\n  if (s.bi_valid > 8) {\n    put_short(s, s.bi_buf);\n  } else if (s.bi_valid > 0) {\n    //put_byte(s, (Byte)s->bi_buf);\n    s.pending_buf[s.pending++] = s.bi_buf;\n  }\n  s.bi_buf = 0;\n  s.bi_valid = 0;\n};\n\n/* ===========================================================================\n * Compares to subtrees, using the tree depth as tie breaker when\n * the subtrees have equal frequency. This minimizes the worst case length.\n */\nconst smaller = (tree, n, m, depth) => {\n\n  const _n2 = n * 2;\n  const _m2 = m * 2;\n  return (tree[_n2]/*.Freq*/ < tree[_m2]/*.Freq*/ ||\n         (tree[_n2]/*.Freq*/ === tree[_m2]/*.Freq*/ && depth[n] <= depth[m]));\n};\n\n/* ===========================================================================\n * Restore the heap property by moving down the tree starting at node k,\n * exchanging a node with the smallest of its two sons if necessary, stopping\n * when the heap property is re-established (each father smaller than its\n * two sons).\n */\nconst pqdownheap = (s, tree, k) => {\n//    deflate_state *s;\n//    ct_data *tree;  /* the tree to restore */\n//    int k;               /* node to move down */\n\n  const v = s.heap[k];\n  let j = k << 1;  /* left son of k */\n  while (j <= s.heap_len) {\n    /* Set j to the smallest of the two sons: */\n    if (j < s.heap_len &&\n      smaller(tree, s.heap[j + 1], s.heap[j], s.depth)) {\n      j++;\n    }\n    /* Exit if v is smaller than both sons */\n    if (smaller(tree, v, s.heap[j], s.depth)) { break; }\n\n    /* Exchange v with the smallest son */\n    s.heap[k] = s.heap[j];\n    k = j;\n\n    /* And continue down the tree, setting j to the left son of k */\n    j <<= 1;\n  }\n  s.heap[k] = v;\n};\n\n\n// inlined manually\n// const SMALLEST = 1;\n\n/* ===========================================================================\n * Send the block data compressed using the given Huffman trees\n */\nconst compress_block = (s, ltree, dtree) => {\n//    deflate_state *s;\n//    const ct_data *ltree; /* literal tree */\n//    const ct_data *dtree; /* distance tree */\n\n  let dist;           /* distance of matched string */\n  let lc;             /* match length or unmatched char (if dist == 0) */\n  let sx = 0;         /* running index in sym_buf */\n  let code;           /* the code to send */\n  let extra;          /* number of extra bits to send */\n\n  if (s.sym_next !== 0) {\n    do {\n      dist = s.pending_buf[s.sym_buf + sx++] & 0xff;\n      dist += (s.pending_buf[s.sym_buf + sx++] & 0xff) << 8;\n      lc = s.pending_buf[s.sym_buf + sx++];\n      if (dist === 0) {\n        send_code(s, lc, ltree); /* send a literal byte */\n        //Tracecv(isgraph(lc), (stderr,\" '%c' \", lc));\n      } else {\n        /* Here, lc is the match length - MIN_MATCH */\n        code = _length_code[lc];\n        send_code(s, code + LITERALS$1 + 1, ltree); /* send the length code */\n        extra = extra_lbits[code];\n        if (extra !== 0) {\n          lc -= base_length[code];\n          send_bits(s, lc, extra);       /* send the extra length bits */\n        }\n        dist--; /* dist is now the match distance - 1 */\n        code = d_code(dist);\n        //Assert (code < D_CODES, \"bad d_code\");\n\n        send_code(s, code, dtree);       /* send the distance code */\n        extra = extra_dbits[code];\n        if (extra !== 0) {\n          dist -= base_dist[code];\n          send_bits(s, dist, extra);   /* send the extra distance bits */\n        }\n      } /* literal or match pair ? */\n\n      /* Check that the overlay between pending_buf and sym_buf is ok: */\n      //Assert(s->pending < s->lit_bufsize + sx, \"pendingBuf overflow\");\n\n    } while (sx < s.sym_next);\n  }\n\n  send_code(s, END_BLOCK, ltree);\n};\n\n\n/* ===========================================================================\n * Construct one Huffman tree and assigns the code bit strings and lengths.\n * Update the total bit length for the current block.\n * IN assertion: the field freq is set for all tree elements.\n * OUT assertions: the fields len and code are set to the optimal bit length\n *     and corresponding code. The length opt_len is updated; static_len is\n *     also updated if stree is not null. The field max_code is set.\n */\nconst build_tree = (s, desc) => {\n//    deflate_state *s;\n//    tree_desc *desc; /* the tree descriptor */\n\n  const tree     = desc.dyn_tree;\n  const stree    = desc.stat_desc.static_tree;\n  const has_stree = desc.stat_desc.has_stree;\n  const elems    = desc.stat_desc.elems;\n  let n, m;          /* iterate over heap elements */\n  let max_code = -1; /* largest code with non zero frequency */\n  let node;          /* new node being created */\n\n  /* Construct the initial heap, with least frequent element in\n   * heap[SMALLEST]. The sons of heap[n] are heap[2*n] and heap[2*n+1].\n   * heap[0] is not used.\n   */\n  s.heap_len = 0;\n  s.heap_max = HEAP_SIZE$1;\n\n  for (n = 0; n < elems; n++) {\n    if (tree[n * 2]/*.Freq*/ !== 0) {\n      s.heap[++s.heap_len] = max_code = n;\n      s.depth[n] = 0;\n\n    } else {\n      tree[n * 2 + 1]/*.Len*/ = 0;\n    }\n  }\n\n  /* The pkzip format requires that at least one distance code exists,\n   * and that at least one bit should be sent even if there is only one\n   * possible code. So to avoid special checks later on we force at least\n   * two codes of non zero frequency.\n   */\n  while (s.heap_len < 2) {\n    node = s.heap[++s.heap_len] = (max_code < 2 ? ++max_code : 0);\n    tree[node * 2]/*.Freq*/ = 1;\n    s.depth[node] = 0;\n    s.opt_len--;\n\n    if (has_stree) {\n      s.static_len -= stree[node * 2 + 1]/*.Len*/;\n    }\n    /* node is 0 or 1 so it does not have extra bits */\n  }\n  desc.max_code = max_code;\n\n  /* The elements heap[heap_len/2+1 .. heap_len] are leaves of the tree,\n   * establish sub-heaps of increasing lengths:\n   */\n  for (n = (s.heap_len >> 1/*int /2*/); n >= 1; n--) { pqdownheap(s, tree, n); }\n\n  /* Construct the Huffman tree by repeatedly combining the least two\n   * frequent nodes.\n   */\n  node = elems;              /* next internal node of the tree */\n  do {\n    //pqremove(s, tree, n);  /* n = node of least frequency */\n    /*** pqremove ***/\n    n = s.heap[1/*SMALLEST*/];\n    s.heap[1/*SMALLEST*/] = s.heap[s.heap_len--];\n    pqdownheap(s, tree, 1/*SMALLEST*/);\n    /***/\n\n    m = s.heap[1/*SMALLEST*/]; /* m = node of next least frequency */\n\n    s.heap[--s.heap_max] = n; /* keep the nodes sorted by frequency */\n    s.heap[--s.heap_max] = m;\n\n    /* Create a new node father of n and m */\n    tree[node * 2]/*.Freq*/ = tree[n * 2]/*.Freq*/ + tree[m * 2]/*.Freq*/;\n    s.depth[node] = (s.depth[n] >= s.depth[m] ? s.depth[n] : s.depth[m]) + 1;\n    tree[n * 2 + 1]/*.Dad*/ = tree[m * 2 + 1]/*.Dad*/ = node;\n\n    /* and insert the new node in the heap */\n    s.heap[1/*SMALLEST*/] = node++;\n    pqdownheap(s, tree, 1/*SMALLEST*/);\n\n  } while (s.heap_len >= 2);\n\n  s.heap[--s.heap_max] = s.heap[1/*SMALLEST*/];\n\n  /* At this point, the fields freq and dad are set. We can now\n   * generate the bit lengths.\n   */\n  gen_bitlen(s, desc);\n\n  /* The field len is now set, we can generate the bit codes */\n  gen_codes(tree, max_code, s.bl_count);\n};\n\n\n/* ===========================================================================\n * Scan a literal or distance tree to determine the frequencies of the codes\n * in the bit length tree.\n */\nconst scan_tree = (s, tree, max_code) => {\n//    deflate_state *s;\n//    ct_data *tree;   /* the tree to be scanned */\n//    int max_code;    /* and its largest code of non zero frequency */\n\n  let n;                     /* iterates over all tree elements */\n  let prevlen = -1;          /* last emitted length */\n  let curlen;                /* length of current code */\n\n  let nextlen = tree[0 * 2 + 1]/*.Len*/; /* length of next code */\n\n  let count = 0;             /* repeat count of the current code */\n  let max_count = 7;         /* max repeat count */\n  let min_count = 4;         /* min repeat count */\n\n  if (nextlen === 0) {\n    max_count = 138;\n    min_count = 3;\n  }\n  tree[(max_code + 1) * 2 + 1]/*.Len*/ = 0xffff; /* guard */\n\n  for (n = 0; n <= max_code; n++) {\n    curlen = nextlen;\n    nextlen = tree[(n + 1) * 2 + 1]/*.Len*/;\n\n    if (++count < max_count && curlen === nextlen) {\n      continue;\n\n    } else if (count < min_count) {\n      s.bl_tree[curlen * 2]/*.Freq*/ += count;\n\n    } else if (curlen !== 0) {\n\n      if (curlen !== prevlen) { s.bl_tree[curlen * 2]/*.Freq*/++; }\n      s.bl_tree[REP_3_6 * 2]/*.Freq*/++;\n\n    } else if (count <= 10) {\n      s.bl_tree[REPZ_3_10 * 2]/*.Freq*/++;\n\n    } else {\n      s.bl_tree[REPZ_11_138 * 2]/*.Freq*/++;\n    }\n\n    count = 0;\n    prevlen = curlen;\n\n    if (nextlen === 0) {\n      max_count = 138;\n      min_count = 3;\n\n    } else if (curlen === nextlen) {\n      max_count = 6;\n      min_count = 3;\n\n    } else {\n      max_count = 7;\n      min_count = 4;\n    }\n  }\n};\n\n\n/* ===========================================================================\n * Send a literal or distance tree in compressed form, using the codes in\n * bl_tree.\n */\nconst send_tree = (s, tree, max_code) => {\n//    deflate_state *s;\n//    ct_data *tree; /* the tree to be scanned */\n//    int max_code;       /* and its largest code of non zero frequency */\n\n  let n;                     /* iterates over all tree elements */\n  let prevlen = -1;          /* last emitted length */\n  let curlen;                /* length of current code */\n\n  let nextlen = tree[0 * 2 + 1]/*.Len*/; /* length of next code */\n\n  let count = 0;             /* repeat count of the current code */\n  let max_count = 7;         /* max repeat count */\n  let min_count = 4;         /* min repeat count */\n\n  /* tree[max_code+1].Len = -1; */  /* guard already set */\n  if (nextlen === 0) {\n    max_count = 138;\n    min_count = 3;\n  }\n\n  for (n = 0; n <= max_code; n++) {\n    curlen = nextlen;\n    nextlen = tree[(n + 1) * 2 + 1]/*.Len*/;\n\n    if (++count < max_count && curlen === nextlen) {\n      continue;\n\n    } else if (count < min_count) {\n      do { send_code(s, curlen, s.bl_tree); } while (--count !== 0);\n\n    } else if (curlen !== 0) {\n      if (curlen !== prevlen) {\n        send_code(s, curlen, s.bl_tree);\n        count--;\n      }\n      //Assert(count >= 3 && count <= 6, \" 3_6?\");\n      send_code(s, REP_3_6, s.bl_tree);\n      send_bits(s, count - 3, 2);\n\n    } else if (count <= 10) {\n      send_code(s, REPZ_3_10, s.bl_tree);\n      send_bits(s, count - 3, 3);\n\n    } else {\n      send_code(s, REPZ_11_138, s.bl_tree);\n      send_bits(s, count - 11, 7);\n    }\n\n    count = 0;\n    prevlen = curlen;\n    if (nextlen === 0) {\n      max_count = 138;\n      min_count = 3;\n\n    } else if (curlen === nextlen) {\n      max_count = 6;\n      min_count = 3;\n\n    } else {\n      max_count = 7;\n      min_count = 4;\n    }\n  }\n};\n\n\n/* ===========================================================================\n * Construct the Huffman tree for the bit lengths and return the index in\n * bl_order of the last bit length code to send.\n */\nconst build_bl_tree = (s) => {\n\n  let max_blindex;  /* index of last bit length code of non zero freq */\n\n  /* Determine the bit length frequencies for literal and distance trees */\n  scan_tree(s, s.dyn_ltree, s.l_desc.max_code);\n  scan_tree(s, s.dyn_dtree, s.d_desc.max_code);\n\n  /* Build the bit length tree: */\n  build_tree(s, s.bl_desc);\n  /* opt_len now includes the length of the tree representations, except\n   * the lengths of the bit lengths codes and the 5+5+4 bits for the counts.\n   */\n\n  /* Determine the number of bit length codes to send. The pkzip format\n   * requires that at least 4 bit length codes be sent. (appnote.txt says\n   * 3 but the actual value used is 4.)\n   */\n  for (max_blindex = BL_CODES$1 - 1; max_blindex >= 3; max_blindex--) {\n    if (s.bl_tree[bl_order[max_blindex] * 2 + 1]/*.Len*/ !== 0) {\n      break;\n    }\n  }\n  /* Update opt_len to include the bit length tree and counts */\n  s.opt_len += 3 * (max_blindex + 1) + 5 + 5 + 4;\n  //Tracev((stderr, \"\\ndyn trees: dyn %ld, stat %ld\",\n  //        s->opt_len, s->static_len));\n\n  return max_blindex;\n};\n\n\n/* ===========================================================================\n * Send the header for a block using dynamic Huffman trees: the counts, the\n * lengths of the bit length codes, the literal tree and the distance tree.\n * IN assertion: lcodes >= 257, dcodes >= 1, blcodes >= 4.\n */\nconst send_all_trees = (s, lcodes, dcodes, blcodes) => {\n//    deflate_state *s;\n//    int lcodes, dcodes, blcodes; /* number of codes for each tree */\n\n  let rank;                    /* index in bl_order */\n\n  //Assert (lcodes >= 257 && dcodes >= 1 && blcodes >= 4, \"not enough codes\");\n  //Assert (lcodes <= L_CODES && dcodes <= D_CODES && blcodes <= BL_CODES,\n  //        \"too many codes\");\n  //Tracev((stderr, \"\\nbl counts: \"));\n  send_bits(s, lcodes - 257, 5); /* not +255 as stated in appnote.txt */\n  send_bits(s, dcodes - 1,   5);\n  send_bits(s, blcodes - 4,  4); /* not -3 as stated in appnote.txt */\n  for (rank = 0; rank < blcodes; rank++) {\n    //Tracev((stderr, \"\\nbl code %2d \", bl_order[rank]));\n    send_bits(s, s.bl_tree[bl_order[rank] * 2 + 1]/*.Len*/, 3);\n  }\n  //Tracev((stderr, \"\\nbl tree: sent %ld\", s->bits_sent));\n\n  send_tree(s, s.dyn_ltree, lcodes - 1); /* literal tree */\n  //Tracev((stderr, \"\\nlit tree: sent %ld\", s->bits_sent));\n\n  send_tree(s, s.dyn_dtree, dcodes - 1); /* distance tree */\n  //Tracev((stderr, \"\\ndist tree: sent %ld\", s->bits_sent));\n};\n\n\n/* ===========================================================================\n * Check if the data type is TEXT or BINARY, using the following algorithm:\n * - TEXT if the two conditions below are satisfied:\n *    a) There are no non-portable control characters belonging to the\n *       \"block list\" (0..6, 14..25, 28..31).\n *    b) There is at least one printable character belonging to the\n *       \"allow list\" (9 {TAB}, 10 {LF}, 13 {CR}, 32..255).\n * - BINARY otherwise.\n * - The following partially-portable control characters form a\n *   \"gray list\" that is ignored in this detection algorithm:\n *   (7 {BEL}, 8 {BS}, 11 {VT}, 12 {FF}, 26 {SUB}, 27 {ESC}).\n * IN assertion: the fields Freq of dyn_ltree are set.\n */\nconst detect_data_type = (s) => {\n  /* block_mask is the bit mask of block-listed bytes\n   * set bits 0..6, 14..25, and 28..31\n   * 0xf3ffc07f = binary 11110011111111111100000001111111\n   */\n  let block_mask = 0xf3ffc07f;\n  let n;\n\n  /* Check for non-textual (\"block-listed\") bytes. */\n  for (n = 0; n <= 31; n++, block_mask >>>= 1) {\n    if ((block_mask & 1) && (s.dyn_ltree[n * 2]/*.Freq*/ !== 0)) {\n      return Z_BINARY;\n    }\n  }\n\n  /* Check for textual (\"allow-listed\") bytes. */\n  if (s.dyn_ltree[9 * 2]/*.Freq*/ !== 0 || s.dyn_ltree[10 * 2]/*.Freq*/ !== 0 ||\n      s.dyn_ltree[13 * 2]/*.Freq*/ !== 0) {\n    return Z_TEXT;\n  }\n  for (n = 32; n < LITERALS$1; n++) {\n    if (s.dyn_ltree[n * 2]/*.Freq*/ !== 0) {\n      return Z_TEXT;\n    }\n  }\n\n  /* There are no \"block-listed\" or \"allow-listed\" bytes:\n   * this stream either is empty or has tolerated (\"gray-listed\") bytes only.\n   */\n  return Z_BINARY;\n};\n\n\nlet static_init_done = false;\n\n/* ===========================================================================\n * Initialize the tree data structures for a new zlib stream.\n */\nconst _tr_init$1 = (s) =>\n{\n\n  if (!static_init_done) {\n    tr_static_init();\n    static_init_done = true;\n  }\n\n  s.l_desc  = new TreeDesc(s.dyn_ltree, static_l_desc);\n  s.d_desc  = new TreeDesc(s.dyn_dtree, static_d_desc);\n  s.bl_desc = new TreeDesc(s.bl_tree, static_bl_desc);\n\n  s.bi_buf = 0;\n  s.bi_valid = 0;\n\n  /* Initialize the first block of the first file: */\n  init_block(s);\n};\n\n\n/* ===========================================================================\n * Send a stored block\n */\nconst _tr_stored_block$1 = (s, buf, stored_len, last) => {\n//DeflateState *s;\n//charf *buf;       /* input block */\n//ulg stored_len;   /* length of input block */\n//int last;         /* one if this is the last block for a file */\n\n  send_bits(s, (STORED_BLOCK << 1) + (last ? 1 : 0), 3);    /* send block type */\n  bi_windup(s);        /* align on byte boundary */\n  put_short(s, stored_len);\n  put_short(s, ~stored_len);\n  if (stored_len) {\n    s.pending_buf.set(s.window.subarray(buf, buf + stored_len), s.pending);\n  }\n  s.pending += stored_len;\n};\n\n\n/* ===========================================================================\n * Send one empty static block to give enough lookahead for inflate.\n * This takes 10 bits, of which 7 may remain in the bit buffer.\n */\nconst _tr_align$1 = (s) => {\n  send_bits(s, STATIC_TREES << 1, 3);\n  send_code(s, END_BLOCK, static_ltree);\n  bi_flush(s);\n};\n\n\n/* ===========================================================================\n * Determine the best encoding for the current block: dynamic trees, static\n * trees or store, and write out the encoded block.\n */\nconst _tr_flush_block$1 = (s, buf, stored_len, last) => {\n//DeflateState *s;\n//charf *buf;       /* input block, or NULL if too old */\n//ulg stored_len;   /* length of input block */\n//int last;         /* one if this is the last block for a file */\n\n  let opt_lenb, static_lenb;  /* opt_len and static_len in bytes */\n  let max_blindex = 0;        /* index of last bit length code of non zero freq */\n\n  /* Build the Huffman trees unless a stored block is forced */\n  if (s.level > 0) {\n\n    /* Check if the file is binary or text */\n    if (s.strm.data_type === Z_UNKNOWN$1) {\n      s.strm.data_type = detect_data_type(s);\n    }\n\n    /* Construct the literal and distance trees */\n    build_tree(s, s.l_desc);\n    // Tracev((stderr, \"\\nlit data: dyn %ld, stat %ld\", s->opt_len,\n    //        s->static_len));\n\n    build_tree(s, s.d_desc);\n    // Tracev((stderr, \"\\ndist data: dyn %ld, stat %ld\", s->opt_len,\n    //        s->static_len));\n    /* At this point, opt_len and static_len are the total bit lengths of\n     * the compressed block data, excluding the tree representations.\n     */\n\n    /* Build the bit length tree for the above two trees, and get the index\n     * in bl_order of the last bit length code to send.\n     */\n    max_blindex = build_bl_tree(s);\n\n    /* Determine the best encoding. Compute the block lengths in bytes. */\n    opt_lenb = (s.opt_len + 3 + 7) >>> 3;\n    static_lenb = (s.static_len + 3 + 7) >>> 3;\n\n    // Tracev((stderr, \"\\nopt %lu(%lu) stat %lu(%lu) stored %lu lit %u \",\n    //        opt_lenb, s->opt_len, static_lenb, s->static_len, stored_len,\n    //        s->sym_next / 3));\n\n    if (static_lenb <= opt_lenb) { opt_lenb = static_lenb; }\n\n  } else {\n    // Assert(buf != (char*)0, \"lost buf\");\n    opt_lenb = static_lenb = stored_len + 5; /* force a stored block */\n  }\n\n  if ((stored_len + 4 <= opt_lenb) && (buf !== -1)) {\n    /* 4: two words for the lengths */\n\n    /* The test buf != NULL is only necessary if LIT_BUFSIZE > WSIZE.\n     * Otherwise we can't have processed more than WSIZE input bytes since\n     * the last block flush, because compression would have been\n     * successful. If LIT_BUFSIZE <= WSIZE, it is never too late to\n     * transform a block into a stored block.\n     */\n    _tr_stored_block$1(s, buf, stored_len, last);\n\n  } else if (s.strategy === Z_FIXED$1 || static_lenb === opt_lenb) {\n\n    send_bits(s, (STATIC_TREES << 1) + (last ? 1 : 0), 3);\n    compress_block(s, static_ltree, static_dtree);\n\n  } else {\n    send_bits(s, (DYN_TREES << 1) + (last ? 1 : 0), 3);\n    send_all_trees(s, s.l_desc.max_code + 1, s.d_desc.max_code + 1, max_blindex + 1);\n    compress_block(s, s.dyn_ltree, s.dyn_dtree);\n  }\n  // Assert (s->compressed_len == s->bits_sent, \"bad compressed size\");\n  /* The above check is made mod 2^32, for files larger than 512 MB\n   * and uLong implemented on 32 bits.\n   */\n  init_block(s);\n\n  if (last) {\n    bi_windup(s);\n  }\n  // Tracev((stderr,\"\\ncomprlen %lu(%lu) \", s->compressed_len>>3,\n  //       s->compressed_len-7*last));\n};\n\n/* ===========================================================================\n * Save the match info and tally the frequency counts. Return true if\n * the current block must be flushed.\n */\nconst _tr_tally$1 = (s, dist, lc) => {\n//    deflate_state *s;\n//    unsigned dist;  /* distance of matched string */\n//    unsigned lc;    /* match length-MIN_MATCH or unmatched char (if dist==0) */\n\n  s.pending_buf[s.sym_buf + s.sym_next++] = dist;\n  s.pending_buf[s.sym_buf + s.sym_next++] = dist >> 8;\n  s.pending_buf[s.sym_buf + s.sym_next++] = lc;\n  if (dist === 0) {\n    /* lc is the unmatched char */\n    s.dyn_ltree[lc * 2]/*.Freq*/++;\n  } else {\n    s.matches++;\n    /* Here, lc is the match length - MIN_MATCH */\n    dist--;             /* dist = match distance - 1 */\n    //Assert((ush)dist < (ush)MAX_DIST(s) &&\n    //       (ush)lc <= (ush)(MAX_MATCH-MIN_MATCH) &&\n    //       (ush)d_code(dist) < (ush)D_CODES,  \"_tr_tally: bad match\");\n\n    s.dyn_ltree[(_length_code[lc] + LITERALS$1 + 1) * 2]/*.Freq*/++;\n    s.dyn_dtree[d_code(dist) * 2]/*.Freq*/++;\n  }\n\n  return (s.sym_next === s.sym_end);\n};\n\nvar _tr_init_1  = _tr_init$1;\nvar _tr_stored_block_1 = _tr_stored_block$1;\nvar _tr_flush_block_1  = _tr_flush_block$1;\nvar _tr_tally_1 = _tr_tally$1;\nvar _tr_align_1 = _tr_align$1;\n\nvar trees = {\n\t_tr_init: _tr_init_1,\n\t_tr_stored_block: _tr_stored_block_1,\n\t_tr_flush_block: _tr_flush_block_1,\n\t_tr_tally: _tr_tally_1,\n\t_tr_align: _tr_align_1\n};\n\n// Note: adler32 takes 12% for level 0 and 2% for level 6.\n// It isn't worth it to make additional optimizations as in original.\n// Small size is preferable.\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nconst adler32 = (adler, buf, len, pos) => {\n  let s1 = (adler & 0xffff) |0,\n      s2 = ((adler >>> 16) & 0xffff) |0,\n      n = 0;\n\n  while (len !== 0) {\n    // Set limit ~ twice less than 5552, to keep\n    // s2 in 31-bits, because we force signed ints.\n    // in other case %= will fail.\n    n = len > 2000 ? 2000 : len;\n    len -= n;\n\n    do {\n      s1 = (s1 + buf[pos++]) |0;\n      s2 = (s2 + s1) |0;\n    } while (--n);\n\n    s1 %= 65521;\n    s2 %= 65521;\n  }\n\n  return (s1 | (s2 << 16)) |0;\n};\n\n\nvar adler32_1 = adler32;\n\n// Note: we can't get significant speed boost here.\n// So write code to minimize size - no pregenerated tables\n// and array tools dependencies.\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n// Use ordinary array, since untyped makes no boost here\nconst makeTable = () => {\n  let c, table = [];\n\n  for (var n = 0; n < 256; n++) {\n    c = n;\n    for (var k = 0; k < 8; k++) {\n      c = ((c & 1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));\n    }\n    table[n] = c;\n  }\n\n  return table;\n};\n\n// Create table on load. Just 255 signed longs. Not a problem.\nconst crcTable = new Uint32Array(makeTable());\n\n\nconst crc32 = (crc, buf, len, pos) => {\n  const t = crcTable;\n  const end = pos + len;\n\n  crc ^= -1;\n\n  for (let i = pos; i < end; i++) {\n    crc = (crc >>> 8) ^ t[(crc ^ buf[i]) & 0xFF];\n  }\n\n  return (crc ^ (-1)); // >>> 0;\n};\n\n\nvar crc32_1 = crc32;\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nvar messages = {\n  2:      'need dictionary',     /* Z_NEED_DICT       2  */\n  1:      'stream end',          /* Z_STREAM_END      1  */\n  0:      '',                    /* Z_OK              0  */\n  '-1':   'file error',          /* Z_ERRNO         (-1) */\n  '-2':   'stream error',        /* Z_STREAM_ERROR  (-2) */\n  '-3':   'data error',          /* Z_DATA_ERROR    (-3) */\n  '-4':   'insufficient memory', /* Z_MEM_ERROR     (-4) */\n  '-5':   'buffer error',        /* Z_BUF_ERROR     (-5) */\n  '-6':   'incompatible version' /* Z_VERSION_ERROR (-6) */\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nvar constants$2 = {\n\n  /* Allowed flush values; see deflate() and inflate() below for details */\n  Z_NO_FLUSH:         0,\n  Z_PARTIAL_FLUSH:    1,\n  Z_SYNC_FLUSH:       2,\n  Z_FULL_FLUSH:       3,\n  Z_FINISH:           4,\n  Z_BLOCK:            5,\n  Z_TREES:            6,\n\n  /* Return codes for the compression/decompression functions. Negative values\n  * are errors, positive values are used for special but normal events.\n  */\n  Z_OK:               0,\n  Z_STREAM_END:       1,\n  Z_NEED_DICT:        2,\n  Z_ERRNO:           -1,\n  Z_STREAM_ERROR:    -2,\n  Z_DATA_ERROR:      -3,\n  Z_MEM_ERROR:       -4,\n  Z_BUF_ERROR:       -5,\n  //Z_VERSION_ERROR: -6,\n\n  /* compression levels */\n  Z_NO_COMPRESSION:         0,\n  Z_BEST_SPEED:             1,\n  Z_BEST_COMPRESSION:       9,\n  Z_DEFAULT_COMPRESSION:   -1,\n\n\n  Z_FILTERED:               1,\n  Z_HUFFMAN_ONLY:           2,\n  Z_RLE:                    3,\n  Z_FIXED:                  4,\n  Z_DEFAULT_STRATEGY:       0,\n\n  /* Possible values of the data_type field (though see inflate()) */\n  Z_BINARY:                 0,\n  Z_TEXT:                   1,\n  //Z_ASCII:                1, // = Z_TEXT (deprecated)\n  Z_UNKNOWN:                2,\n\n  /* The deflate compression method */\n  Z_DEFLATED:               8\n  //Z_NULL:                 null // Use -1 or null inline, depending on var type\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nconst { _tr_init, _tr_stored_block, _tr_flush_block, _tr_tally, _tr_align } = trees;\n\n\n\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_NO_FLUSH: Z_NO_FLUSH$2, Z_PARTIAL_FLUSH, Z_FULL_FLUSH: Z_FULL_FLUSH$1, Z_FINISH: Z_FINISH$3, Z_BLOCK: Z_BLOCK$1,\n  Z_OK: Z_OK$3, Z_STREAM_END: Z_STREAM_END$3, Z_STREAM_ERROR: Z_STREAM_ERROR$2, Z_DATA_ERROR: Z_DATA_ERROR$2, Z_BUF_ERROR: Z_BUF_ERROR$1,\n  Z_DEFAULT_COMPRESSION: Z_DEFAULT_COMPRESSION$1,\n  Z_FILTERED, Z_HUFFMAN_ONLY, Z_RLE, Z_FIXED, Z_DEFAULT_STRATEGY: Z_DEFAULT_STRATEGY$1,\n  Z_UNKNOWN,\n  Z_DEFLATED: Z_DEFLATED$2\n} = constants$2;\n\n/*============================================================================*/\n\n\nconst MAX_MEM_LEVEL = 9;\n/* Maximum value for memLevel in deflateInit2 */\nconst MAX_WBITS$1 = 15;\n/* 32K LZ77 window */\nconst DEF_MEM_LEVEL = 8;\n\n\nconst LENGTH_CODES  = 29;\n/* number of length codes, not counting the special END_BLOCK code */\nconst LITERALS      = 256;\n/* number of literal bytes 0..255 */\nconst L_CODES       = LITERALS + 1 + LENGTH_CODES;\n/* number of Literal or Length codes, including the END_BLOCK code */\nconst D_CODES       = 30;\n/* number of distance codes */\nconst BL_CODES      = 19;\n/* number of codes used to transfer the bit lengths */\nconst HEAP_SIZE     = 2 * L_CODES + 1;\n/* maximum heap size */\nconst MAX_BITS  = 15;\n/* All codes must not exceed MAX_BITS bits */\n\nconst MIN_MATCH = 3;\nconst MAX_MATCH = 258;\nconst MIN_LOOKAHEAD = (MAX_MATCH + MIN_MATCH + 1);\n\nconst PRESET_DICT = 0x20;\n\nconst INIT_STATE    =  42;    /* zlib header -> BUSY_STATE */\n//#ifdef GZIP\nconst GZIP_STATE    =  57;    /* gzip header -> BUSY_STATE | EXTRA_STATE */\n//#endif\nconst EXTRA_STATE   =  69;    /* gzip extra block -> NAME_STATE */\nconst NAME_STATE    =  73;    /* gzip file name -> COMMENT_STATE */\nconst COMMENT_STATE =  91;    /* gzip comment -> HCRC_STATE */\nconst HCRC_STATE    = 103;    /* gzip header CRC -> BUSY_STATE */\nconst BUSY_STATE    = 113;    /* deflate -> FINISH_STATE */\nconst FINISH_STATE  = 666;    /* stream complete */\n\nconst BS_NEED_MORE      = 1; /* block not completed, need more input or more output */\nconst BS_BLOCK_DONE     = 2; /* block flush performed */\nconst BS_FINISH_STARTED = 3; /* finish started, need only more output at next deflate */\nconst BS_FINISH_DONE    = 4; /* finish done, accept no more input or output */\n\nconst OS_CODE = 0x03; // Unix :) . Don't detect, use this default.\n\nconst err = (strm, errorCode) => {\n  strm.msg = messages[errorCode];\n  return errorCode;\n};\n\nconst rank = (f) => {\n  return ((f) * 2) - ((f) > 4 ? 9 : 0);\n};\n\nconst zero = (buf) => {\n  let len = buf.length; while (--len >= 0) { buf[len] = 0; }\n};\n\n/* ===========================================================================\n * Slide the hash table when sliding the window down (could be avoided with 32\n * bit values at the expense of memory usage). We slide even when level == 0 to\n * keep the hash table consistent if we switch back to level > 0 later.\n */\nconst slide_hash = (s) => {\n  let n, m;\n  let p;\n  let wsize = s.w_size;\n\n  n = s.hash_size;\n  p = n;\n  do {\n    m = s.head[--p];\n    s.head[p] = (m >= wsize ? m - wsize : 0);\n  } while (--n);\n  n = wsize;\n//#ifndef FASTEST\n  p = n;\n  do {\n    m = s.prev[--p];\n    s.prev[p] = (m >= wsize ? m - wsize : 0);\n    /* If n is not on any hash chain, prev[n] is garbage but\n     * its value will never be used.\n     */\n  } while (--n);\n//#endif\n};\n\n/* eslint-disable new-cap */\nlet HASH_ZLIB = (s, prev, data) => ((prev << s.hash_shift) ^ data) & s.hash_mask;\n// This hash causes less collisions, https://github.com/nodeca/pako/issues/135\n// But breaks binary compatibility\n//let HASH_FAST = (s, prev, data) => ((prev << 8) + (prev >> 8) + (data << 4)) & s.hash_mask;\nlet HASH = HASH_ZLIB;\n\n\n/* =========================================================================\n * Flush as much pending output as possible. All deflate() output, except for\n * some deflate_stored() output, goes through this function so some\n * applications may wish to modify it to avoid allocating a large\n * strm->next_out buffer and copying into it. (See also read_buf()).\n */\nconst flush_pending = (strm) => {\n  const s = strm.state;\n\n  //_tr_flush_bits(s);\n  let len = s.pending;\n  if (len > strm.avail_out) {\n    len = strm.avail_out;\n  }\n  if (len === 0) { return; }\n\n  strm.output.set(s.pending_buf.subarray(s.pending_out, s.pending_out + len), strm.next_out);\n  strm.next_out  += len;\n  s.pending_out  += len;\n  strm.total_out += len;\n  strm.avail_out -= len;\n  s.pending      -= len;\n  if (s.pending === 0) {\n    s.pending_out = 0;\n  }\n};\n\n\nconst flush_block_only = (s, last) => {\n  _tr_flush_block(s, (s.block_start >= 0 ? s.block_start : -1), s.strstart - s.block_start, last);\n  s.block_start = s.strstart;\n  flush_pending(s.strm);\n};\n\n\nconst put_byte = (s, b) => {\n  s.pending_buf[s.pending++] = b;\n};\n\n\n/* =========================================================================\n * Put a short in the pending buffer. The 16-bit value is put in MSB order.\n * IN assertion: the stream state is correct and there is enough room in\n * pending_buf.\n */\nconst putShortMSB = (s, b) => {\n\n  //  put_byte(s, (Byte)(b >> 8));\n//  put_byte(s, (Byte)(b & 0xff));\n  s.pending_buf[s.pending++] = (b >>> 8) & 0xff;\n  s.pending_buf[s.pending++] = b & 0xff;\n};\n\n\n/* ===========================================================================\n * Read a new buffer from the current input stream, update the adler32\n * and total number of bytes read.  All deflate() input goes through\n * this function so some applications may wish to modify it to avoid\n * allocating a large strm->input buffer and copying from it.\n * (See also flush_pending()).\n */\nconst read_buf = (strm, buf, start, size) => {\n\n  let len = strm.avail_in;\n\n  if (len > size) { len = size; }\n  if (len === 0) { return 0; }\n\n  strm.avail_in -= len;\n\n  // zmemcpy(buf, strm->next_in, len);\n  buf.set(strm.input.subarray(strm.next_in, strm.next_in + len), start);\n  if (strm.state.wrap === 1) {\n    strm.adler = adler32_1(strm.adler, buf, len, start);\n  }\n\n  else if (strm.state.wrap === 2) {\n    strm.adler = crc32_1(strm.adler, buf, len, start);\n  }\n\n  strm.next_in += len;\n  strm.total_in += len;\n\n  return len;\n};\n\n\n/* ===========================================================================\n * Set match_start to the longest match starting at the given string and\n * return its length. Matches shorter or equal to prev_length are discarded,\n * in which case the result is equal to prev_length and match_start is\n * garbage.\n * IN assertions: cur_match is the head of the hash chain for the current\n *   string (strstart) and its distance is <= MAX_DIST, and prev_length >= 1\n * OUT assertion: the match length is not greater than s->lookahead.\n */\nconst longest_match = (s, cur_match) => {\n\n  let chain_length = s.max_chain_length;      /* max hash chain length */\n  let scan = s.strstart; /* current string */\n  let match;                       /* matched string */\n  let len;                           /* length of current match */\n  let best_len = s.prev_length;              /* best match length so far */\n  let nice_match = s.nice_match;             /* stop if match long enough */\n  const limit = (s.strstart > (s.w_size - MIN_LOOKAHEAD)) ?\n      s.strstart - (s.w_size - MIN_LOOKAHEAD) : 0/*NIL*/;\n\n  const _win = s.window; // shortcut\n\n  const wmask = s.w_mask;\n  const prev  = s.prev;\n\n  /* Stop when cur_match becomes <= limit. To simplify the code,\n   * we prevent matches with the string of window index 0.\n   */\n\n  const strend = s.strstart + MAX_MATCH;\n  let scan_end1  = _win[scan + best_len - 1];\n  let scan_end   = _win[scan + best_len];\n\n  /* The code is optimized for HASH_BITS >= 8 and MAX_MATCH-2 multiple of 16.\n   * It is easy to get rid of this optimization if necessary.\n   */\n  // Assert(s->hash_bits >= 8 && MAX_MATCH == 258, \"Code too clever\");\n\n  /* Do not waste too much time if we already have a good match: */\n  if (s.prev_length >= s.good_match) {\n    chain_length >>= 2;\n  }\n  /* Do not look for matches beyond the end of the input. This is necessary\n   * to make deflate deterministic.\n   */\n  if (nice_match > s.lookahead) { nice_match = s.lookahead; }\n\n  // Assert((ulg)s->strstart <= s->window_size-MIN_LOOKAHEAD, \"need lookahead\");\n\n  do {\n    // Assert(cur_match < s->strstart, \"no future\");\n    match = cur_match;\n\n    /* Skip to next match if the match length cannot increase\n     * or if the match length is less than 2.  Note that the checks below\n     * for insufficient lookahead only occur occasionally for performance\n     * reasons.  Therefore uninitialized memory will be accessed, and\n     * conditional jumps will be made that depend on those values.\n     * However the length of the match is limited to the lookahead, so\n     * the output of deflate is not affected by the uninitialized values.\n     */\n\n    if (_win[match + best_len]     !== scan_end  ||\n        _win[match + best_len - 1] !== scan_end1 ||\n        _win[match]                !== _win[scan] ||\n        _win[++match]              !== _win[scan + 1]) {\n      continue;\n    }\n\n    /* The check at best_len-1 can be removed because it will be made\n     * again later. (This heuristic is not always a win.)\n     * It is not necessary to compare scan[2] and match[2] since they\n     * are always equal when the other bytes match, given that\n     * the hash keys are equal and that HASH_BITS >= 8.\n     */\n    scan += 2;\n    match++;\n    // Assert(*scan == *match, \"match[2]?\");\n\n    /* We check for insufficient lookahead only every 8th comparison;\n     * the 256th check will be made at strstart+258.\n     */\n    do {\n      /*jshint noempty:false*/\n    } while (_win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             scan < strend);\n\n    // Assert(scan <= s->window+(unsigned)(s->window_size-1), \"wild scan\");\n\n    len = MAX_MATCH - (strend - scan);\n    scan = strend - MAX_MATCH;\n\n    if (len > best_len) {\n      s.match_start = cur_match;\n      best_len = len;\n      if (len >= nice_match) {\n        break;\n      }\n      scan_end1  = _win[scan + best_len - 1];\n      scan_end   = _win[scan + best_len];\n    }\n  } while ((cur_match = prev[cur_match & wmask]) > limit && --chain_length !== 0);\n\n  if (best_len <= s.lookahead) {\n    return best_len;\n  }\n  return s.lookahead;\n};\n\n\n/* ===========================================================================\n * Fill the window when the lookahead becomes insufficient.\n * Updates strstart and lookahead.\n *\n * IN assertion: lookahead < MIN_LOOKAHEAD\n * OUT assertions: strstart <= window_size-MIN_LOOKAHEAD\n *    At least one byte has been read, or avail_in == 0; reads are\n *    performed for at least two bytes (required for the zip translate_eol\n *    option -- not supported here).\n */\nconst fill_window = (s) => {\n\n  const _w_size = s.w_size;\n  let n, more, str;\n\n  //Assert(s->lookahead < MIN_LOOKAHEAD, \"already enough lookahead\");\n\n  do {\n    more = s.window_size - s.lookahead - s.strstart;\n\n    // JS ints have 32 bit, block below not needed\n    /* Deal with !@#$% 64K limit: */\n    //if (sizeof(int) <= 2) {\n    //    if (more == 0 && s->strstart == 0 && s->lookahead == 0) {\n    //        more = wsize;\n    //\n    //  } else if (more == (unsigned)(-1)) {\n    //        /* Very unlikely, but possible on 16 bit machine if\n    //         * strstart == 0 && lookahead == 1 (input done a byte at time)\n    //         */\n    //        more--;\n    //    }\n    //}\n\n\n    /* If the window is almost full and there is insufficient lookahead,\n     * move the upper half to the lower one to make room in the upper half.\n     */\n    if (s.strstart >= _w_size + (_w_size - MIN_LOOKAHEAD)) {\n\n      s.window.set(s.window.subarray(_w_size, _w_size + _w_size - more), 0);\n      s.match_start -= _w_size;\n      s.strstart -= _w_size;\n      /* we now have strstart >= MAX_DIST */\n      s.block_start -= _w_size;\n      if (s.insert > s.strstart) {\n        s.insert = s.strstart;\n      }\n      slide_hash(s);\n      more += _w_size;\n    }\n    if (s.strm.avail_in === 0) {\n      break;\n    }\n\n    /* If there was no sliding:\n     *    strstart <= WSIZE+MAX_DIST-1 && lookahead <= MIN_LOOKAHEAD - 1 &&\n     *    more == window_size - lookahead - strstart\n     * => more >= window_size - (MIN_LOOKAHEAD-1 + WSIZE + MAX_DIST-1)\n     * => more >= window_size - 2*WSIZE + 2\n     * In the BIG_MEM or MMAP case (not yet supported),\n     *   window_size == input_size + MIN_LOOKAHEAD  &&\n     *   strstart + s->lookahead <= input_size => more >= MIN_LOOKAHEAD.\n     * Otherwise, window_size == 2*WSIZE so more >= 2.\n     * If there was sliding, more >= WSIZE. So in all cases, more >= 2.\n     */\n    //Assert(more >= 2, \"more < 2\");\n    n = read_buf(s.strm, s.window, s.strstart + s.lookahead, more);\n    s.lookahead += n;\n\n    /* Initialize the hash value now that we have some input: */\n    if (s.lookahead + s.insert >= MIN_MATCH) {\n      str = s.strstart - s.insert;\n      s.ins_h = s.window[str];\n\n      /* UPDATE_HASH(s, s->ins_h, s->window[str + 1]); */\n      s.ins_h = HASH(s, s.ins_h, s.window[str + 1]);\n//#if MIN_MATCH != 3\n//        Call update_hash() MIN_MATCH-3 more times\n//#endif\n      while (s.insert) {\n        /* UPDATE_HASH(s, s->ins_h, s->window[str + MIN_MATCH-1]); */\n        s.ins_h = HASH(s, s.ins_h, s.window[str + MIN_MATCH - 1]);\n\n        s.prev[str & s.w_mask] = s.head[s.ins_h];\n        s.head[s.ins_h] = str;\n        str++;\n        s.insert--;\n        if (s.lookahead + s.insert < MIN_MATCH) {\n          break;\n        }\n      }\n    }\n    /* If the whole input has less than MIN_MATCH bytes, ins_h is garbage,\n     * but this is not important since only literal bytes will be emitted.\n     */\n\n  } while (s.lookahead < MIN_LOOKAHEAD && s.strm.avail_in !== 0);\n\n  /* If the WIN_INIT bytes after the end of the current data have never been\n   * written, then zero those bytes in order to avoid memory check reports of\n   * the use of uninitialized (or uninitialised as Julian writes) bytes by\n   * the longest match routines.  Update the high water mark for the next\n   * time through here.  WIN_INIT is set to MAX_MATCH since the longest match\n   * routines allow scanning to strstart + MAX_MATCH, ignoring lookahead.\n   */\n//  if (s.high_water < s.window_size) {\n//    const curr = s.strstart + s.lookahead;\n//    let init = 0;\n//\n//    if (s.high_water < curr) {\n//      /* Previous high water mark below current data -- zero WIN_INIT\n//       * bytes or up to end of window, whichever is less.\n//       */\n//      init = s.window_size - curr;\n//      if (init > WIN_INIT)\n//        init = WIN_INIT;\n//      zmemzero(s->window + curr, (unsigned)init);\n//      s->high_water = curr + init;\n//    }\n//    else if (s->high_water < (ulg)curr + WIN_INIT) {\n//      /* High water mark at or above current data, but below current data\n//       * plus WIN_INIT -- zero out to current data plus WIN_INIT, or up\n//       * to end of window, whichever is less.\n//       */\n//      init = (ulg)curr + WIN_INIT - s->high_water;\n//      if (init > s->window_size - s->high_water)\n//        init = s->window_size - s->high_water;\n//      zmemzero(s->window + s->high_water, (unsigned)init);\n//      s->high_water += init;\n//    }\n//  }\n//\n//  Assert((ulg)s->strstart <= s->window_size - MIN_LOOKAHEAD,\n//    \"not enough room for search\");\n};\n\n/* ===========================================================================\n * Copy without compression as much as possible from the input stream, return\n * the current block state.\n *\n * In case deflateParams() is used to later switch to a non-zero compression\n * level, s->matches (otherwise unused when storing) keeps track of the number\n * of hash table slides to perform. If s->matches is 1, then one hash table\n * slide will be done when switching. If s->matches is 2, the maximum value\n * allowed here, then the hash table will be cleared, since two or more slides\n * is the same as a clear.\n *\n * deflate_stored() is written to minimize the number of times an input byte is\n * copied. It is most efficient with large input and output buffers, which\n * maximizes the opportunites to have a single copy from next_in to next_out.\n */\nconst deflate_stored = (s, flush) => {\n\n  /* Smallest worthy block size when not flushing or finishing. By default\n   * this is 32K. This can be as small as 507 bytes for memLevel == 1. For\n   * large input and output buffers, the stored block size will be larger.\n   */\n  let min_block = s.pending_buf_size - 5 > s.w_size ? s.w_size : s.pending_buf_size - 5;\n\n  /* Copy as many min_block or larger stored blocks directly to next_out as\n   * possible. If flushing, copy the remaining available input to next_out as\n   * stored blocks, if there is enough space.\n   */\n  let len, left, have, last = 0;\n  let used = s.strm.avail_in;\n  do {\n    /* Set len to the maximum size block that we can copy directly with the\n     * available input data and output space. Set left to how much of that\n     * would be copied from what's left in the window.\n     */\n    len = 65535/* MAX_STORED */;     /* maximum deflate stored block length */\n    have = (s.bi_valid + 42) >> 3;     /* number of header bytes */\n    if (s.strm.avail_out < have) {         /* need room for header */\n      break;\n    }\n      /* maximum stored block length that will fit in avail_out: */\n    have = s.strm.avail_out - have;\n    left = s.strstart - s.block_start;  /* bytes left in window */\n    if (len > left + s.strm.avail_in) {\n      len = left + s.strm.avail_in;   /* limit len to the input */\n    }\n    if (len > have) {\n      len = have;             /* limit len to the output */\n    }\n\n    /* If the stored block would be less than min_block in length, or if\n     * unable to copy all of the available input when flushing, then try\n     * copying to the window and the pending buffer instead. Also don't\n     * write an empty block when flushing -- deflate() does that.\n     */\n    if (len < min_block && ((len === 0 && flush !== Z_FINISH$3) ||\n                        flush === Z_NO_FLUSH$2 ||\n                        len !== left + s.strm.avail_in)) {\n      break;\n    }\n\n    /* Make a dummy stored block in pending to get the header bytes,\n     * including any pending bits. This also updates the debugging counts.\n     */\n    last = flush === Z_FINISH$3 && len === left + s.strm.avail_in ? 1 : 0;\n    _tr_stored_block(s, 0, 0, last);\n\n    /* Replace the lengths in the dummy stored block with len. */\n    s.pending_buf[s.pending - 4] = len;\n    s.pending_buf[s.pending - 3] = len >> 8;\n    s.pending_buf[s.pending - 2] = ~len;\n    s.pending_buf[s.pending - 1] = ~len >> 8;\n\n    /* Write the stored block header bytes. */\n    flush_pending(s.strm);\n\n//#ifdef ZLIB_DEBUG\n//    /* Update debugging counts for the data about to be copied. */\n//    s->compressed_len += len << 3;\n//    s->bits_sent += len << 3;\n//#endif\n\n    /* Copy uncompressed bytes from the window to next_out. */\n    if (left) {\n      if (left > len) {\n        left = len;\n      }\n      //zmemcpy(s->strm->next_out, s->window + s->block_start, left);\n      s.strm.output.set(s.window.subarray(s.block_start, s.block_start + left), s.strm.next_out);\n      s.strm.next_out += left;\n      s.strm.avail_out -= left;\n      s.strm.total_out += left;\n      s.block_start += left;\n      len -= left;\n    }\n\n    /* Copy uncompressed bytes directly from next_in to next_out, updating\n     * the check value.\n     */\n    if (len) {\n      read_buf(s.strm, s.strm.output, s.strm.next_out, len);\n      s.strm.next_out += len;\n      s.strm.avail_out -= len;\n      s.strm.total_out += len;\n    }\n  } while (last === 0);\n\n  /* Update the sliding window with the last s->w_size bytes of the copied\n   * data, or append all of the copied data to the existing window if less\n   * than s->w_size bytes were copied. Also update the number of bytes to\n   * insert in the hash tables, in the event that deflateParams() switches to\n   * a non-zero compression level.\n   */\n  used -= s.strm.avail_in;    /* number of input bytes directly copied */\n  if (used) {\n    /* If any input was used, then no unused input remains in the window,\n     * therefore s->block_start == s->strstart.\n     */\n    if (used >= s.w_size) {  /* supplant the previous history */\n      s.matches = 2;     /* clear hash */\n      //zmemcpy(s->window, s->strm->next_in - s->w_size, s->w_size);\n      s.window.set(s.strm.input.subarray(s.strm.next_in - s.w_size, s.strm.next_in), 0);\n      s.strstart = s.w_size;\n      s.insert = s.strstart;\n    }\n    else {\n      if (s.window_size - s.strstart <= used) {\n        /* Slide the window down. */\n        s.strstart -= s.w_size;\n        //zmemcpy(s->window, s->window + s->w_size, s->strstart);\n        s.window.set(s.window.subarray(s.w_size, s.w_size + s.strstart), 0);\n        if (s.matches < 2) {\n          s.matches++;   /* add a pending slide_hash() */\n        }\n        if (s.insert > s.strstart) {\n          s.insert = s.strstart;\n        }\n      }\n      //zmemcpy(s->window + s->strstart, s->strm->next_in - used, used);\n      s.window.set(s.strm.input.subarray(s.strm.next_in - used, s.strm.next_in), s.strstart);\n      s.strstart += used;\n      s.insert += used > s.w_size - s.insert ? s.w_size - s.insert : used;\n    }\n    s.block_start = s.strstart;\n  }\n  if (s.high_water < s.strstart) {\n    s.high_water = s.strstart;\n  }\n\n  /* If the last block was written to next_out, then done. */\n  if (last) {\n    return BS_FINISH_DONE;\n  }\n\n  /* If flushing and all input has been consumed, then done. */\n  if (flush !== Z_NO_FLUSH$2 && flush !== Z_FINISH$3 &&\n    s.strm.avail_in === 0 && s.strstart === s.block_start) {\n    return BS_BLOCK_DONE;\n  }\n\n  /* Fill the window with any remaining input. */\n  have = s.window_size - s.strstart;\n  if (s.strm.avail_in > have && s.block_start >= s.w_size) {\n    /* Slide the window down. */\n    s.block_start -= s.w_size;\n    s.strstart -= s.w_size;\n    //zmemcpy(s->window, s->window + s->w_size, s->strstart);\n    s.window.set(s.window.subarray(s.w_size, s.w_size + s.strstart), 0);\n    if (s.matches < 2) {\n      s.matches++;       /* add a pending slide_hash() */\n    }\n    have += s.w_size;      /* more space now */\n    if (s.insert > s.strstart) {\n      s.insert = s.strstart;\n    }\n  }\n  if (have > s.strm.avail_in) {\n    have = s.strm.avail_in;\n  }\n  if (have) {\n    read_buf(s.strm, s.window, s.strstart, have);\n    s.strstart += have;\n    s.insert += have > s.w_size - s.insert ? s.w_size - s.insert : have;\n  }\n  if (s.high_water < s.strstart) {\n    s.high_water = s.strstart;\n  }\n\n  /* There was not enough avail_out to write a complete worthy or flushed\n   * stored block to next_out. Write a stored block to pending instead, if we\n   * have enough input for a worthy block, or if flushing and there is enough\n   * room for the remaining input as a stored block in the pending buffer.\n   */\n  have = (s.bi_valid + 42) >> 3;     /* number of header bytes */\n    /* maximum stored block length that will fit in pending: */\n  have = s.pending_buf_size - have > 65535/* MAX_STORED */ ? 65535/* MAX_STORED */ : s.pending_buf_size - have;\n  min_block = have > s.w_size ? s.w_size : have;\n  left = s.strstart - s.block_start;\n  if (left >= min_block ||\n     ((left || flush === Z_FINISH$3) && flush !== Z_NO_FLUSH$2 &&\n     s.strm.avail_in === 0 && left <= have)) {\n    len = left > have ? have : left;\n    last = flush === Z_FINISH$3 && s.strm.avail_in === 0 &&\n         len === left ? 1 : 0;\n    _tr_stored_block(s, s.block_start, len, last);\n    s.block_start += len;\n    flush_pending(s.strm);\n  }\n\n  /* We've done all we can with the available input and output. */\n  return last ? BS_FINISH_STARTED : BS_NEED_MORE;\n};\n\n\n/* ===========================================================================\n * Compress as much as possible from the input stream, return the current\n * block state.\n * This function does not perform lazy evaluation of matches and inserts\n * new strings in the dictionary only for unmatched strings or for short\n * matches. It is used only for the fast compression options.\n */\nconst deflate_fast = (s, flush) => {\n\n  let hash_head;        /* head of the hash chain */\n  let bflush;           /* set if current block must be flushed */\n\n  for (;;) {\n    /* Make sure that we always have enough lookahead, except\n     * at the end of the input file. We need MAX_MATCH bytes\n     * for the next match, plus MIN_MATCH bytes to insert the\n     * string following the next match.\n     */\n    if (s.lookahead < MIN_LOOKAHEAD) {\n      fill_window(s);\n      if (s.lookahead < MIN_LOOKAHEAD && flush === Z_NO_FLUSH$2) {\n        return BS_NEED_MORE;\n      }\n      if (s.lookahead === 0) {\n        break; /* flush the current block */\n      }\n    }\n\n    /* Insert the string window[strstart .. strstart+2] in the\n     * dictionary, and set hash_head to the head of the hash chain:\n     */\n    hash_head = 0/*NIL*/;\n    if (s.lookahead >= MIN_MATCH) {\n      /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n      s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n      hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n      s.head[s.ins_h] = s.strstart;\n      /***/\n    }\n\n    /* Find the longest match, discarding those <= prev_length.\n     * At this point we have always match_length < MIN_MATCH\n     */\n    if (hash_head !== 0/*NIL*/ && ((s.strstart - hash_head) <= (s.w_size - MIN_LOOKAHEAD))) {\n      /* To simplify the code, we prevent matches with the string\n       * of window index 0 (in particular we have to avoid a match\n       * of the string with itself at the start of the input file).\n       */\n      s.match_length = longest_match(s, hash_head);\n      /* longest_match() sets match_start */\n    }\n    if (s.match_length >= MIN_MATCH) {\n      // check_match(s, s.strstart, s.match_start, s.match_length); // for debug only\n\n      /*** _tr_tally_dist(s, s.strstart - s.match_start,\n                     s.match_length - MIN_MATCH, bflush); ***/\n      bflush = _tr_tally(s, s.strstart - s.match_start, s.match_length - MIN_MATCH);\n\n      s.lookahead -= s.match_length;\n\n      /* Insert new strings in the hash table only if the match length\n       * is not too large. This saves time but degrades compression.\n       */\n      if (s.match_length <= s.max_lazy_match/*max_insert_length*/ && s.lookahead >= MIN_MATCH) {\n        s.match_length--; /* string at strstart already in table */\n        do {\n          s.strstart++;\n          /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n          s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n          hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n          s.head[s.ins_h] = s.strstart;\n          /***/\n          /* strstart never exceeds WSIZE-MAX_MATCH, so there are\n           * always MIN_MATCH bytes ahead.\n           */\n        } while (--s.match_length !== 0);\n        s.strstart++;\n      } else\n      {\n        s.strstart += s.match_length;\n        s.match_length = 0;\n        s.ins_h = s.window[s.strstart];\n        /* UPDATE_HASH(s, s.ins_h, s.window[s.strstart+1]); */\n        s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + 1]);\n\n//#if MIN_MATCH != 3\n//                Call UPDATE_HASH() MIN_MATCH-3 more times\n//#endif\n        /* If lookahead < MIN_MATCH, ins_h is garbage, but it does not\n         * matter since it will be recomputed at next deflate call.\n         */\n      }\n    } else {\n      /* No match, output a literal byte */\n      //Tracevv((stderr,\"%c\", s.window[s.strstart]));\n      /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\n      bflush = _tr_tally(s, 0, s.window[s.strstart]);\n\n      s.lookahead--;\n      s.strstart++;\n    }\n    if (bflush) {\n      /*** FLUSH_BLOCK(s, 0); ***/\n      flush_block_only(s, false);\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n      /***/\n    }\n  }\n  s.insert = ((s.strstart < (MIN_MATCH - 1)) ? s.strstart : MIN_MATCH - 1);\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n  return BS_BLOCK_DONE;\n};\n\n/* ===========================================================================\n * Same as above, but achieves better compression. We use a lazy\n * evaluation for matches: a match is finally adopted only if there is\n * no better match at the next window position.\n */\nconst deflate_slow = (s, flush) => {\n\n  let hash_head;          /* head of hash chain */\n  let bflush;              /* set if current block must be flushed */\n\n  let max_insert;\n\n  /* Process the input block. */\n  for (;;) {\n    /* Make sure that we always have enough lookahead, except\n     * at the end of the input file. We need MAX_MATCH bytes\n     * for the next match, plus MIN_MATCH bytes to insert the\n     * string following the next match.\n     */\n    if (s.lookahead < MIN_LOOKAHEAD) {\n      fill_window(s);\n      if (s.lookahead < MIN_LOOKAHEAD && flush === Z_NO_FLUSH$2) {\n        return BS_NEED_MORE;\n      }\n      if (s.lookahead === 0) { break; } /* flush the current block */\n    }\n\n    /* Insert the string window[strstart .. strstart+2] in the\n     * dictionary, and set hash_head to the head of the hash chain:\n     */\n    hash_head = 0/*NIL*/;\n    if (s.lookahead >= MIN_MATCH) {\n      /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n      s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n      hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n      s.head[s.ins_h] = s.strstart;\n      /***/\n    }\n\n    /* Find the longest match, discarding those <= prev_length.\n     */\n    s.prev_length = s.match_length;\n    s.prev_match = s.match_start;\n    s.match_length = MIN_MATCH - 1;\n\n    if (hash_head !== 0/*NIL*/ && s.prev_length < s.max_lazy_match &&\n        s.strstart - hash_head <= (s.w_size - MIN_LOOKAHEAD)/*MAX_DIST(s)*/) {\n      /* To simplify the code, we prevent matches with the string\n       * of window index 0 (in particular we have to avoid a match\n       * of the string with itself at the start of the input file).\n       */\n      s.match_length = longest_match(s, hash_head);\n      /* longest_match() sets match_start */\n\n      if (s.match_length <= 5 &&\n         (s.strategy === Z_FILTERED || (s.match_length === MIN_MATCH && s.strstart - s.match_start > 4096/*TOO_FAR*/))) {\n\n        /* If prev_match is also MIN_MATCH, match_start is garbage\n         * but we will ignore the current match anyway.\n         */\n        s.match_length = MIN_MATCH - 1;\n      }\n    }\n    /* If there was a match at the previous step and the current\n     * match is not better, output the previous match:\n     */\n    if (s.prev_length >= MIN_MATCH && s.match_length <= s.prev_length) {\n      max_insert = s.strstart + s.lookahead - MIN_MATCH;\n      /* Do not insert strings in hash table beyond this. */\n\n      //check_match(s, s.strstart-1, s.prev_match, s.prev_length);\n\n      /***_tr_tally_dist(s, s.strstart - 1 - s.prev_match,\n                     s.prev_length - MIN_MATCH, bflush);***/\n      bflush = _tr_tally(s, s.strstart - 1 - s.prev_match, s.prev_length - MIN_MATCH);\n      /* Insert in hash table all strings up to the end of the match.\n       * strstart-1 and strstart are already inserted. If there is not\n       * enough lookahead, the last two strings are not inserted in\n       * the hash table.\n       */\n      s.lookahead -= s.prev_length - 1;\n      s.prev_length -= 2;\n      do {\n        if (++s.strstart <= max_insert) {\n          /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n          s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n          hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n          s.head[s.ins_h] = s.strstart;\n          /***/\n        }\n      } while (--s.prev_length !== 0);\n      s.match_available = 0;\n      s.match_length = MIN_MATCH - 1;\n      s.strstart++;\n\n      if (bflush) {\n        /*** FLUSH_BLOCK(s, 0); ***/\n        flush_block_only(s, false);\n        if (s.strm.avail_out === 0) {\n          return BS_NEED_MORE;\n        }\n        /***/\n      }\n\n    } else if (s.match_available) {\n      /* If there was no match at the previous position, output a\n       * single literal. If there was a match but the current match\n       * is longer, truncate the previous match to a single literal.\n       */\n      //Tracevv((stderr,\"%c\", s->window[s->strstart-1]));\n      /*** _tr_tally_lit(s, s.window[s.strstart-1], bflush); ***/\n      bflush = _tr_tally(s, 0, s.window[s.strstart - 1]);\n\n      if (bflush) {\n        /*** FLUSH_BLOCK_ONLY(s, 0) ***/\n        flush_block_only(s, false);\n        /***/\n      }\n      s.strstart++;\n      s.lookahead--;\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n    } else {\n      /* There is no previous match to compare with, wait for\n       * the next step to decide.\n       */\n      s.match_available = 1;\n      s.strstart++;\n      s.lookahead--;\n    }\n  }\n  //Assert (flush != Z_NO_FLUSH, \"no flush?\");\n  if (s.match_available) {\n    //Tracevv((stderr,\"%c\", s->window[s->strstart-1]));\n    /*** _tr_tally_lit(s, s.window[s.strstart-1], bflush); ***/\n    bflush = _tr_tally(s, 0, s.window[s.strstart - 1]);\n\n    s.match_available = 0;\n  }\n  s.insert = s.strstart < MIN_MATCH - 1 ? s.strstart : MIN_MATCH - 1;\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n\n  return BS_BLOCK_DONE;\n};\n\n\n/* ===========================================================================\n * For Z_RLE, simply look for runs of bytes, generate matches only of distance\n * one.  Do not maintain a hash table.  (It will be regenerated if this run of\n * deflate switches away from Z_RLE.)\n */\nconst deflate_rle = (s, flush) => {\n\n  let bflush;            /* set if current block must be flushed */\n  let prev;              /* byte at distance one to match */\n  let scan, strend;      /* scan goes up to strend for length of run */\n\n  const _win = s.window;\n\n  for (;;) {\n    /* Make sure that we always have enough lookahead, except\n     * at the end of the input file. We need MAX_MATCH bytes\n     * for the longest run, plus one for the unrolled loop.\n     */\n    if (s.lookahead <= MAX_MATCH) {\n      fill_window(s);\n      if (s.lookahead <= MAX_MATCH && flush === Z_NO_FLUSH$2) {\n        return BS_NEED_MORE;\n      }\n      if (s.lookahead === 0) { break; } /* flush the current block */\n    }\n\n    /* See how many times the previous byte repeats */\n    s.match_length = 0;\n    if (s.lookahead >= MIN_MATCH && s.strstart > 0) {\n      scan = s.strstart - 1;\n      prev = _win[scan];\n      if (prev === _win[++scan] && prev === _win[++scan] && prev === _win[++scan]) {\n        strend = s.strstart + MAX_MATCH;\n        do {\n          /*jshint noempty:false*/\n        } while (prev === _win[++scan] && prev === _win[++scan] &&\n                 prev === _win[++scan] && prev === _win[++scan] &&\n                 prev === _win[++scan] && prev === _win[++scan] &&\n                 prev === _win[++scan] && prev === _win[++scan] &&\n                 scan < strend);\n        s.match_length = MAX_MATCH - (strend - scan);\n        if (s.match_length > s.lookahead) {\n          s.match_length = s.lookahead;\n        }\n      }\n      //Assert(scan <= s->window+(uInt)(s->window_size-1), \"wild scan\");\n    }\n\n    /* Emit match if have run of MIN_MATCH or longer, else emit literal */\n    if (s.match_length >= MIN_MATCH) {\n      //check_match(s, s.strstart, s.strstart - 1, s.match_length);\n\n      /*** _tr_tally_dist(s, 1, s.match_length - MIN_MATCH, bflush); ***/\n      bflush = _tr_tally(s, 1, s.match_length - MIN_MATCH);\n\n      s.lookahead -= s.match_length;\n      s.strstart += s.match_length;\n      s.match_length = 0;\n    } else {\n      /* No match, output a literal byte */\n      //Tracevv((stderr,\"%c\", s->window[s->strstart]));\n      /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\n      bflush = _tr_tally(s, 0, s.window[s.strstart]);\n\n      s.lookahead--;\n      s.strstart++;\n    }\n    if (bflush) {\n      /*** FLUSH_BLOCK(s, 0); ***/\n      flush_block_only(s, false);\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n      /***/\n    }\n  }\n  s.insert = 0;\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n  return BS_BLOCK_DONE;\n};\n\n/* ===========================================================================\n * For Z_HUFFMAN_ONLY, do not look for matches.  Do not maintain a hash table.\n * (It will be regenerated if this run of deflate switches away from Huffman.)\n */\nconst deflate_huff = (s, flush) => {\n\n  let bflush;             /* set if current block must be flushed */\n\n  for (;;) {\n    /* Make sure that we have a literal to write. */\n    if (s.lookahead === 0) {\n      fill_window(s);\n      if (s.lookahead === 0) {\n        if (flush === Z_NO_FLUSH$2) {\n          return BS_NEED_MORE;\n        }\n        break;      /* flush the current block */\n      }\n    }\n\n    /* Output a literal byte */\n    s.match_length = 0;\n    //Tracevv((stderr,\"%c\", s->window[s->strstart]));\n    /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\n    bflush = _tr_tally(s, 0, s.window[s.strstart]);\n    s.lookahead--;\n    s.strstart++;\n    if (bflush) {\n      /*** FLUSH_BLOCK(s, 0); ***/\n      flush_block_only(s, false);\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n      /***/\n    }\n  }\n  s.insert = 0;\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n  return BS_BLOCK_DONE;\n};\n\n/* Values for max_lazy_match, good_match and max_chain_length, depending on\n * the desired pack level (0..9). The values given below have been tuned to\n * exclude worst case performance for pathological files. Better values may be\n * found for specific files.\n */\nfunction Config(good_length, max_lazy, nice_length, max_chain, func) {\n\n  this.good_length = good_length;\n  this.max_lazy = max_lazy;\n  this.nice_length = nice_length;\n  this.max_chain = max_chain;\n  this.func = func;\n}\n\nconst configuration_table = [\n  /*      good lazy nice chain */\n  new Config(0, 0, 0, 0, deflate_stored),          /* 0 store only */\n  new Config(4, 4, 8, 4, deflate_fast),            /* 1 max speed, no lazy matches */\n  new Config(4, 5, 16, 8, deflate_fast),           /* 2 */\n  new Config(4, 6, 32, 32, deflate_fast),          /* 3 */\n\n  new Config(4, 4, 16, 16, deflate_slow),          /* 4 lazy matches */\n  new Config(8, 16, 32, 32, deflate_slow),         /* 5 */\n  new Config(8, 16, 128, 128, deflate_slow),       /* 6 */\n  new Config(8, 32, 128, 256, deflate_slow),       /* 7 */\n  new Config(32, 128, 258, 1024, deflate_slow),    /* 8 */\n  new Config(32, 258, 258, 4096, deflate_slow)     /* 9 max compression */\n];\n\n\n/* ===========================================================================\n * Initialize the \"longest match\" routines for a new zlib stream\n */\nconst lm_init = (s) => {\n\n  s.window_size = 2 * s.w_size;\n\n  /*** CLEAR_HASH(s); ***/\n  zero(s.head); // Fill with NIL (= 0);\n\n  /* Set the default configuration parameters:\n   */\n  s.max_lazy_match = configuration_table[s.level].max_lazy;\n  s.good_match = configuration_table[s.level].good_length;\n  s.nice_match = configuration_table[s.level].nice_length;\n  s.max_chain_length = configuration_table[s.level].max_chain;\n\n  s.strstart = 0;\n  s.block_start = 0;\n  s.lookahead = 0;\n  s.insert = 0;\n  s.match_length = s.prev_length = MIN_MATCH - 1;\n  s.match_available = 0;\n  s.ins_h = 0;\n};\n\n\nfunction DeflateState() {\n  this.strm = null;            /* pointer back to this zlib stream */\n  this.status = 0;            /* as the name implies */\n  this.pending_buf = null;      /* output still pending */\n  this.pending_buf_size = 0;  /* size of pending_buf */\n  this.pending_out = 0;       /* next pending byte to output to the stream */\n  this.pending = 0;           /* nb of bytes in the pending buffer */\n  this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip */\n  this.gzhead = null;         /* gzip header information to write */\n  this.gzindex = 0;           /* where in extra, name, or comment */\n  this.method = Z_DEFLATED$2; /* can only be DEFLATED */\n  this.last_flush = -1;   /* value of flush param for previous deflate call */\n\n  this.w_size = 0;  /* LZ77 window size (32K by default) */\n  this.w_bits = 0;  /* log2(w_size)  (8..16) */\n  this.w_mask = 0;  /* w_size - 1 */\n\n  this.window = null;\n  /* Sliding window. Input bytes are read into the second half of the window,\n   * and move to the first half later to keep a dictionary of at least wSize\n   * bytes. With this organization, matches are limited to a distance of\n   * wSize-MAX_MATCH bytes, but this ensures that IO is always\n   * performed with a length multiple of the block size.\n   */\n\n  this.window_size = 0;\n  /* Actual size of window: 2*wSize, except when the user input buffer\n   * is directly used as sliding window.\n   */\n\n  this.prev = null;\n  /* Link to older string with same hash index. To limit the size of this\n   * array to 64K, this link is maintained only for the last 32K strings.\n   * An index in this array is thus a window index modulo 32K.\n   */\n\n  this.head = null;   /* Heads of the hash chains or NIL. */\n\n  this.ins_h = 0;       /* hash index of string to be inserted */\n  this.hash_size = 0;   /* number of elements in hash table */\n  this.hash_bits = 0;   /* log2(hash_size) */\n  this.hash_mask = 0;   /* hash_size-1 */\n\n  this.hash_shift = 0;\n  /* Number of bits by which ins_h must be shifted at each input\n   * step. It must be such that after MIN_MATCH steps, the oldest\n   * byte no longer takes part in the hash key, that is:\n   *   hash_shift * MIN_MATCH >= hash_bits\n   */\n\n  this.block_start = 0;\n  /* Window position at the beginning of the current output block. Gets\n   * negative when the window is moved backwards.\n   */\n\n  this.match_length = 0;      /* length of best match */\n  this.prev_match = 0;        /* previous match */\n  this.match_available = 0;   /* set if previous match exists */\n  this.strstart = 0;          /* start of string to insert */\n  this.match_start = 0;       /* start of matching string */\n  this.lookahead = 0;         /* number of valid bytes ahead in window */\n\n  this.prev_length = 0;\n  /* Length of the best match at previous step. Matches not greater than this\n   * are discarded. This is used in the lazy match evaluation.\n   */\n\n  this.max_chain_length = 0;\n  /* To speed up deflation, hash chains are never searched beyond this\n   * length.  A higher limit improves compression ratio but degrades the\n   * speed.\n   */\n\n  this.max_lazy_match = 0;\n  /* Attempt to find a better match only when the current match is strictly\n   * smaller than this value. This mechanism is used only for compression\n   * levels >= 4.\n   */\n  // That's alias to max_lazy_match, don't use directly\n  //this.max_insert_length = 0;\n  /* Insert new strings in the hash table only if the match length is not\n   * greater than this length. This saves time but degrades compression.\n   * max_insert_length is used only for compression levels <= 3.\n   */\n\n  this.level = 0;     /* compression level (1..9) */\n  this.strategy = 0;  /* favor or force Huffman coding*/\n\n  this.good_match = 0;\n  /* Use a faster search when the previous match is longer than this */\n\n  this.nice_match = 0; /* Stop searching when current match exceeds this */\n\n              /* used by trees.c: */\n\n  /* Didn't use ct_data typedef below to suppress compiler warning */\n\n  // struct ct_data_s dyn_ltree[HEAP_SIZE];   /* literal and length tree */\n  // struct ct_data_s dyn_dtree[2*D_CODES+1]; /* distance tree */\n  // struct ct_data_s bl_tree[2*BL_CODES+1];  /* Huffman tree for bit lengths */\n\n  // Use flat array of DOUBLE size, with interleaved fata,\n  // because JS does not support effective\n  this.dyn_ltree  = new Uint16Array(HEAP_SIZE * 2);\n  this.dyn_dtree  = new Uint16Array((2 * D_CODES + 1) * 2);\n  this.bl_tree    = new Uint16Array((2 * BL_CODES + 1) * 2);\n  zero(this.dyn_ltree);\n  zero(this.dyn_dtree);\n  zero(this.bl_tree);\n\n  this.l_desc   = null;         /* desc. for literal tree */\n  this.d_desc   = null;         /* desc. for distance tree */\n  this.bl_desc  = null;         /* desc. for bit length tree */\n\n  //ush bl_count[MAX_BITS+1];\n  this.bl_count = new Uint16Array(MAX_BITS + 1);\n  /* number of codes at each bit length for an optimal tree */\n\n  //int heap[2*L_CODES+1];      /* heap used to build the Huffman trees */\n  this.heap = new Uint16Array(2 * L_CODES + 1);  /* heap used to build the Huffman trees */\n  zero(this.heap);\n\n  this.heap_len = 0;               /* number of elements in the heap */\n  this.heap_max = 0;               /* element of largest frequency */\n  /* The sons of heap[n] are heap[2*n] and heap[2*n+1]. heap[0] is not used.\n   * The same heap array is used to build all trees.\n   */\n\n  this.depth = new Uint16Array(2 * L_CODES + 1); //uch depth[2*L_CODES+1];\n  zero(this.depth);\n  /* Depth of each subtree used as tie breaker for trees of equal frequency\n   */\n\n  this.sym_buf = 0;        /* buffer for distances and literals/lengths */\n\n  this.lit_bufsize = 0;\n  /* Size of match buffer for literals/lengths.  There are 4 reasons for\n   * limiting lit_bufsize to 64K:\n   *   - frequencies can be kept in 16 bit counters\n   *   - if compression is not successful for the first block, all input\n   *     data is still in the window so we can still emit a stored block even\n   *     when input comes from standard input.  (This can also be done for\n   *     all blocks if lit_bufsize is not greater than 32K.)\n   *   - if compression is not successful for a file smaller than 64K, we can\n   *     even emit a stored file instead of a stored block (saving 5 bytes).\n   *     This is applicable only for zip (not gzip or zlib).\n   *   - creating new Huffman trees less frequently may not provide fast\n   *     adaptation to changes in the input data statistics. (Take for\n   *     example a binary file with poorly compressible code followed by\n   *     a highly compressible string table.) Smaller buffer sizes give\n   *     fast adaptation but have of course the overhead of transmitting\n   *     trees more frequently.\n   *   - I can't count above 4\n   */\n\n  this.sym_next = 0;      /* running index in sym_buf */\n  this.sym_end = 0;       /* symbol table full when sym_next reaches this */\n\n  this.opt_len = 0;       /* bit length of current block with optimal trees */\n  this.static_len = 0;    /* bit length of current block with static trees */\n  this.matches = 0;       /* number of string matches in current block */\n  this.insert = 0;        /* bytes at end of window left to insert */\n\n\n  this.bi_buf = 0;\n  /* Output buffer. bits are inserted starting at the bottom (least\n   * significant bits).\n   */\n  this.bi_valid = 0;\n  /* Number of valid bits in bi_buf.  All bits above the last valid bit\n   * are always zero.\n   */\n\n  // Used for window memory init. We safely ignore it for JS. That makes\n  // sense only for pointers and memory check tools.\n  //this.high_water = 0;\n  /* High water mark offset in window for initialized bytes -- bytes above\n   * this are set to zero in order to avoid memory check warnings when\n   * longest match routines access bytes past the input.  This is then\n   * updated to the new high water mark.\n   */\n}\n\n\n/* =========================================================================\n * Check for a valid deflate stream state. Return 0 if ok, 1 if not.\n */\nconst deflateStateCheck = (strm) => {\n\n  if (!strm) {\n    return 1;\n  }\n  const s = strm.state;\n  if (!s || s.strm !== strm || (s.status !== INIT_STATE &&\n//#ifdef GZIP\n                                s.status !== GZIP_STATE &&\n//#endif\n                                s.status !== EXTRA_STATE &&\n                                s.status !== NAME_STATE &&\n                                s.status !== COMMENT_STATE &&\n                                s.status !== HCRC_STATE &&\n                                s.status !== BUSY_STATE &&\n                                s.status !== FINISH_STATE)) {\n    return 1;\n  }\n  return 0;\n};\n\n\nconst deflateResetKeep = (strm) => {\n\n  if (deflateStateCheck(strm)) {\n    return err(strm, Z_STREAM_ERROR$2);\n  }\n\n  strm.total_in = strm.total_out = 0;\n  strm.data_type = Z_UNKNOWN;\n\n  const s = strm.state;\n  s.pending = 0;\n  s.pending_out = 0;\n\n  if (s.wrap < 0) {\n    s.wrap = -s.wrap;\n    /* was made negative by deflate(..., Z_FINISH); */\n  }\n  s.status =\n//#ifdef GZIP\n    s.wrap === 2 ? GZIP_STATE :\n//#endif\n    s.wrap ? INIT_STATE : BUSY_STATE;\n  strm.adler = (s.wrap === 2) ?\n    0  // crc32(0, Z_NULL, 0)\n  :\n    1; // adler32(0, Z_NULL, 0)\n  s.last_flush = -2;\n  _tr_init(s);\n  return Z_OK$3;\n};\n\n\nconst deflateReset = (strm) => {\n\n  const ret = deflateResetKeep(strm);\n  if (ret === Z_OK$3) {\n    lm_init(strm.state);\n  }\n  return ret;\n};\n\n\nconst deflateSetHeader = (strm, head) => {\n\n  if (deflateStateCheck(strm) || strm.state.wrap !== 2) {\n    return Z_STREAM_ERROR$2;\n  }\n  strm.state.gzhead = head;\n  return Z_OK$3;\n};\n\n\nconst deflateInit2 = (strm, level, method, windowBits, memLevel, strategy) => {\n\n  if (!strm) { // === Z_NULL\n    return Z_STREAM_ERROR$2;\n  }\n  let wrap = 1;\n\n  if (level === Z_DEFAULT_COMPRESSION$1) {\n    level = 6;\n  }\n\n  if (windowBits < 0) { /* suppress zlib wrapper */\n    wrap = 0;\n    windowBits = -windowBits;\n  }\n\n  else if (windowBits > 15) {\n    wrap = 2;           /* write gzip wrapper instead */\n    windowBits -= 16;\n  }\n\n\n  if (memLevel < 1 || memLevel > MAX_MEM_LEVEL || method !== Z_DEFLATED$2 ||\n    windowBits < 8 || windowBits > 15 || level < 0 || level > 9 ||\n    strategy < 0 || strategy > Z_FIXED || (windowBits === 8 && wrap !== 1)) {\n    return err(strm, Z_STREAM_ERROR$2);\n  }\n\n\n  if (windowBits === 8) {\n    windowBits = 9;\n  }\n  /* until 256-byte window bug fixed */\n\n  const s = new DeflateState();\n\n  strm.state = s;\n  s.strm = strm;\n  s.status = INIT_STATE;     /* to pass state test in deflateReset() */\n\n  s.wrap = wrap;\n  s.gzhead = null;\n  s.w_bits = windowBits;\n  s.w_size = 1 << s.w_bits;\n  s.w_mask = s.w_size - 1;\n\n  s.hash_bits = memLevel + 7;\n  s.hash_size = 1 << s.hash_bits;\n  s.hash_mask = s.hash_size - 1;\n  s.hash_shift = ~~((s.hash_bits + MIN_MATCH - 1) / MIN_MATCH);\n\n  s.window = new Uint8Array(s.w_size * 2);\n  s.head = new Uint16Array(s.hash_size);\n  s.prev = new Uint16Array(s.w_size);\n\n  // Don't need mem init magic for JS.\n  //s.high_water = 0;  /* nothing written to s->window yet */\n\n  s.lit_bufsize = 1 << (memLevel + 6); /* 16K elements by default */\n\n  /* We overlay pending_buf and sym_buf. This works since the average size\n   * for length/distance pairs over any compressed block is assured to be 31\n   * bits or less.\n   *\n   * Analysis: The longest fixed codes are a length code of 8 bits plus 5\n   * extra bits, for lengths 131 to 257. The longest fixed distance codes are\n   * 5 bits plus 13 extra bits, for distances 16385 to 32768. The longest\n   * possible fixed-codes length/distance pair is then 31 bits total.\n   *\n   * sym_buf starts one-fourth of the way into pending_buf. So there are\n   * three bytes in sym_buf for every four bytes in pending_buf. Each symbol\n   * in sym_buf is three bytes -- two for the distance and one for the\n   * literal/length. As each symbol is consumed, the pointer to the next\n   * sym_buf value to read moves forward three bytes. From that symbol, up to\n   * 31 bits are written to pending_buf. The closest the written pending_buf\n   * bits gets to the next sym_buf symbol to read is just before the last\n   * code is written. At that time, 31*(n-2) bits have been written, just\n   * after 24*(n-2) bits have been consumed from sym_buf. sym_buf starts at\n   * 8*n bits into pending_buf. (Note that the symbol buffer fills when n-1\n   * symbols are written.) The closest the writing gets to what is unread is\n   * then n+14 bits. Here n is lit_bufsize, which is 16384 by default, and\n   * can range from 128 to 32768.\n   *\n   * Therefore, at a minimum, there are 142 bits of space between what is\n   * written and what is read in the overlain buffers, so the symbols cannot\n   * be overwritten by the compressed data. That space is actually 139 bits,\n   * due to the three-bit fixed-code block header.\n   *\n   * That covers the case where either Z_FIXED is specified, forcing fixed\n   * codes, or when the use of fixed codes is chosen, because that choice\n   * results in a smaller compressed block than dynamic codes. That latter\n   * condition then assures that the above analysis also covers all dynamic\n   * blocks. A dynamic-code block will only be chosen to be emitted if it has\n   * fewer bits than a fixed-code block would for the same set of symbols.\n   * Therefore its average symbol length is assured to be less than 31. So\n   * the compressed data for a dynamic block also cannot overwrite the\n   * symbols from which it is being constructed.\n   */\n\n  s.pending_buf_size = s.lit_bufsize * 4;\n  s.pending_buf = new Uint8Array(s.pending_buf_size);\n\n  // It is offset from `s.pending_buf` (size is `s.lit_bufsize * 2`)\n  //s->sym_buf = s->pending_buf + s->lit_bufsize;\n  s.sym_buf = s.lit_bufsize;\n\n  //s->sym_end = (s->lit_bufsize - 1) * 3;\n  s.sym_end = (s.lit_bufsize - 1) * 3;\n  /* We avoid equality with lit_bufsize*3 because of wraparound at 64K\n   * on 16 bit machines and because stored blocks are restricted to\n   * 64K-1 bytes.\n   */\n\n  s.level = level;\n  s.strategy = strategy;\n  s.method = method;\n\n  return deflateReset(strm);\n};\n\nconst deflateInit = (strm, level) => {\n\n  return deflateInit2(strm, level, Z_DEFLATED$2, MAX_WBITS$1, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY$1);\n};\n\n\n/* ========================================================================= */\nconst deflate$2 = (strm, flush) => {\n\n  if (deflateStateCheck(strm) || flush > Z_BLOCK$1 || flush < 0) {\n    return strm ? err(strm, Z_STREAM_ERROR$2) : Z_STREAM_ERROR$2;\n  }\n\n  const s = strm.state;\n\n  if (!strm.output ||\n      (strm.avail_in !== 0 && !strm.input) ||\n      (s.status === FINISH_STATE && flush !== Z_FINISH$3)) {\n    return err(strm, (strm.avail_out === 0) ? Z_BUF_ERROR$1 : Z_STREAM_ERROR$2);\n  }\n\n  const old_flush = s.last_flush;\n  s.last_flush = flush;\n\n  /* Flush as much pending output as possible */\n  if (s.pending !== 0) {\n    flush_pending(strm);\n    if (strm.avail_out === 0) {\n      /* Since avail_out is 0, deflate will be called again with\n       * more output space, but possibly with both pending and\n       * avail_in equal to zero. There won't be anything to do,\n       * but this is not an error situation so make sure we\n       * return OK instead of BUF_ERROR at next call of deflate:\n       */\n      s.last_flush = -1;\n      return Z_OK$3;\n    }\n\n    /* Make sure there is something to do and avoid duplicate consecutive\n     * flushes. For repeated and useless calls with Z_FINISH, we keep\n     * returning Z_STREAM_END instead of Z_BUF_ERROR.\n     */\n  } else if (strm.avail_in === 0 && rank(flush) <= rank(old_flush) &&\n    flush !== Z_FINISH$3) {\n    return err(strm, Z_BUF_ERROR$1);\n  }\n\n  /* User must not provide more input after the first FINISH: */\n  if (s.status === FINISH_STATE && strm.avail_in !== 0) {\n    return err(strm, Z_BUF_ERROR$1);\n  }\n\n  /* Write the header */\n  if (s.status === INIT_STATE && s.wrap === 0) {\n    s.status = BUSY_STATE;\n  }\n  if (s.status === INIT_STATE) {\n    /* zlib header */\n    let header = (Z_DEFLATED$2 + ((s.w_bits - 8) << 4)) << 8;\n    let level_flags = -1;\n\n    if (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2) {\n      level_flags = 0;\n    } else if (s.level < 6) {\n      level_flags = 1;\n    } else if (s.level === 6) {\n      level_flags = 2;\n    } else {\n      level_flags = 3;\n    }\n    header |= (level_flags << 6);\n    if (s.strstart !== 0) { header |= PRESET_DICT; }\n    header += 31 - (header % 31);\n\n    putShortMSB(s, header);\n\n    /* Save the adler32 of the preset dictionary: */\n    if (s.strstart !== 0) {\n      putShortMSB(s, strm.adler >>> 16);\n      putShortMSB(s, strm.adler & 0xffff);\n    }\n    strm.adler = 1; // adler32(0L, Z_NULL, 0);\n    s.status = BUSY_STATE;\n\n    /* Compression must start with an empty pending buffer */\n    flush_pending(strm);\n    if (s.pending !== 0) {\n      s.last_flush = -1;\n      return Z_OK$3;\n    }\n  }\n//#ifdef GZIP\n  if (s.status === GZIP_STATE) {\n    /* gzip header */\n    strm.adler = 0;  //crc32(0L, Z_NULL, 0);\n    put_byte(s, 31);\n    put_byte(s, 139);\n    put_byte(s, 8);\n    if (!s.gzhead) { // s->gzhead == Z_NULL\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, s.level === 9 ? 2 :\n                  (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2 ?\n                   4 : 0));\n      put_byte(s, OS_CODE);\n      s.status = BUSY_STATE;\n\n      /* Compression must start with an empty pending buffer */\n      flush_pending(strm);\n      if (s.pending !== 0) {\n        s.last_flush = -1;\n        return Z_OK$3;\n      }\n    }\n    else {\n      put_byte(s, (s.gzhead.text ? 1 : 0) +\n                  (s.gzhead.hcrc ? 2 : 0) +\n                  (!s.gzhead.extra ? 0 : 4) +\n                  (!s.gzhead.name ? 0 : 8) +\n                  (!s.gzhead.comment ? 0 : 16)\n      );\n      put_byte(s, s.gzhead.time & 0xff);\n      put_byte(s, (s.gzhead.time >> 8) & 0xff);\n      put_byte(s, (s.gzhead.time >> 16) & 0xff);\n      put_byte(s, (s.gzhead.time >> 24) & 0xff);\n      put_byte(s, s.level === 9 ? 2 :\n                  (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2 ?\n                   4 : 0));\n      put_byte(s, s.gzhead.os & 0xff);\n      if (s.gzhead.extra && s.gzhead.extra.length) {\n        put_byte(s, s.gzhead.extra.length & 0xff);\n        put_byte(s, (s.gzhead.extra.length >> 8) & 0xff);\n      }\n      if (s.gzhead.hcrc) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending, 0);\n      }\n      s.gzindex = 0;\n      s.status = EXTRA_STATE;\n    }\n  }\n  if (s.status === EXTRA_STATE) {\n    if (s.gzhead.extra/* != Z_NULL*/) {\n      let beg = s.pending;   /* start of bytes to update crc */\n      let left = (s.gzhead.extra.length & 0xffff) - s.gzindex;\n      while (s.pending + left > s.pending_buf_size) {\n        let copy = s.pending_buf_size - s.pending;\n        // zmemcpy(s.pending_buf + s.pending,\n        //    s.gzhead.extra + s.gzindex, copy);\n        s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex, s.gzindex + copy), s.pending);\n        s.pending = s.pending_buf_size;\n        //--- HCRC_UPDATE(beg) ---//\n        if (s.gzhead.hcrc && s.pending > beg) {\n          strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n        }\n        //---//\n        s.gzindex += copy;\n        flush_pending(strm);\n        if (s.pending !== 0) {\n          s.last_flush = -1;\n          return Z_OK$3;\n        }\n        beg = 0;\n        left -= copy;\n      }\n      // JS specific: s.gzhead.extra may be TypedArray or Array for backward compatibility\n      //              TypedArray.slice and TypedArray.from don't exist in IE10-IE11\n      let gzhead_extra = new Uint8Array(s.gzhead.extra);\n      // zmemcpy(s->pending_buf + s->pending,\n      //     s->gzhead->extra + s->gzindex, left);\n      s.pending_buf.set(gzhead_extra.subarray(s.gzindex, s.gzindex + left), s.pending);\n      s.pending += left;\n      //--- HCRC_UPDATE(beg) ---//\n      if (s.gzhead.hcrc && s.pending > beg) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n      }\n      //---//\n      s.gzindex = 0;\n    }\n    s.status = NAME_STATE;\n  }\n  if (s.status === NAME_STATE) {\n    if (s.gzhead.name/* != Z_NULL*/) {\n      let beg = s.pending;   /* start of bytes to update crc */\n      let val;\n      do {\n        if (s.pending === s.pending_buf_size) {\n          //--- HCRC_UPDATE(beg) ---//\n          if (s.gzhead.hcrc && s.pending > beg) {\n            strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n          }\n          //---//\n          flush_pending(strm);\n          if (s.pending !== 0) {\n            s.last_flush = -1;\n            return Z_OK$3;\n          }\n          beg = 0;\n        }\n        // JS specific: little magic to add zero terminator to end of string\n        if (s.gzindex < s.gzhead.name.length) {\n          val = s.gzhead.name.charCodeAt(s.gzindex++) & 0xff;\n        } else {\n          val = 0;\n        }\n        put_byte(s, val);\n      } while (val !== 0);\n      //--- HCRC_UPDATE(beg) ---//\n      if (s.gzhead.hcrc && s.pending > beg) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n      }\n      //---//\n      s.gzindex = 0;\n    }\n    s.status = COMMENT_STATE;\n  }\n  if (s.status === COMMENT_STATE) {\n    if (s.gzhead.comment/* != Z_NULL*/) {\n      let beg = s.pending;   /* start of bytes to update crc */\n      let val;\n      do {\n        if (s.pending === s.pending_buf_size) {\n          //--- HCRC_UPDATE(beg) ---//\n          if (s.gzhead.hcrc && s.pending > beg) {\n            strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n          }\n          //---//\n          flush_pending(strm);\n          if (s.pending !== 0) {\n            s.last_flush = -1;\n            return Z_OK$3;\n          }\n          beg = 0;\n        }\n        // JS specific: little magic to add zero terminator to end of string\n        if (s.gzindex < s.gzhead.comment.length) {\n          val = s.gzhead.comment.charCodeAt(s.gzindex++) & 0xff;\n        } else {\n          val = 0;\n        }\n        put_byte(s, val);\n      } while (val !== 0);\n      //--- HCRC_UPDATE(beg) ---//\n      if (s.gzhead.hcrc && s.pending > beg) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n      }\n      //---//\n    }\n    s.status = HCRC_STATE;\n  }\n  if (s.status === HCRC_STATE) {\n    if (s.gzhead.hcrc) {\n      if (s.pending + 2 > s.pending_buf_size) {\n        flush_pending(strm);\n        if (s.pending !== 0) {\n          s.last_flush = -1;\n          return Z_OK$3;\n        }\n      }\n      put_byte(s, strm.adler & 0xff);\n      put_byte(s, (strm.adler >> 8) & 0xff);\n      strm.adler = 0; //crc32(0L, Z_NULL, 0);\n    }\n    s.status = BUSY_STATE;\n\n    /* Compression must start with an empty pending buffer */\n    flush_pending(strm);\n    if (s.pending !== 0) {\n      s.last_flush = -1;\n      return Z_OK$3;\n    }\n  }\n//#endif\n\n  /* Start a new block or continue the current one.\n   */\n  if (strm.avail_in !== 0 || s.lookahead !== 0 ||\n    (flush !== Z_NO_FLUSH$2 && s.status !== FINISH_STATE)) {\n    let bstate = s.level === 0 ? deflate_stored(s, flush) :\n                 s.strategy === Z_HUFFMAN_ONLY ? deflate_huff(s, flush) :\n                 s.strategy === Z_RLE ? deflate_rle(s, flush) :\n                 configuration_table[s.level].func(s, flush);\n\n    if (bstate === BS_FINISH_STARTED || bstate === BS_FINISH_DONE) {\n      s.status = FINISH_STATE;\n    }\n    if (bstate === BS_NEED_MORE || bstate === BS_FINISH_STARTED) {\n      if (strm.avail_out === 0) {\n        s.last_flush = -1;\n        /* avoid BUF_ERROR next call, see above */\n      }\n      return Z_OK$3;\n      /* If flush != Z_NO_FLUSH && avail_out == 0, the next call\n       * of deflate should use the same flush parameter to make sure\n       * that the flush is complete. So we don't have to output an\n       * empty block here, this will be done at next call. This also\n       * ensures that for a very small output buffer, we emit at most\n       * one empty block.\n       */\n    }\n    if (bstate === BS_BLOCK_DONE) {\n      if (flush === Z_PARTIAL_FLUSH) {\n        _tr_align(s);\n      }\n      else if (flush !== Z_BLOCK$1) { /* FULL_FLUSH or SYNC_FLUSH */\n\n        _tr_stored_block(s, 0, 0, false);\n        /* For a full flush, this empty block will be recognized\n         * as a special marker by inflate_sync().\n         */\n        if (flush === Z_FULL_FLUSH$1) {\n          /*** CLEAR_HASH(s); ***/             /* forget history */\n          zero(s.head); // Fill with NIL (= 0);\n\n          if (s.lookahead === 0) {\n            s.strstart = 0;\n            s.block_start = 0;\n            s.insert = 0;\n          }\n        }\n      }\n      flush_pending(strm);\n      if (strm.avail_out === 0) {\n        s.last_flush = -1; /* avoid BUF_ERROR at next call, see above */\n        return Z_OK$3;\n      }\n    }\n  }\n\n  if (flush !== Z_FINISH$3) { return Z_OK$3; }\n  if (s.wrap <= 0) { return Z_STREAM_END$3; }\n\n  /* Write the trailer */\n  if (s.wrap === 2) {\n    put_byte(s, strm.adler & 0xff);\n    put_byte(s, (strm.adler >> 8) & 0xff);\n    put_byte(s, (strm.adler >> 16) & 0xff);\n    put_byte(s, (strm.adler >> 24) & 0xff);\n    put_byte(s, strm.total_in & 0xff);\n    put_byte(s, (strm.total_in >> 8) & 0xff);\n    put_byte(s, (strm.total_in >> 16) & 0xff);\n    put_byte(s, (strm.total_in >> 24) & 0xff);\n  }\n  else\n  {\n    putShortMSB(s, strm.adler >>> 16);\n    putShortMSB(s, strm.adler & 0xffff);\n  }\n\n  flush_pending(strm);\n  /* If avail_out is zero, the application will call deflate again\n   * to flush the rest.\n   */\n  if (s.wrap > 0) { s.wrap = -s.wrap; }\n  /* write the trailer only once! */\n  return s.pending !== 0 ? Z_OK$3 : Z_STREAM_END$3;\n};\n\n\nconst deflateEnd = (strm) => {\n\n  if (deflateStateCheck(strm)) {\n    return Z_STREAM_ERROR$2;\n  }\n\n  const status = strm.state.status;\n\n  strm.state = null;\n\n  return status === BUSY_STATE ? err(strm, Z_DATA_ERROR$2) : Z_OK$3;\n};\n\n\n/* =========================================================================\n * Initializes the compression dictionary from the given byte\n * sequence without producing any compressed output.\n */\nconst deflateSetDictionary = (strm, dictionary) => {\n\n  let dictLength = dictionary.length;\n\n  if (deflateStateCheck(strm)) {\n    return Z_STREAM_ERROR$2;\n  }\n\n  const s = strm.state;\n  const wrap = s.wrap;\n\n  if (wrap === 2 || (wrap === 1 && s.status !== INIT_STATE) || s.lookahead) {\n    return Z_STREAM_ERROR$2;\n  }\n\n  /* when using zlib wrappers, compute Adler-32 for provided dictionary */\n  if (wrap === 1) {\n    /* adler32(strm->adler, dictionary, dictLength); */\n    strm.adler = adler32_1(strm.adler, dictionary, dictLength, 0);\n  }\n\n  s.wrap = 0;   /* avoid computing Adler-32 in read_buf */\n\n  /* if dictionary would fill window, just replace the history */\n  if (dictLength >= s.w_size) {\n    if (wrap === 0) {            /* already empty otherwise */\n      /*** CLEAR_HASH(s); ***/\n      zero(s.head); // Fill with NIL (= 0);\n      s.strstart = 0;\n      s.block_start = 0;\n      s.insert = 0;\n    }\n    /* use the tail */\n    // dictionary = dictionary.slice(dictLength - s.w_size);\n    let tmpDict = new Uint8Array(s.w_size);\n    tmpDict.set(dictionary.subarray(dictLength - s.w_size, dictLength), 0);\n    dictionary = tmpDict;\n    dictLength = s.w_size;\n  }\n  /* insert dictionary into window and hash */\n  const avail = strm.avail_in;\n  const next = strm.next_in;\n  const input = strm.input;\n  strm.avail_in = dictLength;\n  strm.next_in = 0;\n  strm.input = dictionary;\n  fill_window(s);\n  while (s.lookahead >= MIN_MATCH) {\n    let str = s.strstart;\n    let n = s.lookahead - (MIN_MATCH - 1);\n    do {\n      /* UPDATE_HASH(s, s->ins_h, s->window[str + MIN_MATCH-1]); */\n      s.ins_h = HASH(s, s.ins_h, s.window[str + MIN_MATCH - 1]);\n\n      s.prev[str & s.w_mask] = s.head[s.ins_h];\n\n      s.head[s.ins_h] = str;\n      str++;\n    } while (--n);\n    s.strstart = str;\n    s.lookahead = MIN_MATCH - 1;\n    fill_window(s);\n  }\n  s.strstart += s.lookahead;\n  s.block_start = s.strstart;\n  s.insert = s.lookahead;\n  s.lookahead = 0;\n  s.match_length = s.prev_length = MIN_MATCH - 1;\n  s.match_available = 0;\n  strm.next_in = next;\n  strm.input = input;\n  strm.avail_in = avail;\n  s.wrap = wrap;\n  return Z_OK$3;\n};\n\n\nvar deflateInit_1 = deflateInit;\nvar deflateInit2_1 = deflateInit2;\nvar deflateReset_1 = deflateReset;\nvar deflateResetKeep_1 = deflateResetKeep;\nvar deflateSetHeader_1 = deflateSetHeader;\nvar deflate_2$1 = deflate$2;\nvar deflateEnd_1 = deflateEnd;\nvar deflateSetDictionary_1 = deflateSetDictionary;\nvar deflateInfo = 'pako deflate (from Nodeca project)';\n\n/* Not implemented\nmodule.exports.deflateBound = deflateBound;\nmodule.exports.deflateCopy = deflateCopy;\nmodule.exports.deflateGetDictionary = deflateGetDictionary;\nmodule.exports.deflateParams = deflateParams;\nmodule.exports.deflatePending = deflatePending;\nmodule.exports.deflatePrime = deflatePrime;\nmodule.exports.deflateTune = deflateTune;\n*/\n\nvar deflate_1$2 = {\n\tdeflateInit: deflateInit_1,\n\tdeflateInit2: deflateInit2_1,\n\tdeflateReset: deflateReset_1,\n\tdeflateResetKeep: deflateResetKeep_1,\n\tdeflateSetHeader: deflateSetHeader_1,\n\tdeflate: deflate_2$1,\n\tdeflateEnd: deflateEnd_1,\n\tdeflateSetDictionary: deflateSetDictionary_1,\n\tdeflateInfo: deflateInfo\n};\n\nconst _has = (obj, key) => {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n};\n\nvar assign = function (obj /*from1, from2, from3, ...*/) {\n  const sources = Array.prototype.slice.call(arguments, 1);\n  while (sources.length) {\n    const source = sources.shift();\n    if (!source) { continue; }\n\n    if (typeof source !== 'object') {\n      throw new TypeError(source + 'must be non-object');\n    }\n\n    for (const p in source) {\n      if (_has(source, p)) {\n        obj[p] = source[p];\n      }\n    }\n  }\n\n  return obj;\n};\n\n\n// Join array of chunks to single array.\nvar flattenChunks = (chunks) => {\n  // calculate data length\n  let len = 0;\n\n  for (let i = 0, l = chunks.length; i < l; i++) {\n    len += chunks[i].length;\n  }\n\n  // join chunks\n  const result = new Uint8Array(len);\n\n  for (let i = 0, pos = 0, l = chunks.length; i < l; i++) {\n    let chunk = chunks[i];\n    result.set(chunk, pos);\n    pos += chunk.length;\n  }\n\n  return result;\n};\n\nvar common = {\n\tassign: assign,\n\tflattenChunks: flattenChunks\n};\n\n// String encode/decode helpers\n\n\n// Quick check if we can use fast array to bin string conversion\n//\n// - apply(Array) can fail on Android 2.2\n// - apply(Uint8Array) can fail on iOS 5.1 Safari\n//\nlet STR_APPLY_UIA_OK = true;\n\ntry { String.fromCharCode.apply(null, new Uint8Array(1)); } catch (__) { STR_APPLY_UIA_OK = false; }\n\n\n// Table with utf8 lengths (calculated by first byte of sequence)\n// Note, that 5 & 6-byte values and some 4-byte values can not be represented in JS,\n// because max possible codepoint is 0x10ffff\nconst _utf8len = new Uint8Array(256);\nfor (let q = 0; q < 256; q++) {\n  _utf8len[q] = (q >= 252 ? 6 : q >= 248 ? 5 : q >= 240 ? 4 : q >= 224 ? 3 : q >= 192 ? 2 : 1);\n}\n_utf8len[254] = _utf8len[254] = 1; // Invalid sequence start\n\n\n// convert string to array (typed, when possible)\nvar string2buf = (str) => {\n  if (typeof TextEncoder === 'function' && TextEncoder.prototype.encode) {\n    return new TextEncoder().encode(str);\n  }\n\n  let buf, c, c2, m_pos, i, str_len = str.length, buf_len = 0;\n\n  // count binary size\n  for (m_pos = 0; m_pos < str_len; m_pos++) {\n    c = str.charCodeAt(m_pos);\n    if ((c & 0xfc00) === 0xd800 && (m_pos + 1 < str_len)) {\n      c2 = str.charCodeAt(m_pos + 1);\n      if ((c2 & 0xfc00) === 0xdc00) {\n        c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\n        m_pos++;\n      }\n    }\n    buf_len += c < 0x80 ? 1 : c < 0x800 ? 2 : c < 0x10000 ? 3 : 4;\n  }\n\n  // allocate buffer\n  buf = new Uint8Array(buf_len);\n\n  // convert\n  for (i = 0, m_pos = 0; i < buf_len; m_pos++) {\n    c = str.charCodeAt(m_pos);\n    if ((c & 0xfc00) === 0xd800 && (m_pos + 1 < str_len)) {\n      c2 = str.charCodeAt(m_pos + 1);\n      if ((c2 & 0xfc00) === 0xdc00) {\n        c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\n        m_pos++;\n      }\n    }\n    if (c < 0x80) {\n      /* one byte */\n      buf[i++] = c;\n    } else if (c < 0x800) {\n      /* two bytes */\n      buf[i++] = 0xC0 | (c >>> 6);\n      buf[i++] = 0x80 | (c & 0x3f);\n    } else if (c < 0x10000) {\n      /* three bytes */\n      buf[i++] = 0xE0 | (c >>> 12);\n      buf[i++] = 0x80 | (c >>> 6 & 0x3f);\n      buf[i++] = 0x80 | (c & 0x3f);\n    } else {\n      /* four bytes */\n      buf[i++] = 0xf0 | (c >>> 18);\n      buf[i++] = 0x80 | (c >>> 12 & 0x3f);\n      buf[i++] = 0x80 | (c >>> 6 & 0x3f);\n      buf[i++] = 0x80 | (c & 0x3f);\n    }\n  }\n\n  return buf;\n};\n\n// Helper\nconst buf2binstring = (buf, len) => {\n  // On Chrome, the arguments in a function call that are allowed is `65534`.\n  // If the length of the buffer is smaller than that, we can use this optimization,\n  // otherwise we will take a slower path.\n  if (len < 65534) {\n    if (buf.subarray && STR_APPLY_UIA_OK) {\n      return String.fromCharCode.apply(null, buf.length === len ? buf : buf.subarray(0, len));\n    }\n  }\n\n  let result = '';\n  for (let i = 0; i < len; i++) {\n    result += String.fromCharCode(buf[i]);\n  }\n  return result;\n};\n\n\n// convert array to string\nvar buf2string = (buf, max) => {\n  const len = max || buf.length;\n\n  if (typeof TextDecoder === 'function' && TextDecoder.prototype.decode) {\n    return new TextDecoder().decode(buf.subarray(0, max));\n  }\n\n  let i, out;\n\n  // Reserve max possible length (2 words per char)\n  // NB: by unknown reasons, Array is significantly faster for\n  //     String.fromCharCode.apply than Uint16Array.\n  const utf16buf = new Array(len * 2);\n\n  for (out = 0, i = 0; i < len;) {\n    let c = buf[i++];\n    // quick process ascii\n    if (c < 0x80) { utf16buf[out++] = c; continue; }\n\n    let c_len = _utf8len[c];\n    // skip 5 & 6 byte codes\n    if (c_len > 4) { utf16buf[out++] = 0xfffd; i += c_len - 1; continue; }\n\n    // apply mask on first byte\n    c &= c_len === 2 ? 0x1f : c_len === 3 ? 0x0f : 0x07;\n    // join the rest\n    while (c_len > 1 && i < len) {\n      c = (c << 6) | (buf[i++] & 0x3f);\n      c_len--;\n    }\n\n    // terminated by end of string?\n    if (c_len > 1) { utf16buf[out++] = 0xfffd; continue; }\n\n    if (c < 0x10000) {\n      utf16buf[out++] = c;\n    } else {\n      c -= 0x10000;\n      utf16buf[out++] = 0xd800 | ((c >> 10) & 0x3ff);\n      utf16buf[out++] = 0xdc00 | (c & 0x3ff);\n    }\n  }\n\n  return buf2binstring(utf16buf, out);\n};\n\n\n// Calculate max possible position in utf8 buffer,\n// that will not break sequence. If that's not possible\n// - (very small limits) return max size as is.\n//\n// buf[] - utf8 bytes array\n// max   - length limit (mandatory);\nvar utf8border = (buf, max) => {\n\n  max = max || buf.length;\n  if (max > buf.length) { max = buf.length; }\n\n  // go back from last position, until start of sequence found\n  let pos = max - 1;\n  while (pos >= 0 && (buf[pos] & 0xC0) === 0x80) { pos--; }\n\n  // Very small and broken sequence,\n  // return max, because we should return something anyway.\n  if (pos < 0) { return max; }\n\n  // If we came to start of buffer - that means buffer is too small,\n  // return max too.\n  if (pos === 0) { return max; }\n\n  return (pos + _utf8len[buf[pos]] > max) ? pos : max;\n};\n\nvar strings = {\n\tstring2buf: string2buf,\n\tbuf2string: buf2string,\n\tutf8border: utf8border\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nfunction ZStream() {\n  /* next input byte */\n  this.input = null; // JS specific, because we have no pointers\n  this.next_in = 0;\n  /* number of bytes available at input */\n  this.avail_in = 0;\n  /* total number of input bytes read so far */\n  this.total_in = 0;\n  /* next output byte should be put there */\n  this.output = null; // JS specific, because we have no pointers\n  this.next_out = 0;\n  /* remaining free space at output */\n  this.avail_out = 0;\n  /* total number of bytes output so far */\n  this.total_out = 0;\n  /* last error message, NULL if no error */\n  this.msg = ''/*Z_NULL*/;\n  /* not visible by applications */\n  this.state = null;\n  /* best guess about the data type: binary or text */\n  this.data_type = 2/*Z_UNKNOWN*/;\n  /* adler32 value of the uncompressed data */\n  this.adler = 0;\n}\n\nvar zstream = ZStream;\n\nconst toString$1 = Object.prototype.toString;\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_NO_FLUSH: Z_NO_FLUSH$1, Z_SYNC_FLUSH, Z_FULL_FLUSH, Z_FINISH: Z_FINISH$2,\n  Z_OK: Z_OK$2, Z_STREAM_END: Z_STREAM_END$2,\n  Z_DEFAULT_COMPRESSION,\n  Z_DEFAULT_STRATEGY,\n  Z_DEFLATED: Z_DEFLATED$1\n} = constants$2;\n\n/* ===========================================================================*/\n\n\n/**\n * class Deflate\n *\n * Generic JS-style wrapper for zlib calls. If you don't need\n * streaming behaviour - use more simple functions: [[deflate]],\n * [[deflateRaw]] and [[gzip]].\n **/\n\n/* internal\n * Deflate.chunks -> Array\n *\n * Chunks of output data, if [[Deflate#onData]] not overridden.\n **/\n\n/**\n * Deflate.result -> Uint8Array\n *\n * Compressed result, generated by default [[Deflate#onData]]\n * and [[Deflate#onEnd]] handlers. Filled after you push last chunk\n * (call [[Deflate#push]] with `Z_FINISH` / `true` param).\n **/\n\n/**\n * Deflate.err -> Number\n *\n * Error code after deflate finished. 0 (Z_OK) on success.\n * You will not need it in real life, because deflate errors\n * are possible only on wrong options or bad `onData` / `onEnd`\n * custom handlers.\n **/\n\n/**\n * Deflate.msg -> String\n *\n * Error message, if [[Deflate.err]] != 0\n **/\n\n\n/**\n * new Deflate(options)\n * - options (Object): zlib deflate options.\n *\n * Creates new deflator instance with specified params. Throws exception\n * on bad params. Supported options:\n *\n * - `level`\n * - `windowBits`\n * - `memLevel`\n * - `strategy`\n * - `dictionary`\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information on these.\n *\n * Additional options, for internal needs:\n *\n * - `chunkSize` - size of generated data chunks (16K by default)\n * - `raw` (Boolean) - do raw deflate\n * - `gzip` (Boolean) - create gzip wrapper\n * - `header` (Object) - custom header for gzip\n *   - `text` (Boolean) - true if compressed data believed to be text\n *   - `time` (Number) - modification time, unix timestamp\n *   - `os` (Number) - operation system code\n *   - `extra` (Array) - array of bytes with extra data (max 65536)\n *   - `name` (String) - file name (binary string)\n *   - `comment` (String) - comment (binary string)\n *   - `hcrc` (Boolean) - true if header crc should be added\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako')\n *   , chunk1 = new Uint8Array([1,2,3,4,5,6,7,8,9])\n *   , chunk2 = new Uint8Array([10,11,12,13,14,15,16,17,18,19]);\n *\n * const deflate = new pako.Deflate({ level: 3});\n *\n * deflate.push(chunk1, false);\n * deflate.push(chunk2, true);  // true -> last chunk\n *\n * if (deflate.err) { throw new Error(deflate.err); }\n *\n * console.log(deflate.result);\n * ```\n **/\nfunction Deflate$1(options) {\n  this.options = common.assign({\n    level: Z_DEFAULT_COMPRESSION,\n    method: Z_DEFLATED$1,\n    chunkSize: 16384,\n    windowBits: 15,\n    memLevel: 8,\n    strategy: Z_DEFAULT_STRATEGY\n  }, options || {});\n\n  let opt = this.options;\n\n  if (opt.raw && (opt.windowBits > 0)) {\n    opt.windowBits = -opt.windowBits;\n  }\n\n  else if (opt.gzip && (opt.windowBits > 0) && (opt.windowBits < 16)) {\n    opt.windowBits += 16;\n  }\n\n  this.err    = 0;      // error code, if happens (0 = Z_OK)\n  this.msg    = '';     // error message\n  this.ended  = false;  // used to avoid multiple onEnd() calls\n  this.chunks = [];     // chunks of compressed data\n\n  this.strm = new zstream();\n  this.strm.avail_out = 0;\n\n  let status = deflate_1$2.deflateInit2(\n    this.strm,\n    opt.level,\n    opt.method,\n    opt.windowBits,\n    opt.memLevel,\n    opt.strategy\n  );\n\n  if (status !== Z_OK$2) {\n    throw new Error(messages[status]);\n  }\n\n  if (opt.header) {\n    deflate_1$2.deflateSetHeader(this.strm, opt.header);\n  }\n\n  if (opt.dictionary) {\n    let dict;\n    // Convert data if needed\n    if (typeof opt.dictionary === 'string') {\n      // If we need to compress text, change encoding to utf8.\n      dict = strings.string2buf(opt.dictionary);\n    } else if (toString$1.call(opt.dictionary) === '[object ArrayBuffer]') {\n      dict = new Uint8Array(opt.dictionary);\n    } else {\n      dict = opt.dictionary;\n    }\n\n    status = deflate_1$2.deflateSetDictionary(this.strm, dict);\n\n    if (status !== Z_OK$2) {\n      throw new Error(messages[status]);\n    }\n\n    this._dict_set = true;\n  }\n}\n\n/**\n * Deflate#push(data[, flush_mode]) -> Boolean\n * - data (Uint8Array|ArrayBuffer|String): input data. Strings will be\n *   converted to utf8 byte sequence.\n * - flush_mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE modes.\n *   See constants. Skipped or `false` means Z_NO_FLUSH, `true` means Z_FINISH.\n *\n * Sends input data to deflate pipe, generating [[Deflate#onData]] calls with\n * new compressed chunks. Returns `true` on success. The last data block must\n * have `flush_mode` Z_FINISH (or `true`). That will flush internal pending\n * buffers and call [[Deflate#onEnd]].\n *\n * On fail call [[Deflate#onEnd]] with error code and return false.\n *\n * ##### Example\n *\n * ```javascript\n * push(chunk, false); // push one of data chunks\n * ...\n * push(chunk, true);  // push last chunk\n * ```\n **/\nDeflate$1.prototype.push = function (data, flush_mode) {\n  const strm = this.strm;\n  const chunkSize = this.options.chunkSize;\n  let status, _flush_mode;\n\n  if (this.ended) { return false; }\n\n  if (flush_mode === ~~flush_mode) _flush_mode = flush_mode;\n  else _flush_mode = flush_mode === true ? Z_FINISH$2 : Z_NO_FLUSH$1;\n\n  // Convert data if needed\n  if (typeof data === 'string') {\n    // If we need to compress text, change encoding to utf8.\n    strm.input = strings.string2buf(data);\n  } else if (toString$1.call(data) === '[object ArrayBuffer]') {\n    strm.input = new Uint8Array(data);\n  } else {\n    strm.input = data;\n  }\n\n  strm.next_in = 0;\n  strm.avail_in = strm.input.length;\n\n  for (;;) {\n    if (strm.avail_out === 0) {\n      strm.output = new Uint8Array(chunkSize);\n      strm.next_out = 0;\n      strm.avail_out = chunkSize;\n    }\n\n    // Make sure avail_out > 6 to avoid repeating markers\n    if ((_flush_mode === Z_SYNC_FLUSH || _flush_mode === Z_FULL_FLUSH) && strm.avail_out <= 6) {\n      this.onData(strm.output.subarray(0, strm.next_out));\n      strm.avail_out = 0;\n      continue;\n    }\n\n    status = deflate_1$2.deflate(strm, _flush_mode);\n\n    // Ended => flush and finish\n    if (status === Z_STREAM_END$2) {\n      if (strm.next_out > 0) {\n        this.onData(strm.output.subarray(0, strm.next_out));\n      }\n      status = deflate_1$2.deflateEnd(this.strm);\n      this.onEnd(status);\n      this.ended = true;\n      return status === Z_OK$2;\n    }\n\n    // Flush if out buffer full\n    if (strm.avail_out === 0) {\n      this.onData(strm.output);\n      continue;\n    }\n\n    // Flush if requested and has data\n    if (_flush_mode > 0 && strm.next_out > 0) {\n      this.onData(strm.output.subarray(0, strm.next_out));\n      strm.avail_out = 0;\n      continue;\n    }\n\n    if (strm.avail_in === 0) break;\n  }\n\n  return true;\n};\n\n\n/**\n * Deflate#onData(chunk) -> Void\n * - chunk (Uint8Array): output data.\n *\n * By default, stores data blocks in `chunks[]` property and glue\n * those in `onEnd`. Override this handler, if you need another behaviour.\n **/\nDeflate$1.prototype.onData = function (chunk) {\n  this.chunks.push(chunk);\n};\n\n\n/**\n * Deflate#onEnd(status) -> Void\n * - status (Number): deflate status. 0 (Z_OK) on success,\n *   other if not.\n *\n * Called once after you tell deflate that the input stream is\n * complete (Z_FINISH). By default - join collected chunks,\n * free memory and fill `results` / `err` properties.\n **/\nDeflate$1.prototype.onEnd = function (status) {\n  // On success - join\n  if (status === Z_OK$2) {\n    this.result = common.flattenChunks(this.chunks);\n  }\n  this.chunks = [];\n  this.err = status;\n  this.msg = this.strm.msg;\n};\n\n\n/**\n * deflate(data[, options]) -> Uint8Array\n * - data (Uint8Array|ArrayBuffer|String): input data to compress.\n * - options (Object): zlib deflate options.\n *\n * Compress `data` with deflate algorithm and `options`.\n *\n * Supported options are:\n *\n * - level\n * - windowBits\n * - memLevel\n * - strategy\n * - dictionary\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information on these.\n *\n * Sugar (options):\n *\n * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\n *   negative windowBits implicitly.\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako')\n * const data = new Uint8Array([1,2,3,4,5,6,7,8,9]);\n *\n * console.log(pako.deflate(data));\n * ```\n **/\nfunction deflate$1(input, options) {\n  const deflator = new Deflate$1(options);\n\n  deflator.push(input, true);\n\n  // That will never happens, if you don't cheat with options :)\n  if (deflator.err) { throw deflator.msg || messages[deflator.err]; }\n\n  return deflator.result;\n}\n\n\n/**\n * deflateRaw(data[, options]) -> Uint8Array\n * - data (Uint8Array|ArrayBuffer|String): input data to compress.\n * - options (Object): zlib deflate options.\n *\n * The same as [[deflate]], but creates raw data, without wrapper\n * (header and adler32 crc).\n **/\nfunction deflateRaw$1(input, options) {\n  options = options || {};\n  options.raw = true;\n  return deflate$1(input, options);\n}\n\n\n/**\n * gzip(data[, options]) -> Uint8Array\n * - data (Uint8Array|ArrayBuffer|String): input data to compress.\n * - options (Object): zlib deflate options.\n *\n * The same as [[deflate]], but create gzip wrapper instead of\n * deflate one.\n **/\nfunction gzip$1(input, options) {\n  options = options || {};\n  options.gzip = true;\n  return deflate$1(input, options);\n}\n\n\nvar Deflate_1$1 = Deflate$1;\nvar deflate_2 = deflate$1;\nvar deflateRaw_1$1 = deflateRaw$1;\nvar gzip_1$1 = gzip$1;\nvar constants$1 = constants$2;\n\nvar deflate_1$1 = {\n\tDeflate: Deflate_1$1,\n\tdeflate: deflate_2,\n\tdeflateRaw: deflateRaw_1$1,\n\tgzip: gzip_1$1,\n\tconstants: constants$1\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n// See state defs from inflate.js\nconst BAD$1 = 16209;       /* got a data error -- remain here until reset */\nconst TYPE$1 = 16191;      /* i: waiting for type bits, including last-flag bit */\n\n/*\n   Decode literal, length, and distance codes and write out the resulting\n   literal and match bytes until either not enough input or output is\n   available, an end-of-block is encountered, or a data error is encountered.\n   When large enough input and output buffers are supplied to inflate(), for\n   example, a 16K input buffer and a 64K output buffer, more than 95% of the\n   inflate execution time is spent in this routine.\n\n   Entry assumptions:\n\n        state.mode === LEN\n        strm.avail_in >= 6\n        strm.avail_out >= 258\n        start >= strm.avail_out\n        state.bits < 8\n\n   On return, state.mode is one of:\n\n        LEN -- ran out of enough output space or enough available input\n        TYPE -- reached end of block code, inflate() to interpret next block\n        BAD -- error in block data\n\n   Notes:\n\n    - The maximum input bits used by a length/distance pair is 15 bits for the\n      length code, 5 bits for the length extra, 15 bits for the distance code,\n      and 13 bits for the distance extra.  This totals 48 bits, or six bytes.\n      Therefore if strm.avail_in >= 6, then there is enough input to avoid\n      checking for available input while decoding.\n\n    - The maximum bytes that a single length/distance pair can output is 258\n      bytes, which is the maximum length that can be coded.  inflate_fast()\n      requires strm.avail_out >= 258 for each loop to avoid checking for\n      output space.\n */\nvar inffast = function inflate_fast(strm, start) {\n  let _in;                    /* local strm.input */\n  let last;                   /* have enough input while in < last */\n  let _out;                   /* local strm.output */\n  let beg;                    /* inflate()'s initial strm.output */\n  let end;                    /* while out < end, enough space available */\n//#ifdef INFLATE_STRICT\n  let dmax;                   /* maximum distance from zlib header */\n//#endif\n  let wsize;                  /* window size or zero if not using window */\n  let whave;                  /* valid bytes in the window */\n  let wnext;                  /* window write index */\n  // Use `s_window` instead `window`, avoid conflict with instrumentation tools\n  let s_window;               /* allocated sliding window, if wsize != 0 */\n  let hold;                   /* local strm.hold */\n  let bits;                   /* local strm.bits */\n  let lcode;                  /* local strm.lencode */\n  let dcode;                  /* local strm.distcode */\n  let lmask;                  /* mask for first level of length codes */\n  let dmask;                  /* mask for first level of distance codes */\n  let here;                   /* retrieved table entry */\n  let op;                     /* code bits, operation, extra bits, or */\n                              /*  window position, window bytes to copy */\n  let len;                    /* match length, unused bytes */\n  let dist;                   /* match distance */\n  let from;                   /* where to copy match from */\n  let from_source;\n\n\n  let input, output; // JS specific, because we have no pointers\n\n  /* copy state to local variables */\n  const state = strm.state;\n  //here = state.here;\n  _in = strm.next_in;\n  input = strm.input;\n  last = _in + (strm.avail_in - 5);\n  _out = strm.next_out;\n  output = strm.output;\n  beg = _out - (start - strm.avail_out);\n  end = _out + (strm.avail_out - 257);\n//#ifdef INFLATE_STRICT\n  dmax = state.dmax;\n//#endif\n  wsize = state.wsize;\n  whave = state.whave;\n  wnext = state.wnext;\n  s_window = state.window;\n  hold = state.hold;\n  bits = state.bits;\n  lcode = state.lencode;\n  dcode = state.distcode;\n  lmask = (1 << state.lenbits) - 1;\n  dmask = (1 << state.distbits) - 1;\n\n\n  /* decode literals and length/distances until end-of-block or not enough\n     input data or output space */\n\n  top:\n  do {\n    if (bits < 15) {\n      hold += input[_in++] << bits;\n      bits += 8;\n      hold += input[_in++] << bits;\n      bits += 8;\n    }\n\n    here = lcode[hold & lmask];\n\n    dolen:\n    for (;;) { // Goto emulation\n      op = here >>> 24/*here.bits*/;\n      hold >>>= op;\n      bits -= op;\n      op = (here >>> 16) & 0xff/*here.op*/;\n      if (op === 0) {                          /* literal */\n        //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\n        //        \"inflate:         literal '%c'\\n\" :\n        //        \"inflate:         literal 0x%02x\\n\", here.val));\n        output[_out++] = here & 0xffff/*here.val*/;\n      }\n      else if (op & 16) {                     /* length base */\n        len = here & 0xffff/*here.val*/;\n        op &= 15;                           /* number of extra bits */\n        if (op) {\n          if (bits < op) {\n            hold += input[_in++] << bits;\n            bits += 8;\n          }\n          len += hold & ((1 << op) - 1);\n          hold >>>= op;\n          bits -= op;\n        }\n        //Tracevv((stderr, \"inflate:         length %u\\n\", len));\n        if (bits < 15) {\n          hold += input[_in++] << bits;\n          bits += 8;\n          hold += input[_in++] << bits;\n          bits += 8;\n        }\n        here = dcode[hold & dmask];\n\n        dodist:\n        for (;;) { // goto emulation\n          op = here >>> 24/*here.bits*/;\n          hold >>>= op;\n          bits -= op;\n          op = (here >>> 16) & 0xff/*here.op*/;\n\n          if (op & 16) {                      /* distance base */\n            dist = here & 0xffff/*here.val*/;\n            op &= 15;                       /* number of extra bits */\n            if (bits < op) {\n              hold += input[_in++] << bits;\n              bits += 8;\n              if (bits < op) {\n                hold += input[_in++] << bits;\n                bits += 8;\n              }\n            }\n            dist += hold & ((1 << op) - 1);\n//#ifdef INFLATE_STRICT\n            if (dist > dmax) {\n              strm.msg = 'invalid distance too far back';\n              state.mode = BAD$1;\n              break top;\n            }\n//#endif\n            hold >>>= op;\n            bits -= op;\n            //Tracevv((stderr, \"inflate:         distance %u\\n\", dist));\n            op = _out - beg;                /* max distance in output */\n            if (dist > op) {                /* see if copy from window */\n              op = dist - op;               /* distance back in window */\n              if (op > whave) {\n                if (state.sane) {\n                  strm.msg = 'invalid distance too far back';\n                  state.mode = BAD$1;\n                  break top;\n                }\n\n// (!) This block is disabled in zlib defaults,\n// don't enable it for binary compatibility\n//#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\n//                if (len <= op - whave) {\n//                  do {\n//                    output[_out++] = 0;\n//                  } while (--len);\n//                  continue top;\n//                }\n//                len -= op - whave;\n//                do {\n//                  output[_out++] = 0;\n//                } while (--op > whave);\n//                if (op === 0) {\n//                  from = _out - dist;\n//                  do {\n//                    output[_out++] = output[from++];\n//                  } while (--len);\n//                  continue top;\n//                }\n//#endif\n              }\n              from = 0; // window index\n              from_source = s_window;\n              if (wnext === 0) {           /* very common case */\n                from += wsize - op;\n                if (op < len) {         /* some from window */\n                  len -= op;\n                  do {\n                    output[_out++] = s_window[from++];\n                  } while (--op);\n                  from = _out - dist;  /* rest from output */\n                  from_source = output;\n                }\n              }\n              else if (wnext < op) {      /* wrap around window */\n                from += wsize + wnext - op;\n                op -= wnext;\n                if (op < len) {         /* some from end of window */\n                  len -= op;\n                  do {\n                    output[_out++] = s_window[from++];\n                  } while (--op);\n                  from = 0;\n                  if (wnext < len) {  /* some from start of window */\n                    op = wnext;\n                    len -= op;\n                    do {\n                      output[_out++] = s_window[from++];\n                    } while (--op);\n                    from = _out - dist;      /* rest from output */\n                    from_source = output;\n                  }\n                }\n              }\n              else {                      /* contiguous in window */\n                from += wnext - op;\n                if (op < len) {         /* some from window */\n                  len -= op;\n                  do {\n                    output[_out++] = s_window[from++];\n                  } while (--op);\n                  from = _out - dist;  /* rest from output */\n                  from_source = output;\n                }\n              }\n              while (len > 2) {\n                output[_out++] = from_source[from++];\n                output[_out++] = from_source[from++];\n                output[_out++] = from_source[from++];\n                len -= 3;\n              }\n              if (len) {\n                output[_out++] = from_source[from++];\n                if (len > 1) {\n                  output[_out++] = from_source[from++];\n                }\n              }\n            }\n            else {\n              from = _out - dist;          /* copy direct from output */\n              do {                        /* minimum length is three */\n                output[_out++] = output[from++];\n                output[_out++] = output[from++];\n                output[_out++] = output[from++];\n                len -= 3;\n              } while (len > 2);\n              if (len) {\n                output[_out++] = output[from++];\n                if (len > 1) {\n                  output[_out++] = output[from++];\n                }\n              }\n            }\n          }\n          else if ((op & 64) === 0) {          /* 2nd level distance code */\n            here = dcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\n            continue dodist;\n          }\n          else {\n            strm.msg = 'invalid distance code';\n            state.mode = BAD$1;\n            break top;\n          }\n\n          break; // need to emulate goto via \"continue\"\n        }\n      }\n      else if ((op & 64) === 0) {              /* 2nd level length code */\n        here = lcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\n        continue dolen;\n      }\n      else if (op & 32) {                     /* end-of-block */\n        //Tracevv((stderr, \"inflate:         end of block\\n\"));\n        state.mode = TYPE$1;\n        break top;\n      }\n      else {\n        strm.msg = 'invalid literal/length code';\n        state.mode = BAD$1;\n        break top;\n      }\n\n      break; // need to emulate goto via \"continue\"\n    }\n  } while (_in < last && _out < end);\n\n  /* return unused bytes (on entry, bits < 8, so in won't go too far back) */\n  len = bits >> 3;\n  _in -= len;\n  bits -= len << 3;\n  hold &= (1 << bits) - 1;\n\n  /* update state and return */\n  strm.next_in = _in;\n  strm.next_out = _out;\n  strm.avail_in = (_in < last ? 5 + (last - _in) : 5 - (_in - last));\n  strm.avail_out = (_out < end ? 257 + (end - _out) : 257 - (_out - end));\n  state.hold = hold;\n  state.bits = bits;\n  return;\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nconst MAXBITS = 15;\nconst ENOUGH_LENS$1 = 852;\nconst ENOUGH_DISTS$1 = 592;\n//const ENOUGH = (ENOUGH_LENS+ENOUGH_DISTS);\n\nconst CODES$1 = 0;\nconst LENS$1 = 1;\nconst DISTS$1 = 2;\n\nconst lbase = new Uint16Array([ /* Length codes 257..285 base */\n  3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31,\n  35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0\n]);\n\nconst lext = new Uint8Array([ /* Length codes 257..285 extra */\n  16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,\n  19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78\n]);\n\nconst dbase = new Uint16Array([ /* Distance codes 0..29 base */\n  1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193,\n  257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145,\n  8193, 12289, 16385, 24577, 0, 0\n]);\n\nconst dext = new Uint8Array([ /* Distance codes 0..29 extra */\n  16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,\n  23, 23, 24, 24, 25, 25, 26, 26, 27, 27,\n  28, 28, 29, 29, 64, 64\n]);\n\nconst inflate_table = (type, lens, lens_index, codes, table, table_index, work, opts) =>\n{\n  const bits = opts.bits;\n      //here = opts.here; /* table entry for duplication */\n\n  let len = 0;               /* a code's length in bits */\n  let sym = 0;               /* index of code symbols */\n  let min = 0, max = 0;          /* minimum and maximum code lengths */\n  let root = 0;              /* number of index bits for root table */\n  let curr = 0;              /* number of index bits for current table */\n  let drop = 0;              /* code bits to drop for sub-table */\n  let left = 0;                   /* number of prefix codes available */\n  let used = 0;              /* code entries in table used */\n  let huff = 0;              /* Huffman code */\n  let incr;              /* for incrementing code, index */\n  let fill;              /* index for replicating entries */\n  let low;               /* low bits for current root entry */\n  let mask;              /* mask for low root bits */\n  let next;             /* next available space in table */\n  let base = null;     /* base value table to use */\n//  let shoextra;    /* extra bits table to use */\n  let match;                  /* use base and extra for symbol >= match */\n  const count = new Uint16Array(MAXBITS + 1); //[MAXBITS+1];    /* number of codes of each length */\n  const offs = new Uint16Array(MAXBITS + 1); //[MAXBITS+1];     /* offsets in table for each length */\n  let extra = null;\n\n  let here_bits, here_op, here_val;\n\n  /*\n   Process a set of code lengths to create a canonical Huffman code.  The\n   code lengths are lens[0..codes-1].  Each length corresponds to the\n   symbols 0..codes-1.  The Huffman code is generated by first sorting the\n   symbols by length from short to long, and retaining the symbol order\n   for codes with equal lengths.  Then the code starts with all zero bits\n   for the first code of the shortest length, and the codes are integer\n   increments for the same length, and zeros are appended as the length\n   increases.  For the deflate format, these bits are stored backwards\n   from their more natural integer increment ordering, and so when the\n   decoding tables are built in the large loop below, the integer codes\n   are incremented backwards.\n\n   This routine assumes, but does not check, that all of the entries in\n   lens[] are in the range 0..MAXBITS.  The caller must assure this.\n   1..MAXBITS is interpreted as that code length.  zero means that that\n   symbol does not occur in this code.\n\n   The codes are sorted by computing a count of codes for each length,\n   creating from that a table of starting indices for each length in the\n   sorted table, and then entering the symbols in order in the sorted\n   table.  The sorted table is work[], with that space being provided by\n   the caller.\n\n   The length counts are used for other purposes as well, i.e. finding\n   the minimum and maximum length codes, determining if there are any\n   codes at all, checking for a valid set of lengths, and looking ahead\n   at length counts to determine sub-table sizes when building the\n   decoding tables.\n   */\n\n  /* accumulate lengths for codes (assumes lens[] all in 0..MAXBITS) */\n  for (len = 0; len <= MAXBITS; len++) {\n    count[len] = 0;\n  }\n  for (sym = 0; sym < codes; sym++) {\n    count[lens[lens_index + sym]]++;\n  }\n\n  /* bound code lengths, force root to be within code lengths */\n  root = bits;\n  for (max = MAXBITS; max >= 1; max--) {\n    if (count[max] !== 0) { break; }\n  }\n  if (root > max) {\n    root = max;\n  }\n  if (max === 0) {                     /* no symbols to code at all */\n    //table.op[opts.table_index] = 64;  //here.op = (var char)64;    /* invalid code marker */\n    //table.bits[opts.table_index] = 1;   //here.bits = (var char)1;\n    //table.val[opts.table_index++] = 0;   //here.val = (var short)0;\n    table[table_index++] = (1 << 24) | (64 << 16) | 0;\n\n\n    //table.op[opts.table_index] = 64;\n    //table.bits[opts.table_index] = 1;\n    //table.val[opts.table_index++] = 0;\n    table[table_index++] = (1 << 24) | (64 << 16) | 0;\n\n    opts.bits = 1;\n    return 0;     /* no symbols, but wait for decoding to report error */\n  }\n  for (min = 1; min < max; min++) {\n    if (count[min] !== 0) { break; }\n  }\n  if (root < min) {\n    root = min;\n  }\n\n  /* check for an over-subscribed or incomplete set of lengths */\n  left = 1;\n  for (len = 1; len <= MAXBITS; len++) {\n    left <<= 1;\n    left -= count[len];\n    if (left < 0) {\n      return -1;\n    }        /* over-subscribed */\n  }\n  if (left > 0 && (type === CODES$1 || max !== 1)) {\n    return -1;                      /* incomplete set */\n  }\n\n  /* generate offsets into symbol table for each length for sorting */\n  offs[1] = 0;\n  for (len = 1; len < MAXBITS; len++) {\n    offs[len + 1] = offs[len] + count[len];\n  }\n\n  /* sort symbols by length, by symbol order within each length */\n  for (sym = 0; sym < codes; sym++) {\n    if (lens[lens_index + sym] !== 0) {\n      work[offs[lens[lens_index + sym]]++] = sym;\n    }\n  }\n\n  /*\n   Create and fill in decoding tables.  In this loop, the table being\n   filled is at next and has curr index bits.  The code being used is huff\n   with length len.  That code is converted to an index by dropping drop\n   bits off of the bottom.  For codes where len is less than drop + curr,\n   those top drop + curr - len bits are incremented through all values to\n   fill the table with replicated entries.\n\n   root is the number of index bits for the root table.  When len exceeds\n   root, sub-tables are created pointed to by the root entry with an index\n   of the low root bits of huff.  This is saved in low to check for when a\n   new sub-table should be started.  drop is zero when the root table is\n   being filled, and drop is root when sub-tables are being filled.\n\n   When a new sub-table is needed, it is necessary to look ahead in the\n   code lengths to determine what size sub-table is needed.  The length\n   counts are used for this, and so count[] is decremented as codes are\n   entered in the tables.\n\n   used keeps track of how many table entries have been allocated from the\n   provided *table space.  It is checked for LENS and DIST tables against\n   the constants ENOUGH_LENS and ENOUGH_DISTS to guard against changes in\n   the initial root table size constants.  See the comments in inftrees.h\n   for more information.\n\n   sym increments through all symbols, and the loop terminates when\n   all codes of length max, i.e. all codes, have been processed.  This\n   routine permits incomplete codes, so another loop after this one fills\n   in the rest of the decoding tables with invalid code markers.\n   */\n\n  /* set up for code type */\n  // poor man optimization - use if-else instead of switch,\n  // to avoid deopts in old v8\n  if (type === CODES$1) {\n    base = extra = work;    /* dummy value--not used */\n    match = 20;\n\n  } else if (type === LENS$1) {\n    base = lbase;\n    extra = lext;\n    match = 257;\n\n  } else {                    /* DISTS */\n    base = dbase;\n    extra = dext;\n    match = 0;\n  }\n\n  /* initialize opts for loop */\n  huff = 0;                   /* starting code */\n  sym = 0;                    /* starting code symbol */\n  len = min;                  /* starting code length */\n  next = table_index;              /* current table to fill in */\n  curr = root;                /* current table index bits */\n  drop = 0;                   /* current bits to drop from code for index */\n  low = -1;                   /* trigger new sub-table when len > root */\n  used = 1 << root;          /* use root table entries */\n  mask = used - 1;            /* mask for comparing low */\n\n  /* check available table space */\n  if ((type === LENS$1 && used > ENOUGH_LENS$1) ||\n    (type === DISTS$1 && used > ENOUGH_DISTS$1)) {\n    return 1;\n  }\n\n  /* process all codes and make table entries */\n  for (;;) {\n    /* create table entry */\n    here_bits = len - drop;\n    if (work[sym] + 1 < match) {\n      here_op = 0;\n      here_val = work[sym];\n    }\n    else if (work[sym] >= match) {\n      here_op = extra[work[sym] - match];\n      here_val = base[work[sym] - match];\n    }\n    else {\n      here_op = 32 + 64;         /* end of block */\n      here_val = 0;\n    }\n\n    /* replicate for those indices with low len bits equal to huff */\n    incr = 1 << (len - drop);\n    fill = 1 << curr;\n    min = fill;                 /* save offset to next table */\n    do {\n      fill -= incr;\n      table[next + (huff >> drop) + fill] = (here_bits << 24) | (here_op << 16) | here_val |0;\n    } while (fill !== 0);\n\n    /* backwards increment the len-bit code huff */\n    incr = 1 << (len - 1);\n    while (huff & incr) {\n      incr >>= 1;\n    }\n    if (incr !== 0) {\n      huff &= incr - 1;\n      huff += incr;\n    } else {\n      huff = 0;\n    }\n\n    /* go to next symbol, update count, len */\n    sym++;\n    if (--count[len] === 0) {\n      if (len === max) { break; }\n      len = lens[lens_index + work[sym]];\n    }\n\n    /* create new sub-table if needed */\n    if (len > root && (huff & mask) !== low) {\n      /* if first time, transition to sub-tables */\n      if (drop === 0) {\n        drop = root;\n      }\n\n      /* increment past last table */\n      next += min;            /* here min is 1 << curr */\n\n      /* determine length of next table */\n      curr = len - drop;\n      left = 1 << curr;\n      while (curr + drop < max) {\n        left -= count[curr + drop];\n        if (left <= 0) { break; }\n        curr++;\n        left <<= 1;\n      }\n\n      /* check for enough space */\n      used += 1 << curr;\n      if ((type === LENS$1 && used > ENOUGH_LENS$1) ||\n        (type === DISTS$1 && used > ENOUGH_DISTS$1)) {\n        return 1;\n      }\n\n      /* point entry in root table to sub-table */\n      low = huff & mask;\n      /*table.op[low] = curr;\n      table.bits[low] = root;\n      table.val[low] = next - opts.table_index;*/\n      table[low] = (root << 24) | (curr << 16) | (next - table_index) |0;\n    }\n  }\n\n  /* fill in remaining table entry if code is incomplete (guaranteed to have\n   at most one remaining entry, since if the code is incomplete, the\n   maximum code length that was allowed to get this far is one bit) */\n  if (huff !== 0) {\n    //table.op[next + huff] = 64;            /* invalid code marker */\n    //table.bits[next + huff] = len - drop;\n    //table.val[next + huff] = 0;\n    table[next + huff] = ((len - drop) << 24) | (64 << 16) |0;\n  }\n\n  /* set return parameters */\n  //opts.table_index += used;\n  opts.bits = root;\n  return 0;\n};\n\n\nvar inftrees = inflate_table;\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n\n\n\n\n\nconst CODES = 0;\nconst LENS = 1;\nconst DISTS = 2;\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_FINISH: Z_FINISH$1, Z_BLOCK, Z_TREES,\n  Z_OK: Z_OK$1, Z_STREAM_END: Z_STREAM_END$1, Z_NEED_DICT: Z_NEED_DICT$1, Z_STREAM_ERROR: Z_STREAM_ERROR$1, Z_DATA_ERROR: Z_DATA_ERROR$1, Z_MEM_ERROR: Z_MEM_ERROR$1, Z_BUF_ERROR,\n  Z_DEFLATED\n} = constants$2;\n\n\n/* STATES ====================================================================*/\n/* ===========================================================================*/\n\n\nconst    HEAD = 16180;       /* i: waiting for magic header */\nconst    FLAGS = 16181;      /* i: waiting for method and flags (gzip) */\nconst    TIME = 16182;       /* i: waiting for modification time (gzip) */\nconst    OS = 16183;         /* i: waiting for extra flags and operating system (gzip) */\nconst    EXLEN = 16184;      /* i: waiting for extra length (gzip) */\nconst    EXTRA = 16185;      /* i: waiting for extra bytes (gzip) */\nconst    NAME = 16186;       /* i: waiting for end of file name (gzip) */\nconst    COMMENT = 16187;    /* i: waiting for end of comment (gzip) */\nconst    HCRC = 16188;       /* i: waiting for header crc (gzip) */\nconst    DICTID = 16189;    /* i: waiting for dictionary check value */\nconst    DICT = 16190;      /* waiting for inflateSetDictionary() call */\nconst        TYPE = 16191;      /* i: waiting for type bits, including last-flag bit */\nconst        TYPEDO = 16192;    /* i: same, but skip check to exit inflate on new block */\nconst        STORED = 16193;    /* i: waiting for stored size (length and complement) */\nconst        COPY_ = 16194;     /* i/o: same as COPY below, but only first time in */\nconst        COPY = 16195;      /* i/o: waiting for input or output to copy stored block */\nconst        TABLE = 16196;     /* i: waiting for dynamic block table lengths */\nconst        LENLENS = 16197;   /* i: waiting for code length code lengths */\nconst        CODELENS = 16198;  /* i: waiting for length/lit and distance code lengths */\nconst            LEN_ = 16199;      /* i: same as LEN below, but only first time in */\nconst            LEN = 16200;       /* i: waiting for length/lit/eob code */\nconst            LENEXT = 16201;    /* i: waiting for length extra bits */\nconst            DIST = 16202;      /* i: waiting for distance code */\nconst            DISTEXT = 16203;   /* i: waiting for distance extra bits */\nconst            MATCH = 16204;     /* o: waiting for output space to copy string */\nconst            LIT = 16205;       /* o: waiting for output space to write literal */\nconst    CHECK = 16206;     /* i: waiting for 32-bit check value */\nconst    LENGTH = 16207;    /* i: waiting for 32-bit length (gzip) */\nconst    DONE = 16208;      /* finished check, done -- remain here until reset */\nconst    BAD = 16209;       /* got a data error -- remain here until reset */\nconst    MEM = 16210;       /* got an inflate() memory error -- remain here until reset */\nconst    SYNC = 16211;      /* looking for synchronization bytes to restart inflate() */\n\n/* ===========================================================================*/\n\n\n\nconst ENOUGH_LENS = 852;\nconst ENOUGH_DISTS = 592;\n//const ENOUGH =  (ENOUGH_LENS+ENOUGH_DISTS);\n\nconst MAX_WBITS = 15;\n/* 32K LZ77 window */\nconst DEF_WBITS = MAX_WBITS;\n\n\nconst zswap32 = (q) => {\n\n  return  (((q >>> 24) & 0xff) +\n          ((q >>> 8) & 0xff00) +\n          ((q & 0xff00) << 8) +\n          ((q & 0xff) << 24));\n};\n\n\nfunction InflateState() {\n  this.strm = null;           /* pointer back to this zlib stream */\n  this.mode = 0;              /* current inflate mode */\n  this.last = false;          /* true if processing last block */\n  this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip,\n                                 bit 2 true to validate check value */\n  this.havedict = false;      /* true if dictionary provided */\n  this.flags = 0;             /* gzip header method and flags (0 if zlib), or\n                                 -1 if raw or no header yet */\n  this.dmax = 0;              /* zlib header max distance (INFLATE_STRICT) */\n  this.check = 0;             /* protected copy of check value */\n  this.total = 0;             /* protected copy of output count */\n  // TODO: may be {}\n  this.head = null;           /* where to save gzip header information */\n\n  /* sliding window */\n  this.wbits = 0;             /* log base 2 of requested window size */\n  this.wsize = 0;             /* window size or zero if not using window */\n  this.whave = 0;             /* valid bytes in the window */\n  this.wnext = 0;             /* window write index */\n  this.window = null;         /* allocated sliding window, if needed */\n\n  /* bit accumulator */\n  this.hold = 0;              /* input bit accumulator */\n  this.bits = 0;              /* number of bits in \"in\" */\n\n  /* for string and stored block copying */\n  this.length = 0;            /* literal or length of data to copy */\n  this.offset = 0;            /* distance back to copy string from */\n\n  /* for table and code decoding */\n  this.extra = 0;             /* extra bits needed */\n\n  /* fixed and dynamic code tables */\n  this.lencode = null;          /* starting table for length/literal codes */\n  this.distcode = null;         /* starting table for distance codes */\n  this.lenbits = 0;           /* index bits for lencode */\n  this.distbits = 0;          /* index bits for distcode */\n\n  /* dynamic table building */\n  this.ncode = 0;             /* number of code length code lengths */\n  this.nlen = 0;              /* number of length code lengths */\n  this.ndist = 0;             /* number of distance code lengths */\n  this.have = 0;              /* number of code lengths in lens[] */\n  this.next = null;              /* next available space in codes[] */\n\n  this.lens = new Uint16Array(320); /* temporary storage for code lengths */\n  this.work = new Uint16Array(288); /* work area for code table building */\n\n  /*\n   because we don't have pointers in js, we use lencode and distcode directly\n   as buffers so we don't need codes\n  */\n  //this.codes = new Int32Array(ENOUGH);       /* space for code tables */\n  this.lendyn = null;              /* dynamic table for length/literal codes (JS specific) */\n  this.distdyn = null;             /* dynamic table for distance codes (JS specific) */\n  this.sane = 0;                   /* if false, allow invalid distance too far */\n  this.back = 0;                   /* bits back of last unprocessed length/lit */\n  this.was = 0;                    /* initial length of match */\n}\n\n\nconst inflateStateCheck = (strm) => {\n\n  if (!strm) {\n    return 1;\n  }\n  const state = strm.state;\n  if (!state || state.strm !== strm ||\n    state.mode < HEAD || state.mode > SYNC) {\n    return 1;\n  }\n  return 0;\n};\n\n\nconst inflateResetKeep = (strm) => {\n\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n  strm.total_in = strm.total_out = state.total = 0;\n  strm.msg = ''; /*Z_NULL*/\n  if (state.wrap) {       /* to support ill-conceived Java test suite */\n    strm.adler = state.wrap & 1;\n  }\n  state.mode = HEAD;\n  state.last = 0;\n  state.havedict = 0;\n  state.flags = -1;\n  state.dmax = 32768;\n  state.head = null/*Z_NULL*/;\n  state.hold = 0;\n  state.bits = 0;\n  //state.lencode = state.distcode = state.next = state.codes;\n  state.lencode = state.lendyn = new Int32Array(ENOUGH_LENS);\n  state.distcode = state.distdyn = new Int32Array(ENOUGH_DISTS);\n\n  state.sane = 1;\n  state.back = -1;\n  //Tracev((stderr, \"inflate: reset\\n\"));\n  return Z_OK$1;\n};\n\n\nconst inflateReset = (strm) => {\n\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n  state.wsize = 0;\n  state.whave = 0;\n  state.wnext = 0;\n  return inflateResetKeep(strm);\n\n};\n\n\nconst inflateReset2 = (strm, windowBits) => {\n  let wrap;\n\n  /* get the state */\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n\n  /* extract wrap request from windowBits parameter */\n  if (windowBits < 0) {\n    wrap = 0;\n    windowBits = -windowBits;\n  }\n  else {\n    wrap = (windowBits >> 4) + 5;\n    if (windowBits < 48) {\n      windowBits &= 15;\n    }\n  }\n\n  /* set number of window bits, free window if different */\n  if (windowBits && (windowBits < 8 || windowBits > 15)) {\n    return Z_STREAM_ERROR$1;\n  }\n  if (state.window !== null && state.wbits !== windowBits) {\n    state.window = null;\n  }\n\n  /* update state and reset the rest of it */\n  state.wrap = wrap;\n  state.wbits = windowBits;\n  return inflateReset(strm);\n};\n\n\nconst inflateInit2 = (strm, windowBits) => {\n\n  if (!strm) { return Z_STREAM_ERROR$1; }\n  //strm.msg = Z_NULL;                 /* in case we return an error */\n\n  const state = new InflateState();\n\n  //if (state === Z_NULL) return Z_MEM_ERROR;\n  //Tracev((stderr, \"inflate: allocated\\n\"));\n  strm.state = state;\n  state.strm = strm;\n  state.window = null/*Z_NULL*/;\n  state.mode = HEAD;     /* to pass state test in inflateReset2() */\n  const ret = inflateReset2(strm, windowBits);\n  if (ret !== Z_OK$1) {\n    strm.state = null/*Z_NULL*/;\n  }\n  return ret;\n};\n\n\nconst inflateInit = (strm) => {\n\n  return inflateInit2(strm, DEF_WBITS);\n};\n\n\n/*\n Return state with length and distance decoding tables and index sizes set to\n fixed code decoding.  Normally this returns fixed tables from inffixed.h.\n If BUILDFIXED is defined, then instead this routine builds the tables the\n first time it's called, and returns those tables the first time and\n thereafter.  This reduces the size of the code by about 2K bytes, in\n exchange for a little execution time.  However, BUILDFIXED should not be\n used for threaded applications, since the rewriting of the tables and virgin\n may not be thread-safe.\n */\nlet virgin = true;\n\nlet lenfix, distfix; // We have no pointers in JS, so keep tables separate\n\n\nconst fixedtables = (state) => {\n\n  /* build fixed huffman tables if first call (may not be thread safe) */\n  if (virgin) {\n    lenfix = new Int32Array(512);\n    distfix = new Int32Array(32);\n\n    /* literal/length table */\n    let sym = 0;\n    while (sym < 144) { state.lens[sym++] = 8; }\n    while (sym < 256) { state.lens[sym++] = 9; }\n    while (sym < 280) { state.lens[sym++] = 7; }\n    while (sym < 288) { state.lens[sym++] = 8; }\n\n    inftrees(LENS,  state.lens, 0, 288, lenfix,   0, state.work, { bits: 9 });\n\n    /* distance table */\n    sym = 0;\n    while (sym < 32) { state.lens[sym++] = 5; }\n\n    inftrees(DISTS, state.lens, 0, 32,   distfix, 0, state.work, { bits: 5 });\n\n    /* do this just once */\n    virgin = false;\n  }\n\n  state.lencode = lenfix;\n  state.lenbits = 9;\n  state.distcode = distfix;\n  state.distbits = 5;\n};\n\n\n/*\n Update the window with the last wsize (normally 32K) bytes written before\n returning.  If window does not exist yet, create it.  This is only called\n when a window is already in use, or when output has been written during this\n inflate call, but the end of the deflate stream has not been reached yet.\n It is also called to create a window for dictionary data when a dictionary\n is loaded.\n\n Providing output buffers larger than 32K to inflate() should provide a speed\n advantage, since only the last 32K of output is copied to the sliding window\n upon return from inflate(), and since all distances after the first 32K of\n output will fall in the output data, making match copies simpler and faster.\n The advantage may be dependent on the size of the processor's data caches.\n */\nconst updatewindow = (strm, src, end, copy) => {\n\n  let dist;\n  const state = strm.state;\n\n  /* if it hasn't been done already, allocate space for the window */\n  if (state.window === null) {\n    state.wsize = 1 << state.wbits;\n    state.wnext = 0;\n    state.whave = 0;\n\n    state.window = new Uint8Array(state.wsize);\n  }\n\n  /* copy state->wsize or less output bytes into the circular window */\n  if (copy >= state.wsize) {\n    state.window.set(src.subarray(end - state.wsize, end), 0);\n    state.wnext = 0;\n    state.whave = state.wsize;\n  }\n  else {\n    dist = state.wsize - state.wnext;\n    if (dist > copy) {\n      dist = copy;\n    }\n    //zmemcpy(state->window + state->wnext, end - copy, dist);\n    state.window.set(src.subarray(end - copy, end - copy + dist), state.wnext);\n    copy -= dist;\n    if (copy) {\n      //zmemcpy(state->window, end - copy, copy);\n      state.window.set(src.subarray(end - copy, end), 0);\n      state.wnext = copy;\n      state.whave = state.wsize;\n    }\n    else {\n      state.wnext += dist;\n      if (state.wnext === state.wsize) { state.wnext = 0; }\n      if (state.whave < state.wsize) { state.whave += dist; }\n    }\n  }\n  return 0;\n};\n\n\nconst inflate$2 = (strm, flush) => {\n\n  let state;\n  let input, output;          // input/output buffers\n  let next;                   /* next input INDEX */\n  let put;                    /* next output INDEX */\n  let have, left;             /* available input and output */\n  let hold;                   /* bit buffer */\n  let bits;                   /* bits in bit buffer */\n  let _in, _out;              /* save starting available input and output */\n  let copy;                   /* number of stored or match bytes to copy */\n  let from;                   /* where to copy match bytes from */\n  let from_source;\n  let here = 0;               /* current decoding table entry */\n  let here_bits, here_op, here_val; // paked \"here\" denormalized (JS specific)\n  //let last;                   /* parent table entry */\n  let last_bits, last_op, last_val; // paked \"last\" denormalized (JS specific)\n  let len;                    /* length to copy for repeats, bits to drop */\n  let ret;                    /* return code */\n  const hbuf = new Uint8Array(4);    /* buffer for gzip header crc calculation */\n  let opts;\n\n  let n; // temporary variable for NEED_BITS\n\n  const order = /* permutation of code lengths */\n    new Uint8Array([ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ]);\n\n\n  if (inflateStateCheck(strm) || !strm.output ||\n      (!strm.input && strm.avail_in !== 0)) {\n    return Z_STREAM_ERROR$1;\n  }\n\n  state = strm.state;\n  if (state.mode === TYPE) { state.mode = TYPEDO; }    /* skip check */\n\n\n  //--- LOAD() ---\n  put = strm.next_out;\n  output = strm.output;\n  left = strm.avail_out;\n  next = strm.next_in;\n  input = strm.input;\n  have = strm.avail_in;\n  hold = state.hold;\n  bits = state.bits;\n  //---\n\n  _in = have;\n  _out = left;\n  ret = Z_OK$1;\n\n  inf_leave: // goto emulation\n  for (;;) {\n    switch (state.mode) {\n      case HEAD:\n        if (state.wrap === 0) {\n          state.mode = TYPEDO;\n          break;\n        }\n        //=== NEEDBITS(16);\n        while (bits < 16) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if ((state.wrap & 2) && hold === 0x8b1f) {  /* gzip header */\n          if (state.wbits === 0) {\n            state.wbits = 15;\n          }\n          state.check = 0/*crc32(0L, Z_NULL, 0)*/;\n          //=== CRC2(state.check, hold);\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 2, 0);\n          //===//\n\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = FLAGS;\n          break;\n        }\n        if (state.head) {\n          state.head.done = false;\n        }\n        if (!(state.wrap & 1) ||   /* check if zlib header allowed */\n          (((hold & 0xff)/*BITS(8)*/ << 8) + (hold >> 8)) % 31) {\n          strm.msg = 'incorrect header check';\n          state.mode = BAD;\n          break;\n        }\n        if ((hold & 0x0f)/*BITS(4)*/ !== Z_DEFLATED) {\n          strm.msg = 'unknown compression method';\n          state.mode = BAD;\n          break;\n        }\n        //--- DROPBITS(4) ---//\n        hold >>>= 4;\n        bits -= 4;\n        //---//\n        len = (hold & 0x0f)/*BITS(4)*/ + 8;\n        if (state.wbits === 0) {\n          state.wbits = len;\n        }\n        if (len > 15 || len > state.wbits) {\n          strm.msg = 'invalid window size';\n          state.mode = BAD;\n          break;\n        }\n\n        // !!! pako patch. Force use `options.windowBits` if passed.\n        // Required to always use max window size by default.\n        state.dmax = 1 << state.wbits;\n        //state.dmax = 1 << len;\n\n        state.flags = 0;               /* indicate zlib header */\n        //Tracev((stderr, \"inflate:   zlib header ok\\n\"));\n        strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\n        state.mode = hold & 0x200 ? DICTID : TYPE;\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        break;\n      case FLAGS:\n        //=== NEEDBITS(16); */\n        while (bits < 16) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        state.flags = hold;\n        if ((state.flags & 0xff) !== Z_DEFLATED) {\n          strm.msg = 'unknown compression method';\n          state.mode = BAD;\n          break;\n        }\n        if (state.flags & 0xe000) {\n          strm.msg = 'unknown header flags set';\n          state.mode = BAD;\n          break;\n        }\n        if (state.head) {\n          state.head.text = ((hold >> 8) & 1);\n        }\n        if ((state.flags & 0x0200) && (state.wrap & 4)) {\n          //=== CRC2(state.check, hold);\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 2, 0);\n          //===//\n        }\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = TIME;\n        /* falls through */\n      case TIME:\n        //=== NEEDBITS(32); */\n        while (bits < 32) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if (state.head) {\n          state.head.time = hold;\n        }\n        if ((state.flags & 0x0200) && (state.wrap & 4)) {\n          //=== CRC4(state.check, hold)\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          hbuf[2] = (hold >>> 16) & 0xff;\n          hbuf[3] = (hold >>> 24) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 4, 0);\n          //===\n        }\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = OS;\n        /* falls through */\n      case OS:\n        //=== NEEDBITS(16); */\n        while (bits < 16) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if (state.head) {\n          state.head.xflags = (hold & 0xff);\n          state.head.os = (hold >> 8);\n        }\n        if ((state.flags & 0x0200) && (state.wrap & 4)) {\n          //=== CRC2(state.check, hold);\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 2, 0);\n          //===//\n        }\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = EXLEN;\n        /* falls through */\n      case EXLEN:\n        if (state.flags & 0x0400) {\n          //=== NEEDBITS(16); */\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.length = hold;\n          if (state.head) {\n            state.head.extra_len = hold;\n          }\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            //=== CRC2(state.check, hold);\n            hbuf[0] = hold & 0xff;\n            hbuf[1] = (hold >>> 8) & 0xff;\n            state.check = crc32_1(state.check, hbuf, 2, 0);\n            //===//\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n        }\n        else if (state.head) {\n          state.head.extra = null/*Z_NULL*/;\n        }\n        state.mode = EXTRA;\n        /* falls through */\n      case EXTRA:\n        if (state.flags & 0x0400) {\n          copy = state.length;\n          if (copy > have) { copy = have; }\n          if (copy) {\n            if (state.head) {\n              len = state.head.extra_len - state.length;\n              if (!state.head.extra) {\n                // Use untyped array for more convenient processing later\n                state.head.extra = new Uint8Array(state.head.extra_len);\n              }\n              state.head.extra.set(\n                input.subarray(\n                  next,\n                  // extra field is limited to 65536 bytes\n                  // - no need for additional size check\n                  next + copy\n                ),\n                /*len + copy > state.head.extra_max - len ? state.head.extra_max : copy,*/\n                len\n              );\n              //zmemcpy(state.head.extra + len, next,\n              //        len + copy > state.head.extra_max ?\n              //        state.head.extra_max - len : copy);\n            }\n            if ((state.flags & 0x0200) && (state.wrap & 4)) {\n              state.check = crc32_1(state.check, input, copy, next);\n            }\n            have -= copy;\n            next += copy;\n            state.length -= copy;\n          }\n          if (state.length) { break inf_leave; }\n        }\n        state.length = 0;\n        state.mode = NAME;\n        /* falls through */\n      case NAME:\n        if (state.flags & 0x0800) {\n          if (have === 0) { break inf_leave; }\n          copy = 0;\n          do {\n            // TODO: 2 or 1 bytes?\n            len = input[next + copy++];\n            /* use constant limit because in js we should not preallocate memory */\n            if (state.head && len &&\n                (state.length < 65536 /*state.head.name_max*/)) {\n              state.head.name += String.fromCharCode(len);\n            }\n          } while (len && copy < have);\n\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            state.check = crc32_1(state.check, input, copy, next);\n          }\n          have -= copy;\n          next += copy;\n          if (len) { break inf_leave; }\n        }\n        else if (state.head) {\n          state.head.name = null;\n        }\n        state.length = 0;\n        state.mode = COMMENT;\n        /* falls through */\n      case COMMENT:\n        if (state.flags & 0x1000) {\n          if (have === 0) { break inf_leave; }\n          copy = 0;\n          do {\n            len = input[next + copy++];\n            /* use constant limit because in js we should not preallocate memory */\n            if (state.head && len &&\n                (state.length < 65536 /*state.head.comm_max*/)) {\n              state.head.comment += String.fromCharCode(len);\n            }\n          } while (len && copy < have);\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            state.check = crc32_1(state.check, input, copy, next);\n          }\n          have -= copy;\n          next += copy;\n          if (len) { break inf_leave; }\n        }\n        else if (state.head) {\n          state.head.comment = null;\n        }\n        state.mode = HCRC;\n        /* falls through */\n      case HCRC:\n        if (state.flags & 0x0200) {\n          //=== NEEDBITS(16); */\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if ((state.wrap & 4) && hold !== (state.check & 0xffff)) {\n            strm.msg = 'header crc mismatch';\n            state.mode = BAD;\n            break;\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n        }\n        if (state.head) {\n          state.head.hcrc = ((state.flags >> 9) & 1);\n          state.head.done = true;\n        }\n        strm.adler = state.check = 0;\n        state.mode = TYPE;\n        break;\n      case DICTID:\n        //=== NEEDBITS(32); */\n        while (bits < 32) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        strm.adler = state.check = zswap32(hold);\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = DICT;\n        /* falls through */\n      case DICT:\n        if (state.havedict === 0) {\n          //--- RESTORE() ---\n          strm.next_out = put;\n          strm.avail_out = left;\n          strm.next_in = next;\n          strm.avail_in = have;\n          state.hold = hold;\n          state.bits = bits;\n          //---\n          return Z_NEED_DICT$1;\n        }\n        strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\n        state.mode = TYPE;\n        /* falls through */\n      case TYPE:\n        if (flush === Z_BLOCK || flush === Z_TREES) { break inf_leave; }\n        /* falls through */\n      case TYPEDO:\n        if (state.last) {\n          //--- BYTEBITS() ---//\n          hold >>>= bits & 7;\n          bits -= bits & 7;\n          //---//\n          state.mode = CHECK;\n          break;\n        }\n        //=== NEEDBITS(3); */\n        while (bits < 3) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        state.last = (hold & 0x01)/*BITS(1)*/;\n        //--- DROPBITS(1) ---//\n        hold >>>= 1;\n        bits -= 1;\n        //---//\n\n        switch ((hold & 0x03)/*BITS(2)*/) {\n          case 0:                             /* stored block */\n            //Tracev((stderr, \"inflate:     stored block%s\\n\",\n            //        state.last ? \" (last)\" : \"\"));\n            state.mode = STORED;\n            break;\n          case 1:                             /* fixed block */\n            fixedtables(state);\n            //Tracev((stderr, \"inflate:     fixed codes block%s\\n\",\n            //        state.last ? \" (last)\" : \"\"));\n            state.mode = LEN_;             /* decode codes */\n            if (flush === Z_TREES) {\n              //--- DROPBITS(2) ---//\n              hold >>>= 2;\n              bits -= 2;\n              //---//\n              break inf_leave;\n            }\n            break;\n          case 2:                             /* dynamic block */\n            //Tracev((stderr, \"inflate:     dynamic codes block%s\\n\",\n            //        state.last ? \" (last)\" : \"\"));\n            state.mode = TABLE;\n            break;\n          case 3:\n            strm.msg = 'invalid block type';\n            state.mode = BAD;\n        }\n        //--- DROPBITS(2) ---//\n        hold >>>= 2;\n        bits -= 2;\n        //---//\n        break;\n      case STORED:\n        //--- BYTEBITS() ---// /* go to byte boundary */\n        hold >>>= bits & 7;\n        bits -= bits & 7;\n        //---//\n        //=== NEEDBITS(32); */\n        while (bits < 32) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if ((hold & 0xffff) !== ((hold >>> 16) ^ 0xffff)) {\n          strm.msg = 'invalid stored block lengths';\n          state.mode = BAD;\n          break;\n        }\n        state.length = hold & 0xffff;\n        //Tracev((stderr, \"inflate:       stored length %u\\n\",\n        //        state.length));\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = COPY_;\n        if (flush === Z_TREES) { break inf_leave; }\n        /* falls through */\n      case COPY_:\n        state.mode = COPY;\n        /* falls through */\n      case COPY:\n        copy = state.length;\n        if (copy) {\n          if (copy > have) { copy = have; }\n          if (copy > left) { copy = left; }\n          if (copy === 0) { break inf_leave; }\n          //--- zmemcpy(put, next, copy); ---\n          output.set(input.subarray(next, next + copy), put);\n          //---//\n          have -= copy;\n          next += copy;\n          left -= copy;\n          put += copy;\n          state.length -= copy;\n          break;\n        }\n        //Tracev((stderr, \"inflate:       stored end\\n\"));\n        state.mode = TYPE;\n        break;\n      case TABLE:\n        //=== NEEDBITS(14); */\n        while (bits < 14) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        state.nlen = (hold & 0x1f)/*BITS(5)*/ + 257;\n        //--- DROPBITS(5) ---//\n        hold >>>= 5;\n        bits -= 5;\n        //---//\n        state.ndist = (hold & 0x1f)/*BITS(5)*/ + 1;\n        //--- DROPBITS(5) ---//\n        hold >>>= 5;\n        bits -= 5;\n        //---//\n        state.ncode = (hold & 0x0f)/*BITS(4)*/ + 4;\n        //--- DROPBITS(4) ---//\n        hold >>>= 4;\n        bits -= 4;\n        //---//\n//#ifndef PKZIP_BUG_WORKAROUND\n        if (state.nlen > 286 || state.ndist > 30) {\n          strm.msg = 'too many length or distance symbols';\n          state.mode = BAD;\n          break;\n        }\n//#endif\n        //Tracev((stderr, \"inflate:       table sizes ok\\n\"));\n        state.have = 0;\n        state.mode = LENLENS;\n        /* falls through */\n      case LENLENS:\n        while (state.have < state.ncode) {\n          //=== NEEDBITS(3);\n          while (bits < 3) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.lens[order[state.have++]] = (hold & 0x07);//BITS(3);\n          //--- DROPBITS(3) ---//\n          hold >>>= 3;\n          bits -= 3;\n          //---//\n        }\n        while (state.have < 19) {\n          state.lens[order[state.have++]] = 0;\n        }\n        // We have separate tables & no pointers. 2 commented lines below not needed.\n        //state.next = state.codes;\n        //state.lencode = state.next;\n        // Switch to use dynamic table\n        state.lencode = state.lendyn;\n        state.lenbits = 7;\n\n        opts = { bits: state.lenbits };\n        ret = inftrees(CODES, state.lens, 0, 19, state.lencode, 0, state.work, opts);\n        state.lenbits = opts.bits;\n\n        if (ret) {\n          strm.msg = 'invalid code lengths set';\n          state.mode = BAD;\n          break;\n        }\n        //Tracev((stderr, \"inflate:       code lengths ok\\n\"));\n        state.have = 0;\n        state.mode = CODELENS;\n        /* falls through */\n      case CODELENS:\n        while (state.have < state.nlen + state.ndist) {\n          for (;;) {\n            here = state.lencode[hold & ((1 << state.lenbits) - 1)];/*BITS(state.lenbits)*/\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          if (here_val < 16) {\n            //--- DROPBITS(here.bits) ---//\n            hold >>>= here_bits;\n            bits -= here_bits;\n            //---//\n            state.lens[state.have++] = here_val;\n          }\n          else {\n            if (here_val === 16) {\n              //=== NEEDBITS(here.bits + 2);\n              n = here_bits + 2;\n              while (bits < n) {\n                if (have === 0) { break inf_leave; }\n                have--;\n                hold += input[next++] << bits;\n                bits += 8;\n              }\n              //===//\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              if (state.have === 0) {\n                strm.msg = 'invalid bit length repeat';\n                state.mode = BAD;\n                break;\n              }\n              len = state.lens[state.have - 1];\n              copy = 3 + (hold & 0x03);//BITS(2);\n              //--- DROPBITS(2) ---//\n              hold >>>= 2;\n              bits -= 2;\n              //---//\n            }\n            else if (here_val === 17) {\n              //=== NEEDBITS(here.bits + 3);\n              n = here_bits + 3;\n              while (bits < n) {\n                if (have === 0) { break inf_leave; }\n                have--;\n                hold += input[next++] << bits;\n                bits += 8;\n              }\n              //===//\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              len = 0;\n              copy = 3 + (hold & 0x07);//BITS(3);\n              //--- DROPBITS(3) ---//\n              hold >>>= 3;\n              bits -= 3;\n              //---//\n            }\n            else {\n              //=== NEEDBITS(here.bits + 7);\n              n = here_bits + 7;\n              while (bits < n) {\n                if (have === 0) { break inf_leave; }\n                have--;\n                hold += input[next++] << bits;\n                bits += 8;\n              }\n              //===//\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              len = 0;\n              copy = 11 + (hold & 0x7f);//BITS(7);\n              //--- DROPBITS(7) ---//\n              hold >>>= 7;\n              bits -= 7;\n              //---//\n            }\n            if (state.have + copy > state.nlen + state.ndist) {\n              strm.msg = 'invalid bit length repeat';\n              state.mode = BAD;\n              break;\n            }\n            while (copy--) {\n              state.lens[state.have++] = len;\n            }\n          }\n        }\n\n        /* handle error breaks in while */\n        if (state.mode === BAD) { break; }\n\n        /* check for end-of-block code (better have one) */\n        if (state.lens[256] === 0) {\n          strm.msg = 'invalid code -- missing end-of-block';\n          state.mode = BAD;\n          break;\n        }\n\n        /* build code tables -- note: do not change the lenbits or distbits\n           values here (9 and 6) without reading the comments in inftrees.h\n           concerning the ENOUGH constants, which depend on those values */\n        state.lenbits = 9;\n\n        opts = { bits: state.lenbits };\n        ret = inftrees(LENS, state.lens, 0, state.nlen, state.lencode, 0, state.work, opts);\n        // We have separate tables & no pointers. 2 commented lines below not needed.\n        // state.next_index = opts.table_index;\n        state.lenbits = opts.bits;\n        // state.lencode = state.next;\n\n        if (ret) {\n          strm.msg = 'invalid literal/lengths set';\n          state.mode = BAD;\n          break;\n        }\n\n        state.distbits = 6;\n        //state.distcode.copy(state.codes);\n        // Switch to use dynamic table\n        state.distcode = state.distdyn;\n        opts = { bits: state.distbits };\n        ret = inftrees(DISTS, state.lens, state.nlen, state.ndist, state.distcode, 0, state.work, opts);\n        // We have separate tables & no pointers. 2 commented lines below not needed.\n        // state.next_index = opts.table_index;\n        state.distbits = opts.bits;\n        // state.distcode = state.next;\n\n        if (ret) {\n          strm.msg = 'invalid distances set';\n          state.mode = BAD;\n          break;\n        }\n        //Tracev((stderr, 'inflate:       codes ok\\n'));\n        state.mode = LEN_;\n        if (flush === Z_TREES) { break inf_leave; }\n        /* falls through */\n      case LEN_:\n        state.mode = LEN;\n        /* falls through */\n      case LEN:\n        if (have >= 6 && left >= 258) {\n          //--- RESTORE() ---\n          strm.next_out = put;\n          strm.avail_out = left;\n          strm.next_in = next;\n          strm.avail_in = have;\n          state.hold = hold;\n          state.bits = bits;\n          //---\n          inffast(strm, _out);\n          //--- LOAD() ---\n          put = strm.next_out;\n          output = strm.output;\n          left = strm.avail_out;\n          next = strm.next_in;\n          input = strm.input;\n          have = strm.avail_in;\n          hold = state.hold;\n          bits = state.bits;\n          //---\n\n          if (state.mode === TYPE) {\n            state.back = -1;\n          }\n          break;\n        }\n        state.back = 0;\n        for (;;) {\n          here = state.lencode[hold & ((1 << state.lenbits) - 1)];  /*BITS(state.lenbits)*/\n          here_bits = here >>> 24;\n          here_op = (here >>> 16) & 0xff;\n          here_val = here & 0xffff;\n\n          if (here_bits <= bits) { break; }\n          //--- PULLBYTE() ---//\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n          //---//\n        }\n        if (here_op && (here_op & 0xf0) === 0) {\n          last_bits = here_bits;\n          last_op = here_op;\n          last_val = here_val;\n          for (;;) {\n            here = state.lencode[last_val +\n                    ((hold & ((1 << (last_bits + last_op)) - 1))/*BITS(last.bits + last.op)*/ >> last_bits)];\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((last_bits + here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          //--- DROPBITS(last.bits) ---//\n          hold >>>= last_bits;\n          bits -= last_bits;\n          //---//\n          state.back += last_bits;\n        }\n        //--- DROPBITS(here.bits) ---//\n        hold >>>= here_bits;\n        bits -= here_bits;\n        //---//\n        state.back += here_bits;\n        state.length = here_val;\n        if (here_op === 0) {\n          //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\n          //        \"inflate:         literal '%c'\\n\" :\n          //        \"inflate:         literal 0x%02x\\n\", here.val));\n          state.mode = LIT;\n          break;\n        }\n        if (here_op & 32) {\n          //Tracevv((stderr, \"inflate:         end of block\\n\"));\n          state.back = -1;\n          state.mode = TYPE;\n          break;\n        }\n        if (here_op & 64) {\n          strm.msg = 'invalid literal/length code';\n          state.mode = BAD;\n          break;\n        }\n        state.extra = here_op & 15;\n        state.mode = LENEXT;\n        /* falls through */\n      case LENEXT:\n        if (state.extra) {\n          //=== NEEDBITS(state.extra);\n          n = state.extra;\n          while (bits < n) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.length += hold & ((1 << state.extra) - 1)/*BITS(state.extra)*/;\n          //--- DROPBITS(state.extra) ---//\n          hold >>>= state.extra;\n          bits -= state.extra;\n          //---//\n          state.back += state.extra;\n        }\n        //Tracevv((stderr, \"inflate:         length %u\\n\", state.length));\n        state.was = state.length;\n        state.mode = DIST;\n        /* falls through */\n      case DIST:\n        for (;;) {\n          here = state.distcode[hold & ((1 << state.distbits) - 1)];/*BITS(state.distbits)*/\n          here_bits = here >>> 24;\n          here_op = (here >>> 16) & 0xff;\n          here_val = here & 0xffff;\n\n          if ((here_bits) <= bits) { break; }\n          //--- PULLBYTE() ---//\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n          //---//\n        }\n        if ((here_op & 0xf0) === 0) {\n          last_bits = here_bits;\n          last_op = here_op;\n          last_val = here_val;\n          for (;;) {\n            here = state.distcode[last_val +\n                    ((hold & ((1 << (last_bits + last_op)) - 1))/*BITS(last.bits + last.op)*/ >> last_bits)];\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((last_bits + here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          //--- DROPBITS(last.bits) ---//\n          hold >>>= last_bits;\n          bits -= last_bits;\n          //---//\n          state.back += last_bits;\n        }\n        //--- DROPBITS(here.bits) ---//\n        hold >>>= here_bits;\n        bits -= here_bits;\n        //---//\n        state.back += here_bits;\n        if (here_op & 64) {\n          strm.msg = 'invalid distance code';\n          state.mode = BAD;\n          break;\n        }\n        state.offset = here_val;\n        state.extra = (here_op) & 15;\n        state.mode = DISTEXT;\n        /* falls through */\n      case DISTEXT:\n        if (state.extra) {\n          //=== NEEDBITS(state.extra);\n          n = state.extra;\n          while (bits < n) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.offset += hold & ((1 << state.extra) - 1)/*BITS(state.extra)*/;\n          //--- DROPBITS(state.extra) ---//\n          hold >>>= state.extra;\n          bits -= state.extra;\n          //---//\n          state.back += state.extra;\n        }\n//#ifdef INFLATE_STRICT\n        if (state.offset > state.dmax) {\n          strm.msg = 'invalid distance too far back';\n          state.mode = BAD;\n          break;\n        }\n//#endif\n        //Tracevv((stderr, \"inflate:         distance %u\\n\", state.offset));\n        state.mode = MATCH;\n        /* falls through */\n      case MATCH:\n        if (left === 0) { break inf_leave; }\n        copy = _out - left;\n        if (state.offset > copy) {         /* copy from window */\n          copy = state.offset - copy;\n          if (copy > state.whave) {\n            if (state.sane) {\n              strm.msg = 'invalid distance too far back';\n              state.mode = BAD;\n              break;\n            }\n// (!) This block is disabled in zlib defaults,\n// don't enable it for binary compatibility\n//#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\n//          Trace((stderr, \"inflate.c too far\\n\"));\n//          copy -= state.whave;\n//          if (copy > state.length) { copy = state.length; }\n//          if (copy > left) { copy = left; }\n//          left -= copy;\n//          state.length -= copy;\n//          do {\n//            output[put++] = 0;\n//          } while (--copy);\n//          if (state.length === 0) { state.mode = LEN; }\n//          break;\n//#endif\n          }\n          if (copy > state.wnext) {\n            copy -= state.wnext;\n            from = state.wsize - copy;\n          }\n          else {\n            from = state.wnext - copy;\n          }\n          if (copy > state.length) { copy = state.length; }\n          from_source = state.window;\n        }\n        else {                              /* copy from output */\n          from_source = output;\n          from = put - state.offset;\n          copy = state.length;\n        }\n        if (copy > left) { copy = left; }\n        left -= copy;\n        state.length -= copy;\n        do {\n          output[put++] = from_source[from++];\n        } while (--copy);\n        if (state.length === 0) { state.mode = LEN; }\n        break;\n      case LIT:\n        if (left === 0) { break inf_leave; }\n        output[put++] = state.length;\n        left--;\n        state.mode = LEN;\n        break;\n      case CHECK:\n        if (state.wrap) {\n          //=== NEEDBITS(32);\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            // Use '|' instead of '+' to make sure that result is signed\n            hold |= input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          _out -= left;\n          strm.total_out += _out;\n          state.total += _out;\n          if ((state.wrap & 4) && _out) {\n            strm.adler = state.check =\n                /*UPDATE_CHECK(state.check, put - _out, _out);*/\n                (state.flags ? crc32_1(state.check, output, _out, put - _out) : adler32_1(state.check, output, _out, put - _out));\n\n          }\n          _out = left;\n          // NB: crc32 stored as signed 32-bit int, zswap32 returns signed too\n          if ((state.wrap & 4) && (state.flags ? hold : zswap32(hold)) !== state.check) {\n            strm.msg = 'incorrect data check';\n            state.mode = BAD;\n            break;\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          //Tracev((stderr, \"inflate:   check matches trailer\\n\"));\n        }\n        state.mode = LENGTH;\n        /* falls through */\n      case LENGTH:\n        if (state.wrap && state.flags) {\n          //=== NEEDBITS(32);\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if ((state.wrap & 4) && hold !== (state.total & 0xffffffff)) {\n            strm.msg = 'incorrect length check';\n            state.mode = BAD;\n            break;\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          //Tracev((stderr, \"inflate:   length matches trailer\\n\"));\n        }\n        state.mode = DONE;\n        /* falls through */\n      case DONE:\n        ret = Z_STREAM_END$1;\n        break inf_leave;\n      case BAD:\n        ret = Z_DATA_ERROR$1;\n        break inf_leave;\n      case MEM:\n        return Z_MEM_ERROR$1;\n      case SYNC:\n        /* falls through */\n      default:\n        return Z_STREAM_ERROR$1;\n    }\n  }\n\n  // inf_leave <- here is real place for \"goto inf_leave\", emulated via \"break inf_leave\"\n\n  /*\n     Return from inflate(), updating the total counts and the check value.\n     If there was no progress during the inflate() call, return a buffer\n     error.  Call updatewindow() to create and/or update the window state.\n     Note: a memory error from inflate() is non-recoverable.\n   */\n\n  //--- RESTORE() ---\n  strm.next_out = put;\n  strm.avail_out = left;\n  strm.next_in = next;\n  strm.avail_in = have;\n  state.hold = hold;\n  state.bits = bits;\n  //---\n\n  if (state.wsize || (_out !== strm.avail_out && state.mode < BAD &&\n                      (state.mode < CHECK || flush !== Z_FINISH$1))) {\n    if (updatewindow(strm, strm.output, strm.next_out, _out - strm.avail_out)) ;\n  }\n  _in -= strm.avail_in;\n  _out -= strm.avail_out;\n  strm.total_in += _in;\n  strm.total_out += _out;\n  state.total += _out;\n  if ((state.wrap & 4) && _out) {\n    strm.adler = state.check = /*UPDATE_CHECK(state.check, strm.next_out - _out, _out);*/\n      (state.flags ? crc32_1(state.check, output, _out, strm.next_out - _out) : adler32_1(state.check, output, _out, strm.next_out - _out));\n  }\n  strm.data_type = state.bits + (state.last ? 64 : 0) +\n                    (state.mode === TYPE ? 128 : 0) +\n                    (state.mode === LEN_ || state.mode === COPY_ ? 256 : 0);\n  if (((_in === 0 && _out === 0) || flush === Z_FINISH$1) && ret === Z_OK$1) {\n    ret = Z_BUF_ERROR;\n  }\n  return ret;\n};\n\n\nconst inflateEnd = (strm) => {\n\n  if (inflateStateCheck(strm)) {\n    return Z_STREAM_ERROR$1;\n  }\n\n  let state = strm.state;\n  if (state.window) {\n    state.window = null;\n  }\n  strm.state = null;\n  return Z_OK$1;\n};\n\n\nconst inflateGetHeader = (strm, head) => {\n\n  /* check state */\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n  if ((state.wrap & 2) === 0) { return Z_STREAM_ERROR$1; }\n\n  /* save header structure */\n  state.head = head;\n  head.done = false;\n  return Z_OK$1;\n};\n\n\nconst inflateSetDictionary = (strm, dictionary) => {\n  const dictLength = dictionary.length;\n\n  let state;\n  let dictid;\n  let ret;\n\n  /* check state */\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  state = strm.state;\n\n  if (state.wrap !== 0 && state.mode !== DICT) {\n    return Z_STREAM_ERROR$1;\n  }\n\n  /* check for correct dictionary identifier */\n  if (state.mode === DICT) {\n    dictid = 1; /* adler32(0, null, 0)*/\n    /* dictid = adler32(dictid, dictionary, dictLength); */\n    dictid = adler32_1(dictid, dictionary, dictLength, 0);\n    if (dictid !== state.check) {\n      return Z_DATA_ERROR$1;\n    }\n  }\n  /* copy dictionary to window using updatewindow(), which will amend the\n   existing dictionary if appropriate */\n  ret = updatewindow(strm, dictionary, dictLength, dictLength);\n  if (ret) {\n    state.mode = MEM;\n    return Z_MEM_ERROR$1;\n  }\n  state.havedict = 1;\n  // Tracev((stderr, \"inflate:   dictionary set\\n\"));\n  return Z_OK$1;\n};\n\n\nvar inflateReset_1 = inflateReset;\nvar inflateReset2_1 = inflateReset2;\nvar inflateResetKeep_1 = inflateResetKeep;\nvar inflateInit_1 = inflateInit;\nvar inflateInit2_1 = inflateInit2;\nvar inflate_2$1 = inflate$2;\nvar inflateEnd_1 = inflateEnd;\nvar inflateGetHeader_1 = inflateGetHeader;\nvar inflateSetDictionary_1 = inflateSetDictionary;\nvar inflateInfo = 'pako inflate (from Nodeca project)';\n\n/* Not implemented\nmodule.exports.inflateCodesUsed = inflateCodesUsed;\nmodule.exports.inflateCopy = inflateCopy;\nmodule.exports.inflateGetDictionary = inflateGetDictionary;\nmodule.exports.inflateMark = inflateMark;\nmodule.exports.inflatePrime = inflatePrime;\nmodule.exports.inflateSync = inflateSync;\nmodule.exports.inflateSyncPoint = inflateSyncPoint;\nmodule.exports.inflateUndermine = inflateUndermine;\nmodule.exports.inflateValidate = inflateValidate;\n*/\n\nvar inflate_1$2 = {\n\tinflateReset: inflateReset_1,\n\tinflateReset2: inflateReset2_1,\n\tinflateResetKeep: inflateResetKeep_1,\n\tinflateInit: inflateInit_1,\n\tinflateInit2: inflateInit2_1,\n\tinflate: inflate_2$1,\n\tinflateEnd: inflateEnd_1,\n\tinflateGetHeader: inflateGetHeader_1,\n\tinflateSetDictionary: inflateSetDictionary_1,\n\tinflateInfo: inflateInfo\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nfunction GZheader() {\n  /* true if compressed data believed to be text */\n  this.text       = 0;\n  /* modification time */\n  this.time       = 0;\n  /* extra flags (not used when writing a gzip file) */\n  this.xflags     = 0;\n  /* operating system */\n  this.os         = 0;\n  /* pointer to extra field or Z_NULL if none */\n  this.extra      = null;\n  /* extra field length (valid if extra != Z_NULL) */\n  this.extra_len  = 0; // Actually, we don't need it in JS,\n                       // but leave for few code modifications\n\n  //\n  // Setup limits is not necessary because in js we should not preallocate memory\n  // for inflate use constant limit in 65536 bytes\n  //\n\n  /* space at extra (only when reading header) */\n  // this.extra_max  = 0;\n  /* pointer to zero-terminated file name or Z_NULL */\n  this.name       = '';\n  /* space at name (only when reading header) */\n  // this.name_max   = 0;\n  /* pointer to zero-terminated comment or Z_NULL */\n  this.comment    = '';\n  /* space at comment (only when reading header) */\n  // this.comm_max   = 0;\n  /* true if there was or will be a header crc */\n  this.hcrc       = 0;\n  /* true when done reading gzip header (not used when writing a gzip file) */\n  this.done       = false;\n}\n\nvar gzheader = GZheader;\n\nconst toString = Object.prototype.toString;\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_NO_FLUSH, Z_FINISH,\n  Z_OK, Z_STREAM_END, Z_NEED_DICT, Z_STREAM_ERROR, Z_DATA_ERROR, Z_MEM_ERROR\n} = constants$2;\n\n/* ===========================================================================*/\n\n\n/**\n * class Inflate\n *\n * Generic JS-style wrapper for zlib calls. If you don't need\n * streaming behaviour - use more simple functions: [[inflate]]\n * and [[inflateRaw]].\n **/\n\n/* internal\n * inflate.chunks -> Array\n *\n * Chunks of output data, if [[Inflate#onData]] not overridden.\n **/\n\n/**\n * Inflate.result -> Uint8Array|String\n *\n * Uncompressed result, generated by default [[Inflate#onData]]\n * and [[Inflate#onEnd]] handlers. Filled after you push last chunk\n * (call [[Inflate#push]] with `Z_FINISH` / `true` param).\n **/\n\n/**\n * Inflate.err -> Number\n *\n * Error code after inflate finished. 0 (Z_OK) on success.\n * Should be checked if broken data possible.\n **/\n\n/**\n * Inflate.msg -> String\n *\n * Error message, if [[Inflate.err]] != 0\n **/\n\n\n/**\n * new Inflate(options)\n * - options (Object): zlib inflate options.\n *\n * Creates new inflator instance with specified params. Throws exception\n * on bad params. Supported options:\n *\n * - `windowBits`\n * - `dictionary`\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information on these.\n *\n * Additional options, for internal needs:\n *\n * - `chunkSize` - size of generated data chunks (16K by default)\n * - `raw` (Boolean) - do raw inflate\n * - `to` (String) - if equal to 'string', then result will be converted\n *   from utf8 to utf16 (javascript) string. When string output requested,\n *   chunk length can differ from `chunkSize`, depending on content.\n *\n * By default, when no options set, autodetect deflate/gzip data format via\n * wrapper header.\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako')\n * const chunk1 = new Uint8Array([1,2,3,4,5,6,7,8,9])\n * const chunk2 = new Uint8Array([10,11,12,13,14,15,16,17,18,19]);\n *\n * const inflate = new pako.Inflate({ level: 3});\n *\n * inflate.push(chunk1, false);\n * inflate.push(chunk2, true);  // true -> last chunk\n *\n * if (inflate.err) { throw new Error(inflate.err); }\n *\n * console.log(inflate.result);\n * ```\n **/\nfunction Inflate$1(options) {\n  this.options = common.assign({\n    chunkSize: 1024 * 64,\n    windowBits: 15,\n    to: ''\n  }, options || {});\n\n  const opt = this.options;\n\n  // Force window size for `raw` data, if not set directly,\n  // because we have no header for autodetect.\n  if (opt.raw && (opt.windowBits >= 0) && (opt.windowBits < 16)) {\n    opt.windowBits = -opt.windowBits;\n    if (opt.windowBits === 0) { opt.windowBits = -15; }\n  }\n\n  // If `windowBits` not defined (and mode not raw) - set autodetect flag for gzip/deflate\n  if ((opt.windowBits >= 0) && (opt.windowBits < 16) &&\n      !(options && options.windowBits)) {\n    opt.windowBits += 32;\n  }\n\n  // Gzip header has no info about windows size, we can do autodetect only\n  // for deflate. So, if window size not set, force it to max when gzip possible\n  if ((opt.windowBits > 15) && (opt.windowBits < 48)) {\n    // bit 3 (16) -> gzipped data\n    // bit 4 (32) -> autodetect gzip/deflate\n    if ((opt.windowBits & 15) === 0) {\n      opt.windowBits |= 15;\n    }\n  }\n\n  this.err    = 0;      // error code, if happens (0 = Z_OK)\n  this.msg    = '';     // error message\n  this.ended  = false;  // used to avoid multiple onEnd() calls\n  this.chunks = [];     // chunks of compressed data\n\n  this.strm   = new zstream();\n  this.strm.avail_out = 0;\n\n  let status  = inflate_1$2.inflateInit2(\n    this.strm,\n    opt.windowBits\n  );\n\n  if (status !== Z_OK) {\n    throw new Error(messages[status]);\n  }\n\n  this.header = new gzheader();\n\n  inflate_1$2.inflateGetHeader(this.strm, this.header);\n\n  // Setup dictionary\n  if (opt.dictionary) {\n    // Convert data if needed\n    if (typeof opt.dictionary === 'string') {\n      opt.dictionary = strings.string2buf(opt.dictionary);\n    } else if (toString.call(opt.dictionary) === '[object ArrayBuffer]') {\n      opt.dictionary = new Uint8Array(opt.dictionary);\n    }\n    if (opt.raw) { //In raw mode we need to set the dictionary early\n      status = inflate_1$2.inflateSetDictionary(this.strm, opt.dictionary);\n      if (status !== Z_OK) {\n        throw new Error(messages[status]);\n      }\n    }\n  }\n}\n\n/**\n * Inflate#push(data[, flush_mode]) -> Boolean\n * - data (Uint8Array|ArrayBuffer): input data\n * - flush_mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE\n *   flush modes. See constants. Skipped or `false` means Z_NO_FLUSH,\n *   `true` means Z_FINISH.\n *\n * Sends input data to inflate pipe, generating [[Inflate#onData]] calls with\n * new output chunks. Returns `true` on success. If end of stream detected,\n * [[Inflate#onEnd]] will be called.\n *\n * `flush_mode` is not needed for normal operation, because end of stream\n * detected automatically. You may try to use it for advanced things, but\n * this functionality was not tested.\n *\n * On fail call [[Inflate#onEnd]] with error code and return false.\n *\n * ##### Example\n *\n * ```javascript\n * push(chunk, false); // push one of data chunks\n * ...\n * push(chunk, true);  // push last chunk\n * ```\n **/\nInflate$1.prototype.push = function (data, flush_mode) {\n  const strm = this.strm;\n  const chunkSize = this.options.chunkSize;\n  const dictionary = this.options.dictionary;\n  let status, _flush_mode, last_avail_out;\n\n  if (this.ended) return false;\n\n  if (flush_mode === ~~flush_mode) _flush_mode = flush_mode;\n  else _flush_mode = flush_mode === true ? Z_FINISH : Z_NO_FLUSH;\n\n  // Convert data if needed\n  if (toString.call(data) === '[object ArrayBuffer]') {\n    strm.input = new Uint8Array(data);\n  } else {\n    strm.input = data;\n  }\n\n  strm.next_in = 0;\n  strm.avail_in = strm.input.length;\n\n  for (;;) {\n    if (strm.avail_out === 0) {\n      strm.output = new Uint8Array(chunkSize);\n      strm.next_out = 0;\n      strm.avail_out = chunkSize;\n    }\n\n    status = inflate_1$2.inflate(strm, _flush_mode);\n\n    if (status === Z_NEED_DICT && dictionary) {\n      status = inflate_1$2.inflateSetDictionary(strm, dictionary);\n\n      if (status === Z_OK) {\n        status = inflate_1$2.inflate(strm, _flush_mode);\n      } else if (status === Z_DATA_ERROR) {\n        // Replace code with more verbose\n        status = Z_NEED_DICT;\n      }\n    }\n\n    // Skip snyc markers if more data follows and not raw mode\n    while (strm.avail_in > 0 &&\n           status === Z_STREAM_END &&\n           strm.state.wrap > 0 &&\n           data[strm.next_in] !== 0)\n    {\n      inflate_1$2.inflateReset(strm);\n      status = inflate_1$2.inflate(strm, _flush_mode);\n    }\n\n    switch (status) {\n      case Z_STREAM_ERROR:\n      case Z_DATA_ERROR:\n      case Z_NEED_DICT:\n      case Z_MEM_ERROR:\n        this.onEnd(status);\n        this.ended = true;\n        return false;\n    }\n\n    // Remember real `avail_out` value, because we may patch out buffer content\n    // to align utf8 strings boundaries.\n    last_avail_out = strm.avail_out;\n\n    if (strm.next_out) {\n      if (strm.avail_out === 0 || status === Z_STREAM_END) {\n\n        if (this.options.to === 'string') {\n\n          let next_out_utf8 = strings.utf8border(strm.output, strm.next_out);\n\n          let tail = strm.next_out - next_out_utf8;\n          let utf8str = strings.buf2string(strm.output, next_out_utf8);\n\n          // move tail & realign counters\n          strm.next_out = tail;\n          strm.avail_out = chunkSize - tail;\n          if (tail) strm.output.set(strm.output.subarray(next_out_utf8, next_out_utf8 + tail), 0);\n\n          this.onData(utf8str);\n\n        } else {\n          this.onData(strm.output.length === strm.next_out ? strm.output : strm.output.subarray(0, strm.next_out));\n        }\n      }\n    }\n\n    // Must repeat iteration if out buffer is full\n    if (status === Z_OK && last_avail_out === 0) continue;\n\n    // Finalize if end of stream reached.\n    if (status === Z_STREAM_END) {\n      status = inflate_1$2.inflateEnd(this.strm);\n      this.onEnd(status);\n      this.ended = true;\n      return true;\n    }\n\n    if (strm.avail_in === 0) break;\n  }\n\n  return true;\n};\n\n\n/**\n * Inflate#onData(chunk) -> Void\n * - chunk (Uint8Array|String): output data. When string output requested,\n *   each chunk will be string.\n *\n * By default, stores data blocks in `chunks[]` property and glue\n * those in `onEnd`. Override this handler, if you need another behaviour.\n **/\nInflate$1.prototype.onData = function (chunk) {\n  this.chunks.push(chunk);\n};\n\n\n/**\n * Inflate#onEnd(status) -> Void\n * - status (Number): inflate status. 0 (Z_OK) on success,\n *   other if not.\n *\n * Called either after you tell inflate that the input stream is\n * complete (Z_FINISH). By default - join collected chunks,\n * free memory and fill `results` / `err` properties.\n **/\nInflate$1.prototype.onEnd = function (status) {\n  // On success - join\n  if (status === Z_OK) {\n    if (this.options.to === 'string') {\n      this.result = this.chunks.join('');\n    } else {\n      this.result = common.flattenChunks(this.chunks);\n    }\n  }\n  this.chunks = [];\n  this.err = status;\n  this.msg = this.strm.msg;\n};\n\n\n/**\n * inflate(data[, options]) -> Uint8Array|String\n * - data (Uint8Array|ArrayBuffer): input data to decompress.\n * - options (Object): zlib inflate options.\n *\n * Decompress `data` with inflate/ungzip and `options`. Autodetect\n * format via wrapper header by default. That's why we don't provide\n * separate `ungzip` method.\n *\n * Supported options are:\n *\n * - windowBits\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information.\n *\n * Sugar (options):\n *\n * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\n *   negative windowBits implicitly.\n * - `to` (String) - if equal to 'string', then result will be converted\n *   from utf8 to utf16 (javascript) string. When string output requested,\n *   chunk length can differ from `chunkSize`, depending on content.\n *\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako');\n * const input = pako.deflate(new Uint8Array([1,2,3,4,5,6,7,8,9]));\n * let output;\n *\n * try {\n *   output = pako.inflate(input);\n * } catch (err) {\n *   console.log(err);\n * }\n * ```\n **/\nfunction inflate$1(input, options) {\n  const inflator = new Inflate$1(options);\n\n  inflator.push(input);\n\n  // That will never happens, if you don't cheat with options :)\n  if (inflator.err) throw inflator.msg || messages[inflator.err];\n\n  return inflator.result;\n}\n\n\n/**\n * inflateRaw(data[, options]) -> Uint8Array|String\n * - data (Uint8Array|ArrayBuffer): input data to decompress.\n * - options (Object): zlib inflate options.\n *\n * The same as [[inflate]], but creates raw data, without wrapper\n * (header and adler32 crc).\n **/\nfunction inflateRaw$1(input, options) {\n  options = options || {};\n  options.raw = true;\n  return inflate$1(input, options);\n}\n\n\n/**\n * ungzip(data[, options]) -> Uint8Array|String\n * - data (Uint8Array|ArrayBuffer): input data to decompress.\n * - options (Object): zlib inflate options.\n *\n * Just shortcut to [[inflate]], because it autodetects format\n * by header.content. Done for convenience.\n **/\n\n\nvar Inflate_1$1 = Inflate$1;\nvar inflate_2 = inflate$1;\nvar inflateRaw_1$1 = inflateRaw$1;\nvar ungzip$1 = inflate$1;\nvar constants = constants$2;\n\nvar inflate_1$1 = {\n\tInflate: Inflate_1$1,\n\tinflate: inflate_2,\n\tinflateRaw: inflateRaw_1$1,\n\tungzip: ungzip$1,\n\tconstants: constants\n};\n\nconst { Deflate, deflate, deflateRaw, gzip } = deflate_1$1;\n\nconst { Inflate, inflate, inflateRaw, ungzip } = inflate_1$1;\n\n\n\nvar Deflate_1 = Deflate;\nvar deflate_1 = deflate;\nvar deflateRaw_1 = deflateRaw;\nvar gzip_1 = gzip;\nvar Inflate_1 = Inflate;\nvar inflate_1 = inflate;\nvar inflateRaw_1 = inflateRaw;\nvar ungzip_1 = ungzip;\nvar constants_1 = constants$2;\n\nvar pako = {\n\tDeflate: Deflate_1,\n\tdeflate: deflate_1,\n\tdeflateRaw: deflateRaw_1,\n\tgzip: gzip_1,\n\tInflate: Inflate_1,\n\tinflate: inflate_1,\n\tinflateRaw: inflateRaw_1,\n\tungzip: ungzip_1,\n\tconstants: constants_1\n};\n\nexport { Deflate_1 as Deflate, Inflate_1 as Inflate, constants_1 as constants, pako as default, deflate_1 as deflate, deflateRaw_1 as deflateRaw, gzip_1 as gzip, inflate_1 as inflate, inflateRaw_1 as inflateRaw, ungzip_1 as ungzip };\n","// A near direct copy of Ladislav Zezula's C implementation.\n// I left the comments out - if you wish to understand the algorithm, please check the C implementation at https://github.com/ladislav-zezula/StormLib/tree/master/src/pklib\n//\n// There are three key differences:\n//   1) It takes in a Uint8Array, and returns a Uint8Array, rather than using abstract read/write functions.\n//   2) The tables are generated once the first time explode() is used.\n//      I am not sure why the C implementation copies all of the data and regenerates the tables on every explode().\n//      Further more, I am not sure why they are generated at all, unlike the rest of data.\n//   3) There is no output circle buffer, the output is a normal JS number array that grows as it will, wrapped at the end with a Uint8Array.\n//      It's simple, and I don't think anything else will perform better in JS either way.\n\nconst CMP_BINARY = 0;\nconst CMP_ASCII = 1;\n\nclass TDcmpStruct {\n  ctype = 0;\n  outputPos = 0;\n  dsize_bits = 0;\n  dsize_mask = 0;\n  bit_buff = 0;\n  extra_bits = 0;\n  in_pos = 0;\n  in_buff: Uint8Array;\n  out_buff: number[] = [];\n\n  constructor(in_buff: Uint8Array) {\n    this.in_buff = in_buff;\n  }\n}\n\nconst PKDCL_OK = 0;\nconst PKDCL_STREAM_END = 1;\n\nconst DistBits = new Uint8Array([\n  0x02, 0x04, 0x04, 0x05, 0x05, 0x05, 0x05, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06,\n  0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07,\n  0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07,\n  0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,\n]);\n\nconst DistCode = new Uint8Array([\n  0x03, 0x0D, 0x05, 0x19, 0x09, 0x11, 0x01, 0x3E, 0x1E, 0x2E, 0x0E, 0x36, 0x16, 0x26, 0x06, 0x3A,\n  0x1A, 0x2A, 0x0A, 0x32, 0x12, 0x22, 0x42, 0x02, 0x7C, 0x3C, 0x5C, 0x1C, 0x6C, 0x2C, 0x4C, 0x0C,\n  0x74, 0x34, 0x54, 0x14, 0x64, 0x24, 0x44, 0x04, 0x78, 0x38, 0x58, 0x18, 0x68, 0x28, 0x48, 0x08,\n  0xF0, 0x70, 0xB0, 0x30, 0xD0, 0x50, 0x90, 0x10, 0xE0, 0x60, 0xA0, 0x20, 0xC0, 0x40, 0x80, 0x00,\n]);\n\nconst ExLenBits = new Uint8Array([\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,\n]);\n\nconst LenBase = new Uint16Array([\n  0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007,\n  0x0008, 0x000A, 0x000E, 0x0016, 0x0026, 0x0046, 0x0086, 0x0106,\n]);\n\nconst LenBits = new Uint8Array([\n  0x03, 0x02, 0x03, 0x03, 0x04, 0x04, 0x04, 0x05, 0x05, 0x05, 0x05, 0x06, 0x06, 0x06, 0x07, 0x07,\n]);\n\nconst LenCode = new Uint8Array([\n  0x05, 0x03, 0x01, 0x06, 0x0A, 0x02, 0x0C, 0x14, 0x04, 0x18, 0x08, 0x30, 0x10, 0x20, 0x40, 0x00,\n]);\n\nconst ChBitsAsc = new Uint8Array([\n  0x0B, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x08, 0x07, 0x0C, 0x0C, 0x07, 0x0C, 0x0C,\n  0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0D, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C,\n  0x04, 0x0A, 0x08, 0x0C, 0x0A, 0x0C, 0x0A, 0x08, 0x07, 0x07, 0x08, 0x09, 0x07, 0x06, 0x07, 0x08,\n  0x07, 0x06, 0x07, 0x07, 0x07, 0x07, 0x08, 0x07, 0x07, 0x08, 0x08, 0x0C, 0x0B, 0x07, 0x09, 0x0B,\n  0x0C, 0x06, 0x07, 0x06, 0x06, 0x05, 0x07, 0x08, 0x08, 0x06, 0x0B, 0x09, 0x06, 0x07, 0x06, 0x06,\n  0x07, 0x0B, 0x06, 0x06, 0x06, 0x07, 0x09, 0x08, 0x09, 0x09, 0x0B, 0x08, 0x0B, 0x09, 0x0C, 0x08,\n  0x0C, 0x05, 0x06, 0x06, 0x06, 0x05, 0x06, 0x06, 0x06, 0x05, 0x0B, 0x07, 0x05, 0x06, 0x05, 0x05,\n  0x06, 0x0A, 0x05, 0x05, 0x05, 0x05, 0x08, 0x07, 0x08, 0x08, 0x0A, 0x0B, 0x0B, 0x0C, 0x0C, 0x0C,\n  0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D,\n  0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D,\n  0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D,\n  0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C,\n  0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C,\n  0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C,\n  0x0D, 0x0C, 0x0D, 0x0D, 0x0D, 0x0C, 0x0D, 0x0D, 0x0D, 0x0C, 0x0D, 0x0D, 0x0D, 0x0D, 0x0C, 0x0D,\n  0x0D, 0x0D, 0x0C, 0x0C, 0x0C, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D,\n]);\n\nconst ChCodeAsc = new Uint16Array([\n  0x0490, 0x0FE0, 0x07E0, 0x0BE0, 0x03E0, 0x0DE0, 0x05E0, 0x09E0,\n  0x01E0, 0x00B8, 0x0062, 0x0EE0, 0x06E0, 0x0022, 0x0AE0, 0x02E0,\n  0x0CE0, 0x04E0, 0x08E0, 0x00E0, 0x0F60, 0x0760, 0x0B60, 0x0360,\n  0x0D60, 0x0560, 0x1240, 0x0960, 0x0160, 0x0E60, 0x0660, 0x0A60,\n  0x000F, 0x0250, 0x0038, 0x0260, 0x0050, 0x0C60, 0x0390, 0x00D8,\n  0x0042, 0x0002, 0x0058, 0x01B0, 0x007C, 0x0029, 0x003C, 0x0098,\n  0x005C, 0x0009, 0x001C, 0x006C, 0x002C, 0x004C, 0x0018, 0x000C,\n  0x0074, 0x00E8, 0x0068, 0x0460, 0x0090, 0x0034, 0x00B0, 0x0710,\n  0x0860, 0x0031, 0x0054, 0x0011, 0x0021, 0x0017, 0x0014, 0x00A8,\n  0x0028, 0x0001, 0x0310, 0x0130, 0x003E, 0x0064, 0x001E, 0x002E,\n  0x0024, 0x0510, 0x000E, 0x0036, 0x0016, 0x0044, 0x0030, 0x00C8,\n  0x01D0, 0x00D0, 0x0110, 0x0048, 0x0610, 0x0150, 0x0060, 0x0088,\n  0x0FA0, 0x0007, 0x0026, 0x0006, 0x003A, 0x001B, 0x001A, 0x002A,\n  0x000A, 0x000B, 0x0210, 0x0004, 0x0013, 0x0032, 0x0003, 0x001D,\n  0x0012, 0x0190, 0x000D, 0x0015, 0x0005, 0x0019, 0x0008, 0x0078,\n  0x00F0, 0x0070, 0x0290, 0x0410, 0x0010, 0x07A0, 0x0BA0, 0x03A0,\n  0x0240, 0x1C40, 0x0C40, 0x1440, 0x0440, 0x1840, 0x0840, 0x1040,\n  0x0040, 0x1F80, 0x0F80, 0x1780, 0x0780, 0x1B80, 0x0B80, 0x1380,\n  0x0380, 0x1D80, 0x0D80, 0x1580, 0x0580, 0x1980, 0x0980, 0x1180,\n  0x0180, 0x1E80, 0x0E80, 0x1680, 0x0680, 0x1A80, 0x0A80, 0x1280,\n  0x0280, 0x1C80, 0x0C80, 0x1480, 0x0480, 0x1880, 0x0880, 0x1080,\n  0x0080, 0x1F00, 0x0F00, 0x1700, 0x0700, 0x1B00, 0x0B00, 0x1300,\n  0x0DA0, 0x05A0, 0x09A0, 0x01A0, 0x0EA0, 0x06A0, 0x0AA0, 0x02A0,\n  0x0CA0, 0x04A0, 0x08A0, 0x00A0, 0x0F20, 0x0720, 0x0B20, 0x0320,\n  0x0D20, 0x0520, 0x0920, 0x0120, 0x0E20, 0x0620, 0x0A20, 0x0220,\n  0x0C20, 0x0420, 0x0820, 0x0020, 0x0FC0, 0x07C0, 0x0BC0, 0x03C0,\n  0x0DC0, 0x05C0, 0x09C0, 0x01C0, 0x0EC0, 0x06C0, 0x0AC0, 0x02C0,\n  0x0CC0, 0x04C0, 0x08C0, 0x00C0, 0x0F40, 0x0740, 0x0B40, 0x0340,\n  0x0300, 0x0D40, 0x1D00, 0x0D00, 0x1500, 0x0540, 0x0500, 0x1900,\n  0x0900, 0x0940, 0x1100, 0x0100, 0x1E00, 0x0E00, 0x0140, 0x1600,\n  0x0600, 0x1A00, 0x0E40, 0x0640, 0x0A40, 0x0A00, 0x1200, 0x0200,\n  0x1C00, 0x0C00, 0x1400, 0x0400, 0x1800, 0x0800, 0x1000, 0x0000,\n]);\n\n// Generated on the first time explode() is used.\nlet generatedDecodeTabs = false;\nconst DistPosCodes = new Uint8Array(0x100);\nconst LengthCodes = new Uint8Array(0x100);\n\n// Same as above.\nlet generatedAscTabs = false;\nconst offs2C34 = new Uint8Array(0x100);\nconst offs2D34 = new Uint8Array(0x100);\nconst offs2E34 = new Uint8Array(0x80);\nconst offs2EB4 = new Uint8Array(0x100);\n\nfunction GenDecodeTabs(positions: Uint8Array, start_indexes: Uint8Array, length_bits: Uint8Array): void {\n  for (let i = 0, elements = start_indexes.length; i < elements; i++) {\n    const length = 1 << length_bits[i];\n\n    for (let index = start_indexes[i]; index < 0x100; index += length) {\n      positions[index] = i;\n    }\n  }\n}\n\nfunction GenAscTabs(): void {\n  let pChCodeAsc = 0xFF;\n  let acc, add;\n\n  for (let count = 0x00FF; pChCodeAsc >= 0; pChCodeAsc--, count--) {\n    const pChBitsAsc = count;\n    let bits_asc = ChBitsAsc[pChBitsAsc];\n\n    if (bits_asc <= 8) {\n      add = (1 << bits_asc);\n      acc = ChCodeAsc[pChCodeAsc];\n\n      do {\n        offs2C34[acc] = count;\n        acc += add;\n      } while (acc < 0x100);\n    } else if ((acc = (ChCodeAsc[pChCodeAsc] & 0xFF)) != 0) {\n      offs2C34[acc] = 0xFF;\n\n      if (ChCodeAsc[pChCodeAsc] & 0x3F) {\n        bits_asc -= 4;\n        ChBitsAsc[pChBitsAsc] = bits_asc;\n\n        add = (1 << bits_asc);\n        acc = ChCodeAsc[pChCodeAsc] >> 4;\n\n        do {\n          offs2D34[acc] = count;\n          acc += add;\n        } while (acc < 0x100);\n      } else {\n        bits_asc -= 6;\n        ChBitsAsc[pChBitsAsc] = bits_asc;\n\n        add = (1 << bits_asc);\n        acc = ChCodeAsc[pChCodeAsc] >> 6;\n\n        do {\n          offs2E34[acc] = count;\n          acc += add;\n        } while (acc < 0x80);\n      }\n    } else {\n      bits_asc -= 8;\n      ChBitsAsc[pChBitsAsc] = bits_asc;\n\n      add = (1 << bits_asc);\n      acc = ChCodeAsc[pChCodeAsc] >> 8;\n\n      do {\n        offs2EB4[acc] = count;\n        acc += add;\n      } while (acc < 0x100);\n    }\n  }\n}\n\nfunction WasteBits(pWork: TDcmpStruct, nBits: number): number {\n  if (nBits <= pWork.extra_bits) {\n    pWork.extra_bits -= nBits;\n    pWork.bit_buff >>= nBits;\n\n    return PKDCL_OK;\n  }\n\n  pWork.bit_buff >>= pWork.extra_bits;\n\n  if (pWork.in_pos === pWork.in_buff.byteLength) {\n    return PKDCL_STREAM_END;\n  }\n\n  pWork.bit_buff |= (pWork.in_buff[pWork.in_pos++] << 8);\n  pWork.bit_buff >>= (nBits - pWork.extra_bits);\n  pWork.extra_bits = (pWork.extra_bits - nBits) + 8;\n\n  return PKDCL_OK;\n}\n\nfunction DecodeLit(pWork: TDcmpStruct): number {\n  if (pWork.bit_buff & 1) {\n    if (WasteBits(pWork, 1)) {\n      return 0x306;\n    }\n\n    let length_code = LengthCodes[pWork.bit_buff & 0xFF];\n\n    if (WasteBits(pWork, LenBits[length_code])) {\n      return 0x306;\n    }\n\n    let extra_length_bits;\n\n    if ((extra_length_bits = ExLenBits[length_code]) != 0) {\n      const extra_length = pWork.bit_buff & ((1 << extra_length_bits) - 1);\n\n      if (WasteBits(pWork, extra_length_bits)) {\n        if ((length_code + extra_length) != 0x10E) {\n          return 0x306;\n        }\n      }\n\n      length_code = LenBase[length_code] + extra_length;\n    }\n\n    return length_code + 0x100;\n  }\n\n  if (WasteBits(pWork, 1)) {\n    return 0x306;\n  }\n\n  if (pWork.ctype == CMP_BINARY) {\n    const uncompressed_byte = pWork.bit_buff & 0xFF;\n\n    if (WasteBits(pWork, 8)) {\n      return 0x306;\n    }\n\n    return uncompressed_byte;\n  }\n\n  let value;\n\n  if (pWork.bit_buff & 0xFF) {\n    value = offs2C34[pWork.bit_buff & 0xFF];\n\n    if (value == 0xFF) {\n      if (pWork.bit_buff & 0x3F) {\n        if (WasteBits(pWork, 4)) {\n          return 0x306;\n        }\n\n        value = offs2D34[pWork.bit_buff & 0xFF];\n      } else {\n        if (WasteBits(pWork, 6)) {\n          return 0x306;\n        }\n\n        value = offs2E34[pWork.bit_buff & 0x7F];\n      }\n    }\n  } else {\n    if (WasteBits(pWork, 8)) {\n      return 0x306;\n    }\n\n    value = offs2EB4[pWork.bit_buff & 0xFF];\n  }\n\n  return WasteBits(pWork, ChBitsAsc[value]) ? 0x306 : value;\n}\n\nfunction DecodeDist(pWork: TDcmpStruct, rep_length: number): number {\n  const dist_pos_code = DistPosCodes[pWork.bit_buff & 0xFF];\n  const dist_pos_bits = DistBits[dist_pos_code];\n\n  if (WasteBits(pWork, dist_pos_bits)) {\n    return 0;\n  }\n\n  let distance;\n\n  if (rep_length == 2) {\n    distance = (dist_pos_code << 2) | (pWork.bit_buff & 0x03);\n\n    if (WasteBits(pWork, 2)) {\n      return 0;\n    }\n  } else {\n    distance = (dist_pos_code << pWork.dsize_bits) | (pWork.bit_buff & pWork.dsize_mask);\n\n    if (WasteBits(pWork, pWork.dsize_bits)) {\n      return 0;\n    }\n  }\n\n  return distance + 1;\n}\n\nfunction Expand(pWork: TDcmpStruct): number {\n  let next_literal;\n\n  while ((next_literal = DecodeLit(pWork)) < 0x305) {\n    if (next_literal >= 0x100) {\n      let rep_length = next_literal - 0xFE;\n      let minus_dist;\n\n      if ((minus_dist = DecodeDist(pWork, rep_length)) == 0) {\n        return 0x306;\n      }\n\n      let target = pWork.outputPos;\n      let source = target - minus_dist;\n\n      pWork.outputPos += rep_length;\n\n      while (rep_length-- > 0) {\n        pWork.out_buff[target++] = pWork.out_buff[source++];\n      }\n    } else {\n      pWork.out_buff[pWork.outputPos++] = next_literal;\n    }\n  }\n\n  return next_literal;\n}\n\nexport default function explode(bytes: Uint8Array): Uint8Array {\n  const pWork = new TDcmpStruct(bytes);\n\n  if (pWork.in_buff.byteLength <= 4) {\n    throw new Error('Bad data');\n  }\n\n  pWork.ctype = pWork.in_buff[0];\n  pWork.dsize_bits = pWork.in_buff[1];\n  pWork.bit_buff = pWork.in_buff[2];\n  pWork.extra_bits = 0;\n  pWork.in_pos = 3;\n\n  if (4 > pWork.dsize_bits || pWork.dsize_bits > 6) {\n    throw new Error('Invalid dictionary size');\n  }\n\n  pWork.dsize_mask = 0xFFFF >> (0x10 - pWork.dsize_bits);\n\n  if (pWork.ctype !== CMP_BINARY) {\n    if (pWork.ctype !== CMP_ASCII) {\n      throw new Error('Invalid mode');\n    }\n\n    if (!generatedAscTabs) {\n      GenAscTabs();\n\n      generatedAscTabs = true;\n    }\n  }\n\n  if (!generatedDecodeTabs) {\n    GenDecodeTabs(LengthCodes, LenCode, LenBits);\n    GenDecodeTabs(DistPosCodes, DistCode, DistBits);\n\n    generatedDecodeTabs = true;\n  }\n\n  if (Expand(pWork) === 0x306) {\n    throw new Error('Error while expanding');\n  }\n\n  return new Uint8Array(pWork.out_buff);\n}\n","/**\n * Search for the MPQ header - MPQ\\x1A.\n * The header can be on any 512 bytes boundry offset.\n */\nexport function searchHeader(bytes: Uint8Array): number {\n  let offset = -1;\n\n  for (let i = 0, l = Math.ceil(bytes.byteLength / 512); i < l; i++) {\n    const base = i * 512;\n\n    // Test 'MPQ\\x1A'.\n    if (bytes[base] === 77 && bytes[base + 1] === 80 && bytes[base + 2] === 81 && bytes[base + 3] === 26) {\n      offset = base;\n    }\n  }\n\n  return offset;\n}\n\n/**\n * Checks whether the given buffer is either a Warcraft 3 map or otherwise a generic MPQ archive.\n */\nexport function isArchive(bytes: Uint8Array): boolean {\n  // Check for the map identifier - HM3W\n  if (bytes[0] === 72 && bytes[1] === 77 && bytes[2] === 51 && bytes[3] === 87) {\n    return true;\n  }\n\n  // Look for an MPQ header.\n  return searchHeader(bytes) !== -1;\n}\n","import { deflate, inflate } from 'pako';\nimport { decodeUtf8 } from '../../common/utf8';\nimport MpqArchive from './archive';\nimport MpqBlock from './block';\nimport { COMPRESSION_ADPCM_MONO, COMPRESSION_ADPCM_STEREO, COMPRESSION_BZIP2, COMPRESSION_DEFLATE, COMPRESSION_HUFFMAN, COMPRESSION_IMPLODE, FILE_COMPRESSED, FILE_ENCRYPTED, FILE_EXISTS, FILE_IMPLODE, FILE_OFFSET_ADJUSTED_KEY, FILE_SINGLE_UNIT, HASH_ENTRY_DELETED } from './constants';\nimport MpqCrypto from './crypto';\nimport explode from './explode';\n// import decodeHuffman from './huffman';\nimport MpqHash from './hash';\nimport { isArchive } from './isarchive';\n\n/**\n * A MPQ file.\n */\nexport default class MpqFile {\n  archive: MpqArchive;\n  c: MpqCrypto;\n  name: string;\n  nameResolved: boolean;\n  hash: MpqHash;\n  block: MpqBlock;\n  rawBuffer: Uint8Array | null = null;\n  buffer: Uint8Array | null = null;\n\n  constructor(archive: MpqArchive, hash: MpqHash, block: MpqBlock, rawBuffer: Uint8Array | null, buffer: Uint8Array | null) {\n    const headerOffset = archive.headerOffset;\n\n    this.archive = archive;\n    this.c = archive.c;\n    this.name = `File${`${hash.blockIndex}`.padStart(8, '0')}`;\n    this.nameResolved = false;\n    this.hash = hash;\n    this.block = block;\n\n    if (rawBuffer) {\n      this.rawBuffer = rawBuffer.slice(headerOffset + block.offset, headerOffset + block.offset + block.compressedSize);\n    }\n\n    if (buffer) {\n      this.buffer = buffer;\n    }\n  }\n\n  /**\n   * Gets this file's data as a Uint8Array.\n   * \n   * An exception will be thrown if the file needs to be decoded, and decoding fails.\n   */\n  bytes(): Uint8Array {\n    // Decode if needed\n    if (this.buffer === null) {\n      this.decode();\n    }\n\n    // If decoding failed, an exception would have been thrown, so buffer is known to exist at this point.\n    return <Uint8Array>this.buffer;\n  }\n\n  /**\n   * Gets this file's data as an ArrayBuffer.\n   * \n   * An exception will be thrown if the file needs to be decoded, and decoding fails.\n   */\n  arrayBuffer(): ArrayBuffer {\n    return this.bytes().buffer;\n  }\n\n  /**\n   * Gets this file's data as a UTF8 string.\n   * \n   * An exception will be thrown if the file needs to be decoded, and decoding fails.\n   */\n  text(): string {\n    return decodeUtf8(this.bytes());\n  }\n\n  /**\n   * Changes the buffer of this file.\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  set(buffer: Uint8Array): boolean {\n    if (this.archive.readonly) {\n      return false;\n    }\n\n    const hash = this.hash;\n    const block = this.block;\n\n    // Reset the hash.\n    hash.locale = 0;\n    hash.platform = 0;\n\n    // Reset the block.\n    block.compressedSize = 0;\n    block.normalSize = buffer.byteLength;\n    block.flags = 0;\n\n    this.buffer = buffer;\n    this.rawBuffer = null;\n\n    return true;\n  }\n\n  /**\n   * Deletes this file.\n   * \n   * Using the file after it was deleted will result in undefined behavior.\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  delete(): boolean {\n    if (this.archive.readonly) {\n      return false;\n    }\n\n    const archive = this.archive;\n    const hash = this.hash;\n    const blockIndex = hash.blockIndex;\n\n    hash.delete();\n\n    for (const hash of archive.hashTable.entries) {\n      if (hash.blockIndex < HASH_ENTRY_DELETED && hash.blockIndex > blockIndex) {\n        hash.blockIndex -= 1;\n      }\n    }\n\n    archive.blockTable.entries.splice(blockIndex, 1);\n    archive.files.splice(blockIndex, 1);\n\n    return true;\n  }\n\n  /**\n   * Renames this file.\n   * \n   * Note that this sets the current file's hash's status to being deleted, rather than removing it.\n   * This is due to the way the search algorithm works.\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  rename(newName: string): boolean {\n    if (this.archive.readonly) {\n      return false;\n    }\n\n    const hash = this.hash;\n    const locale = hash.locale;\n    const platform = hash.platform;\n    const blockIndex = hash.blockIndex;\n\n    // First delete the current hash.\n    // This will allow its entry to be reused in case it's the only empty/deleted entry in the hashtable.\n    hash.delete();\n\n    const newHash = <MpqHash>this.archive.hashTable.add(newName, blockIndex);\n\n    newHash.locale = locale;\n    newHash.platform = platform;\n\n    this.name = newName;\n    this.nameResolved = true;\n    this.hash = newHash;\n\n    return true;\n  }\n\n  /**\n   * Decode this file.\n   */\n  decode(): void {\n    if (!this.rawBuffer) {\n      throw new Error(`File ${this.name}: Nothing to decode`);\n    }\n\n    const archive = this.archive;\n    const block = this.block;\n    const c = archive.c;\n    const encryptionKey = c.computeFileKey(this.name, block);\n    const data = this.rawBuffer;\n    const flags = block.flags;\n\n    // One buffer of raw data.\n    // I don't know why having no flags means it's a chunk of memory rather than sectors.\n    // After all, there is no flag to say there are indeed sectors.\n    if (flags === FILE_EXISTS) {\n      this.buffer = data.slice(0, block.normalSize);\n    } else if (flags & FILE_SINGLE_UNIT) {\n      // One buffer of possibly encrypted and/or compressed data.\n      // Read the sector\n      let sector;\n\n      // If this block is encrypted, decrypt the sector.\n      if (flags & FILE_ENCRYPTED) {\n        sector = c.decryptBlock(data.slice(0, block.compressedSize), encryptionKey);\n      } else {\n        sector = data.subarray(0, block.compressedSize);\n      }\n\n      // If this block is compressed, decompress the sector.\n      // Otherwise, copy the sector as-is.\n      if (flags & FILE_COMPRESSED) {\n        sector = this.decompressSector(sector, block.normalSize);\n      } else {\n        sector = sector.slice();\n      }\n\n      this.buffer = sector;\n    } else {\n      // One or more sectors of possibly encrypted and/or compressed data.\n      const sectorCount = Math.ceil(block.normalSize / archive.sectorSize);\n\n      // Alocate a buffer for the uncompressed block size\n      const buffer = new Uint8Array(block.normalSize);\n\n      // Get the sector offsets\n      let sectorOffsets = new Uint32Array(data.buffer, 0, sectorCount + 1);\n\n      // If this file is encrypted, copy the sector offsets and decrypt them.\n      if (flags & FILE_ENCRYPTED) {\n        sectorOffsets = c.decryptBlock(sectorOffsets.slice(), encryptionKey - 1);\n      }\n\n      let start = sectorOffsets[0];\n      let end = sectorOffsets[1];\n      let offset = 0;\n\n      for (let i = 0; i < sectorCount; i++) {\n        let sector;\n\n        // If this file is encrypted, copy the sector and decrypt it.\n        // Otherwise a view can be used directly.\n        if (flags & FILE_ENCRYPTED) {\n          sector = c.decryptBlock(data.slice(start, end), encryptionKey + i);\n        } else {\n          sector = data.subarray(start, end);\n        }\n\n        // Decompress the sector\n        if (flags & FILE_COMPRESSED) {\n          let uncompressedSize = archive.sectorSize;\n\n          // If this is the last sector, its uncompressed size might not be the size of a sector.\n          if (block.normalSize - offset < uncompressedSize) {\n            uncompressedSize = block.normalSize - offset;\n          }\n\n          sector = this.decompressSector(sector, uncompressedSize);\n        }\n\n        // Some sectors have this flags instead of the compression flag + algorithm byte.\n        if (flags & FILE_IMPLODE) {\n          sector = explode(sector);\n        }\n\n        // Add the sector bytes to the buffer\n        buffer.set(sector, offset);\n        offset += sector.byteLength;\n\n        // Prepare for the next sector\n        if (i < sectorCount) {\n          start = end;\n          end = sectorOffsets[i + 2];\n        }\n      }\n\n      this.buffer = buffer;\n    }\n\n    // If the archive is in read-only mode, the raw buffer isn't needed anymore, so free the memory.\n    if (archive.readonly) {\n      this.rawBuffer = null;\n    }\n  }\n\n  decompressSector(bytes: Uint8Array, decompressedSize: number): Uint8Array {\n    // If the size of the data is the same as its decompressed size, it's not compressed.\n    if (bytes.byteLength === decompressedSize) {\n      return bytes;\n    } else {\n      const compressionMask = bytes[0];\n\n      if (compressionMask & COMPRESSION_BZIP2) {\n        throw new Error(`File ${this.name}: compression type 'bzip2' not supported`);\n      }\n\n      if (compressionMask & COMPRESSION_IMPLODE) {\n        try {\n          bytes = explode(bytes.subarray(1));\n        } catch (e) {\n          throw new Error(`File ${this.name}: failed to decompress with 'explode': ${e}`);\n        }\n      }\n\n      if (compressionMask & COMPRESSION_DEFLATE) {\n        try {\n          bytes = inflate(bytes.subarray(1));\n        } catch (e) {\n          throw new Error(`File ${this.name}: failed to decompress with 'zlib': ${e}`);\n        }\n      }\n\n      if (compressionMask & COMPRESSION_HUFFMAN) {\n        // try {\n        //   bytes = decodeHuffman(bytes.subarray(1));\n        // } catch (e) {\n        //   throw new Error(`File ${this.name}: failed to decompress with 'huffman': ${e}`);\n        // }\n        throw new Error(`File ${this.name}: compression type 'huffman' not supported`);\n      }\n\n      if (compressionMask & COMPRESSION_ADPCM_STEREO) {\n        throw new Error(`File ${this.name}: compression type 'adpcm stereo' not supported`);\n      }\n\n      if (compressionMask & COMPRESSION_ADPCM_MONO) {\n        throw new Error(`File ${this.name}: compression type 'adpcm mono' not supported`);\n      }\n\n      return bytes;\n    }\n  }\n\n  /**\n   * Encode this file.\n   * Archives (maps or generic MPQs) are stored uncompressed in one chunk.\n   * Other files are always stored in sectors, except when a file is smaller than a sector.\n   * Sectors themselves are always compressed, except when the result is smaller than the uncompressed data.\n   */\n  encode(): void {\n    if (this.buffer !== null && this.rawBuffer === null) {\n      const data = this.buffer;\n\n      if (isArchive(data)) {\n        this.rawBuffer = this.buffer;\n        this.block.compressedSize = this.buffer.byteLength;\n        this.block.flags = FILE_EXISTS;\n      } else {\n        const sectorSize = this.archive.sectorSize;\n        const sectorCount = Math.ceil(data.byteLength / sectorSize);\n        const offsets = new Uint32Array(sectorCount + 1);\n        let offset = offsets.byteLength;\n        const sectors = [];\n        const compression = [];\n\n        // First offset is right after the offsets list.\n        offsets[0] = offset;\n\n        for (let i = 0; i < sectorCount; i++) {\n          const sectorOffset = i * sectorSize;\n          let sector = data.subarray(sectorOffset, sectorOffset + sectorSize);\n          let size = sector.byteLength;\n          const compressed = deflate(sector);\n          let isCompressed = false;\n\n          // If the compressed size of the sector is smaller than the uncompressed, use the compressed data.\n          // +1 because of the compression mask byte.\n          if (compressed.byteLength + 1 < size) {\n            sector = compressed;\n            size = compressed.byteLength + 1;\n            isCompressed = true;\n          }\n\n          offset += size;\n          offsets[i + 1] = offset;\n          sectors[i] = sector;\n          compression[i] = isCompressed;\n        }\n\n        // Only use the compressed data if it's actually smaller than the uncompressed data.\n        if (offset < data.byteLength) {\n          const rawBuffer = new Uint8Array(offset);\n\n          // Write the offsets list.\n          rawBuffer.set(new Uint8Array(offsets.buffer));\n\n          offset = offsets.byteLength;\n\n          for (let i = 0; i < sectorCount; i++) {\n            // If this sector is compressed, set it to zlib.\n            if (compression[i]) {\n              rawBuffer[offset] = 2;\n              offset += 1;\n            }\n\n            // Write the sector.\n            const sector = sectors[i];\n\n            rawBuffer.set(sector, offset);\n            offset += sector.byteLength;\n          }\n\n          this.rawBuffer = rawBuffer;\n          this.block.compressedSize = rawBuffer.byteLength;\n          this.block.flags = (FILE_EXISTS | FILE_COMPRESSED) >>> 0;\n        } else {\n          this.rawBuffer = this.buffer;\n          this.block.compressedSize = this.buffer.byteLength;\n          this.block.flags = FILE_EXISTS;\n        }\n      }\n    }\n  }\n\n  /**\n   * Decrypt this file and encrypt it back, with a new offset in the archive.\n   * This is used for files that use FILE_OFFSET_ADJUSTED_KEY, which are encrypted with a key that depends on their offset.\n   */\n  reEncrypt(offset: number): boolean {\n    if (!this.rawBuffer) {\n      return false;\n    }\n\n    const archive = this.archive;\n    const block = this.block;\n    const c = archive.c;\n    const bytes = this.rawBuffer;\n    const flags = block.flags;\n    const encryptionKey = c.computeFileKey(this.name, block);\n\n    block.offset = offset;\n\n    const newEncryptionKey = c.computeFileKey(this.name, block);\n\n    if (flags & FILE_SINGLE_UNIT) {\n      // Decrypt the chunk with the old key.\n      c.decryptBlock(bytes, encryptionKey);\n\n      // Encrypt the chunk with the new key.\n      c.encryptBlock(bytes, newEncryptionKey);\n    } else {\n      const sectorCount = Math.ceil(block.normalSize / archive.sectorSize);\n\n      // Get the sector offsets\n      const sectorOffsets = new Uint32Array(bytes.buffer, 0, sectorCount + 1);\n\n      // Decrypt the sector offsets with the old key.\n      c.decryptBlock(sectorOffsets, encryptionKey - 1);\n\n      let start = sectorOffsets[0];\n      let end = sectorOffsets[1];\n\n      for (let i = 0; i < sectorCount; i++) {\n        const sector = bytes.subarray(start, end);\n\n        // Decrypt the chunk with the old key.\n        c.decryptBlock(sector, encryptionKey + i);\n\n        // Encrypt the chunk with the new key.\n        c.encryptBlock(sector, newEncryptionKey + i);\n\n        // Prepare for the next sector\n        if (i < sectorCount) {\n          start = end;\n          end = sectorOffsets[i + 2];\n        }\n      }\n\n      // Encrypt the sector offsets with the new key.\n      c.encryptBlock(sectorOffsets, newEncryptionKey - 1);\n    }\n\n    return true;\n  }\n\n  /**\n   * The offset of the file has been recalculated.\n   * If the offset is different, and this file uses FILE_OFFSET_ADJUSTED_KEY encryption, it must be re-encrypted with the new offset.\n   */\n  offsetChanged(offset: number): boolean {\n    const block = this.block;\n\n    if (block.offset !== offset && block.flags & FILE_OFFSET_ADJUSTED_KEY) {\n      if (this.nameResolved) {\n        return this.reEncrypt(offset);\n      }\n\n      return false;\n    }\n\n    block.offset = offset;\n\n    return true;\n  }\n}\n","import { HASH_ENTRY_DELETED, HASH_ENTRY_EMPTY } from './constants';\n\n/**\n * A MPQ hash.\n */\nexport default class MpqHash {\n  nameA = 0xFFFFFFFF;\n  nameB = 0xFFFFFFFF;\n  locale = 0xFFFF;\n  platform = 0xFFFF;\n  blockIndex = HASH_ENTRY_EMPTY;\n\n  load(bytes: Uint32Array): void {\n    const localePlatform = bytes[2];\n\n    this.nameA = bytes[0];\n    this.nameB = bytes[1];\n    this.locale = localePlatform & 0x0000FFFF;\n    this.platform = localePlatform >>> 16;\n    this.blockIndex = bytes[3];\n  }\n\n  copy(hash: MpqHash): void {\n    this.nameA = hash.nameA;\n    this.nameB = hash.nameB;\n    this.locale = hash.locale;\n    this.platform = hash.platform;\n    this.blockIndex = hash.blockIndex;\n  }\n\n  save(bytes: Uint32Array): void {\n    bytes[0] = this.nameA;\n    bytes[1] = this.nameB;\n    bytes[2] = (this.locale << 16) | this.platform;\n    bytes[3] = this.blockIndex;\n  }\n\n  delete(): void {\n    this.nameA = 0xFFFFFFFF;\n    this.nameB = 0xFFFFFFFF;\n    this.locale = 0xFFFF;\n    this.platform = 0xFFFF;\n    this.blockIndex = HASH_ENTRY_DELETED;\n  }\n}\n","import MpqCrypto from './crypto';\nimport MpqHash from './hash';\nimport { HASH_TABLE_KEY, HASH_TABLE_INDEX, HASH_NAME_A, HASH_NAME_B } from './constants';\n\n/**\n * A MPQ hash table.\n */\nexport default class MpqHashTable {\n  c: MpqCrypto;\n  entries: MpqHash[];\n\n  constructor(c: MpqCrypto) {\n    this.c = c;\n    this.entries = [];\n\n    // Minimum size\n    this.addEmpties(4);\n  }\n\n  clear(): void {\n    this.entries.length = 0;\n  }\n\n  addEmpties(howMany: number): void {\n    for (let i = 0; i < howMany; i++) {\n      this.entries.push(new MpqHash());\n    }\n  }\n\n  getInsertionIndex(name: string): number {\n    const entries = this.entries;\n    const offset = this.c.hash(name, HASH_TABLE_INDEX) & (entries.length - 1);\n\n    for (let i = 0, l = entries.length; i < l; i++) {\n      const index = (i + offset) % l;\n      const hash = entries[index];\n\n      if (hash.platform === 0xFFFF) {\n        return index;\n      }\n    }\n\n    return -1;\n  }\n\n  add(name: string, blockIndex: number): MpqHash | undefined {\n    const insertionIndex = this.getInsertionIndex(name);\n\n    if (insertionIndex !== -1) {\n      const hash = this.entries[insertionIndex];\n\n      hash.nameA = this.c.hash(name, HASH_NAME_A);\n      hash.nameB = this.c.hash(name, HASH_NAME_B);\n      hash.locale = 0;\n      hash.platform = 0;\n      hash.blockIndex = blockIndex;\n\n      return hash;\n    }\n\n    return;\n  }\n\n  load(bytes: Uint8Array): void {\n    const entriesCount = bytes.byteLength / 16;\n    const uint32array = new Uint32Array(this.c.decryptBlock(bytes, HASH_TABLE_KEY).buffer);\n    let offset = 0;\n\n    // Clear the table and add the needed empties.\n    this.clear();\n    this.addEmpties(entriesCount);\n\n    for (const hash of this.entries) {\n      hash.load(uint32array.subarray(offset, offset + 4));\n\n      offset += 4;\n    }\n  }\n\n  save(bytes: Uint8Array): void {\n    const uint32array = new Uint32Array(this.entries.length * 4);\n    let offset = 0;\n\n    for (const hash of this.entries) {\n      hash.save(uint32array.subarray(offset, offset + 4));\n\n      offset += 4;\n    }\n\n    const uint8array = new Uint8Array(uint32array.buffer);\n\n    this.c.encryptBlock(uint8array, HASH_TABLE_KEY);\n\n    bytes.set(uint8array);\n  }\n\n  get(name: string): MpqHash | null {\n    const c = this.c;\n    const entries = this.entries;\n    const offset = c.hash(name, HASH_TABLE_INDEX) & (entries.length - 1);\n    const nameA = c.hash(name, HASH_NAME_A);\n    const nameB = c.hash(name, HASH_NAME_B);\n\n    for (let i = 0, l = entries.length; i < l; i++) {\n      const hash = entries[(i + offset) % l];\n\n      if (nameA === hash.nameA && nameB === hash.nameB) {\n        return hash;\n      } else if (hash.blockIndex === 0xFFFFFFFF) {\n        return null;\n      }\n    }\n\n    return null;\n  }\n}\n","import { bytesOf } from '../../common/bytesof';\nimport { powerOfTwo } from '../../common/math';\nimport { numberToUint32 } from '../../common/typecast';\nimport MpqBlockTable from './blocktable';\nimport { HASH_ENTRY_DELETED, HASH_ENTRY_EMPTY, MAGIC } from './constants';\nimport MpqCrypto from './crypto';\nimport MpqFile from './file';\nimport MpqHashTable from './hashtable';\nimport { searchHeader } from './isarchive';\n\n/**\n * MoPaQ archive (MPQ) version 0.\n */\nexport default class MpqArchive {\n  headerOffset: number;\n  sectorSize: number;\n  c: MpqCrypto;\n  hashTable: MpqHashTable;\n  blockTable: MpqBlockTable;\n  files: MpqFile[];\n  readonly = false;\n\n  constructor() {\n    this.headerOffset = 0;\n    this.sectorSize = 4096;\n    this.c = new MpqCrypto();\n    this.hashTable = new MpqHashTable(this.c);\n    this.blockTable = new MpqBlockTable(this.c);\n    this.files = [];\n  }\n\n  /**\n   * Load an existing archive.\n   * \n   * Note that this clears the archive from whatever it had in it before.\n   */\n  load(buffer: ArrayBuffer | Uint8Array, readonly = false): void {\n    const bytes = bytesOf(buffer);\n\n    this.readonly = readonly;\n\n    // let fileSize = buffer.byteLength;\n    const headerOffset = searchHeader(bytes);\n\n    if (headerOffset === -1) {\n      throw new Error('No MPQ header');\n    }\n\n    // Read the header.\n    const uint32array = new Uint32Array(bytes.buffer, headerOffset, 8);\n    // let headerSize = uint32array[1];\n    // let archiveSize = uint32array[2];\n    const formatVersionSectorSize = uint32array[3];\n    // let formatVersion = formatVersionSectorSize & 0x0000FFFF;\n    const hashPos = numberToUint32(uint32array[4] + headerOffset); // Whoever thought of MoonLight, clever!\n    const blockPos = numberToUint32(uint32array[5] + headerOffset);\n    const hashSize = uint32array[6];\n    let blockSize = uint32array[7];\n\n    // There can only be as many or less blocks as there are hashes.\n    // Therefore, if the file is reporting too many blocks, cap the actual blocks read to the amount of hashes.\n    if (blockSize > hashSize) {\n      blockSize = hashSize;\n    }\n\n    this.headerOffset = headerOffset;\n    this.sectorSize = 512 * (1 << (formatVersionSectorSize >>> 16)); // Generally 4096\n\n    // Read the hash table.\n    // Also clears any existing entries.\n    // Have to copy the data, because hashPos is not guaranteed to be a multiple of 4.\n    this.hashTable.load(bytes.slice(hashPos, hashPos + hashSize * 16));\n\n    // Read the block table.\n    // Also clears any existing entries.\n    // Have to copy the data, because blockPos is not guaranteed to be a multiple of 4.\n    this.blockTable.load(bytes.slice(blockPos, blockPos + blockSize * 16));\n\n    // Clear any existing files.\n    this.files.length = 0;\n\n    // Read the files.\n    for (const hash of this.hashTable.entries) {\n      const blockIndex = hash.blockIndex;\n\n      // If the block index is valid, load a file.\n      // This isn't the case when the block is marked as deleted with HASH_ENTRY_DELETED.\n      // This also isn't the case for archives with fake block indices.\n      if (blockIndex < this.blockTable.entries.length) {\n        this.files[blockIndex] = new MpqFile(this, hash, this.blockTable.entries[blockIndex], bytes, null);\n      }\n    }\n\n    // If there is a listfile, use all of the file names in it.\n    const listfile = this.get('(listfile)');\n    if (listfile) {\n      const list = listfile.text();\n\n      if (list) {\n        for (const name of list.split('\\r\\n')) {\n          // get() internally also sets the file's name to the given one.\n          this.get(name);\n        }\n      }\n    }\n  }\n\n  /**\n   * Save this archive.\n   * \n   * Returns null when...\n   * \n   *     1) The archive is in readonly mode.\n   *     2) The offset of a file encrypted with FILE_OFFSET_ADJUSTED_KEY changed, and the file name is unknown.\n   */\n  save(): Uint8Array | null {\n    if (this.readonly) {\n      return null;\n    }\n\n    const headerSize = 32;\n\n    // Delete the internal attributes file.\n    // The attributes might (and do in the case of World Editor generated maps) contain CRC checksums for the internal files.\n    // If any of these files is edited in any way, the map will be considered corrupted.\n    // Therefore, delete the file, and nothing will be corrupted.\n    // As far as I can tell, there is no real reason to keep (and update) any of the file attributes.\n    // It's not like Warcraft 3 has some database of checksums that it checks against.\n    // I assume it does have a database for the Battle.net ladder maps.\n    // If at any point it becomes known to me that it is indeed needed, I will add support for (attributes).\n    this.delete('(attributes)');\n\n    // Some archives have empty blocks in them.\n    // That is, blocks that take up memory, but have no actual valid data in them (as far as the archive is concerned).\n    // I am not sure why they exist - maybe someone deleted a file's entry and was too lazy to rebuild the archive.\n    // This removes such blocks of memory from the archive.\n    this.saveMemory();\n\n    // Set the listfile.\n    this.set('(listfile)', this.getFileNames().join('\\r\\n'));\n\n    // Reset the file offsets.\n    let offset = headerSize;\n\n    for (const file of this.files) {\n      // There can be holes in the files array.\n      if (file) {\n        // If the file's offset changed, and it is encrypted with a key that depends on its offset,\n        // it needs to be decryped with it's current key, and encryped with the new key.\n        if (!file.offsetChanged(offset)) {\n          return null;\n        }\n\n        // If the file needs to be encoded, do it.\n        file.encode();\n\n        offset += file.block.compressedSize;\n      }\n    }\n\n    const hashTable = this.hashTable;\n    const blockTable = this.blockTable;\n    const hashes = hashTable.entries.length;\n    const blocks = blockTable.entries.length;\n    const filesSize = offset - headerSize;\n    const archiveSize = headerSize + filesSize + hashes * 16 + blocks * 16;\n    const hashPos = headerSize + filesSize;\n    const blockPos = hashPos + hashes * 16;\n    const bytes = new Uint8Array(archiveSize);\n    const uint32array = new Uint32Array(bytes.buffer, 0, 8);\n\n    // Write the header.\n    uint32array[0] = MAGIC;\n    uint32array[1] = headerSize;\n    uint32array[2] = archiveSize;\n    uint32array[3] = Math.log2(this.sectorSize / 512) << 16; // The version is always 0, so ignore it.\n    uint32array[4] = hashPos;\n    uint32array[5] = blockPos;\n    uint32array[6] = hashes;\n    uint32array[7] = blocks;\n\n    offset = headerSize;\n\n    // Write the files.\n    for (const file of this.files) {\n      // There can be holes in the files array.\n      if (file) {\n        if (file.rawBuffer) {\n          bytes.set(file.rawBuffer, offset);\n        }\n\n        offset += file.block.compressedSize;\n      }\n    }\n\n    // Write the hash table.\n    hashTable.save(bytes.subarray(offset, offset + hashTable.entries.length * 16));\n\n    offset += hashTable.entries.length * 16;\n\n    // Write the block table.\n    blockTable.save(bytes.subarray(offset, offset + blockTable.entries.length * 16));\n\n    return bytes;\n  }\n\n  /**\n   * Some MPQs have empty memory chunks in them, left over from files that were deleted.\n   * This function searches for such chunks, and removes them.\n   * \n   * Note that it is called automatically by save().\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  saveMemory(): number {\n    if (this.readonly) {\n      return 0;\n    }\n\n    const blocks = this.blockTable.entries;\n    const hashes = this.hashTable.entries;\n    let i = blocks.length;\n    let saved = 0;\n\n    while (i--) {\n      const block = blocks[i];\n\n      // Remove blocks with no data.\n      if (block.normalSize === 0) {\n        this.removeBlock(i);\n\n        saved += block.compressedSize;\n      } else {\n        let used = false;\n\n        for (const hash of hashes) {\n          if (hash.blockIndex === i) {\n            used = true;\n            break;\n          }\n        }\n\n        // Remove blocks that are not used.\n        if (!used) {\n          this.removeBlock(i);\n\n          saved += block.compressedSize;\n        }\n      }\n    }\n\n    return saved;\n  }\n\n  removeBlock(blockIndex: number): void {\n    for (const hash of this.hashTable.entries) {\n      if (hash.blockIndex < HASH_ENTRY_DELETED && hash.blockIndex > blockIndex) {\n        hash.blockIndex -= 1;\n      }\n    }\n\n    this.blockTable.entries.splice(blockIndex, 1);\n  }\n\n  /**\n   * Gets a list of the file names in the archive.\n   * \n   * Note that files loaded from an existing archive, without resolved names, will be named FileXXXXXXXX.\n   */\n  getFileNames(): string[] {\n    const names = [];\n\n    for (const file of this.files) {\n      if (file && file.name !== '') {\n        names.push(file.name);\n      }\n    }\n\n    return names;\n  }\n\n  /**\n   * Count the files with unresolved names.\n   */\n  countUnresolved(): number {\n    let unresolved = 0;\n\n    for (const file of this.files) {\n      if (!file.nameResolved) {\n        unresolved++;\n      }\n    }\n\n    return unresolved;\n  }\n\n  /**\n   * Given an iterable of file names, attempt to resolve the archive files with them.\n   */\n  applyListfile(listfile: Iterable<string>): void {\n    for (const file of listfile) {\n      this.get(file);\n    }\n  }\n\n  /**\n   * Adds a file to this archive.\n   * If the file already exists, its buffer will be set.\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  set(name: string, buffer: ArrayBuffer | Uint8Array | string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    const bytes = bytesOf(buffer);\n    let file = this.get(name);\n\n    // If the file already exists, change the data.\n    if (file) {\n      file.set(bytes);\n    } else {\n      const blockIndex = this.blockTable.entries.length;\n      const hash = this.hashTable.add(name, blockIndex);\n\n      if (!hash) {\n        return false;\n      }\n\n      const block = this.blockTable.add(bytes);\n\n      file = new MpqFile(this, hash, block, null, bytes);\n      file.name = name;\n      file.nameResolved = true;\n\n      this.files[blockIndex] = file;\n    }\n\n    return true;\n  }\n\n  /**\n   * Gets a file from this archive.\n   * If the file doesn't exist, null is returned.\n   */\n  get(name: string): MpqFile | null {\n    const hash = this.hashTable.get(name);\n\n    if (hash) {\n      const blockIndex = hash.blockIndex;\n\n      // Check if the block exists.\n      if (blockIndex < HASH_ENTRY_DELETED) {\n        const file = this.files[blockIndex];\n\n        if (file) {\n          // Save the name in case it wasn't already resolved.\n          file.name = name;\n          file.nameResolved = true;\n\n          return file;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Checks if a file exists.\n   * \n   * Prefer to use get() if you are going to use get() afterwards anyway.\n   */\n  has(name: string): boolean {\n    return !!this.get(name);\n  }\n\n  /**\n   * Deletes a file from this archive.\n   * \n   * Does nothing if...\n   * \n   *     1) The archive is in readonly mode.\n   *     2) The file does not exist.\n   */\n  delete(name: string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    const file = this.get(name);\n\n    if (!file) {\n      return false;\n    }\n\n    file.delete();\n\n    return true;\n  }\n\n  /**\n   * Renames a file.\n   * \n   * Does nothing if...\n   * \n   *     1) The archive is in readonly mode.\n   *     2) The file does not exist.\n   * \n   * Note that this sets the current file's hash's status to being deleted, rather than removing it.\n   * This is due to the way the search algorithm works.\n   */\n  rename(name: string, newName: string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    const file = this.get(name);\n\n    if (!file) {\n      return false;\n    }\n\n    file.rename(newName);\n\n    return true;\n  }\n\n  /**\n   * Resizes the hashtable to the nearest power of two equal to or bigger than the given size.\n   * \n   * Generally speaking, the bigger the hashtable is, the quicker insertions/searches are, at the cost of added memory.\n   * \n   * Does nothing if...\n   * \n   *     1) The archive is in readonly mode.\n   *     2) The calculated size is smaller than the amount of files in the archive.\n   *     3) Not all of the file names in the archive are resolved.\n   */\n  resizeHashtable(size: number): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    size = Math.max(4, powerOfTwo(size));\n\n    const files = this.files;\n\n    // Can't resize to a size smaller than the existing files.\n    if (files.length > size) {\n      return false;\n    }\n\n    // If not all file names are known, don't resize.\n    // The insertion algorithm depends on the names.\n    for (const file of files) {\n      if (!file.nameResolved) {\n        return false;\n      }\n    }\n\n    const hashTable = this.hashTable;\n    const entries = hashTable.entries;\n    const oldEntries = entries.slice();\n\n    // Clear the entries.\n    hashTable.clear();\n\n    // Add empty entries.\n    hashTable.addEmpties(size);\n\n    // Go over all of the old entries, and copy them into the new entries.\n    for (const hash of oldEntries) {\n      if (hash.blockIndex !== HASH_ENTRY_EMPTY) {\n        const file = files[hash.blockIndex];\n        const insertionIndex = hashTable.getInsertionIndex(file.name);\n\n        entries[insertionIndex].copy(hash);\n      }\n    }\n\n    return true;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * An import.\n */\nexport default class Import {\n  isCustom = 0;\n  path = '';\n\n  load(stream: BinaryStream): void {\n    this.isCustom = stream.readUint8();\n    this.path = stream.readNull();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeUint8(this.isCustom);\n    stream.writeNull(this.path);\n  }\n\n  getByteLength(): number {\n    return 2 + byteLengthUtf8(this.path);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Import from './import';\n\n/**\n * war3map.imp - the import file.\n */\nexport default class War3MapImp {\n  version = 1;\n  entries: Map<string, Import> = new Map();\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const stream = new BinaryStream(buffer);\n\n    this.version = stream.readUint32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const entry = new Import();\n\n      entry.load(stream);\n\n      if (entry.isCustom) {\n        this.entries.set(entry.path, entry);\n      } else {\n        this.entries.set(`war3mapimported\\\\${entry.path}`, entry);\n      }\n    }\n  }\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeUint32(this.version);\n    stream.writeUint32(this.entries.size);\n\n    for (const entry of this.entries.values()) {\n      entry.save(stream);\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    let size = 8;\n\n    for (const entry of this.entries.values()) {\n      size += entry.getByteLength();\n    }\n\n    return size;\n  }\n\n  set(path: string): boolean {\n    if (!this.entries.has(path)) {\n      const entry = new Import();\n\n      entry.isCustom = 10;\n      entry.path = path;\n\n      this.entries.set(path, entry);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  has(path: string): boolean {\n    return this.entries.has(path);\n  }\n\n  delete(path: string): boolean {\n    return this.entries.delete(path);\n  }\n\n  rename(path: string, newPath: string): boolean {\n    const entry = this.entries.get(path);\n\n    if (entry) {\n      entry.isCustom = 10;\n      entry.path = newPath;\n\n      return true;\n    }\n\n    return false;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * A modification.\n */\nexport default class Modification {\n  id = '\\0\\0\\0\\0';\n  variableType = 0;\n  levelOrVariation = 0;\n  dataPointer = 0;\n  value: number | string = 0;\n  u1 = 0;\n\n  load(stream: BinaryStream, useOptionalInts: boolean): void {\n    this.id = stream.readBinary(4);\n    this.variableType = stream.readInt32();\n\n    if (useOptionalInts) {\n      this.levelOrVariation = stream.readInt32();\n      this.dataPointer = stream.readInt32();\n    }\n\n    if (this.variableType === 0) {\n      this.value = stream.readInt32();\n    } else if (this.variableType === 1 || this.variableType === 2) {\n      this.value = stream.readFloat32();\n    } else if (this.variableType === 3) {\n      this.value = stream.readNull();\n    } else {\n      throw new Error(`Modification: unknown variable type ${this.variableType}`);\n    }\n\n    this.u1 = stream.readInt32();\n  }\n\n  save(stream: BinaryStream, useOptionalInts: boolean): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.variableType);\n\n    if (useOptionalInts) {\n      stream.writeInt32(this.levelOrVariation);\n      stream.writeInt32(this.dataPointer);\n    }\n\n    if (this.variableType === 0) {\n      stream.writeInt32(<number>this.value);\n    } else if (this.variableType === 1 || this.variableType === 2) {\n      stream.writeFloat32(<number>this.value);\n    } else if (this.variableType === 3) {\n      stream.writeNull(<string>this.value);\n    } else {\n      throw new Error(`Modification: unknown variable type ${this.variableType}`);\n    }\n\n    stream.writeInt32(this.u1);\n  }\n\n  getByteLength(useOptionalInts: boolean): number {\n    let size = 12;\n\n    if (useOptionalInts) {\n      size += 8;\n    }\n\n    if (this.variableType === 3) {\n      size += byteLengthUtf8(<string>this.value) + 1;\n    } else {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Modification from './modification';\n\n/**\n * A modified object.\n */\nexport default class ModifiedObject {\n  oldId = '\\0\\0\\0\\0';\n  newId = '\\0\\0\\0\\0';\n  modifications: Modification[] = [];\n\n  load(stream: BinaryStream, useOptionalInts: boolean): void {\n    this.oldId = stream.readBinary(4);\n    this.newId = stream.readBinary(4);\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const modification = new Modification();\n\n      modification.load(stream, useOptionalInts);\n\n      this.modifications[i] = modification;\n    }\n  }\n\n  save(stream: BinaryStream, useOptionalInts: boolean): void {\n    if (this.oldId !== '\\0\\0\\0\\0') {\n      stream.writeBinary(this.oldId);\n    } else {\n      stream.writeUint32(0);\n    }\n\n    if (this.newId !== '\\0\\0\\0\\0') {\n      stream.writeBinary(this.newId);\n    } else {\n      stream.writeUint32(0);\n    }\n\n    stream.writeUint32(this.modifications.length);\n\n    for (const modification of this.modifications) {\n      modification.save(stream, useOptionalInts);\n    }\n  }\n\n  getByteLength(useOptionalInts: boolean): number {\n    let size = 12;\n\n    for (const modification of this.modifications) {\n      size += modification.getByteLength(useOptionalInts);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport ModifiedObject from './modifiedobject';\n\n/**\n * A modification table.\n */\nexport default class ModificationTable {\n  objects: ModifiedObject[] = [];\n\n  load(stream: BinaryStream, useOptionalInts: boolean): void {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const object = new ModifiedObject();\n\n      object.load(stream, useOptionalInts);\n\n      this.objects[i] = object;\n    }\n  }\n\n  save(stream: BinaryStream, useOptionalInts: boolean): void {\n    stream.writeUint32(this.objects.length);\n\n    for (const object of this.objects) {\n      object.save(stream, useOptionalInts);\n    }\n  }\n\n  getByteLength(useOptionalInts: boolean): number {\n    let size = 4;\n\n    for (const object of this.objects) {\n      size += object.getByteLength(useOptionalInts);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport ModificationTable from '../w3u/modificationtable';\n\n/**\n * war3map.w3d - the doodad modification file.\n *\n * Also used for war3map.w3a (abilities), and war3map.w3q (upgrades).\n */\nexport default class War3MapW3d {\n  version = 0;\n  originalTable = new ModificationTable();\n  customTable = new ModificationTable();\n\n  load(bufferOrStream: ArrayBuffer | Uint8Array | BinaryStream): void {\n    let stream;\n\n    if (bufferOrStream instanceof BinaryStream) {\n      stream = bufferOrStream;\n    } else {\n      stream = new BinaryStream(bufferOrStream);\n    }\n\n    this.version = stream.readInt32();\n    this.originalTable.load(stream, true);\n    this.customTable.load(stream, true);\n  }\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeInt32(this.version);\n    this.originalTable.save(stream, true);\n    this.customTable.save(stream, true);\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    return 4 + this.originalTable.getByteLength(true) + this.customTable.getByteLength(true);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport ModificationTable from './modificationtable';\n\n/**\n * war3map.w3u - the unit modification file.\n *\n * Also used for war3map.w3t (items), war3map.w3b (destructibles), and war3map.w3h (buffs).\n */\nexport default class War3MapW3u {\n  version = 0;\n  originalTable = new ModificationTable();\n  customTable = new ModificationTable();\n\n  load(bufferOrStream: ArrayBuffer | Uint8Array | BinaryStream): void {\n    let stream;\n\n    if (bufferOrStream instanceof BinaryStream) {\n      stream = bufferOrStream;\n    } else {\n      stream = new BinaryStream(bufferOrStream);\n    }\n\n    this.version = stream.readInt32();\n    this.originalTable.load(stream, false);\n    this.customTable.load(stream, false);\n  }\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeInt32(this.version);\n    this.originalTable.save(stream, false);\n    this.customTable.save(stream, false);\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    return 4 + this.originalTable.getByteLength(false) + this.customTable.getByteLength(false);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * A custom text trigger.\n */\nexport default class CustomTextTrigger {\n  text = '';\n\n  load(stream: BinaryStream): void {\n    const textLength = stream.readInt32();\n\n    if (textLength) {\n      this.text = stream.read(textLength - 1);\n      stream.skip(1);\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    if (this.text.length) {\n      stream.writeInt32(byteLengthUtf8(this.text) + 1);\n      stream.write(this.text);\n      stream.skip(1);\n    } else {\n      stream.writeInt32(0);\n    }\n  }\n\n  getByteLength(): number {\n    let size = 4;\n\n    if (this.text.length) {\n      size += byteLengthUtf8(this.text) + 1;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport CustomTextTrigger from './customtexttrigger';\n\n/**\n * war3map.wct - the custom text (jass) trigger file.\n */\nexport default class War3MapWct {\n  version = 0;\n  comment = '';\n  trigger = new CustomTextTrigger();\n  triggers: CustomTextTrigger[] = [];\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n\n    if (this.version === 1) {\n      this.comment = stream.readNull();\n\n      this.trigger.load(stream);\n    }\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const trigger = new CustomTextTrigger();\n\n      trigger.load(stream);\n\n      this.triggers[i] = trigger;\n    }\n  }\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeInt32(this.version);\n\n    if (this.version === 1) {\n      stream.writeNull(this.comment);\n\n      this.trigger.save(stream);\n    }\n\n    stream.writeUint32(this.triggers.length);\n\n    for (const trigger of this.triggers) {\n      trigger.save(stream);\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    let size = 8;\n\n    if (this.version === 1) {\n      size += byteLengthUtf8(this.comment) + 1 + this.trigger.getByteLength();\n    }\n\n    for (const trigger of this.triggers) {\n      size += trigger.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * A Trigger category.\n * \n * Used to scope triggers together in a Folder-like hierarchy.\n */\nexport default class TriggerCategory {\n  id = 0;\n  name = '';\n  isComment = 0;\n\n  load(stream: BinaryStream, version: number): void {\n    this.id = stream.readInt32();\n    this.name = stream.readNull();\n\n    if (version === 7) {\n      this.isComment = stream.readInt32();\n    }\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeInt32(this.id);\n    stream.writeNull(this.name);\n\n    if (version === 7) {\n      stream.writeInt32(this.isComment);\n    }\n  }\n\n  getByteLength(version: number): number {\n    let size = 5 + byteLengthUtf8(this.name);\n\n    if (version === 7) {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * A global variable.\n */\nexport default class Variable {\n  name = '';\n  type = '';\n  u1 = 0;\n  isArray = 0;\n  arraySize = 0;\n  isInitialized = 0;\n  initialValue = '';\n\n  load(stream: BinaryStream, version: number): void {\n    this.name = stream.readNull();\n    this.type = stream.readNull();\n    this.u1 = stream.readInt32();\n    this.isArray = stream.readInt32();\n\n    if (version === 7) {\n      this.arraySize = stream.readInt32();\n    }\n\n    this.isInitialized = stream.readInt32();\n    this.initialValue = stream.readNull();\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeNull(this.name);\n    stream.writeNull(this.type);\n    stream.writeInt32(this.u1);\n    stream.writeInt32(this.isArray);\n\n    if (version === 7) {\n      stream.writeInt32(this.arraySize);\n    }\n\n    stream.writeInt32(this.isInitialized);\n    stream.writeNull(this.initialValue);\n  }\n\n  getByteLength(version: number): number {\n    let size = 15 + byteLengthUtf8(this.name) + byteLengthUtf8(this.type) + byteLengthUtf8(this.initialValue);\n\n    if (version === 7) {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport Parameter from './parameter';\nimport { TriggerData } from './triggerdata';\n\n/**\n * A function call in an expression.\n */\nexport default class SubParameters {\n  type = 0;\n  name = '';\n  beginParameters = 0;\n  parameters: Parameter[] = [];\n\n  load(stream: BinaryStream, version: number, triggerData: TriggerData): void {\n    this.type = stream.readInt32();\n\n    if (this.type < 0 || this.type > 3) {\n      throw new Error(`SubParameters: Bad type: ${this.type}`);\n    }\n\n    this.name = stream.readNull();\n\n    if (this.name.length === 0) {\n      throw new Error(`SubParameters: Empty name`);\n    }\n\n    this.beginParameters = stream.readInt32();\n\n    if (this.beginParameters) {\n      const signature = triggerData.getFunction(this.type, this.name);\n\n      if (!signature) {\n        throw new Error(`SubParameters \"${this.name}:${this.type}\": Unknown signature`);\n      }\n\n      const args = signature.args;\n\n      for (let i = 0, l = args.length; i < l; i++) {\n        const parameter = new Parameter();\n\n        try {\n          parameter.load(stream, version, triggerData);\n        } catch (e) {\n          throw new Error(`SubParameters \"${this.name}\": Parameter ${i}: ${e}`);\n        }\n\n        this.parameters[i] = parameter;\n      }\n    }\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeInt32(this.type);\n    stream.writeNull(this.name);\n    stream.writeInt32(this.beginParameters);\n\n    for (const parameter of this.parameters) {\n      parameter.save(stream, version);\n    }\n  }\n\n  getByteLength(version: number): number {\n    let size = 9 + byteLengthUtf8(this.name);\n\n    if (this.parameters.length) {\n      for (const parameter of this.parameters) {\n        size += parameter.getByteLength(version);\n      }\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport SubParameters from './subparameters';\nimport { TriggerData } from './triggerdata';\n\n/**\n * A function parameter. Can be a function itself, in which case it will have a SubParameters structure.\n */\nexport default class Parameter {\n  type = 0;\n  value = '';\n  subParameters: SubParameters | null = null;\n  u1 = 0;\n  isArray = 0;\n  arrayIndex: Parameter | null = null;\n\n  load(stream: BinaryStream, version: number, triggerData: TriggerData): void {\n    this.type = stream.readInt32();\n\n    if (this.type < -1 || this.type > 3) {\n      throw new Error(`Parameter: Bad type: ${this.type}`);\n    }\n\n    this.value = stream.readNull();\n\n    if (stream.readInt32()) {\n      const subParameters = new SubParameters();\n\n      try {\n        subParameters.load(stream, version, triggerData);\n      } catch (e) {\n        throw new Error(`Parameter \"${this.value}\": SubParameters ${e}`);\n      }\n\n      this.subParameters = subParameters;\n    }\n\n    if ((version === 4 && this.type === 2) || (version === 7 && this.subParameters)) {\n      this.u1 = stream.readInt32();\n    }\n\n    if ((version === 4 && this.type !== 2) || version === 7) {\n      this.isArray = stream.readInt32();\n    }\n\n    if (this.isArray) {\n      const arrayIndex = new Parameter();\n\n      try {\n        arrayIndex.load(stream, version, triggerData);\n      } catch (e) {\n        throw new Error(`Parameter \"${this.value}\": ArrayIndex: ${e}`);\n      }\n\n      this.arrayIndex = arrayIndex;\n    }\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeInt32(this.type);\n    stream.writeNull(this.value);\n\n    if (this.subParameters) {\n      stream.writeInt32(1);\n      this.subParameters.save(stream, version);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if ((version === 4 && this.type === 2) || (version === 7 && this.subParameters)) {\n      stream.writeInt32(this.u1);\n    }\n\n    if ((version === 4 && this.type !== 2) || version === 7) {\n      stream.writeInt32(this.isArray);\n    }\n\n    if (this.isArray && this.arrayIndex) {\n      this.arrayIndex.save(stream, version);\n    }\n  }\n\n  getByteLength(version: number): number {\n    let size = 9 + byteLengthUtf8(this.value);\n\n    if (this.subParameters) {\n      size += this.subParameters.getByteLength(version);\n    }\n\n    if ((version === 4 && this.type === 2) || (version === 7 && this.subParameters)) {\n      size += 4;\n    }\n\n    if ((version === 4 && this.type !== 2) || version === 7) {\n      size += 4;\n    }\n\n    if (this.isArray && this.arrayIndex) {\n      size += this.arrayIndex.getByteLength(version);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport Parameter from './parameter';\nimport { TriggerData } from './triggerdata';\n\n/**\n * An Event/Condition/Action.\n */\nexport default class ECA {\n  type = -1;\n  group = -1;\n  name = '';\n  isEnabled = 0;\n  parameters: Parameter[] = [];\n  ecas: ECA[] = [];\n\n  load(stream: BinaryStream, version: number, isChildECA: boolean, triggerData: TriggerData): void {\n    this.type = stream.readInt32();\n\n    if (this.type < 0 || this.type > 3) {\n      throw new Error(`ECA: Bad type: ${this.type}`);\n    }\n\n    if (isChildECA) {\n      this.group = stream.readUint32();\n    }\n\n    this.name = stream.readNull();\n\n    if (this.name.length === 0) {\n      throw new Error('ECA: Empty name');\n    }\n\n    this.isEnabled = stream.readInt32();\n\n    const signature = triggerData.getFunction(this.type, this.name);\n\n    if (!signature) {\n      throw new Error(`ECA \"${this.name}:${this.type}\": Unknown signature`);\n    }\n\n    const args = signature.args;\n\n    for (let i = 0, l = args.length; i < l; i++) {\n      const parameter = new Parameter();\n\n      try {\n        parameter.load(stream, version, triggerData);\n      } catch (e) {\n        throw new Error(`ECA \"${this.name}\": Parameter ${i}: ${e}`);\n      }\n\n      this.parameters[i] = parameter;\n    }\n\n    if (version === 7) {\n      for (let i = 0, l = stream.readUint32(); i < l; i++) {\n        const eca = new ECA();\n\n        try {\n          eca.load(stream, version, true, triggerData);\n        } catch (e) {\n          throw new Error(`ECA \"${this.name}\": Child ECA ${i} ${e}`);\n        }\n\n        this.ecas[i] = eca;\n      }\n    }\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeInt32(this.type);\n\n    if (this.group !== -1) {\n      stream.writeInt32(this.group);\n    }\n\n    stream.writeNull(this.name);\n    stream.writeInt32(this.isEnabled);\n\n    for (const parameter of this.parameters) {\n      parameter.save(stream, version);\n    }\n\n    if (version === 7) {\n      stream.writeUint32(this.ecas.length);\n\n      for (const eca of this.ecas) {\n        eca.save(stream, version);\n      }\n    }\n  }\n\n  getByteLength(version: number): number {\n    let size = 9 + byteLengthUtf8(this.name);\n\n    if (this.group !== -1) {\n      size += 4;\n    }\n\n    for (const parameter of this.parameters) {\n      size += parameter.getByteLength(version);\n    }\n\n    if (version === 7) {\n      size += 4;\n\n      for (const eca of this.ecas) {\n        size += eca.getByteLength(version);\n      }\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport ECA from './eca';\nimport { TriggerData } from './triggerdata';\n\n/**\n * A GUI Trigger.\n */\nexport default class Trigger {\n  name = '';\n  description = '';\n  isComment = 0;\n  isEnabled = 0;\n  isCustom = 0;\n  isInitiallyOff = 0;\n  runOnInitialization = 0;\n  category = 0;\n  ecas: ECA[] = [];\n\n  load(stream: BinaryStream, version: number, triggerData: TriggerData): void {\n    this.name = stream.readNull();\n    this.description = stream.readNull();\n\n    if (version === 7) {\n      this.isComment = stream.readInt32();\n    }\n\n    this.isEnabled = stream.readInt32();\n    this.isCustom = stream.readInt32();\n    this.isInitiallyOff = stream.readInt32();\n    this.runOnInitialization = stream.readInt32();\n    this.category = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const eca = new ECA();\n\n      try {\n        eca.load(stream, version, false, triggerData);\n      } catch (e) {\n        throw new Error(`Trigger \"${this.name}\": ECA ${i}: ${e}`);\n      }\n\n      this.ecas[i] = eca;\n    }\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeNull(this.name);\n    stream.writeNull(this.description);\n\n    if (version === 7) {\n      stream.writeInt32(this.isComment);\n    }\n\n    stream.writeInt32(this.isEnabled);\n    stream.writeInt32(this.isCustom);\n    stream.writeInt32(this.isInitiallyOff);\n    stream.writeInt32(this.runOnInitialization);\n    stream.writeInt32(this.category);\n    stream.writeUint32(this.ecas.length);\n\n    for (const eca of this.ecas) {\n      eca.save(stream, version);\n    }\n  }\n\n  getByteLength(version: number): number {\n    let size = 26 + byteLengthUtf8(this.name) + byteLengthUtf8(this.description);\n\n    if (version === 7) {\n      size += 4;\n    }\n\n    for (const eca of this.ecas) {\n      size += eca.getByteLength(version);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport TriggerCategory from './triggercategory';\nimport Variable from './variable';\nimport Trigger from './trigger';\nimport { TriggerData } from './triggerdata';\n\n/**\n * war3map.wtg - the trigger file.\n */\nexport default class War3MapWtg {\n  version = 0;\n  categories: TriggerCategory[] = [];\n  u1 = 0;\n  variables: Variable[] = [];\n  triggers: Trigger[] = [];\n\n  load(buffer: ArrayBuffer | Uint8Array, triggerData: TriggerData): void {\n    const stream = new BinaryStream(buffer);\n\n    if (stream.readBinary(4) !== 'WTG!') {\n      throw new Error('Not a WTG file');\n    }\n\n    this.version = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const category = new TriggerCategory();\n\n      category.load(stream, this.version);\n\n      this.categories[i] = category;\n    }\n\n    this.u1 = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const variable = new Variable();\n\n      variable.load(stream, this.version);\n\n      this.variables[i] = variable;\n    }\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const trigger = new Trigger();\n\n      try {\n        trigger.load(stream, this.version, triggerData);\n      } catch (e) {\n        throw new Error(`Trigger ${i}: ${e}`);\n      }\n\n      this.triggers[i] = trigger;\n    }\n  }\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeBinary('WTG!');\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.categories.length);\n\n    for (const category of this.categories) {\n      category.save(stream, this.version);\n    }\n\n    stream.writeInt32(this.u1);\n    stream.writeUint32(this.variables.length);\n\n    for (const variable of this.variables) {\n      variable.save(stream, this.version);\n    }\n\n    stream.writeUint32(this.triggers.length);\n\n    for (const trigger of this.triggers) {\n      trigger.save(stream, this.version);\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    let size = 24;\n    const version = this.version;\n\n    for (const category of this.categories) {\n      size += category.getByteLength(version);\n    }\n\n    for (const variable of this.variables) {\n      size += variable.getByteLength(version);\n    }\n\n    for (const trigger of this.triggers) {\n      size += trigger.getByteLength(version);\n    }\n\n    return size;\n  }\n}\n","import TokenStream from '../../mdlx/tokenstream';\n\n/**\n * war3map.wts - the string table file.\n *\n * Contains a map of number->string.\n * When other map data like triggers use the string TRIGSTR_XXX, where XXX is a number, the value will be fetched from the table.\n */\nexport default class War3MapWts {\n  stringMap: Map<number, string> = new Map();\n\n  load(buffer: string): void {\n    const stream = new TokenStream(buffer);\n    let token;\n\n    // Find the first instance of \"STRING\".\n    // There are some weird war3map.wts files that begin with the bytes \"ï»¿\", and this causes the tokenizer to see the first token as \"ï»¿STRING\".\n    // Going to the first \"STRING\" means we can ignore any weird bytes that happened to be before.\n    const start = buffer.indexOf('STRING');\n\n    // Can war3map.wts have no entries? I don't know, might as well add a condition.\n    if (start === -1) {\n      throw new Error('Not a valid war3map.wts buffer');\n    }\n\n    stream.index = start;\n\n    while ((token = stream.readToken())) {\n      if (token === 'STRING') {\n        const index = stream.readInt();\n\n        stream.read(); // {\n\n        const end = buffer.indexOf('}', stream.index);\n\n        // For broken files, keep whatever data can be kept, and throw an exception.\n        if (end === -1) {\n          this.stringMap.set(index, buffer.slice(stream.index, buffer.length).trim());\n\n          throw new Error(`WTS: missing data in string ${this.stringMap.size} (and maybe more)`);\n        }\n\n        this.stringMap.set(index, buffer.slice(stream.index, end).trim());\n\n        stream.index = end;\n      }\n    }\n  }\n\n  save(): string {\n    let buffer = '';\n\n    for (const [key, value] of this.stringMap) {\n      buffer += `STRING ${key}\\r\\n{\\r\\n${value}\\r\\n}\\r\\n\\r\\n`;\n    }\n\n    return buffer;\n  }\n\n  /**\n   * Get the string at the given index.\n   * \n   * Strings in the form \"TRIGSTR_nnn\" are also supported.\n   */\n  getString(index: number | string): string | undefined {\n    if (typeof index === 'string') {\n      if (index.startsWith('TRIGSTR_')) {\n        return this.stringMap.get(parseInt(index.slice(8)));\n      }\n    } else {\n      return this.stringMap.get(index);\n    }\n\n    return;\n  }\n\n  /**\n   * Set the string at the given index.\n   * \n   * Strings in the form \"TRIGSTR_nnn\" are also supported.\n   */\n  setString(index: number | string, value: string): void {\n    if (typeof index === 'string') {\n      if (index.startsWith('TRIGSTR_')) {\n        this.stringMap.set(parseInt(index.slice(8)), value);\n      }\n    } else {\n      this.stringMap.set(index, value);\n    }\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * A force.\n */\nexport default class Force {\n  flags = 0;\n  playerMasks = 0;\n  name = '';\n\n  load(stream: BinaryStream): void {\n    this.flags = stream.readUint32();\n    this.playerMasks = stream.readUint32();\n    this.name = stream.readNull();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeUint32(this.flags);\n    stream.writeUint32(this.playerMasks);\n    stream.writeNull(this.name);\n  }\n\n  getByteLength(): number {\n    return 9 + byteLengthUtf8(this.name);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\n\n/**\n * A player.\n */\nexport default class Player {\n  id = 0;\n  type = 0;\n  race = 0;\n  isFixedStartPosition = 0;\n  name = '';\n  startLocation = new Float32Array(2);\n  allyLowPriorities = 0;\n  allyHighPriorities = 0;\n  unknown1 = new Uint8Array(8);\n\n  load(stream: BinaryStream, version: number): void {\n    this.id = stream.readInt32();\n    this.type = stream.readInt32();\n    this.race = stream.readInt32();\n    this.isFixedStartPosition = stream.readInt32();\n    this.name = stream.readNull();\n    stream.readFloat32Array(this.startLocation);\n    this.allyLowPriorities = stream.readUint32();\n    this.allyHighPriorities = stream.readUint32();\n    if (version > 30) {\n      stream.readUint8Array(this.unknown1);\n    }\n  }\n\n  save(stream: BinaryStream, version: number): void {\n    stream.writeInt32(this.id);\n    stream.writeInt32(this.type);\n    stream.writeInt32(this.race);\n    stream.writeInt32(this.isFixedStartPosition);\n    stream.writeNull(this.name);\n    stream.writeFloat32Array(this.startLocation);\n    stream.writeUint32(this.allyLowPriorities);\n    stream.writeUint32(this.allyHighPriorities);\n    if (version > 30) {\n      stream.writeUint8Array(this.unknown1);\n    }\n  }\n\n  getByteLength(version: number): number {\n    let size = 33 + byteLengthUtf8(this.name);\n\n    if (version > 30) {\n      size += 8;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A random item.\n */\nexport default class RandomItem {\n  chance = 0;\n  id = '\\0\\0\\0\\0';\n\n  load(stream: BinaryStream): void {\n    this.chance = stream.readInt32();\n    this.id = stream.readBinary(4);\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt32(this.chance);\n    stream.writeBinary(this.id);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport RandomItem from './randomitem';\n\n/**\n * A random item set.\n */\nexport default class RandomItemSet {\n  items: RandomItem[] = [];\n\n  load(stream: BinaryStream): void {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const item = new RandomItem();\n\n      item.load(stream);\n\n      this.items[i] = item;\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeUint32(this.items.length);\n\n    for (const item of this.items) {\n      item.save(stream);\n    }\n  }\n\n  getByteLength(): number {\n    return 4 + this.items.length * 8;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport RandomItemSet from './randomitemset';\n\n/**\n * A random item table.\n */\nexport default class RandomItemTable {\n  id = 0;\n  name = '';\n  sets: RandomItemSet[] = [];\n\n  load(stream: BinaryStream): void {\n    this.id = stream.readInt32();\n    this.name = stream.readNull();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const set = new RandomItemSet();\n\n      set.load(stream);\n\n      this.sets[i] = set;\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt32(this.id);\n    stream.writeNull(this.name);\n    stream.writeUint32(this.sets.length);\n\n    for (const set of this.sets) {\n      set.save(stream);\n    }\n  }\n\n  getByteLength(): number {\n    let size = 9 + byteLengthUtf8(this.name);\n\n    for (const set of this.sets) {\n      size += set.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A random unit.\n */\nexport default class RandomUnit {\n  chance = 0;\n  ids: string[] = [];\n\n  load(stream: BinaryStream, positions: number): void {\n    this.chance = stream.readInt32();\n\n    for (let i = 0; i < positions; i++) {\n      this.ids[i] = stream.readBinary(4);\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt32(this.chance);\n\n    for (const id of this.ids) {\n      stream.writeBinary(id);\n    }\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport RandomUnit from './randomunit';\n\n/**\n * A random unit table.\n */\nexport default class RandomUnitTable {\n  id = 0;\n  name = '';\n  positions = 0;\n  columnTypes = new Int32Array(0);\n  units: RandomUnit[] = [];\n\n  load(stream: BinaryStream): void {\n    this.id = stream.readInt32();\n    this.name = stream.readNull();\n    this.positions = stream.readInt32();\n    this.columnTypes = stream.readInt32Array(this.positions);\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const unit = new RandomUnit();\n\n      unit.load(stream, this.positions);\n\n      this.units[i] = unit;\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt32(this.id);\n    stream.writeNull(this.name);\n    stream.writeInt32(this.positions);\n    stream.writeInt32Array(this.columnTypes);\n    stream.writeUint32(this.units.length);\n\n    for (const unit of this.units) {\n      unit.save(stream);\n    }\n  }\n\n  getByteLength(): number {\n    return 13 + byteLengthUtf8(this.name) + this.columnTypes.byteLength + (this.units.length * (4 + 4 * this.positions));\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A tech availablity change.\n */\nexport default class TechAvailabilityChange {\n  playerFlags = 0;\n  id = '\\0\\0\\0\\0';\n\n  load(stream: BinaryStream): void {\n    this.playerFlags = stream.readUint32();\n    this.id = stream.readBinary(4);\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeUint32(this.playerFlags);\n    stream.writeBinary(this.id);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * An upgrade availability change.\n */\nexport default class UpgradeAvailabilityChange {\n  playerFlags = 0;\n  id = '\\0\\0\\0\\0';\n  levelAffected = 0;\n  availability = 0;\n\n  load(stream: BinaryStream): void {\n    this.playerFlags = stream.readUint32();\n    this.id = stream.readBinary(4);\n    this.levelAffected = stream.readInt32();\n    this.availability = stream.readInt32();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeUint32(this.playerFlags);\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.levelAffected);\n    stream.writeInt32(this.availability);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport { byteLengthUtf8 } from '../../../common/utf8';\nimport Force from './force';\nimport Player from './player';\nimport RandomItemTable from './randomitemtable';\nimport RandomUnitTable from './randomunittable';\nimport TechAvailabilityChange from './techavailabilitychange';\nimport UpgradeAvailabilityChange from './upgradeavailabilitychange';\n\n/**\n * war3map.w3i - the general information file.\n */\nexport default class War3MapW3i {\n  version = 0;\n  saves = 0;\n  editorVersion = 0;\n  buildVersion = new Uint32Array(4);\n  name = '';\n  author = '';\n  description = '';\n  recommendedPlayers = '';\n  cameraBounds = new Float32Array(8);\n  cameraBoundsComplements = new Int32Array(4);\n  playableSize = new Int32Array(2);\n  flags = 0;\n  tileset = 'A';\n  campaignBackground = 0;\n  loadingScreenModel = '';\n  loadingScreenText = '';\n  loadingScreenTitle = '';\n  loadingScreenSubtitle = '';\n  loadingScreen = 0;\n  prologueScreenModel = '';\n  prologueScreenText = '';\n  prologueScreenTitle = '';\n  prologueScreenSubtitle = '';\n  useTerrainFog = 0;\n  fogHeight = new Float32Array(2);\n  fogDensity = 0;\n  fogColor = new Uint8Array(4);\n  globalWeather = 0;\n  soundEnvironment = '';\n  lightEnvironmentTileset = '\\0';\n  waterVertexColor = new Uint8Array(4);\n  scriptMode = 0;\n  graphicsMode = 0;\n  players: Player[] = [];\n  forces: Force[] = [];\n  upgradeAvailabilityChanges: UpgradeAvailabilityChange[] = [];\n  techAvailabilityChanges: TechAvailabilityChange[] = [];\n  randomUnitTables: RandomUnitTable[] = [];\n  randomItemTables: RandomItemTable[] = [];\n  unknown1 = 0;\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n    this.saves = stream.readInt32();\n    this.editorVersion = stream.readInt32();\n\n    if (this.version > 27) {\n      stream.readUint32Array(this.buildVersion);\n    }\n\n    this.name = stream.readNull();\n    this.author = stream.readNull();\n    this.description = stream.readNull();\n    this.recommendedPlayers = stream.readNull();\n    stream.readFloat32Array(this.cameraBounds);\n    stream.readInt32Array(this.cameraBoundsComplements);\n    stream.readInt32Array(this.playableSize);\n    this.flags = stream.readUint32();\n    this.tileset = stream.readBinary(1);\n    this.campaignBackground = stream.readInt32();\n\n    if (this.version > 24) {\n      this.loadingScreenModel = stream.readNull();\n    }\n\n    this.loadingScreenText = stream.readNull();\n    this.loadingScreenTitle = stream.readNull();\n    this.loadingScreenSubtitle = stream.readNull();\n    this.loadingScreen = stream.readInt32();\n\n    if (this.version > 24) {\n      this.prologueScreenModel = stream.readNull();\n    }\n\n    this.prologueScreenText = stream.readNull();\n    this.prologueScreenTitle = stream.readNull();\n    this.prologueScreenSubtitle = stream.readNull();\n\n    if (this.version > 24) {\n      this.useTerrainFog = stream.readInt32();\n      stream.readFloat32Array(this.fogHeight);\n      this.fogDensity = stream.readFloat32();\n      stream.readUint8Array(this.fogColor);\n      this.globalWeather = stream.readInt32();\n      this.soundEnvironment = stream.readNull();\n      this.lightEnvironmentTileset = stream.readBinary(1);\n      stream.readUint8Array(this.waterVertexColor);\n    }\n\n    if (this.version > 27) {\n      this.scriptMode = stream.readUint32();\n    }\n\n    if (this.version > 30) {\n      this.graphicsMode = stream.readUint32();\n      this.unknown1 = stream.readUint32();\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const player = new Player();\n\n      player.load(stream, this.version);\n\n      this.players[i] = player;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const force = new Force();\n\n      force.load(stream);\n\n      this.forces[i] = force;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const upgradeAvailabilityChange = new UpgradeAvailabilityChange();\n\n      upgradeAvailabilityChange.load(stream);\n\n      this.upgradeAvailabilityChanges[i] = upgradeAvailabilityChange;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const techAvailabilityChange = new TechAvailabilityChange();\n\n      techAvailabilityChange.load(stream);\n\n      this.techAvailabilityChanges[i] = techAvailabilityChange;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const randomUnitTable = new RandomUnitTable();\n\n      randomUnitTable.load(stream);\n\n      this.randomUnitTables[i] = randomUnitTable;\n    }\n\n    if (this.version > 24) {\n      for (let i = 0, l = stream.readInt32(); i < l; i++) {\n        const randomItemTable = new RandomItemTable();\n\n        randomItemTable.load(stream);\n\n        this.randomItemTables[i] = randomItemTable;\n      }\n    }\n  }\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeInt32(this.version);\n    stream.writeInt32(this.saves);\n    stream.writeInt32(this.editorVersion);\n\n    if (this.version > 27) {\n      stream.writeUint32Array(this.buildVersion);\n    }\n\n    stream.writeNull(this.name);\n    stream.writeNull(this.author);\n    stream.writeNull(this.description);\n    stream.writeNull(this.recommendedPlayers);\n    stream.writeFloat32Array(this.cameraBounds);\n    stream.writeInt32Array(this.cameraBoundsComplements);\n    stream.writeInt32Array(this.playableSize);\n    stream.writeUint32(this.flags);\n    stream.writeBinary(this.tileset);\n    stream.writeInt32(this.campaignBackground);\n\n    if (this.version > 24) {\n      stream.writeNull(this.loadingScreenModel);\n    }\n\n    stream.writeNull(this.loadingScreenText);\n    stream.writeNull(this.loadingScreenTitle);\n    stream.writeNull(this.loadingScreenSubtitle);\n    stream.writeInt32(this.loadingScreen);\n\n    if (this.version > 24) {\n      stream.writeNull(this.prologueScreenModel);\n    }\n\n    stream.writeNull(this.prologueScreenText);\n    stream.writeNull(this.prologueScreenTitle);\n    stream.writeNull(this.prologueScreenSubtitle);\n\n    if (this.version > 24) {\n      stream.writeInt32(this.useTerrainFog);\n      stream.writeFloat32Array(this.fogHeight);\n      stream.writeFloat32(this.fogDensity);\n      stream.writeUint8Array(this.fogColor);\n      stream.writeInt32(this.globalWeather);\n      stream.writeNull(this.soundEnvironment);\n      stream.writeBinary(this.lightEnvironmentTileset);\n      stream.writeUint8Array(this.waterVertexColor);\n    }\n\n    if (this.version > 27) {\n      stream.writeUint32(this.scriptMode);\n    }\n\n    if (this.version > 30) {\n      stream.writeUint32(this.graphicsMode);\n      stream.writeUint32(this.unknown1);\n    }\n\n    stream.writeUint32(this.players.length);\n\n    for (const player of this.players) {\n      player.save(stream, this.version);\n    }\n\n    stream.writeUint32(this.forces.length);\n\n    for (const force of this.forces) {\n      force.save(stream);\n    }\n\n    stream.writeUint32(this.upgradeAvailabilityChanges.length);\n\n    for (const change of this.upgradeAvailabilityChanges) {\n      change.save(stream);\n    }\n\n    stream.writeUint32(this.techAvailabilityChanges.length);\n\n    for (const change of this.techAvailabilityChanges) {\n      change.save(stream);\n    }\n\n    stream.writeUint32(this.randomUnitTables.length);\n\n    for (const table of this.randomUnitTables) {\n      table.save(stream);\n    }\n\n    if (this.version > 24) {\n      stream.writeUint32(this.randomItemTables.length);\n\n      for (const table of this.randomItemTables) {\n        table.save(stream);\n      }\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    let size = 111 + byteLengthUtf8(this.name) + byteLengthUtf8(this.author) + byteLengthUtf8(this.description) + byteLengthUtf8(this.recommendedPlayers) + byteLengthUtf8(this.loadingScreenText) + byteLengthUtf8(this.loadingScreenTitle) + byteLengthUtf8(this.loadingScreenSubtitle) + byteLengthUtf8(this.prologueScreenText) + byteLengthUtf8(this.prologueScreenTitle) + byteLengthUtf8(this.prologueScreenSubtitle);\n\n    for (const player of this.players) {\n      size += player.getByteLength(this.version);\n    }\n\n    for (const force of this.forces) {\n      size += force.getByteLength();\n    }\n\n    size += this.upgradeAvailabilityChanges.length * 16;\n\n    size += this.techAvailabilityChanges.length * 8;\n\n    for (const table of this.randomUnitTables) {\n      size += table.getByteLength();\n    }\n\n    if (this.version > 24) {\n      size += 36 + byteLengthUtf8(this.loadingScreenModel) + byteLengthUtf8(this.prologueScreenModel) + byteLengthUtf8(this.soundEnvironment);\n\n      for (const table of this.randomItemTables) {\n        size += table.getByteLength();\n      }\n    }\n\n    if (this.version > 27) {\n      size += 20;\n    }\n\n    if (this.version > 30) {\n      size += 8;\n    }\n\n    return size;\n  }\n\n  /**\n   * Returns the build version as major+minor.\n   * \n   * For example version 1.31.X will return 131.\n   * \n   * Note that this will always return 0 for any version below 1.31.\n   */\n  getBuildVersion(): number {\n    return this.buildVersion[0] * 100 + this.buildVersion[1];\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport MpqArchive from '../mpq/archive';\nimport War3MapImp from './imp/file';\nimport War3MapW3d from './w3d/file';\nimport War3MapW3u from './w3u/file';\nimport War3MapWct from './wct/file';\nimport War3MapWtg from './wtg/file';\nimport War3MapWts from './wts/file';\nimport { TriggerData } from './wtg/triggerdata';\nimport War3MapW3i from './w3i/file';\nimport MpqFile from '../mpq/file';\n\ntype War3MapModificationNames = 'w3a' | 'w3b' | 'w3d' | 'w3h' | 'w3q' | 'w3t' | 'w3u';\n\ninterface War3MapModifications {\n  w3a?: War3MapW3d;\n  w3b?: War3MapW3u;\n  w3d?: War3MapW3d;\n  w3h?: War3MapW3u;\n  w3q?: War3MapW3d;\n  w3t?: War3MapW3u;\n  w3u?: War3MapW3u;\n}\n\n/**\n * Warcraft 3 map (W3X and W3M).\n */\nexport default class War3Map {\n  u1 = 0;\n  name = '';\n  flags = 0;\n  maxPlayers = 0;\n\n  archive = new MpqArchive();\n  imports = new War3MapImp();\n  readonly = false;\n\n  /**\n   * Load an existing map.\n   * \n   * Note that this clears the map from whatever it had in it before.\n   */\n  load(buffer: ArrayBuffer | Uint8Array, readonly = false): void {\n    const stream = new BinaryStream(buffer);\n\n    // The header no longer exists since some 1.3X.X patch?\n    if (stream.readBinary(4) === 'HM3W') {\n      this.u1 = stream.readUint32();\n      this.name = stream.readNull();\n      this.flags = stream.readUint32();\n      this.maxPlayers = stream.readUint32();\n    }\n\n    this.readonly = readonly;\n\n    // Read the archive.\n    this.archive.load(buffer, readonly);\n\n    // Read in the imports file if there is one.\n    this.readImports();\n  }\n\n  /**\n   * Save this map.\n   * If the archive is in readonly mode, returns null.\n   */\n  save(): Uint8Array {\n    // Update the imports if needed.\n    this.setImportsFile();\n\n    const archiveBuffer = this.archive.save();\n\n    if (!archiveBuffer) {\n      throw Error('Failed to save the map MPQ archive');\n    }\n\n    const information = this.getMapInformation();\n\n    // If this is a pre-1.31 map, or we don't know what the version is, save also the map header.\n    if (!information || information.getBuildVersion() < 131) {\n      const bytes = new Uint8Array(512 + archiveBuffer.byteLength);\n      const stream = new BinaryStream(bytes);\n\n      // Write the header.\n      stream.writeBinary('HM3W');\n      stream.writeUint32(this.u1);\n      stream.writeNull(this.name);\n      stream.writeUint32(this.flags);\n      stream.writeUint32(this.maxPlayers);\n\n      bytes.set(archiveBuffer, 512);\n\n      return bytes;\n    } else {\n      return archiveBuffer;\n    }\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   */\n  getFileNames(): string[] {\n    return this.archive.getFileNames();\n  }\n\n  /**\n   * Gets a list of the file names imported in this map.\n   */\n  getImportNames(): string[] {\n    const names = [];\n\n    for (const entry of this.imports.entries.values()) {\n      const isCustom = entry.isCustom;\n\n      if (isCustom === 10 || isCustom === 13) {\n        names.push(entry.path);\n      } else {\n        names.push(`war3mapImported\\\\${entry.path}`);\n      }\n    }\n\n    return names;\n  }\n\n  /**\n   * Sets the imports file with all of the imports.\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  setImportsFile(): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    if (this.imports.entries.size > 0) {\n      return this.set('war3map.imp', this.imports.save());\n    }\n\n    return false;\n  }\n\n  /**\n   * Imports a file to this archive.\n   * \n   * If the file already exists, its buffer will be set.\n   * \n   * Files added to the archive but not to the imports list will be deleted by the World Editor automatically.\n   * This of course doesn't apply to internal map files.\n   * \n   * Does nothing if the archive is in readonly mode.\n   */\n  import(name: string, buffer: ArrayBuffer | string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    if (this.archive.set(name, buffer)) {\n      this.imports.set(name);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   */\n  set(name: string, buffer: ArrayBuffer | string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    return this.archive.set(name, buffer);\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   */\n  get(name: string): MpqFile | null {\n    return this.archive.get(name);\n  }\n\n  /**\n   * Get the map's script.\n   */\n  getScriptFile(): MpqFile | null {\n    return this.get('war3map.j') || this.get('scripts\\\\war3map.j') || this.get('war3map.lua') || this.get('scripts\\\\war3map.lua');\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   */\n  has(name: string): boolean {\n    return this.archive.has(name);\n  }\n\n  /**\n   * Deletes a file from the internal archive.\n   * \n   * Note that if the file is in the imports list, it will be removed from it too.\n   * \n   * Use this rather than the internal archive's delete.\n   */\n  delete(name: string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    // If this file is in the import list, remove it.\n    this.imports.delete(name);\n\n    return this.archive.delete(name);\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   */\n  rename(name: string, newName: string): boolean {\n    if (this.readonly) {\n      return false;\n    }\n\n    if (this.archive.rename(name, newName)) {\n      // If the file was actually renamed, and it is an import, rename also the import entry.\n      this.imports.rename(name, newName);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  getMapInformation(): War3MapW3i {\n    const file = this.archive.get('war3map.w3i');\n\n    if (!file) {\n      throw new Error('File does not exist');\n    }\n\n    const parser = new War3MapW3i();\n\n    parser.load(file.bytes());\n\n    return parser;\n  }\n\n  readImports(): void {\n    const file = this.archive.get('war3map.imp');\n\n    if (file) {\n      const buffer = file.arrayBuffer();\n\n      if (buffer) {\n        this.imports.load(buffer);\n      }\n    }\n  }\n\n  readTriggers(triggerData: TriggerData): War3MapWtg | undefined {\n    const file = this.archive.get('war3map.wtg');\n\n    if (file) {\n      const buffer = file.arrayBuffer();\n\n      if (buffer) {\n        const object = new War3MapWtg();\n\n        object.load(buffer, triggerData);\n\n        return object;\n      }\n    }\n\n    return;\n  }\n\n  /**\n   * Read and parse the custom text trigger file.\n   */\n  readCustomTextTriggers(): War3MapWct | undefined {\n    const file = this.archive.get('war3map.wct');\n\n    if (file) {\n      const buffer = file.arrayBuffer();\n\n      if (buffer) {\n        const object = new War3MapWct();\n\n        object.load(buffer);\n\n        return object;\n      }\n    }\n\n    return;\n  }\n\n  /**\n   * Read and parse the string table file.\n   */\n  readStringTable(): War3MapWts | undefined {\n    const file = this.archive.get('war3map.wts');\n\n    if (file) {\n      const buffer = file.text();\n\n      if (buffer) {\n        const object = new War3MapWts();\n\n        object.load(buffer);\n\n        return object;\n      }\n    }\n\n    return;\n  }\n\n  /**\n   * Read and parse all of the modification tables.\n   */\n  readModifications(): War3MapModifications {\n    const modifications: War3MapModifications = {};\n\n    // useOptionalInts:\n    //      w3u: no (units)\n    //      w3t: no (items)\n    //      w3b: no (destructables)\n    //      w3d: yes (doodads)\n    //      w3a: yes (abilities)\n    //      w3h: no (buffs)\n    //      w3q: yes (upgrades)\n    const fileNames: War3MapModificationNames[] = ['w3u', 'w3t', 'w3b', 'w3d', 'w3a', 'w3h', 'w3q'];\n    const useOptionalInts = [false, false, false, true, true, false, true];\n\n    for (let i = 0, l = fileNames.length; i < l; i++) {\n      const file = this.archive.get(`war3map.${fileNames[i]}`);\n\n      if (file) {\n        const buffer = file.arrayBuffer();\n\n        if (buffer) {\n          let modification;\n\n          if (useOptionalInts[i]) {\n            modification = new War3MapW3d();\n          } else {\n            modification = new War3MapW3u();\n          }\n\n          modification.load(buffer);\n\n          modifications[fileNames[i]] = modification;\n        }\n      }\n    }\n\n    return modifications;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A random item.\n */\nexport default class RandomItem {\n  id = '\\0\\0\\0\\0';\n  chance = 0;\n\n  load(stream: BinaryStream): void {\n    this.id = stream.readBinary(4);\n    this.chance = stream.readInt32();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.chance);\n  }\n}\n","import RandomItem from './randomitem';\nimport BinaryStream from '../../../common/binarystream';\n\n/**\n * A random item set.\n */\nexport default class RandomItemSet {\n  items: RandomItem[] = [];\n\n  load(stream: BinaryStream): void {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      const item = new RandomItem();\n\n      item.load(stream);\n\n      this.items.push(item);\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeUint32(this.items.length);\n\n    for (const item of this.items) {\n      item.save(stream);\n    }\n  }\n\n  getByteLength(): number {\n    return 4 + this.items.length * 8;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport RandomItemSet from './randomitemset';\n\n/**\n * A doodad.\n */\nexport default class Doodad {\n  id = '\\0\\0\\0\\0';\n  variation = 0;\n  location = new Float32Array(3);\n  angle = 0;\n  scale = new Float32Array([1, 1, 1]);\n  /**\n   * @since Game version 1.32\n   */\n  skin = '\\0\\0\\0\\0';\n  flags = 0;\n  life = 0;\n  itemTable = -1;\n  itemSets: RandomItemSet[] = [];\n  editorId = 0;\n  u1 = new Uint8Array(8);\n\n  load(stream: BinaryStream, version: number, buildVersion: number): void {\n    this.id = stream.readBinary(4);\n    this.variation = stream.readInt32();\n    stream.readFloat32Array(this.location);\n    this.angle = stream.readFloat32();\n    stream.readFloat32Array(this.scale);\n\n    if (buildVersion > 131) {\n      this.skin = stream.readBinary(4);\n    }\n\n    this.flags = stream.readUint8();\n    this.life = stream.readUint8();\n\n    if (version > 7) {\n      this.itemTable = stream.readUint32();\n\n      for (let i = 0, l = stream.readUint32(); i < l; i++) {\n        const itemSet = new RandomItemSet();\n\n        itemSet.load(stream);\n\n        this.itemSets.push(itemSet);\n      }\n    }\n\n    this.editorId = stream.readInt32();\n  }\n\n  save(stream: BinaryStream, version: number, buildVersion: number): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.variation);\n    stream.writeFloat32Array(this.location);\n    stream.writeFloat32(this.angle);\n    stream.writeFloat32Array(this.scale);\n\n    if (buildVersion > 131) {\n      stream.writeBinary(this.skin);\n    }\n\n    stream.writeUint8(this.flags);\n    stream.writeUint8(this.life);\n\n    if (version > 7) {\n      stream.writeUint32(this.itemTable);\n      stream.writeUint32(this.itemSets.length);\n\n      for (const itemSet of this.itemSets) {\n        itemSet.save(stream);\n      }\n    }\n\n    stream.writeInt32(this.editorId);\n  }\n\n  getByteLength(version: number, buildVersion: number): number {\n    let size = 42;\n\n    if (buildVersion > 131) {\n      size += 4;\n    }\n\n    if (version > 7) {\n      size += 8;\n\n      for (const itemSet of this.itemSets) {\n        size += itemSet.getByteLength();\n      }\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A terrain doodad.\n *\n * This type of doodad works much like cliffs.\n * It uses the height of the terrain, and gets affected by the ground heightmap.\n * It cannot be manipulated in any way in the World Editor once placed.\n * Indeed, the only way to change it is to remove it by changing cliffs around it.\n */\nexport default class TerrainDoodad {\n  id = '\\0\\0\\0\\0';\n  u1 = 0;\n  location = new Uint32Array(2);\n\n  load(stream: BinaryStream, _version: number): void {\n    this.id = stream.readBinary(4);\n    this.u1 = stream.readUint32();\n    stream.readUint32Array(this.location);\n  }\n\n  save(stream: BinaryStream, _version: number): void {\n    stream.writeBinary(this.id);\n    stream.writeUint32(this.u1);\n    stream.writeUint32Array(this.location);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Doodad from './doodad';\nimport TerrainDoodad from './terraindoodad';\n\n/**\n * war3map.doo - the doodad and destructible file.\n */\nexport default class War3MapDoo {\n  version = 0;\n  u1 = new Uint8Array(4);\n  doodads: Doodad[] = [];\n  u2 = new Uint8Array(4);\n  terrainDoodads: TerrainDoodad[] = [];\n\n  load(buffer: ArrayBuffer | Uint8Array, buildVersion: number): void {\n    const stream = new BinaryStream(buffer);\n\n    if (stream.readBinary(4) !== 'W3do') {\n      throw new Error('Not a valid war3map.doo buffer');\n    }\n\n    this.version = stream.readInt32();\n    stream.readUint8Array(this.u1);\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const doodad = new Doodad();\n\n      doodad.load(stream, this.version, buildVersion);\n\n      this.doodads.push(doodad);\n    }\n\n    stream.readUint8Array(this.u2);\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const terrainDoodad = new TerrainDoodad();\n\n      terrainDoodad.load(stream, this.version);\n\n      this.terrainDoodads.push(terrainDoodad);\n    }\n  }\n\n  save(buildVersion: number): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength(buildVersion)));\n\n    stream.writeBinary('W3do');\n    stream.writeInt32(this.version);\n    stream.writeUint8Array(this.u1);\n    stream.writeUint32(this.doodads.length);\n\n    for (const doodad of this.doodads) {\n      doodad.save(stream, this.version, buildVersion);\n    }\n\n    stream.writeUint8Array(this.u2);\n    stream.writeUint32(this.terrainDoodads.length);\n\n    for (const terrainDoodad of this.terrainDoodads) {\n      terrainDoodad.save(stream, this.version);\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(buildVersion: number): number {\n    let size = 24 + this.terrainDoodads.length * 16;\n\n    for (const doodad of this.doodads) {\n      size += doodad.getByteLength(this.version, buildVersion);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A tile corner.\n */\nexport default class Corner {\n  groundHeight = 0;\n  waterHeight = 0;\n  mapEdge = 0;\n  ramp = 0;\n  blight = 0;\n  water = 0;\n  boundary = 0;\n  groundTexture = 0;\n  cliffVariation = 0;\n  groundVariation = 0;\n  cliffTexture = 0;\n  layerHeight = 0;\n\n  load(stream: BinaryStream): void {\n    this.groundHeight = (stream.readInt16() - 8192) / 512;\n\n    const waterAndEdge = stream.readInt16();\n\n    this.waterHeight = ((waterAndEdge & 0x3FFF) - 8192) / 512;\n    this.mapEdge = waterAndEdge & 0x4000;\n\n    const textureAndFlags = stream.readUint8();\n\n    this.ramp = textureAndFlags & 0b00010000;\n    this.blight = textureAndFlags & 0b00100000;\n    this.water = textureAndFlags & 0b01000000;\n    this.boundary = textureAndFlags & 0b10000000;\n\n    this.groundTexture = textureAndFlags & 0b00001111;\n\n    const variation = stream.readUint8();\n\n    this.cliffVariation = (variation & 0b11100000) >>> 5;\n    this.groundVariation = variation & 0b00011111;\n\n    const cliffTextureAndLayer = stream.readUint8();\n\n    this.cliffTexture = (cliffTextureAndLayer & 0b11110000) >>> 4;\n    this.layerHeight = cliffTextureAndLayer & 0b00001111;\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt16(this.groundHeight * 512 + 8192);\n    stream.writeInt16(this.waterHeight * 512 + 8192 + this.mapEdge << 14);\n    stream.writeUint8((this.ramp << 4) | (this.blight << 5) | (this.water << 6) | (this.boundary << 7) | this.groundTexture);\n    stream.writeUint8((this.cliffVariation << 5) | this.groundVariation);\n    stream.writeUint8((this.cliffTexture << 4) + this.layerHeight);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Corner from './corner';\n\n/**\n * war3map.w3e - the environment file.\n */\nexport default class War3MapW3e {\n  version = 0;\n  tileset = 'A';\n  haveCustomTileset = 0;\n  groundTilesets: string[] = [];\n  cliffTilesets: string[] = [];\n  mapSize = new Int32Array(2);\n  centerOffset = new Float32Array(2);\n  corners: Corner[][] = [];\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const stream = new BinaryStream(buffer);\n\n    if (stream.readBinary(4) !== 'W3E!') {\n      return;\n    }\n\n    this.version = stream.readInt32();\n    this.tileset = stream.readBinary(1);\n    this.haveCustomTileset = stream.readInt32();\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      this.groundTilesets[i] = stream.readBinary(4);\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      this.cliffTilesets[i] = stream.readBinary(4);\n    }\n\n    stream.readInt32Array(this.mapSize);\n    stream.readFloat32Array(this.centerOffset);\n\n    for (let row = 0, rows = this.mapSize[1]; row < rows; row++) {\n      this.corners[row] = [];\n\n      for (let column = 0, columns = this.mapSize[0]; column < columns; column++) {\n        const corner = new Corner();\n\n        corner.load(stream);\n\n        this.corners[row][column] = corner;\n      }\n    }\n  }\n\n\n  save(): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength()));\n\n    stream.writeBinary('W3E!');\n    stream.writeInt32(this.version);\n    stream.writeBinary(this.tileset);\n    stream.writeInt32(this.haveCustomTileset);\n    stream.writeUint32(this.groundTilesets.length);\n\n    for (const groundTileset of this.groundTilesets) {\n      stream.writeBinary(groundTileset);\n    }\n\n    stream.writeUint32(this.cliffTilesets.length);\n\n    for (const cliffTileset of this.cliffTilesets) {\n      stream.writeBinary(cliffTileset);\n    }\n\n    stream.writeInt32Array(this.mapSize);\n    stream.writeFloat32Array(this.centerOffset);\n\n    for (const row of this.corners) {\n      for (const corner of row) {\n        corner.save(stream);\n      }\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(): number {\n    return 37 + (this.groundTilesets.length * 4) + (this.cliffTilesets.length * 4) + (this.mapSize[0] * this.mapSize[1] * 7);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A dropped item.\n */\nexport default class DroppedItem {\n  id = '\\0\\0\\0\\0';\n  chance = 0;\n\n  load(stream: BinaryStream): void {\n    this.id = stream.readBinary(4);\n    this.chance = stream.readInt32();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.chance);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport DroppedItem from './droppeditem';\n\n/**\n * A dropped item set.\n */\nexport default class DroppedItemSet {\n  items: DroppedItem[] = [];\n\n  load(stream: BinaryStream): void {\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const item = new DroppedItem();\n\n      item.load(stream);\n\n      this.items[i] = item;\n    }\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt32(this.items.length);\n\n    for (const item of this.items) {\n      item.save(stream);\n    }\n  }\n\n  getByteLength(): number {\n    return 4 + this.items.length * 8;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * An inventory item.\n */\nexport default class InventoryItem {\n  slot = 0;\n  id = '\\0\\0\\0\\0';\n\n  load(stream: BinaryStream): void {\n    this.slot = stream.readInt32();\n    this.id = stream.readBinary(4);\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeInt32(this.slot);\n    stream.writeBinary(this.id);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A modified ability.\n */\nexport default class ModifiedAbility {\n  id = '\\0\\0\\0\\0';\n  activeForAutocast = 0;\n  heroLevel = 1;\n\n  load(stream: BinaryStream): void {\n    this.id = stream.readBinary(4);\n    this.activeForAutocast = stream.readInt32();\n    this.heroLevel = stream.readInt32();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.activeForAutocast);\n    stream.writeInt32(this.heroLevel);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * A random unit.\n */\nexport default class RandomUnit {\n  id = '\\0\\0\\0\\0';\n  chance = 0;\n\n  load(stream: BinaryStream): void {\n    this.id = stream.readBinary(4);\n    this.chance = stream.readInt32();\n  }\n\n  save(stream: BinaryStream): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.chance);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport DroppedItemSet from './droppeditemset';\nimport InventoryItem from './inventoryitem';\nimport ModifiedAbility from './modifiedability';\nimport RandomUnit from './randomunit';\n\n/**\n * A unit.\n */\nexport default class Unit {\n  id = '\\0\\0\\0\\0';\n  variation = 0;\n  location = new Float32Array(3);\n  angle = 0;\n  scale = new Float32Array([1, 1, 1]);\n  /**\n   * @since Game version 1.32\n   */\n  skin = '\\0\\0\\0\\0';\n  flags = 0;\n  player = 0;\n  unknown = 0;\n  hitpoints = -1;\n  mana = -1;\n  /**\n   * @since 8\n   */\n  droppedItemTable = 0;\n  droppedItemSets: DroppedItemSet[] = [];\n  goldAmount = 0;\n  targetAcquisition = 0;\n  heroLevel = 0;\n  /**\n   * @since 8\n   */\n  heroStrength = 0;\n  /**\n   * @since 8\n   */\n  heroAgility = 0;\n  /**\n   * @since 8\n   */\n  heroIntelligence = 0;\n  itemsInInventory: InventoryItem[] = [];\n  modifiedAbilities: ModifiedAbility[] = [];\n  randomFlag = 0;\n  level = new Uint8Array(3);\n  itemClass = 0;\n  unitGroup = 0;\n  positionInGroup = 0;\n  randomUnitTables: RandomUnit[] = [];\n  customTeamColor = 0;\n  waygate = 0;\n  creationNumber = 0;\n\n  load(stream: BinaryStream, version: number, subversion: number, buildVersion: number): void {\n    this.id = stream.readBinary(4);\n    this.variation = stream.readInt32();\n    stream.readFloat32Array(this.location);\n    this.angle = stream.readFloat32();\n    stream.readFloat32Array(this.scale);\n\n    if (buildVersion > 131) {\n      this.skin = stream.readBinary(4);\n    }\n\n    this.flags = stream.readUint8();\n    this.player = stream.readInt32();\n    this.unknown = stream.readUint16();\n    this.hitpoints = stream.readInt32();\n    this.mana = stream.readInt32();\n\n    if (subversion > 10) {\n      this.droppedItemTable = stream.readInt32();\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const set = new DroppedItemSet();\n\n      set.load(stream);\n\n      this.droppedItemSets[i] = set;\n    }\n\n    this.goldAmount = stream.readInt32();\n    this.targetAcquisition = stream.readFloat32();\n    this.heroLevel = stream.readInt32();\n\n    if (subversion > 10) {\n      this.heroStrength = stream.readInt32();\n      this.heroAgility = stream.readInt32();\n      this.heroIntelligence = stream.readInt32();\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const item = new InventoryItem();\n\n      item.load(stream);\n\n      this.itemsInInventory[i] = item;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const modifiedAbility = new ModifiedAbility();\n\n      modifiedAbility.load(stream);\n\n      this.modifiedAbilities[i] = modifiedAbility;\n    }\n\n    this.randomFlag = stream.readInt32();\n\n    if (this.randomFlag === 0) {\n      stream.readUint8Array(this.level); // 24bit number\n      this.itemClass = stream.readUint8();\n    } else if (this.randomFlag === 1) {\n      this.unitGroup = stream.readUint32();\n      this.positionInGroup = stream.readUint32();\n    } else if (this.randomFlag === 2) {\n      for (let i = 0, l = stream.readInt32(); i < l; i++) {\n        const randomUnit = new RandomUnit();\n\n        randomUnit.load(stream);\n\n        this.randomUnitTables[i] = randomUnit;\n      }\n    }\n\n    this.customTeamColor = stream.readInt32();\n    this.waygate = stream.readInt32();\n    this.creationNumber = stream.readInt32();\n  }\n\n  save(stream: BinaryStream, version: number, subversion: number, buildVersion: number): void {\n    stream.writeBinary(this.id);\n    stream.writeInt32(this.variation);\n    stream.writeFloat32Array(this.location);\n    stream.writeFloat32(this.angle);\n    stream.writeFloat32Array(this.scale);\n\n    if (buildVersion > 131) {\n      stream.writeBinary(this.skin);\n    }\n\n    stream.writeUint8(this.flags);\n    stream.writeInt32(this.player);\n    stream.writeUint16(this.unknown);\n    stream.writeInt32(this.hitpoints);\n    stream.writeInt32(this.mana);\n\n    if (subversion > 10) {\n      stream.writeInt32(this.droppedItemTable);\n    }\n\n    stream.writeInt32(this.droppedItemSets.length);\n\n    for (const droppedItemSet of this.droppedItemSets) {\n      droppedItemSet.save(stream);\n    }\n\n    stream.writeInt32(this.goldAmount);\n    stream.writeFloat32(this.targetAcquisition);\n    stream.writeInt32(this.heroLevel);\n\n    if (subversion > 10) {\n      stream.writeInt32(this.heroStrength);\n      stream.writeInt32(this.heroAgility);\n      stream.writeInt32(this.heroIntelligence);\n    }\n\n    stream.writeInt32(this.itemsInInventory.length);\n\n    for (const itemInInventory of this.itemsInInventory) {\n      itemInInventory.save(stream);\n    }\n\n    stream.writeInt32(this.modifiedAbilities.length);\n\n    for (const modifiedAbility of this.modifiedAbilities) {\n      modifiedAbility.save(stream);\n    }\n\n    stream.writeInt32(this.randomFlag);\n\n    if (this.randomFlag === 0) {\n      stream.writeUint8Array(this.level);\n      stream.writeUint8(this.itemClass);\n    } else if (this.randomFlag === 1) {\n      stream.writeUint32(this.unitGroup);\n      stream.writeUint32(this.positionInGroup);\n    } else if (this.randomFlag === 2) {\n      stream.writeInt32(this.randomUnitTables.length);\n\n      for (const randomUnitTable of this.randomUnitTables) {\n        randomUnitTable.save(stream);\n      }\n    }\n\n    stream.writeInt32(this.customTeamColor);\n    stream.writeInt32(this.waygate);\n    stream.writeInt32(this.creationNumber);\n  }\n\n  getByteLength(version: number, subversion: number, buildVersion: number): number {\n    let size = 91;\n\n    if (buildVersion > 131) {\n      size += 4;\n    }\n\n    if (subversion > 10) {\n      size += 16;\n    }\n\n    for (const droppedItemSet of this.droppedItemSets) {\n      size += droppedItemSet.getByteLength();\n    }\n\n    size += this.itemsInInventory.length * 8;\n\n    size += this.modifiedAbilities.length * 12;\n\n    if (this.randomFlag === 0) {\n      size += 4;\n    } else if (this.randomFlag === 1) {\n      size += 8;\n    } else if (this.randomFlag === 2) {\n      size += 4 + this.randomUnitTables.length * 8;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Unit from './unit';\n\n/**\n * war3mapUnits.doo - the units and items file.\n */\nexport default class War3MapUnitsDoo {\n  version = 8;\n  subversion = 11;\n  units: Unit[] = [];\n\n  load(buffer: ArrayBuffer | Uint8Array, buildVersion: number): void {\n    const stream = new BinaryStream(buffer);\n\n    if (stream.readBinary(4) !== 'W3do') {\n      throw new Error('Not a valid war3mapUnits.doo buffer');\n    }\n\n    this.version = stream.readInt32();\n    this.subversion = stream.readUint32();\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      const unit = new Unit();\n\n      unit.load(stream, this.version, this.subversion, buildVersion);\n\n      this.units[i] = unit;\n    }\n  }\n\n  save(buildVersion: number): Uint8Array {\n    const stream = new BinaryStream(new ArrayBuffer(this.getByteLength(buildVersion)));\n\n    stream.writeBinary('W3do');\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.subversion);\n    stream.writeInt32(this.units.length);\n\n    for (const unit of this.units) {\n      unit.save(stream, this.version, this.subversion, buildVersion);\n    }\n\n    return stream.uint8array;\n  }\n\n  getByteLength(buildVersion: number): number {\n    let size = 16;\n\n    for (const unit of this.units) {\n      size += unit.getByteLength(this.version, this.subversion, buildVersion);\n    }\n\n    return size;\n  }\n}\n","/**\n * Returns a number, which when multiplied with a number of fromBits bits, will convert it to a toBits bits number.\n * \n * For example, 7 * convertBitRange(3, 8) == 255.\n * \n * In other words, if we look at the bits, 111 is the same to 3 bits as 11111111 is to 8 bits.\n */\nexport default function convertBitRange(fromBits: number, toBits: number): number {\n  return ((1 << toBits) - 1) / ((1 << fromBits) - 1);\n}\n","/* eslint-disable */\n\n/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// NOTICE: This file was edited to support loading JPEG data stored in BLP files, which use a non-standard RGBA pixel format.\n// NOTICE2: It has been edited more to support modern building.\n\nconst _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n};\n\n\nconst JpegError = function JpegErrorClosure() {\n  function JpegError(msg) {\n    this.message = 'JPEG error: ' + msg;\n  }\n  JpegError.prototype = new Error();\n  JpegError.prototype.name = 'JpegError';\n  JpegError.constructor = JpegError;\n  return JpegError;\n}();\n\nconst dctZigZag = new Uint8Array([0, 1, 8, 16, 9, 2, 3, 10, 17, 24, 32, 25, 18, 11, 4, 5, 12, 19, 26, 33, 40, 48, 41, 34, 27, 20, 13, 6, 7, 14, 21, 28, 35, 42, 49, 56, 57, 50, 43, 36, 29, 22, 15, 23, 30, 37, 44, 51, 58, 59, 52, 45, 38, 31, 39, 46, 53, 60, 61, 54, 47, 55, 62, 63]);\nconst dctCos1 = 4017;\nconst dctSin1 = 799;\nconst dctCos3 = 3406;\nconst dctSin3 = 2276;\nconst dctCos6 = 1567;\nconst dctSin6 = 3784;\nconst dctSqrt2 = 5793;\nconst dctSqrt1d2 = 2896;\n\nfunction buildHuffmanTable(codeLengths, values) {\n  let k = 0,\n    code = [],\n    i,\n    j,\n    length = 16;\n  while (length > 0 && !codeLengths[length - 1]) {\n    length--;\n  }\n  code.push({\n    children: [],\n    index: 0,\n  });\n  let p = code[0],\n    q;\n  for (i = 0; i < length; i++) {\n    for (j = 0; j < codeLengths[i]; j++) {\n      p = code.pop();\n      p.children[p.index] = values[k];\n      while (p.index > 0) {\n        p = code.pop();\n      }\n      p.index++;\n      code.push(p);\n      while (code.length <= i) {\n        code.push(q = {\n          children: [],\n          index: 0,\n        });\n        p.children[p.index] = q.children;\n        p = q;\n      }\n      k++;\n    }\n    if (i + 1 < length) {\n      code.push(q = {\n        children: [],\n        index: 0,\n      });\n      p.children[p.index] = q.children;\n      p = q;\n    }\n  }\n  return code[0].children;\n}\nfunction getBlockBufferOffset(component, row, col) {\n  return 64 * ((component.blocksPerLine + 1) * row + col);\n}\nfunction decodeScan(data, offset, frame, components, resetInterval, spectralStart, spectralEnd, successivePrev, successive) {\n  const mcusPerLine = frame.mcusPerLine;\n  const progressive = frame.progressive;\n  let startOffset = offset,\n    bitsData = 0,\n    bitsCount = 0;\n  function readBit() {\n    if (bitsCount > 0) {\n      bitsCount--;\n      return bitsData >> bitsCount & 1;\n    }\n    bitsData = data[offset++];\n    if (bitsData === 0xFF) {\n      const nextByte = data[offset++];\n      if (nextByte) {\n        throw new JpegError('unexpected marker ' + (bitsData << 8 | nextByte).toString(16));\n      }\n    }\n    bitsCount = 7;\n    return bitsData >>> 7;\n  }\n  function decodeHuffman(tree) {\n    let node = tree;\n    while (true) {\n      node = node[readBit()];\n      if (typeof node === 'number') {\n        return node;\n      }\n      if ((typeof node === 'undefined' ? 'undefined' : _typeof(node)) !== 'object') {\n        throw new JpegError('invalid huffman sequence');\n      }\n    }\n  }\n  function receive(length) {\n    let n = 0;\n    while (length > 0) {\n      n = n << 1 | readBit();\n      length--;\n    }\n    return n;\n  }\n  function receiveAndExtend(length) {\n    if (length === 1) {\n      return readBit() === 1 ? 1 : -1;\n    }\n    const n = receive(length);\n    if (n >= 1 << length - 1) {\n      return n;\n    }\n    return n + (-1 << length) + 1;\n  }\n  function decodeBaseline(component, offset) {\n    const t = decodeHuffman(component.huffmanTableDC);\n    const diff = t === 0 ? 0 : receiveAndExtend(t);\n    component.blockData[offset] = component.pred += diff;\n    let k = 1;\n    while (k < 64) {\n      const rs = decodeHuffman(component.huffmanTableAC);\n      const s = rs & 15,\n        r = rs >> 4;\n      if (s === 0) {\n        if (r < 15) {\n          break;\n        }\n        k += 16;\n        continue;\n      }\n      k += r;\n      const z = dctZigZag[k];\n      component.blockData[offset + z] = receiveAndExtend(s);\n      k++;\n    }\n  }\n  function decodeDCFirst(component, offset) {\n    const t = decodeHuffman(component.huffmanTableDC);\n    const diff = t === 0 ? 0 : receiveAndExtend(t) << successive;\n    component.blockData[offset] = component.pred += diff;\n  }\n  function decodeDCSuccessive(component, offset) {\n    component.blockData[offset] |= readBit() << successive;\n  }\n  let eobrun = 0;\n  function decodeACFirst(component, offset) {\n    if (eobrun > 0) {\n      eobrun--;\n      return;\n    }\n    let k = spectralStart,\n      e = spectralEnd;\n    while (k <= e) {\n      const rs = decodeHuffman(component.huffmanTableAC);\n      const s = rs & 15,\n        r = rs >> 4;\n      if (s === 0) {\n        if (r < 15) {\n          eobrun = receive(r) + (1 << r) - 1;\n          break;\n        }\n        k += 16;\n        continue;\n      }\n      k += r;\n      const z = dctZigZag[k];\n      component.blockData[offset + z] = receiveAndExtend(s) * (1 << successive);\n      k++;\n    }\n  }\n  let successiveACState = 0,\n    successiveACNextValue;\n  function decodeACSuccessive(component, offset) {\n    let k = spectralStart;\n    const e = spectralEnd;\n    let r = 0;\n    let s;\n    let rs;\n    while (k <= e) {\n      const z = dctZigZag[k];\n      switch (successiveACState) {\n        case 0:\n          rs = decodeHuffman(component.huffmanTableAC);\n          s = rs & 15;\n          r = rs >> 4;\n          if (s === 0) {\n            if (r < 15) {\n              eobrun = receive(r) + (1 << r);\n              successiveACState = 4;\n            } else {\n              r = 16;\n              successiveACState = 1;\n            }\n          } else {\n            if (s !== 1) {\n              throw new JpegError('invalid ACn encoding');\n            }\n            successiveACNextValue = receiveAndExtend(s);\n            successiveACState = r ? 2 : 3;\n          }\n          continue;\n        case 1:\n        case 2:\n          if (component.blockData[offset + z]) {\n            component.blockData[offset + z] += readBit() << successive;\n          } else {\n            r--;\n            if (r === 0) {\n              successiveACState = successiveACState === 2 ? 3 : 0;\n            }\n          }\n          break;\n        case 3:\n          if (component.blockData[offset + z]) {\n            component.blockData[offset + z] += readBit() << successive;\n          } else {\n            component.blockData[offset + z] = successiveACNextValue << successive;\n            successiveACState = 0;\n          }\n          break;\n        case 4:\n          if (component.blockData[offset + z]) {\n            component.blockData[offset + z] += readBit() << successive;\n          }\n          break;\n      }\n      k++;\n    }\n    if (successiveACState === 4) {\n      eobrun--;\n      if (eobrun === 0) {\n        successiveACState = 0;\n      }\n    }\n  }\n  function decodeMcu(component, decode, mcu, row, col) {\n    const mcuRow = mcu / mcusPerLine | 0;\n    const mcuCol = mcu % mcusPerLine;\n    const blockRow = mcuRow * component.v + row;\n    const blockCol = mcuCol * component.h + col;\n    const offset = getBlockBufferOffset(component, blockRow, blockCol);\n    decode(component, offset);\n  }\n  function decodeBlock(component, decode, mcu) {\n    const blockRow = mcu / component.blocksPerLine | 0;\n    const blockCol = mcu % component.blocksPerLine;\n    const offset = getBlockBufferOffset(component, blockRow, blockCol);\n    decode(component, offset);\n  }\n  const componentsLength = components.length;\n  let component, i, j, k, n;\n  let decodeFn;\n  if (progressive) {\n    if (spectralStart === 0) {\n      decodeFn = successivePrev === 0 ? decodeDCFirst : decodeDCSuccessive;\n    } else {\n      decodeFn = successivePrev === 0 ? decodeACFirst : decodeACSuccessive;\n    }\n  } else {\n    decodeFn = decodeBaseline;\n  }\n  let mcu = 0,\n    fileMarker;\n  let mcuExpected;\n  if (componentsLength === 1) {\n    mcuExpected = components[0].blocksPerLine * components[0].blocksPerColumn;\n  } else {\n    mcuExpected = mcusPerLine * frame.mcusPerColumn;\n  }\n  let h, v;\n  while (mcu < mcuExpected) {\n    const mcuToRead = resetInterval ? Math.min(mcuExpected - mcu, resetInterval) : mcuExpected;\n    for (i = 0; i < componentsLength; i++) {\n      components[i].pred = 0;\n    }\n    eobrun = 0;\n    if (componentsLength === 1) {\n      component = components[0];\n      for (n = 0; n < mcuToRead; n++) {\n        decodeBlock(component, decodeFn, mcu);\n        mcu++;\n      }\n    } else {\n      for (n = 0; n < mcuToRead; n++) {\n        for (i = 0; i < componentsLength; i++) {\n          component = components[i];\n          h = component.h;\n          v = component.v;\n          for (j = 0; j < v; j++) {\n            for (k = 0; k < h; k++) {\n              decodeMcu(component, decodeFn, mcu, j, k);\n            }\n          }\n        }\n        mcu++;\n      }\n    }\n    bitsCount = 0;\n    fileMarker = findNextFileMarker(data, offset);\n    if (fileMarker && fileMarker.invalid) {\n      // (0, _util.warn)('decodeScan - unexpected MCU data, next marker is: ' + fileMarker.invalid);\n      offset = fileMarker.offset;\n    }\n    const marker = fileMarker && fileMarker.marker;\n    if (!marker || marker <= 0xFF00) {\n      throw new JpegError('marker was not found');\n    }\n    if (marker >= 0xFFD0 && marker <= 0xFFD7) {\n      offset += 2;\n    } else {\n      break;\n    }\n  }\n  fileMarker = findNextFileMarker(data, offset);\n  if (fileMarker && fileMarker.invalid) {\n    // (0, _util.warn)('decodeScan - unexpected Scan data, next marker is: ' + fileMarker.invalid);\n    offset = fileMarker.offset;\n  }\n  return offset - startOffset;\n}\nfunction quantizeAndInverse(component, blockBufferOffset, p) {\n  const qt = component.quantizationTable,\n    blockData = component.blockData;\n  let v0, v1, v2, v3, v4, v5, v6, v7;\n  let p0, p1, p2, p3, p4, p5, p6, p7;\n  let t;\n  if (!qt) {\n    throw new JpegError('missing required Quantization Table.');\n  }\n  for (let row = 0; row < 64; row += 8) {\n    p0 = blockData[blockBufferOffset + row];\n    p1 = blockData[blockBufferOffset + row + 1];\n    p2 = blockData[blockBufferOffset + row + 2];\n    p3 = blockData[blockBufferOffset + row + 3];\n    p4 = blockData[blockBufferOffset + row + 4];\n    p5 = blockData[blockBufferOffset + row + 5];\n    p6 = blockData[blockBufferOffset + row + 6];\n    p7 = blockData[blockBufferOffset + row + 7];\n    p0 *= qt[row];\n    if ((p1 | p2 | p3 | p4 | p5 | p6 | p7) === 0) {\n      t = dctSqrt2 * p0 + 512 >> 10;\n      p[row] = t;\n      p[row + 1] = t;\n      p[row + 2] = t;\n      p[row + 3] = t;\n      p[row + 4] = t;\n      p[row + 5] = t;\n      p[row + 6] = t;\n      p[row + 7] = t;\n      continue;\n    }\n    p1 *= qt[row + 1];\n    p2 *= qt[row + 2];\n    p3 *= qt[row + 3];\n    p4 *= qt[row + 4];\n    p5 *= qt[row + 5];\n    p6 *= qt[row + 6];\n    p7 *= qt[row + 7];\n    v0 = dctSqrt2 * p0 + 128 >> 8;\n    v1 = dctSqrt2 * p4 + 128 >> 8;\n    v2 = p2;\n    v3 = p6;\n    v4 = dctSqrt1d2 * (p1 - p7) + 128 >> 8;\n    v7 = dctSqrt1d2 * (p1 + p7) + 128 >> 8;\n    v5 = p3 << 4;\n    v6 = p5 << 4;\n    v0 = v0 + v1 + 1 >> 1;\n    v1 = v0 - v1;\n    t = v2 * dctSin6 + v3 * dctCos6 + 128 >> 8;\n    v2 = v2 * dctCos6 - v3 * dctSin6 + 128 >> 8;\n    v3 = t;\n    v4 = v4 + v6 + 1 >> 1;\n    v6 = v4 - v6;\n    v7 = v7 + v5 + 1 >> 1;\n    v5 = v7 - v5;\n    v0 = v0 + v3 + 1 >> 1;\n    v3 = v0 - v3;\n    v1 = v1 + v2 + 1 >> 1;\n    v2 = v1 - v2;\n    t = v4 * dctSin3 + v7 * dctCos3 + 2048 >> 12;\n    v4 = v4 * dctCos3 - v7 * dctSin3 + 2048 >> 12;\n    v7 = t;\n    t = v5 * dctSin1 + v6 * dctCos1 + 2048 >> 12;\n    v5 = v5 * dctCos1 - v6 * dctSin1 + 2048 >> 12;\n    v6 = t;\n    p[row] = v0 + v7;\n    p[row + 7] = v0 - v7;\n    p[row + 1] = v1 + v6;\n    p[row + 6] = v1 - v6;\n    p[row + 2] = v2 + v5;\n    p[row + 5] = v2 - v5;\n    p[row + 3] = v3 + v4;\n    p[row + 4] = v3 - v4;\n  }\n  for (let col = 0; col < 8; ++col) {\n    p0 = p[col];\n    p1 = p[col + 8];\n    p2 = p[col + 16];\n    p3 = p[col + 24];\n    p4 = p[col + 32];\n    p5 = p[col + 40];\n    p6 = p[col + 48];\n    p7 = p[col + 56];\n    if ((p1 | p2 | p3 | p4 | p5 | p6 | p7) === 0) {\n      t = dctSqrt2 * p0 + 8192 >> 14;\n      t = t < -2040 ? 0 : t >= 2024 ? 255 : t + 2056 >> 4;\n      blockData[blockBufferOffset + col] = t;\n      blockData[blockBufferOffset + col + 8] = t;\n      blockData[blockBufferOffset + col + 16] = t;\n      blockData[blockBufferOffset + col + 24] = t;\n      blockData[blockBufferOffset + col + 32] = t;\n      blockData[blockBufferOffset + col + 40] = t;\n      blockData[blockBufferOffset + col + 48] = t;\n      blockData[blockBufferOffset + col + 56] = t;\n      continue;\n    }\n    v0 = dctSqrt2 * p0 + 2048 >> 12;\n    v1 = dctSqrt2 * p4 + 2048 >> 12;\n    v2 = p2;\n    v3 = p6;\n    v4 = dctSqrt1d2 * (p1 - p7) + 2048 >> 12;\n    v7 = dctSqrt1d2 * (p1 + p7) + 2048 >> 12;\n    v5 = p3;\n    v6 = p5;\n    v0 = (v0 + v1 + 1 >> 1) + 4112;\n    v1 = v0 - v1;\n    t = v2 * dctSin6 + v3 * dctCos6 + 2048 >> 12;\n    v2 = v2 * dctCos6 - v3 * dctSin6 + 2048 >> 12;\n    v3 = t;\n    v4 = v4 + v6 + 1 >> 1;\n    v6 = v4 - v6;\n    v7 = v7 + v5 + 1 >> 1;\n    v5 = v7 - v5;\n    v0 = v0 + v3 + 1 >> 1;\n    v3 = v0 - v3;\n    v1 = v1 + v2 + 1 >> 1;\n    v2 = v1 - v2;\n    t = v4 * dctSin3 + v7 * dctCos3 + 2048 >> 12;\n    v4 = v4 * dctCos3 - v7 * dctSin3 + 2048 >> 12;\n    v7 = t;\n    t = v5 * dctSin1 + v6 * dctCos1 + 2048 >> 12;\n    v5 = v5 * dctCos1 - v6 * dctSin1 + 2048 >> 12;\n    v6 = t;\n    p0 = v0 + v7;\n    p7 = v0 - v7;\n    p1 = v1 + v6;\n    p6 = v1 - v6;\n    p2 = v2 + v5;\n    p5 = v2 - v5;\n    p3 = v3 + v4;\n    p4 = v3 - v4;\n    p0 = p0 < 16 ? 0 : p0 >= 4080 ? 255 : p0 >> 4;\n    p1 = p1 < 16 ? 0 : p1 >= 4080 ? 255 : p1 >> 4;\n    p2 = p2 < 16 ? 0 : p2 >= 4080 ? 255 : p2 >> 4;\n    p3 = p3 < 16 ? 0 : p3 >= 4080 ? 255 : p3 >> 4;\n    p4 = p4 < 16 ? 0 : p4 >= 4080 ? 255 : p4 >> 4;\n    p5 = p5 < 16 ? 0 : p5 >= 4080 ? 255 : p5 >> 4;\n    p6 = p6 < 16 ? 0 : p6 >= 4080 ? 255 : p6 >> 4;\n    p7 = p7 < 16 ? 0 : p7 >= 4080 ? 255 : p7 >> 4;\n    blockData[blockBufferOffset + col] = p0;\n    blockData[blockBufferOffset + col + 8] = p1;\n    blockData[blockBufferOffset + col + 16] = p2;\n    blockData[blockBufferOffset + col + 24] = p3;\n    blockData[blockBufferOffset + col + 32] = p4;\n    blockData[blockBufferOffset + col + 40] = p5;\n    blockData[blockBufferOffset + col + 48] = p6;\n    blockData[blockBufferOffset + col + 56] = p7;\n  }\n}\nfunction buildComponentData(frame, component) {\n  const blocksPerLine = component.blocksPerLine;\n  const blocksPerColumn = component.blocksPerColumn;\n  const computationBuffer = new Int16Array(64);\n  for (let blockRow = 0; blockRow < blocksPerColumn; blockRow++) {\n    for (let blockCol = 0; blockCol < blocksPerLine; blockCol++) {\n      const offset = getBlockBufferOffset(component, blockRow, blockCol);\n      quantizeAndInverse(component, offset, computationBuffer);\n    }\n  }\n  return component.blockData;\n}\nfunction clamp0to255(a) {\n  return a <= 0 ? 0 : a >= 255 ? 255 : a;\n}\nfunction findNextFileMarker(data, currentPos, startPos) {\n  function peekUint16(pos) {\n    return data[pos] << 8 | data[pos + 1];\n  }\n  const maxPos = data.length - 1;\n  let newPos = startPos < currentPos ? startPos : currentPos;\n  if (currentPos >= maxPos) {\n    return null;\n  }\n  const currentMarker = peekUint16(currentPos);\n  if (currentMarker >= 0xFFC0 && currentMarker <= 0xFFFE) {\n    return {\n      invalid: null,\n      marker: currentMarker,\n      offset: currentPos,\n    };\n  }\n  let newMarker = peekUint16(newPos);\n  while (!(newMarker >= 0xFFC0 && newMarker <= 0xFFFE)) {\n    if (++newPos >= maxPos) {\n      return null;\n    }\n    newMarker = peekUint16(newPos);\n  }\n  return {\n    invalid: currentMarker.toString(16),\n    marker: newMarker,\n    offset: newPos,\n  };\n}\n\nexport class JpegImage {\n  constructor() {\n    this.decodeTransform = null;\n    this.colorTransform = -1;\n    this.width = 0;\n    this.height = 0;\n  }\n\n  parse(data) {\n    function readUint16() {\n      const value = data[offset] << 8 | data[offset + 1];\n      offset += 2;\n      return value;\n    }\n    function readDataBlock() {\n      const length = readUint16();\n      let endOffset = offset + length - 2;\n      const fileMarker = findNextFileMarker(data, endOffset, offset);\n      if (fileMarker && fileMarker.invalid) {\n        // (0, _util.warn)('readDataBlock - incorrect length, next marker is: ' + fileMarker.invalid);\n        endOffset = fileMarker.offset;\n      }\n      const array = data.subarray(offset, endOffset);\n      offset += array.length;\n      return array;\n    }\n    function prepareComponents(frame) {\n      const mcusPerLine = Math.ceil(frame.samplesPerLine / 8 / frame.maxH);\n      const mcusPerColumn = Math.ceil(frame.scanLines / 8 / frame.maxV);\n      for (let i = 0; i < frame.components.length; i++) {\n        component = frame.components[i];\n        const blocksPerLine = Math.ceil(Math.ceil(frame.samplesPerLine / 8) * component.h / frame.maxH);\n        const blocksPerColumn = Math.ceil(Math.ceil(frame.scanLines / 8) * component.v / frame.maxV);\n        const blocksPerLineForMcu = mcusPerLine * component.h;\n        const blocksPerColumnForMcu = mcusPerColumn * component.v;\n        const blocksBufferSize = 64 * blocksPerColumnForMcu * (blocksPerLineForMcu + 1);\n        component.blockData = new Int16Array(blocksBufferSize);\n        component.blocksPerLine = blocksPerLine;\n        component.blocksPerColumn = blocksPerColumn;\n      }\n      frame.mcusPerLine = mcusPerLine;\n      frame.mcusPerColumn = mcusPerColumn;\n    }\n    var offset = 0;\n    let jfif = null;\n    let adobe = null;\n    let frame, resetInterval;\n    const quantizationTables = [];\n    const huffmanTablesAC = [],\n      huffmanTablesDC = [];\n    let fileMarker = readUint16();\n    if (fileMarker !== 0xFFD8) {\n      throw new JpegError('SOI not found');\n    }\n    fileMarker = readUint16();\n    while (fileMarker !== 0xFFD9) {\n      var i, j, l;\n      switch (fileMarker) {\n        case 0xFFE0:\n        case 0xFFE1:\n        case 0xFFE2:\n        case 0xFFE3:\n        case 0xFFE4:\n        case 0xFFE5:\n        case 0xFFE6:\n        case 0xFFE7:\n        case 0xFFE8:\n        case 0xFFE9:\n        case 0xFFEA:\n        case 0xFFEB:\n        case 0xFFEC:\n        case 0xFFED:\n        case 0xFFEE:\n        case 0xFFEF:\n        case 0xFFFE:\n          var appData = readDataBlock();\n          if (fileMarker === 0xFFE0) {\n            if (appData[0] === 0x4A && appData[1] === 0x46 && appData[2] === 0x49 && appData[3] === 0x46 && appData[4] === 0) {\n              jfif = {\n                version: {\n                  major: appData[5],\n                  minor: appData[6],\n                },\n                densityUnits: appData[7],\n                xDensity: appData[8] << 8 | appData[9],\n                yDensity: appData[10] << 8 | appData[11],\n                thumbWidth: appData[12],\n                thumbHeight: appData[13],\n                thumbData: appData.subarray(14, 14 + 3 * appData[12] * appData[13]),\n              };\n            }\n          }\n          if (fileMarker === 0xFFEE) {\n            if (appData[0] === 0x41 && appData[1] === 0x64 && appData[2] === 0x6F && appData[3] === 0x62 && appData[4] === 0x65) {\n              adobe = {\n                version: appData[5] << 8 | appData[6],\n                flags0: appData[7] << 8 | appData[8],\n                flags1: appData[9] << 8 | appData[10],\n                transformCode: appData[11],\n              };\n            }\n          }\n          break;\n        case 0xFFDB:\n          var quantizationTablesLength = readUint16();\n          var quantizationTablesEnd = quantizationTablesLength + offset - 2;\n          var z;\n          while (offset < quantizationTablesEnd) {\n            const quantizationTableSpec = data[offset++];\n            const tableData = new Uint16Array(64);\n            if (quantizationTableSpec >> 4 === 0) {\n              for (j = 0; j < 64; j++) {\n                z = dctZigZag[j];\n                tableData[z] = data[offset++];\n              }\n            } else if (quantizationTableSpec >> 4 === 1) {\n              for (j = 0; j < 64; j++) {\n                z = dctZigZag[j];\n                tableData[z] = readUint16();\n              }\n            } else {\n              throw new JpegError('DQT - invalid table spec');\n            }\n            quantizationTables[quantizationTableSpec & 15] = tableData;\n          }\n          break;\n        case 0xFFC0:\n        case 0xFFC1:\n        case 0xFFC2:\n          if (frame) {\n            throw new JpegError('Only single frame JPEGs supported');\n          }\n          readUint16();\n          frame = {};\n          frame.extended = fileMarker === 0xFFC1;\n          frame.progressive = fileMarker === 0xFFC2;\n          frame.precision = data[offset++];\n          frame.scanLines = readUint16();\n          frame.samplesPerLine = readUint16();\n          frame.components = [];\n          frame.componentIds = {};\n          var componentsCount = data[offset++],\n            componentId;\n          var maxH = 0,\n            maxV = 0;\n          for (i = 0; i < componentsCount; i++) {\n            componentId = data[offset];\n            const h = data[offset + 1] >> 4;\n            const v = data[offset + 1] & 15;\n            if (maxH < h) {\n              maxH = h;\n            }\n            if (maxV < v) {\n              maxV = v;\n            }\n            const qId = data[offset + 2];\n            l = frame.components.push({\n              h: h,\n              v: v,\n              quantizationId: qId,\n              quantizationTable: null,\n            });\n            frame.componentIds[componentId] = l - 1;\n            offset += 3;\n          }\n          frame.maxH = maxH;\n          frame.maxV = maxV;\n          prepareComponents(frame);\n          break;\n        case 0xFFC4:\n          var huffmanLength = readUint16();\n          for (i = 2; i < huffmanLength;) {\n            const huffmanTableSpec = data[offset++];\n            const codeLengths = new Uint8Array(16);\n            let codeLengthSum = 0;\n            for (j = 0; j < 16; j++, offset++) {\n              codeLengthSum += codeLengths[j] = data[offset];\n            }\n            const huffmanValues = new Uint8Array(codeLengthSum);\n            for (j = 0; j < codeLengthSum; j++, offset++) {\n              huffmanValues[j] = data[offset];\n            }\n            i += 17 + codeLengthSum;\n            (huffmanTableSpec >> 4 === 0 ? huffmanTablesDC : huffmanTablesAC)[huffmanTableSpec & 15] = buildHuffmanTable(codeLengths, huffmanValues);\n          }\n          break;\n        case 0xFFDD:\n          readUint16();\n          resetInterval = readUint16();\n          break;\n        case 0xFFDA:\n          readUint16();\n          var selectorsCount = data[offset++];\n          var components = [],\n            component;\n          for (i = 0; i < selectorsCount; i++) {\n            const componentIndex = frame.componentIds[data[offset++]];\n            component = frame.components[componentIndex];\n            const tableSpec = data[offset++];\n            component.huffmanTableDC = huffmanTablesDC[tableSpec >> 4];\n            component.huffmanTableAC = huffmanTablesAC[tableSpec & 15];\n            components.push(component);\n          }\n          var spectralStart = data[offset++];\n          var spectralEnd = data[offset++];\n          var successiveApproximation = data[offset++];\n          var processed = decodeScan(data, offset, frame, components, resetInterval, spectralStart, spectralEnd, successiveApproximation >> 4, successiveApproximation & 15);\n          offset += processed;\n          break;\n        case 0xFFFF:\n          if (data[offset] !== 0xFF) {\n            offset--;\n          }\n          break;\n        default:\n          if (data[offset - 3] === 0xFF && data[offset - 2] >= 0xC0 && data[offset - 2] <= 0xFE) {\n            offset -= 3;\n            break;\n          }\n          throw new JpegError('unknown marker ' + fileMarker.toString(16));\n      }\n      fileMarker = readUint16();\n    }\n    this.width = frame.samplesPerLine;\n    this.height = frame.scanLines;\n    this.jfif = jfif;\n    this.adobe = adobe;\n    this.components = [];\n    for (i = 0; i < frame.components.length; i++) {\n      component = frame.components[i];\n      const quantizationTable = quantizationTables[component.quantizationId];\n      if (quantizationTable) {\n        component.quantizationTable = quantizationTable;\n      }\n      this.components.push({\n        output: buildComponentData(frame, component),\n        scaleX: component.h / frame.maxH,\n        scaleY: component.v / frame.maxV,\n        blocksPerLine: component.blocksPerLine,\n        blocksPerColumn: component.blocksPerColumn,\n      });\n    }\n    this.numComponents = this.components.length;\n  }\n  getData(imageData) {\n    const data = imageData.data;\n    const components = this.components;\n    const lineData = new Uint8Array((components[0].blocksPerLine << 3) * components[0].blocksPerColumn * 8);\n\n    // NOTICE: This forces BGR->RGB conversion without adding any costs, since really we know this is going to be a hacky BGRA BLP file.\n    [components[0], components[2]] = [components[2], components[0]];\n\n    for (let i = 0, numComponents = components.length; i < numComponents; i++) {\n      const component = components[i];\n      const blocksPerLine = component.blocksPerLine;\n      const blocksPerColumn = component.blocksPerColumn;\n      const samplesPerLine = blocksPerLine << 3;\n      var j, k, ll = 0;\n      var lineOffset = 0;\n\n      for (let blockRow = 0; blockRow < blocksPerColumn; blockRow++) {\n        const scanLine = blockRow << 3;\n\n        for (let blockCol = 0; blockCol < blocksPerLine; blockCol++) {\n          const bufferOffset = getBlockBufferOffset(component, blockRow, blockCol);\n          let offset2 = 0, sample = blockCol << 3;\n\n          for (j = 0; j < 8; j++) {\n            var lineOffset = (scanLine + j) * samplesPerLine;\n\n            for (k = 0; k < 8; k++) {\n              lineData[lineOffset + sample + k] = component.output[bufferOffset + offset2++];\n            }\n          }\n        }\n      }\n\n      let offset = i;\n\n      for (let y = 0; y < this.height; y++) {\n        for (let x = 0; x < this.width; x++) {\n          data[offset] = lineData[y * samplesPerLine + x];\n          offset += numComponents;\n        }\n      }\n    }\n\n    return data;\n  }\n}\n","import BitStream from '../../common/bitstream';\nimport { bytesOf } from '../../common/bytesof';\nimport convertBitRange from '../../common/convertbitrange';\nimport { JpegImage } from './jpg.js';\n\nexport const BLP1_MAGIC = 0x31504c42;\nexport const CONTENT_JPG = 0x0;\n// const CONTENT_PALLETE = 0x1;\n\n/**\n * A BLP1 image.\n */\nexport class BlpImage {\n  content = 0;\n  alphaBits = 0;\n  width = 0;\n  height = 0;\n  type = 0;\n  hasMipmaps = false;\n  mipmapOffsets = new Uint32Array(16);\n  mipmapSizes = new Uint32Array(16);\n  uint8array: Uint8Array | null = null;\n  /**\n   * Used for JPG images.\n   */\n  jpgHeader: Uint8Array | null = null;\n  /**\n   * Used for indexed images.\n   */\n  pallete: Uint8Array | null = null;\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const bytes = bytesOf(buffer);\n\n    // This includes the JPG header size, in case its a JPG image.\n    // Otherwise, the last element is ignored.\n    const header = new Int32Array(bytes.buffer, 0, 40);\n\n    if (header[0] !== BLP1_MAGIC) {\n      throw new Error('WrongMagicNumber');\n    }\n\n    this.content = header[1];\n    this.alphaBits = header[2];\n    this.width = header[3];\n    this.height = header[4];\n    this.type = header[5];\n    this.hasMipmaps = header[6] !== 0;\n\n    for (let i = 0; i < 16; i++) {\n      this.mipmapOffsets[i] = header[7 + i];\n      this.mipmapSizes[i] = header[23 + i];\n    }\n\n    this.uint8array = bytes;\n\n    if (this.content === CONTENT_JPG) {\n      this.jpgHeader = bytes.subarray(160, 160 + header[39]);\n    } else {\n      this.pallete = bytes.subarray(156, 156 + 1024);\n    }\n  }\n\n  getMipmap(level: number): ImageData {\n    const uint8array = <Uint8Array>this.uint8array;\n    const offset = this.mipmapOffsets[level];\n    const size = this.mipmapSizes[level];\n    let imageData: ImageData;\n\n    if (this.content === CONTENT_JPG) {\n      const jpgHeader = <Uint8Array>this.jpgHeader;\n      const data = new Uint8Array(jpgHeader.length + size);\n      const jpegImage = new JpegImage();\n\n      data.set(jpgHeader);\n      data.set(uint8array.subarray(offset, offset + size), jpgHeader.length);\n\n      jpegImage.parse(data);\n\n      // The JPG data might not actually match the correct mipmap size.\n      imageData = new ImageData(jpegImage.width, jpegImage.height);\n\n      jpegImage.getData(imageData);\n    } else {\n      const pallete = <Uint8Array>this.pallete;\n      const width = Math.max(this.width / (1 << level), 1); // max of 1 because for non-square textures one dimension will eventually be <1.\n      const height = Math.max(this.height / (1 << level), 1);\n      const size = width * height;\n      let alphaBits = this.alphaBits;\n      let bitStream;\n      let bitsToByte = 0;\n\n      imageData = new ImageData(width, height);\n\n      if (alphaBits > 0) {\n        if (alphaBits > 8) {\n          alphaBits = 8;\n        }\n        \n        bitStream = new BitStream(uint8array.buffer, offset + size, Math.ceil((size * alphaBits) / 8));\n        bitsToByte = convertBitRange(alphaBits, 8);\n      }\n\n      const data = imageData.data;\n\n      for (let i = 0; i < size; i++) {\n        const dataIndex = i * 4;\n        const paletteIndex = uint8array[offset + i] * 4;\n\n        // BGRA->RGBA\n        data[dataIndex] = pallete[paletteIndex + 2];\n        data[dataIndex + 1] = pallete[paletteIndex + 1];\n        data[dataIndex + 2] = pallete[paletteIndex];\n\n        if (alphaBits > 0) {\n          data[dataIndex + 3] = (<BitStream>bitStream).readBits(alphaBits) * bitsToByte;\n        } else {\n          data[dataIndex + 3] = 255;\n        }\n      }\n    }\n\n    return imageData;\n  }\n\n  mipmaps(): number {\n    let mipmaps = 0;\n\n    for (const size of this.mipmapSizes) {\n      if (size > 0) {\n        mipmaps += 1;\n      }\n    }\n\n    return mipmaps;\n  }\n\n  fakeMipmaps(): number {\n    const offsets = this.mipmapOffsets;\n    let mipmaps = 0;\n\n    for (let i = 0; i < 16; i++) {\n      const offset = offsets[i];\n\n      if (offset > 0) {\n        for (let j = i + 1; j < 16; j++) {\n          if (offset === offsets[j]) {\n            mipmaps += 1;\n            break;\n          }\n        }\n      }\n    }\n\n    return mipmaps;\n  }\n}\n","import { BlpImage as Image } from './image';\n\nexport default {\n  Image,\n};\n","import convertBitRange from './convertbitrange';\n\nconst dxt4to8 = convertBitRange(4, 8);\nconst dxt5to8 = convertBitRange(5, 8);\nconst dxt6to8 = convertBitRange(6, 8);\nconst dx1colors = new Uint8Array(16);\nconst dx3colors = new Uint8Array(12);\nconst dx5alphas = new Uint8Array(8);\nconst red = new Uint8Array(8);\nconst green = new Uint8Array(8);\n\nfunction dx1Colors(out: Uint8Array, color0: number, color1: number): void {\n  const r0 = ((color0 >> 11) & 31) * dxt5to8;\n  const g0 = ((color0 >> 5) & 63) * dxt6to8;\n  const b0 = (color0 & 31) * dxt5to8;\n  const r1 = ((color1 >> 11) & 31) * dxt5to8;\n  const g1 = ((color1 >> 5) & 63) * dxt6to8;\n  const b1 = (color1 & 31) * dxt5to8;\n\n  // Minimum and maximum colors.\n  out[0] = r0;\n  out[1] = g0;\n  out[2] = b0;\n  out[3] = 255;\n  out[4] = r1;\n  out[5] = g1;\n  out[6] = b1;\n  out[7] = 255;\n\n  // Interpolated colors.\n  if (color0 > color1) {\n    out[8] = (5 * r0 + 3 * r1) >> 3;\n    out[9] = (5 * g0 + 3 * g1) >> 3;\n    out[10] = (5 * b0 + 3 * b1) >> 3;\n    out[11] = 255;\n    out[12] = (5 * r1 + 3 * r0) >> 3;\n    out[13] = (5 * g1 + 3 * g0) >> 3;\n    out[14] = (5 * b1 + 3 * b0) >> 3;\n    out[15] = 255;\n  } else {\n    out[8] = (r0 + r1) >> 1;\n    out[9] = (g0 + g1) >> 1;\n    out[10] = (b0 + b1) >> 1;\n    out[11] = 255;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 0;\n  }\n}\n\nfunction dx3Colors(out: Uint8Array, color0: number, color1: number): void {\n  const r0 = ((color0 >> 11) & 31) * dxt5to8;\n  const g0 = ((color0 >> 5) & 63) * dxt6to8;\n  const b0 = (color0 & 31) * dxt5to8;\n  const r1 = ((color1 >> 11) & 31) * dxt5to8;\n  const g1 = ((color1 >> 5) & 63) * dxt6to8;\n  const b1 = (color1 & 31) * dxt5to8;\n\n  // Minimum and maximum colors.\n  out[0] = r0;\n  out[1] = g0;\n  out[2] = b0;\n  out[3] = r1;\n  out[4] = g1;\n  out[5] = b1;\n\n  // Interpolated colors.\n  out[6] = (5 * r0 + 3 * r1) >> 3;\n  out[7] = (5 * g0 + 3 * g1) >> 3;\n  out[8] = (5 * b0 + 3 * b1) >> 3;\n  out[9] = (5 * r1 + 3 * r0) >> 3;\n  out[10] = (5 * g1 + 3 * g0) >> 3;\n  out[11] = (5 * b1 + 3 * b0) >> 3;\n}\n\nfunction dx5Alphas(out: Uint8Array, alpha0: number, alpha1: number): void {\n  // Minimum and maximum alphas.\n  out[0] = alpha0;\n  out[1] = alpha1;\n\n  // Interpolated alphas.\n  if (alpha0 > alpha1) {\n    out[2] = (54 * alpha0 + 9 * alpha1) >> 6;\n    out[3] = (45 * alpha0 + 18 * alpha1) >> 6;\n    out[4] = (36 * alpha0 + 27 * alpha1) >> 6;\n    out[5] = (27 * alpha0 + 36 * alpha1) >> 6;\n    out[6] = (18 * alpha0 + 45 * alpha1) >> 6;\n    out[7] = (9 * alpha0 + 54 * alpha1) >> 6;\n  } else {\n    out[2] = (12 * alpha0 + 3 * alpha1) >> 4;\n    out[3] = (9 * alpha0 + 6 * alpha1) >> 4;\n    out[4] = (6 * alpha0 + 9 * alpha1) >> 4;\n    out[5] = (3 * alpha0 + 12 * alpha1) >> 4;\n    out[6] = 0;\n    out[7] = 255;\n  }\n}\n\nfunction rgColors(out: Uint8Array, color0: number, color1: number): void {\n  // Minimum and maximum red colors.\n  out[0] = color0;\n  out[1] = color1;\n\n  // Interpolated red colors.\n  if (color0 > color1) {\n    out[2] = (6 * color0 + 1 * color1) / 7;\n    out[3] = (5 * color0 + 2 * color1) / 7;\n    out[4] = (4 * color0 + 3 * color1) / 7;\n    out[5] = (3 * color0 + 4 * color1) / 7;\n    out[6] = (2 * color0 + 5 * color1) / 7;\n    out[7] = (1 * color0 + 6 * color1) / 7;\n  } else {\n    out[2] = (4 * color0 + 1 * color1) / 5;\n    out[3] = (3 * color0 + 2 * color1) / 5;\n    out[4] = (2 * color0 + 3 * color1) / 5;\n    out[5] = (1 * color0 + 4 * color1) / 5;\n    out[6] = 0;\n    out[7] = 1;\n  }\n}\n\n/**\n * Decodes DXT1 data to a Uint8Array typed array with 8-8-8-8 RGBA bits.\n * \n * DXT1 is also known as BC1.\n */\nexport function decodeDxt1(src: Uint8Array, width: number, height: number): Uint8Array {\n  const dst = new Uint8Array(width * height * 4);\n\n  for (let blockY = 0, blockHeight = height / 4; blockY < blockHeight; blockY++) {\n    for (let blockX = 0, blockWidth = width / 4; blockX < blockWidth; blockX++) {\n      const i = 8 * (blockY * blockWidth + blockX);\n\n      // Get the color values.\n      dx1Colors(dx1colors, src[i] + 256 * src[i + 1], src[i + 2] + 256 * src[i + 3]);\n\n      // The offset to the first pixel in the destination.\n      const dstI = (blockY * 16) * width + blockX * 16;\n\n      // All 32 color bits.\n      const bits = src[i + 4] | (src[i + 5] << 8) | (src[i + 6] << 16) | (src[i + 7] << 24);\n\n      for (let row = 0; row < 4; row++) {\n        const rowOffset = row * 8;\n        const dstOffset = dstI + row * width * 4;\n\n        for (let column = 0; column < 4; column++) {\n          const dstIndex = dstOffset + column * 4;\n          const colorOffset = ((bits >> (rowOffset + column * 2)) & 3) * 4;\n\n          dst[dstIndex + 0] = dx1colors[colorOffset + 0];\n          dst[dstIndex + 1] = dx1colors[colorOffset + 1];\n          dst[dstIndex + 2] = dx1colors[colorOffset + 2];\n          dst[dstIndex + 3] = dx1colors[colorOffset + 3];\n        }\n      }\n    }\n  }\n\n  return dst;\n}\n\n/**\n * Decodes DXT3 data to a Uint8Array typed array with 8-8-8-8 RGBA bits.\n * \n * DXT3 is also known as BC2.\n */\nexport function decodeDxt3(src: Uint8Array, width: number, height: number): Uint8Array {\n  const dst = new Uint8Array(width * height * 4);\n  const rowBytes = width * 4;\n\n  for (let blockY = 0, blockHeight = height / 4; blockY < blockHeight; blockY++) {\n    for (let blockX = 0, blockWidth = width / 4; blockX < blockWidth; blockX++) {\n      const i = 16 * (blockY * blockWidth + blockX);\n\n      // Get the color values.\n      dx3Colors(dx3colors, src[i + 8] + 256 * src[i + 9], src[i + 10] + 256 * src[i + 11]);\n\n      let dstI = (blockY * 16) * width + blockX * 16;\n\n      for (let row = 0; row < 4; row++) {\n        // Get 16 bits of alpha indices.\n        const alphaBits = src[i + row * 2] + 256 * src[i + 1 + row * 2];\n\n        // Get 8 bits of color indices.\n        const colorBits = src[i + 12 + row];\n\n        for (let column = 0; column < 4; column++) {\n          const dstIndex = dstI + column * 4;\n          const colorIndex = ((colorBits >> (column * 2)) & 3) * 3;\n\n          dst[dstIndex + 0] = dx3colors[colorIndex + 0];\n          dst[dstIndex + 1] = dx3colors[colorIndex + 1];\n          dst[dstIndex + 2] = dx3colors[colorIndex + 2];\n          dst[dstIndex + 3] = ((alphaBits >> (column * 4)) & 0xf) * dxt4to8;\n        }\n\n        dstI += rowBytes;\n      }\n    }\n  }\n\n  return dst;\n}\n\n/**\n * Decodes DXT5 data to a Uint8Array typed array with 8-8-8-8 RGBA bits.\n * \n * DXT5 is also known as BC3.\n */\nexport function decodeDxt5(src: Uint8Array, width: number, height: number): Uint8Array {\n  const dst = new Uint8Array(width * height * 4);\n  const rowBytes = width * 4;\n\n  for (let blockY = 0, blockHeight = height / 4; blockY < blockHeight; blockY++) {\n    for (let blockX = 0, blockWidth = width / 4; blockX < blockWidth; blockX++) {\n      const i = 16 * (blockY * blockWidth + blockX);\n\n      // Get the alpha values.\n      dx5Alphas(dx5alphas, src[i], src[i + 1]);\n\n      // Get the color values.\n      dx3Colors(dx3colors, src[i + 8] + 256 * src[i + 9], src[i + 10] + 256 * src[i + 11]);\n\n      // The offset to the first pixel in the destination.\n      let dstI = (blockY * 16) * width + blockX * 16;\n\n      // The outer loop is only needed because JS bitwise operators only work on 32bit integers, while the alpha flags contain 48 bits.\n      // Processing is instead done in two blocks, where each one handles 24 bits, or two rows of 4 pixels.\n      for (let block = 0; block < 2; block++) {\n        const alphaOffset = i + 2 + block * 3;\n        const colorOffset = i + 12 + block * 2;\n\n        // 24 alpha bits.\n        const alphaBits = src[alphaOffset] + 256 * (src[alphaOffset + 1] + 256 * src[alphaOffset + 2]);\n\n        // Go over two rows.\n        for (let row = 0; row < 2; row++) {\n          const colorBits = src[colorOffset + row];\n\n          // Go over four columns.\n          for (let column = 0; column < 4; column++) {\n            const dstIndex = dstI + column * 4;\n            const colorIndex = ((colorBits >> (column * 2)) & 3) * 3;\n            const alphaIndex = (alphaBits >> (row * 12 + column * 3)) & 7;\n\n            // Set the pixel.\n            dst[dstIndex + 0] = dx3colors[colorIndex + 0];\n            dst[dstIndex + 1] = dx3colors[colorIndex + 1];\n            dst[dstIndex + 2] = dx3colors[colorIndex + 2];\n            dst[dstIndex + 3] = dx5alphas[alphaIndex];\n          }\n\n          // Next row.\n          dstI += rowBytes;\n        }\n      }\n    }\n  }\n\n  return dst;\n}\n\n/**\n * Decodes RGTC data to a Uint8Array typed array with 8-8 RG bits.\n * \n * RGTC is also known as BC5, ATI2, and 3Dc.\n */\nexport function decodeRgtc(src: Uint8Array, width: number, height: number): Uint8Array {\n  const dst = new Uint8Array(width * height * 2);\n  const rowBytes = width * 2;\n\n  for (let blockY = 0, blockHeight = height / 4; blockY < blockHeight; blockY++) {\n    for (let blockX = 0, blockWidth = width / 4; blockX < blockWidth; blockX++) {\n      const i = 16 * (blockY * blockWidth + blockX);\n\n      // Get the red colors.\n      rgColors(red, src[i], src[i + 1]);\n\n      // Get the green colors.\n      rgColors(green, src[i + 8], src[i + 9]);\n\n      // The offset to the first pixel in the destination.\n      let dstI = (blockY * 8) * width + blockX * 8;\n\n      // Split to two blocks of two rows, because there are 48 color bits.\n      for (let block = 0; block < 2; block++) {\n        const blockOffset = i + block * 3;\n\n        // Get 24 bits of the color indices.\n        const redbits = src[blockOffset + 2] + 256 * (src[blockOffset + 3] + 256 * src[blockOffset + 4]);\n        const greenbits = src[blockOffset + 10] + 256 * (src[blockOffset + 11] + 256 * src[blockOffset + 12]);\n\n        for (let row = 0; row < 2; row++) {\n          const rowOffset = row * 4;\n\n          for (let column = 0; column < 4; column++) {\n            const dstOffset = dstI + column * 2;\n            const shifts = 3 * (rowOffset + column);\n\n            dst[dstOffset + 1] = red[(redbits >> shifts) & 7];\n            dst[dstOffset + 2] = green[(greenbits >> shifts) & 7];\n          }\n\n          // Next row.\n          dstI += rowBytes;\n        }\n      }\n    }\n  }\n\n  return dst;\n}\n","import { base256ToString } from '../../common/typecast';\nimport { decodeDxt1, decodeDxt3, decodeDxt5, decodeRgtc } from '../../common/dxt';\nimport { bytesOf } from '../../common/bytesof';\n\nexport const DDS_MAGIC = 0x20534444;\nconst DDSD_MIPMAPCOUNT = 0x20000;\nconst DDPF_FOURCC = 0x4;\n\nexport const FOURCC_DXT1 = 0x31545844;\nexport const FOURCC_DXT3 = 0x33545844;\nexport const FOURCC_DXT5 = 0x35545844;\nexport const FOURCC_ATI2 = 0x32495441;\n\nconst FOURCC_DX10 = 0x30315844;\nconst DXGI_FORMAT_BC1_UNORM = 0x00000047;\nconst DXGI_FORMAT_BC2_UNORM = 0x0000004A;\nconst DXGI_FORMAT_BC3_UNORM = 0x0000004D;\nconst DXGI_FORMAT_BC5_UNORM = 0x00000053;\n\n/**\n * A DDS image.\n */\nexport class DdsImage {\n  width = 0;\n  height = 0;\n  format = 0;\n  mipmapWidths: number[] = [];\n  mipmapHeights: number[] = [];\n  mipmapDatas: Uint8Array[] = [];\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const bytes = bytesOf(buffer);\n    const header = new Int32Array(bytes.buffer, 0, 31);\n    let offset = 128; // sizeof(DDS_HEADER) + 4 for the magic.\n\n    if (header[0] !== DDS_MAGIC) {\n      throw new Error('Wrong magic number');\n    }\n\n    if (!(header[20] & DDPF_FOURCC)) {\n      throw new Error('Not FourCC');\n    }\n\n    let fourCC = header[21];\n    \n    if (fourCC !== FOURCC_DXT1 && fourCC !== FOURCC_DXT3 && fourCC !== FOURCC_DXT5 && fourCC !== FOURCC_ATI2) {\n      if (fourCC === FOURCC_DX10) {\n        offset += 20; // sizeof(DDS_HEADER_DXT10)\n\n        const extendedHeader = new Int32Array(bytes.buffer, 128, 5);\n        const dxgiFormat = extendedHeader[0];\n\n        if (dxgiFormat === DXGI_FORMAT_BC1_UNORM) {\n          fourCC = FOURCC_DXT1;\n        } else if (dxgiFormat === DXGI_FORMAT_BC2_UNORM) {\n          fourCC = FOURCC_DXT3;\n        } else if (dxgiFormat === DXGI_FORMAT_BC3_UNORM) {\n          fourCC = FOURCC_DXT5;\n        } else if (dxgiFormat === DXGI_FORMAT_BC5_UNORM) {\n          fourCC = FOURCC_ATI2;\n        } else {\n          throw new Error(`Unsupported DXGI format: ${dxgiFormat}`);\n        }\n\n        console.log(extendedHeader);\n      } else {\n        throw new Error(`Unsupported FourCC: ${base256ToString(fourCC)}`);\n      }\n    }\n\n    this.format = fourCC;\n\n    let mipmaps = 1;\n\n    if (header[2] & DDSD_MIPMAPCOUNT) {\n      mipmaps = Math.max(1, header[7]);\n    }\n\n    let width = header[4];\n    let height = header[3];\n    let blockSize = 16;\n\n    // DXT3, DXT5, and RGTC, all have 16 bytes per block.\n    if (fourCC === FOURCC_DXT1) {\n      blockSize = 8;\n    }\n\n    this.width = width;\n    this.height = height;\n\n    for (let i = 0; i < mipmaps; i++) {\n      const size = Math.max(4, width) / 4 * Math.max(4, height) / 4 * blockSize;\n\n      this.mipmapWidths[i] = width;\n      this.mipmapHeights[i] = height;\n      this.mipmapDatas[i] = bytes.subarray(offset, offset + size);\n\n      offset += size;\n      width = Math.max(width / 2, 1);\n      height = Math.max(height / 2, 1);\n    }\n  }\n\n  mipmaps(): number {\n    return this.mipmapDatas.length;\n  }\n\n  getMipmap(level: number, raw = false): { width: number, height: number, data: Uint8Array } {\n    const width = this.mipmapWidths[level];\n    const height = this.mipmapHeights[level];\n    const data = this.mipmapDatas[level];\n    let mipmap: Uint16Array | Uint8Array;\n\n    if (raw) {\n      mipmap = data;\n    } else if (this.format === FOURCC_DXT1) {\n      mipmap = decodeDxt1(data, width, height);\n    } else if (this.format === FOURCC_DXT3) {\n      mipmap = decodeDxt3(data, width, height);\n    } else if (this.format === FOURCC_DXT5) {\n      mipmap = decodeDxt5(data, width, height);\n    } else {\n      mipmap = decodeRgtc(data, width, height);\n    }\n\n    return { width, height, data: mipmap };\n  }\n}\n","/**\n * Detects if the given object is a DDS source.\n */\nexport default function isDds(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x44 && bytes[1] === 0x44 && bytes[2] === 0x53 && bytes[3] === 0x20) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","import { DdsImage as Image, FOURCC_DXT1, FOURCC_DXT3, FOURCC_DXT5, FOURCC_ATI2 } from './image';\nimport isDds from './isformat';\n\nexport default {\n  Image,\n  FOURCC_DXT1,\n  FOURCC_DXT3,\n  FOURCC_DXT5,\n  FOURCC_ATI2,\n  isDds,\n};\n","/**\n * @license tga-js 1.1.1\n * Copyright (c) 2013-2020 Vincent Thibault, Inc.\n * License: MIT\n */\nconst e=0,t=1,a=3,r=9,o=10,i=11,s=0,h=2,n=3,g=4,l=48;export default class{_checkHeader(){const t=this.header;if(t.imageType===e)throw Error(\"No data\");if(t.hasColorMap){if(t.colorMapLength>256||24!==t.colorMapDepth||1!==t.colorMapType)throw Error(\"Invalid colormap for indexed type\")}else if(t.colorMapType)throw Error(\"Why does the image contain a palette ?\");if(!t.width||!t.height)throw Error(\"Invalid image size\");if(8!==t.pixelDepth&&16!==t.pixelDepth&&24!==t.pixelDepth&&32!==t.pixelDepth)throw Error('Invalid pixel size \"'+t.pixelDepth+'\"')}_decodeRLE(e,t,a,r){const o=new Uint8Array(r),i=new Uint8Array(a);let s=0;for(;s<r;){const r=e[t++];let h=1+(127&r);if(128&r){for(let r=0;r<a;++r)i[r]=e[t+r];t+=a;for(let e=0;e<h;++e)o.set(i,s),s+=a}else{h*=a;for(let a=0;a<h;++a)o[s+a]=e[t+a];s+=h,t+=h}}return o}_getImageData8bits(e,t,a,r,o,i,s,h,n,g){for(let l=0,p=o;p!==s;p+=i)for(let o=h;o!==g;o+=n,l++){const i=t[l];e[4*(o+r*p)+3]=255,e[4*(o+r*p)+2]=a[3*i+0],e[4*(o+r*p)+1]=a[3*i+1],e[4*(o+r*p)+0]=a[3*i+2]}return e}_getImageData16bits(e,t,a,r,o,i,s,h,n,g){for(let a=0,l=o;l!==s;l+=i)for(let o=h;o!==g;o+=n,a+=2){const i=t[a+0]|t[a+1]<<8;e[4*(o+r*l)+0]=(31744&i)>>7,e[4*(o+r*l)+1]=(992&i)>>2,e[4*(o+r*l)+2]=(31&i)>>3,e[4*(o+r*l)+3]=32768&i?0:255}return e}_getImageData24bits(e,t,a,r,o,i,s,h,n,g){for(let a=0,l=o;l!==s;l+=i)for(let o=h;o!==g;o+=n,a+=3)e[4*(o+r*l)+3]=255,e[4*(o+r*l)+2]=t[a+0],e[4*(o+r*l)+1]=t[a+1],e[4*(o+r*l)+0]=t[a+2];return e}_getImageData32bits(e,t,a,r,o,i,s,h,n,g){for(let a=0,l=o;l!==s;l+=i)for(let o=h;o!==g;o+=n,a+=4)e[4*(o+r*l)+2]=t[a+0],e[4*(o+r*l)+1]=t[a+1],e[4*(o+r*l)+0]=t[a+2],e[4*(o+r*l)+3]=t[a+3];return e}_getImageDataGrey8bits(e,t,a,r,o,i,s,h,n,g){for(let a=0,l=o;l!==s;l+=i)for(let o=h;o!==g;o+=n,a++){const i=t[a];e[4*(o+r*l)+0]=i,e[4*(o+r*l)+1]=i,e[4*(o+r*l)+2]=i,e[4*(o+r*l)+3]=255}return e}_getImageDataGrey16bits(e,t,a,r,o,i,s,h,n,g){for(let a=0,l=o;l!==s;l+=i)for(let o=h;o!==g;o+=n,a+=2)e[4*(o+r*l)+0]=t[a+0],e[4*(o+r*l)+1]=t[a+0],e[4*(o+r*l)+2]=t[a+0],e[4*(o+r*l)+3]=t[a+1];return e}open(e,t){const a=new XMLHttpRequest;a.responseType=\"arraybuffer\",a.open(\"GET\",e,!0),a.onload=(()=>{200===a.status&&(this.load(new Uint8Array(a.response)),t&&t())}),a.send(null)}load(e){let s=0;if(e.length<18)throw Error(\"Not enough data to contain header\");const h={idLength:e[s++],colorMapType:e[s++],imageType:e[s++],colorMapIndex:e[s++]|e[s++]<<8,colorMapLength:e[s++]|e[s++]<<8,colorMapDepth:e[s++],offsetX:e[s++]|e[s++]<<8,offsetY:e[s++]|e[s++]<<8,width:e[s++]|e[s++]<<8,height:e[s++]|e[s++]<<8,pixelDepth:e[s++],flags:e[s++]};if(h.hasEncoding=h.imageType===r||h.imageType===o||h.imageType===i,h.hasColorMap=h.imageType===r||h.imageType===t,h.isGreyColor=h.imageType===i||h.imageType===a,this.header=h,this._checkHeader(),(s+=h.idLength)>=e.length)throw Error(\"No data\");if(h.hasColorMap){const t=h.colorMapLength*(h.colorMapDepth>>3);this.palette=e.subarray(s,s+t),s+=t}const n=h.pixelDepth>>3,g=h.width*h.height,l=g*n;h.hasEncoding?this.imageData=this._decodeRLE(e,s,n,l):this.imageData=e.subarray(s,s+(h.hasColorMap?g:l))}getImageData(e){const{width:t,height:a,flags:r,pixelDepth:o,isGreyColor:i}=this.header,p=(r&l)>>g;let c,d,m,f,D,y,u;switch(e||(e=document?document.createElement(\"canvas\").getContext(\"2d\").createImageData(t,a):{width:t,height:a,data:new Uint8ClampedArray(t*a*4)}),p===h||p===n?(f=0,D=1,y=a):(f=a-1,D=-1,y=-1),p===h||p===s?(c=0,d=1,m=t):(c=t-1,d=-1,m=-1),o){case 8:u=i?this._getImageDataGrey8bits:this._getImageData8bits;break;case 16:u=i?this._getImageDataGrey16bits:this._getImageData16bits;break;case 24:u=this._getImageData24bits;break;case 32:u=this._getImageData32bits}return u.call(this,e.data,this.imageData,this.palette,t,f,D,y,c,d,m),e}getCanvas(){const{width:e,height:t}=this.header,a=document.createElement(\"canvas\"),r=a.getContext(\"2d\"),o=r.createImageData(e,t);return a.width=e,a.height=t,r.putImageData(this.getImageData(o),0,0),a}getDataURL(e){return this.getCanvas().toDataURL(e||\"image/png\")}}\n","import TgaLoader from 'tga-js';\nimport { bytesOf } from '../../common/bytesof';\n\n/**\n * A TGA image.\n */\nexport default class TgaImage {\n  width = 0;\n  height = 0;\n  data: ImageData | null = null;\n\n  load(buffer: ArrayBuffer | Uint8Array): void {\n    const bytes = bytesOf(buffer);\n    const tga = new TgaLoader();\n\n    tga.load(bytes);\n\n    const header = tga.header;\n\n    this.width = header.width;\n    this.height = header.height;\n    this.data = new ImageData(header.width, header.height);\n\n    tga.getImageData(this.data);\n  }\n}\n","import { isStringInBytes } from '../../common/searches';\n\n/**\n * Detects if the given object is a TGA source.\n */\nexport default function isTga(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array && isStringInBytes(bytes, 'TRUEVISION-XFILE.\\0', bytes.length - 18)) {\n    return true;\n  }\n\n  return false;\n}\n","/**\n * The valid data type names for resource fetches.\n */\nexport type FetchDataTypeName = 'image' | 'text' | 'arrayBuffer' | 'bytes' | 'blob';\n\n/**\n * The valid data types for resource fetches.\n */\nexport type FetchDataType = HTMLImageElement | string | ArrayBuffer | Uint8Array | Blob;\n\n/**\n * The structure that the promise returned by fetchDataType is resolved to.\n */\nexport interface FetchResult {\n  ok: boolean;\n  data: FetchDataType | Response | Event;\n  error?: string;\n}\n\n/**\n * Returns a promise that will resolve with the data from the given path.\n * \n * The data type determines the returned object:\n *\n *     \"image\" => Image\n *     \"text\" => string\n *     \"arrayBuffer\" => ArrayBuffer\n *     \"bytes\" => Uint8Array\n *     \"blob\" => Blob\n */\nexport async function fetchDataType(path: string, dataType: FetchDataTypeName): Promise<FetchResult> {\n  if (dataType === 'image') {\n    // Promise wrapper for an image load.\n    return new Promise<FetchResult>((resolve) => {\n      const image = new Image();\n\n      image.onload = (): void => {\n        resolve({ ok: true, data: image });\n      };\n\n      image.onerror = (e): void => {\n        resolve({ ok: false, error: 'Image Error', data: e });\n      };\n\n      image.src = path;\n    });\n  } else {\n    let response: Response;\n\n    // Fetch.\n    try {\n      response = await fetch(path);\n    } catch (e) {\n      return <FetchResult>{ ok: false, error: 'Network Error', data: e };\n    }\n\n    // Fetch went ok?\n    if (!response.ok) {\n      return <FetchResult>{ ok: false, error: 'Http Error', data: response };\n    }\n\n    // Try to get the requested data type.\n    try {\n      let data: string | ArrayBuffer | Blob | null = null;\n\n      if (dataType === 'text') {\n        data = await response.text();\n      } else if (dataType === 'arrayBuffer' || dataType === 'bytes') {\n        data = await response.arrayBuffer();\n      } else if (dataType === 'blob') {\n        data = await response.blob();\n      }\n\n      if (dataType === 'bytes') {\n        data = new Uint8Array(<ArrayBuffer>data);\n      }\n\n      return <FetchResult>{ ok: true, data };\n    } catch (e) {\n      return <FetchResult>{ ok: false, error: 'Data Error', data: e };\n    }\n  }\n}\n","/**\n * A buffer.\n */\nexport default class ClientBuffer {\n  gl: WebGLRenderingContext;\n  buffer: WebGLBuffer;\n  size = 0;\n  arrayBuffer: ArrayBuffer | null = null;\n  byteView: Uint8Array | null = null;\n  floatView: Float32Array | null = null;\n\n  constructor(gl: WebGLRenderingContext, size = 4) {\n    this.gl = gl;\n    this.buffer = <WebGLBuffer>gl.createBuffer();\n\n    this.reserve(size);\n  }\n\n  reserve(size: number): void {\n    if (this.size < size) {\n      const gl = this.gl;\n\n      // Ensure the size is on a 4 byte boundary.\n      this.size = Math.ceil(size / 4) * 4;\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.size, gl.DYNAMIC_DRAW);\n\n      this.arrayBuffer = new ArrayBuffer(this.size);\n      this.byteView = new Uint8Array(this.arrayBuffer);\n      this.floatView = new Float32Array(this.arrayBuffer);\n    }\n  }\n\n  bindAndUpdate(size = this.size): void {\n    const gl = this.gl;\n    const byteView = <Uint8Array>this.byteView;\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, byteView.subarray(0, size));\n  }\n}\n","/**\n * A data texture.\n */\nexport default class ClientDataTexture {\n  gl: WebGLRenderingContext;\n  texture: WebGLTexture;\n  width = 0;\n  height = 0;\n  arrayBuffer = new ArrayBuffer(0);\n  byteView: Uint8Array | null = null;\n  floatView: Float32Array | null = null;\n\n  constructor(gl: WebGLRenderingContext, width = 1, height = 1) {\n    this.gl = gl;\n    this.texture = <WebGLTexture>gl.createTexture();\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\n    this.reserve(width, height);\n  }\n\n  reserve(width: number, height: number): void {\n    if (this.width < width || this.height < height) {\n      const gl = this.gl;\n\n      this.width = Math.max(this.width, width);\n      this.height = Math.max(this.height, height);\n\n      gl.bindTexture(gl.TEXTURE_2D, this.texture);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.FLOAT, null);\n\n      this.arrayBuffer = new ArrayBuffer(this.width * this.height * 16);\n      this.byteView = new Uint8Array(this.arrayBuffer);\n      this.floatView = new Float32Array(this.arrayBuffer);\n    }\n  }\n\n  bindAndUpdate(width = this.width, height = this.height): void {\n    const gl = this.gl;\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, width, height, gl.RGBA, gl.FLOAT, this.byteView);\n  }\n}\n","/**\n * A data texture.\n */\nexport default class DataTexture {\n  gl: WebGLRenderingContext;\n  texture: WebGLTexture;\n  format: number;\n  width = 0;\n  height = 0;\n\n  constructor(gl: WebGLRenderingContext, channels = 4, width = 1, height = 1) {\n    this.gl = gl;\n    this.texture = <WebGLTexture>gl.createTexture();\n    this.format = (channels === 3 ? gl.RGB : gl.RGBA);\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\n    this.reserve(width, height);\n  }\n\n  reserve(width: number, height: number): void {\n    if (this.width < width || this.height < height) {\n      const gl = this.gl;\n\n      this.width = Math.max(this.width, width);\n      this.height = Math.max(this.height, height);\n\n      gl.bindTexture(gl.TEXTURE_2D, this.texture);\n      gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.width, this.height, 0, this.format, gl.FLOAT, null);\n    }\n  }\n\n  bindAndUpdate(buffer: Float32Array, width = this.width, height = this.height): void {\n    const gl = this.gl;\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, width, height, this.format, gl.FLOAT, buffer);\n  }\n\n  bind(unit: number): void {\n    const gl = this.gl;\n\n    gl.activeTexture(gl.TEXTURE0 + unit);\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n  }\n}\n","import WebGL from './gl';\n\n/**\n * A wrapper around a WebGL shader program.\n */\nexport default class Shader {\n  webgl: WebGL;\n  program: WebGLProgram;\n  uniforms: {[key: string]: WebGLUniformLocation } = {};\n  attribs: {[key: string]: number } = {};\n  attribsCount = 0;\n\n  constructor(webgl: WebGL, program: WebGLProgram) {\n    this.webgl = webgl;\n    this.program = program;\n\n    const gl = webgl.gl;\n\n    for (let i = 0, l = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS); i < l; i++) {\n      const object = gl.getActiveUniform(program, i);\n\n      if (object) {\n        if (object.size === 1) {\n          this.uniforms[object.name] = <WebGLUniformLocation>gl.getUniformLocation(program, object.name);\n        } else {\n          const base = object.name.substr(0, object.name.length - 3);\n\n          for (let index = 0; index < object.size; index++) {\n            const name = base + '[' + index + ']';\n\n            this.uniforms[name] = <WebGLUniformLocation>gl.getUniformLocation(program, name);\n          }\n        }\n      }\n    }\n\n    for (let i = 0, l = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES); i < l; i++) {\n      const object = gl.getActiveAttrib(program, i);\n\n      if (object) {\n        this.attribsCount += object.size;\n\n        if (object.size === 1) {\n          this.attribs[object.name] = gl.getAttribLocation(program, object.name);\n        } else {\n          const base = object.name.substr(0, object.name.length - 3);\n\n          for (let index = 0; index < object.size; index++) {\n            const name = base + '[' + index + ']';\n\n            this.attribs[name] = gl.getAttribLocation(program, name);\n          }\n        }\n      }\n    }\n  }\n\n  use(): void {\n    this.webgl.useShader(this);\n  }\n}\n","import Texture from '../texture';\nimport ClientBuffer from './clientbuffer';\nimport ClientDataTexture from './clientdatatexture';\nimport DataTexture from './datatexture';\nimport Shader from './shader';\n\n/**\n * A small WebGL utility class.\n * Makes it easier to generate shaders, textures, etc.\n */\nexport default class WebGL {\n  gl: WebGLRenderingContext;\n  currentShader: Shader | null = null;\n  emptyTexture: WebGLTexture;\n  extensions: {[key: string]: unknown } = {};\n\n  constructor(canvas: HTMLCanvasElement, options: WebGLContextAttributes = { alpha: false }) {\n    let gl = canvas.getContext('webgl', options);\n\n    if (!gl) {\n      gl = <WebGLRenderingContext | null>canvas.getContext('experimental-webgl', options);\n    }\n\n    if (!gl) {\n      throw new Error('WebGL: Failed to create a WebGL context!');\n    }\n\n    const twoByTwo = new Uint8ClampedArray(16).fill(255);\n\n    const emptyTexture = <WebGLTexture>gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, emptyTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2, 2, 0, gl.RGBA, gl.UNSIGNED_BYTE, twoByTwo);\n\n    this.gl = gl;\n    this.emptyTexture = emptyTexture;\n  }\n\n  /**\n   * Ensures that an extension is available.\n   * \n   * If it is, it will be added to `extensions`.\n   */\n  ensureExtension(name: string): boolean {\n    const ext = this.gl.getExtension(name);\n\n    if (ext) {\n      this.extensions[name] = ext;\n\n      return true;\n    }\n\n    return false;\n  }\n\n  createShader(vertexSource: string, fragmentSource: string): Shader {\n    const gl = this.gl;\n\n    const vertex = <WebGLShader>gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertex, vertexSource);\n    gl.compileShader(vertex);\n\n    const fragment = <WebGLShader>gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragment, fragmentSource);\n    gl.compileShader(fragment);\n\n    const program = <WebGLProgram>gl.createProgram();\n    gl.attachShader(program, vertex);\n    gl.attachShader(program, fragment);\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      let log = 'Shader failed to link:';\n\n      const vertexLog = gl.getShaderInfoLog(vertex);\n      if (vertexLog && vertexLog.length) {\n        log += ` Vertex shader: ${vertexLog}`;\n      }\n\n      const fragmentLog = gl.getShaderInfoLog(fragment);\n      if (fragmentLog && fragmentLog.length) {\n        log += ` Fragment shader: ${fragmentLog}`;\n      }\n\n      throw new Error(log);\n    }\n\n    return new Shader(this, program);\n  }\n\n  /**\n   * Enables all vertex attribs between [start, end], including start and discluding end.\n   */\n  enableVertexAttribs(start: number, end: number): void {\n    const gl = this.gl;\n\n    for (let i = start; i < end; i++) {\n      gl.enableVertexAttribArray(i);\n    }\n  }\n\n  /**\n   * Disables all vertex attribs between [start, end], including start and discluding end.\n   */\n  disableVertexAttribs(start: number, end: number): void {\n    const gl = this.gl;\n\n    for (let i = start; i < end; i++) {\n      gl.disableVertexAttribArray(i);\n    }\n  }\n\n  /**\n   * Use a shader program.\n   */\n  useShader(shader: Shader): void {\n    if (shader && shader !== this.currentShader) {\n      let oldAttribs = 0;\n      const newAttribs = shader.attribsCount;\n\n      if (this.currentShader) {\n        oldAttribs = this.currentShader.attribsCount;\n      }\n\n      this.gl.useProgram(shader.program);\n\n      if (newAttribs > oldAttribs) {\n        this.enableVertexAttribs(oldAttribs, newAttribs);\n      } else if (newAttribs < oldAttribs) {\n        this.disableVertexAttribs(newAttribs, oldAttribs);\n      }\n\n      this.currentShader = shader;\n    }\n  }\n\n  /**\n   * Bind a texture.\n   * \n   * If the given texture is invalid, a 2x2 black texture will be bound instead.\n   */\n  bindTexture(texture: Texture | undefined | null, unit: number): void {\n    const gl = this.gl;\n\n    gl.activeTexture(gl.TEXTURE0 + unit);\n\n    if (texture) {\n      gl.bindTexture(gl.TEXTURE_2D, texture.webglResource);\n    } else {\n      // Bind an empty texture in case an invalid one was given, to avoid WebGL errors.\n      gl.bindTexture(gl.TEXTURE_2D, this.emptyTexture);\n    }\n  }\n\n  bindTextureAndWrap(texture: Texture | undefined | null, unit: number, wrapS: number, wrapT: number): void {\n    const gl = this.gl;\n\n    gl.activeTexture(gl.TEXTURE0 + unit);\n\n    if (texture) {\n      gl.bindTexture(gl.TEXTURE_2D, texture.webglResource);\n    } else {\n      // Bind an empty texture in case an invalid one was given, to avoid WebGL errors.\n      gl.bindTexture(gl.TEXTURE_2D, this.emptyTexture);\n    }\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT);\n  }\n\n  /**\n   * Set the texture wrap and filter values.\n   */\n  setTextureMode(wrapS: number, wrapT: number, magFilter: number, minFilter: number): void {\n    const gl = this.gl;\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, magFilter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter);\n  }\n\n  /**\n   * A shortcut for `new ClientBuffer(gl, size)`.\n   */\n  createClientBuffer(size = 4): ClientBuffer {\n    return new ClientBuffer(this.gl, size);\n  }\n\n  /**\n   * A shortcut for `new DataTexture(gl, channels, width, height)`.\n   */\n  createDataTexture(channels = 4, width = 1, height = 1): DataTexture {\n    return new DataTexture(this.gl, channels, width, height);\n  }\n\n  /**\n   * A shortcut for `new ClientDataTexture(gl, width, height)`.\n   */\n  createClientDataTexture(width = 1, height = 1): ClientDataTexture {\n    return new ClientDataTexture(this.gl, width, height);\n  }\n}\n","import { vec3, vec4, quat, mat4 } from 'gl-matrix';\nimport { VEC3_UNIT_Y, VEC3_UNIT_X, VEC3_UNIT_Z, unproject, unpackPlanes, quatLookAt } from '../common/gl-matrix-addon';\n\nconst vectorHeap = vec3.create();\nconst vectorHeap2 = vec3.create();\nconst vectorHeap3 = vec3.create();\nconst quatHeap = quat.create();\nconst facingCorrection = quat.setAxisAngle(quat.create(), VEC3_UNIT_X, Math.PI / 2);\n\n/**\n * A camera.\n */\nexport default class Camera {\n  isPerspective = true;\n  fov = 0;\n  aspect = 0;\n  isOrtho = false;\n  leftClipPlane = 0;\n  rightClipPlane = 0;\n  bottomClipPlane = 0;\n  topClipPlane = 0;\n  nearClipPlane = 0;\n  farClipPlane = 0;\n  location = vec3.create();\n  rotation = quat.create();\n  inverseRotation = quat.create();\n  /**\n   * World -> View.\n   */\n  viewMatrix = mat4.create();\n  /**\n   * View -> Clip.\n   */\n  projectionMatrix = mat4.create();\n  /**\n   * World -> Clip.\n   */\n  viewProjectionMatrix = mat4.create();\n  /**\n   * View -> World.\n   */\n  inverseViewMatrix = mat4.create();\n  /**\n   * Clip -> World.\n   */\n  inverseViewProjectionMatrix = mat4.create();\n  /**\n   * The X axis in camera space.\n   */\n  directionX = vec3.create();\n  /**\n   * The Y axis in camera space.\n   */\n  directionY = vec3.create();\n  /**\n   * The Z axis in camera space.\n   */\n  directionZ = vec3.create();\n  /**\n   * The four corners of a 2x2 rectangle.\n   */\n  vectors = [vec3.fromValues(-1, -1, 0), vec3.fromValues(-1, 1, 0), vec3.fromValues(1, 1, 0), vec3.fromValues(1, -1, 0), vec3.fromValues(1, 0, 0), vec3.fromValues(0, 1, 0), vec3.fromValues(0, 0, 1)];\n  /**\n   * Same as vectors, however these are all billboarded to the camera.\n   */\n  billboardedVectors = [vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n  /**\n   * The camera frustum planes in this order: left, right, top, bottom, near, far.\n   */\n  planes = [vec4.create(), vec4.create(), vec4.create(), vec4.create(), vec4.create(), vec4.create()];\n\n  /**\n   * Set the camera to perspective projection mode.\n   */\n  perspective(fov: number, aspect: number, near: number, far: number): void {\n    this.isPerspective = true;\n    this.isOrtho = false;\n    this.fov = fov;\n    this.aspect = aspect;\n    this.nearClipPlane = near;\n    this.farClipPlane = far;\n\n    this.update();\n  }\n\n  /**\n   * Set the camera to orthogonal projection mode.\n   */\n  ortho(left: number, right: number, bottom: number, top: number, near: number, far: number): void {\n    this.isPerspective = false;\n    this.isOrtho = true;\n    this.leftClipPlane = left;\n    this.rightClipPlane = right;\n    this.bottomClipPlane = bottom;\n    this.topClipPlane = top;\n    this.nearClipPlane = near;\n    this.farClipPlane = far;\n\n    this.update();\n  }\n\n  /**\n   * Set the camera location in world coordinates.\n   */\n  setLocation(location: vec3): void {\n    vec3.copy(this.location, location);\n\n    this.update();\n  }\n\n  /**\n   * Move the camera by the given offset in world coordinates.\n   */\n  move(offset: vec3): void {\n    vec3.add(this.location, this.location, offset);\n\n    this.update();\n  }\n\n  /**\n   * Set the camera rotation.\n   */\n  setRotation(rotation: quat): void {\n    quat.copy(this.rotation, rotation);\n\n    this.update();\n  }\n\n  /**\n   * Rotate the camera by the given rotation.\n   */\n  rotate(rotation: quat): void {\n    quat.mul(this.rotation, this.rotation, rotation);\n\n    this.update();\n  }\n\n  /**\n   * Look at `to`.\n   */\n  face(to: vec3, worldUp: vec3): void {\n    quat.mul(this.rotation, facingCorrection, quatLookAt(quatHeap, to, this.location, worldUp));\n\n    this.update();\n  }\n\n  /**\n   * Move to `from` and look at `to`.\n   */\n  moveToAndFace(from: vec3, to: vec3, worldUp: vec3): void {\n    vec3.copy(this.location, from);\n    this.face(to, worldUp);\n  }\n\n  /**\n   * Reset the location and angles.\n   */\n  reset(): void {\n    vec3.set(this.location, 0, 0, 0);\n    quat.identity(this.rotation);\n\n    this.update();\n  }\n\n  /**\n   * Recalculate the camera's transformation.\n   */\n  update(): void {\n    const location = this.location;\n    const rotation = this.rotation;\n    const inverseRotation = this.inverseRotation;\n    const viewMatrix = this.viewMatrix;\n    const projectionMatrix = this.projectionMatrix;\n    const viewProjectionMatrix = this.viewProjectionMatrix;\n    const vectors = this.vectors;\n    const billboardedVectors = this.billboardedVectors;\n\n    // View -> Clip.\n    if (this.isPerspective) {\n      mat4.perspective(projectionMatrix, this.fov, this.aspect, this.nearClipPlane, this.farClipPlane);\n    } else {\n      mat4.ortho(projectionMatrix, this.leftClipPlane, this.rightClipPlane, this.bottomClipPlane, this.topClipPlane, this.nearClipPlane, this.farClipPlane);\n    }\n\n    // World -> View.\n    mat4.fromQuat(viewMatrix, rotation);\n    mat4.translate(viewMatrix, viewMatrix, vec3.negate(vectorHeap, location));\n\n    // World -> Clip.\n    mat4.mul(viewProjectionMatrix, projectionMatrix, viewMatrix);\n\n    // View -> World.\n    mat4.invert(this.inverseViewMatrix, viewMatrix);\n\n    // Clip -> World.\n    mat4.invert(this.inverseViewProjectionMatrix, viewProjectionMatrix);\n\n    // Recaculate the camera's frusum planes\n    unpackPlanes(this.planes, viewProjectionMatrix);\n\n    quat.conjugate(inverseRotation, rotation);\n\n    // View-space axes.\n    vec3.transformQuat(this.directionX, VEC3_UNIT_X, inverseRotation);\n    vec3.transformQuat(this.directionY, VEC3_UNIT_Y, inverseRotation);\n    vec3.transformQuat(this.directionZ, VEC3_UNIT_Z, inverseRotation);\n\n    // View-space rectangle, aka billboarded.\n    for (let i = 0; i < 7; i++) {\n      vec3.transformQuat(billboardedVectors[i], vectors[i], inverseRotation);\n    }\n  }\n\n  /**\n   * Given a vector in camera space, return the vector transformed to world space.\n   */\n  cameraToWorld(out: vec3, v: vec3): vec3 {\n    return vec3.transformMat4(out, v, this.inverseViewMatrix);\n  }\n\n  /**\n   * Given a vector in world space, return the vector transformed to camera space.\n   */\n  worldToCamera(out: vec3, v: vec3): vec3 {\n    return vec3.transformMat4(out, v, this.viewMatrix);\n  }\n\n  /**\n   * Given a vector in world space, return the vector transformed to screen space.\n   */\n  worldToScreen(out: Float32Array, v: Float32Array, viewport: vec4): Float32Array {\n    vec3.transformMat4(vectorHeap, <vec3>v, this.viewProjectionMatrix);\n\n    out[0] = Math.round(((vectorHeap[0] + 1) / 2) * viewport[2]);\n    out[1] = Math.round(((vectorHeap[1] + 1) / 2) * viewport[3]);\n\n    return out;\n  }\n\n  /**\n   * Given a vector in screen space, return a ray from the near plane to the far plane.\n   */\n  screenToWorldRay(out: Float32Array, v: Float32Array, viewport: vec4): Float32Array {\n    const a = vectorHeap;\n    const b = vectorHeap2;\n    const c = vectorHeap3;\n    const x = v[0];\n    const y = v[1];\n    const inverseViewProjectionMatrix = this.inverseViewProjectionMatrix;\n\n    // Intersection on the near-plane\n    unproject(a, vec3.set(c, x, y, 0), inverseViewProjectionMatrix, viewport);\n\n    // Intersection on the far-plane\n    unproject(b, vec3.set(c, x, y, 1), inverseViewProjectionMatrix, viewport);\n\n    out.set(a, 0);\n    out.set(b, 3);\n\n    return out;\n  }\n}\n","import { testCell } from '../common/gl-matrix-addon';\nimport Camera from './camera';\nimport ModelInstance from './modelinstance';\n\n/**\n * A grid cell.\n */\nexport default class Cell {\n  left: number;\n  right: number;\n  bottom: number;\n  top: number;\n  plane = -1;\n  instances: ModelInstance[] = [];\n  visible = false;\n\n  constructor(left: number, right: number, bottom: number, top: number) {\n    this.left = left;\n    this.right = right;\n    this.bottom = bottom;\n    this.top = top;\n  }\n\n  add(instance: ModelInstance): void {\n    this.instances.push(instance);\n  }\n\n  remove(instance: ModelInstance): void {\n    const index = this.instances.indexOf(instance);\n\n    this.instances.splice(index, 1);\n  }\n\n  /**\n   * Remove all of the instances from this cell.\n   */\n  clear(): void {\n    this.instances.length = 0;\n  }\n\n  isVisible(camera: Camera): boolean {\n    this.plane = testCell(camera.planes, this.left, this.right, this.bottom, this.top, this.plane);\n\n    return this.plane === -1;\n  }\n}\n","import Cell from './cell';\nimport ModelInstance from './modelinstance';\n\n/**\n * A grid.\n */\nexport default class Grid {\n  x: number;\n  y: number;\n  width: number;\n  depth: number;\n  cellWidth: number;\n  cellDepth: number;\n  columns: number;\n  rows: number;\n  cells: Cell[] = [];\n\n  constructor(x: number, y: number, width: number, depth: number, cellWidth: number, cellDepth: number) {\n    const columns = width / cellWidth;\n    const rows = depth / cellDepth;\n\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.depth = depth;\n    this.cellWidth = cellWidth;\n    this.cellDepth = cellDepth;\n    this.columns = columns;\n    this.rows = rows;\n\n    for (let row = 0; row < rows; row++) {\n      for (let column = 0; column < columns; column++) {\n        const left = x + column * cellWidth;\n        const right = left + cellWidth;\n        const bottom = y + row * cellDepth;\n        const top = bottom + cellDepth;\n\n        this.cells[row * columns + column] = new Cell(left, right, bottom, top);\n      }\n    }\n  }\n\n  add(instance: ModelInstance): void {\n    const cells = this.cells;\n    const columns = this.columns;\n    const left = instance.left;\n    const right = instance.right + 1;\n    const bottom = instance.bottom;\n    const top = instance.top + 1;\n\n    if (left !== -1) {\n      for (let y = bottom; y < top; y++) {\n        for (let x = left; x < right; x++) {\n          cells[y * columns + x].add(instance);\n        }\n      }\n    }\n  }\n\n  remove(instance: ModelInstance): void {\n    const cells = this.cells;\n    const columns = this.columns;\n    const left = instance.left;\n    const right = instance.right + 1;\n    const bottom = instance.bottom;\n    const top = instance.top + 1;\n\n    if (left !== -1) {\n      instance.left = -1;\n\n      for (let y = bottom; y < top; y++) {\n        for (let x = left; x < right; x++) {\n          cells[y * columns + x].remove(instance);\n        }\n      }\n    }\n  }\n\n  moved(instance: ModelInstance): void {\n    const cellWidth = this.cellWidth;\n    const cellDepth = this.cellDepth;\n    const bounds = instance.model.bounds;\n    const x = instance.worldLocation[0] + bounds.x - this.x;\n    const y = instance.worldLocation[1] + bounds.y - this.y;\n    const r = bounds.r;\n    const s = instance.worldScale;\n    let left = Math.floor((x - r * s[0]) / cellWidth);\n    let right = Math.floor((x + r * s[0]) / cellWidth);\n    let bottom = Math.floor((y - r * s[1]) / cellDepth);\n    let top = Math.floor((y + r * s[1]) / cellDepth);\n\n    if (right < 0 || left > this.columns - 1 || top < 0 || bottom > this.rows - 1) {\n      // The instance is outside of the grid, so remove it.\n      this.remove(instance);\n    } else {\n      // Clamp the values so they are in the grid.\n      left = Math.max(left, 0);\n      right = Math.min(right, this.columns - 1);\n      bottom = Math.max(bottom, 0);\n      top = Math.min(top, this.rows - 1);\n\n      // If the values actually changed, update the cells.\n      if (left !== instance.left || right !== instance.right || bottom !== instance.bottom || top !== instance.top) {\n        /// TODO: This can be optimized by checking if there are shared cells.\n        ///       That can be done in precisely the same way as done a few lines above, i.e. simple rectangle intersection.\n        this.remove(instance);\n\n        instance.left = left;\n        instance.right = right;\n        instance.bottom = bottom;\n        instance.top = top;\n\n        this.add(instance);\n      }\n    }\n  }\n\n  /**\n   * Removes all of the instances from this grid.\n   */\n  clear(): void {\n    for (const cell of this.cells) {\n      cell.clear();\n    }\n  }\n}\n","import EmittedObject from './emittedobject';\n\n/**\n * An emitted object updater.\n */\nexport default class EmittedObjectUpdater {\n  objects: EmittedObject[] = [];\n  alive = 0;\n\n  add(object: EmittedObject): void {\n    this.objects[this.alive++] = object;\n  }\n\n  update(dt: number): void {\n    const objects = this.objects;\n\n    for (let i = 0; i < this.alive; i++) {\n      const object = objects[i];\n\n      object.update(dt * object.emitter.instance.timeScale);\n\n      if (object.health <= 0) {\n        this.alive -= 1;\n\n        object.emitter.kill(object);\n\n        // Swap between this object and the last living object.\n        // Decrement the iterator so the swapped object is updated this frame.\n        if (i !== this.alive) {\n          objects[i] = objects[this.alive];\n          i -= 1;\n        }\n      }\n    }\n  }\n}\n","import { vec3, vec4 } from 'gl-matrix';\nimport ModelViewer from './viewer';\nimport Camera from './camera';\nimport Grid from './grid';\nimport ModelInstance from './modelinstance';\nimport EmittedObjectUpdater from './emittedobjectupdater';\n\n/**\n * A scene.\n *\n * Every scene has its own list of model instances, and its own camera and viewport.\n *\n * In addition, every scene may have its own AudioContext if enableAudio() is called.\n * If audio is enabled, the AudioContext's listener's location will be updated automatically.\n * Note that due to browser policies, this may be done only after user interaction with the web page.\n */\nexport default class Scene {\n  viewer: ModelViewer;\n  camera = new Camera();\n  grid = new Grid(-100000, -100000, 200000, 200000, 200000, 200000);\n  visibleCells = 0;\n  visibleInstances = 0;\n  updatedParticles = 0;\n  audioEnabled = false;\n  audioContext: AudioContext | null = null;\n  instances: ModelInstance[] = [];\n  emittedObjectUpdater = new EmittedObjectUpdater();\n  /**\n   * Similar to WebGL's own `alpha` parameter.\n   * \n   * If false, the scene will be cleared before rendering, meaning that scenes behind it won't be visible through it.\n   * \n   * If true, alpha works as usual.\n   */\n  alpha = false;\n  /**\n   * The scene's background color.\n   * \n   * Only used if `alpha` is false.\n   */\n  color = vec3.create();\n  /**\n   * The area on the canvas in which this scene is rendered.\n   * \n   * Defaults to the entire canvas.\n   * \n   * The vector defines [x, y, width, height], sizes are in pixels, and everything is related to the bottom left corner of the canvas.\n   */\n  viewport = vec4.create();\n  /**\n   * The position of the light that is used when rendering.\n   * \n   * Affects HD MDX and M3 models.\n   */\n  lightPosition = vec3.fromValues(0, 0, 10000);\n\n  constructor(viewer: ModelViewer) {\n    this.viewer = viewer;\n\n    const canvas = viewer.canvas;\n    const width = canvas.width;\n    const height = canvas.height;\n\n    // Use the whole canvas by default.\n    this.viewport[2] = width;\n    this.viewport[3] = height;\n\n    // And standard perspective projection.\n    this.camera.perspective(Math.PI / 4, width / height, 8, 10000);\n  }\n\n  /**\n   * Creates an AudioContext if one wasn't created already, and resumes it if needed.\n   * \n   * The returned promise will resolve to whether it is actually running or not.\n   * \n   * It may stay in suspended state indefinitly until the user interacts with the page, due to browser policies.\n   */\n  async enableAudio(): Promise<boolean> {\n    if (typeof AudioContext === 'function') {\n      if (!this.audioContext) {\n        this.audioContext = new AudioContext();\n      }\n\n      if (this.audioContext.state !== 'suspended') {\n        await this.audioContext.resume();\n      }\n\n      this.audioEnabled = this.audioContext.state === 'running';\n\n      return this.audioEnabled;\n    }\n\n    return false;\n  }\n\n  /**\n   * Suspend the audio context.\n   */\n  disableAudio(): void {\n    if (this.audioContext) {\n      this.audioContext.suspend();\n    }\n\n    this.audioEnabled = false;\n  }\n\n  /**\n   * Sets the scene of the given instance.\n   * \n   * Equivalent to instance.setScene(scene).\n   */\n  addInstance(instance: ModelInstance): boolean {\n    if (instance.scene !== this) {\n      if (instance.scene) {\n        instance.scene.removeInstance(instance);\n      }\n\n      instance.scene = this;\n\n      this.grid.moved(instance);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Remove the given instance from this scene.\n   * \n   * Equivalent to ModelInstance.detach().\n   */\n  removeInstance(instance: ModelInstance): boolean {\n    if (instance.scene === this) {\n      this.grid.remove(instance);\n\n      instance.scene = null;\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Clear this scene.\n   */\n  clear(): void {\n    // First remove references to this scene stored in the instances.\n    for (const cell of this.grid.cells) {\n      for (const instance of cell.instances) {\n        instance.scene = null;\n      }\n    }\n\n    // Then remove references to the instances.\n    this.grid.clear();\n  }\n\n  /**\n   * Detach this scene from the viewer.\n   * \n   * Equivalent to viewer.removeScene(scene).\n   */\n  detach(): boolean {\n    if (this.viewer) {\n      return this.viewer.removeScene(this);\n    }\n\n    return false;\n  }\n\n  /**\n   * Update this scene.\n   */\n  update(dt: number): void {\n    const camera = this.camera;\n\n    // Update the audio context's position if it exists.\n    if (this.audioContext) {\n      const listener = this.audioContext.listener;\n      const position = camera.location;\n      const forward = camera.directionY;\n      const up = camera.directionZ;\n\n      listener.positionX.value = -position[0];\n      listener.positionY.value = -position[1];\n      listener.positionZ.value = -position[2];\n\n      listener.forwardX.value = forward[0];\n      listener.forwardY.value = forward[1];\n      listener.forwardZ.value = forward[2];\n\n      listener.upX.value = up[0];\n      listener.upY.value = up[1];\n      listener.upZ.value = up[2];\n    }\n\n    const frame = this.viewer.frame;\n    const instances = this.instances;\n\n    this.visibleCells = 0;\n    this.visibleInstances = 0;\n\n    // Update and collect all of the visible instances.\n    for (const cell of this.grid.cells) {\n      if (cell.isVisible(camera)) {\n        this.visibleCells += 1;\n\n        for (const instance of cell.instances) {\n          // If an instance is rendered, wasn't updated on this frame, and has no parent, update it.\n          // If the instance is visible, it will be updated, all of its children will be updated, and it will be added to the render list.\n          // Note that the update frame is needed because instances can exist in any number of cells at the same time.\n          if (instance.rendered && instance.updateFrame < frame && !instance.parent) {\n            instance.updateFrame = frame;\n            instance.update(dt);\n          }\n        }\n      }\n    }\n\n    // Sort the visible instances based on depth.\n    instances.length = this.visibleInstances;\n    instances.sort((a, b) => a.depth - b.depth);\n\n    this.emittedObjectUpdater.update(dt);\n    this.updatedParticles = this.emittedObjectUpdater.alive;\n  }\n\n  renderInstance(instance: ModelInstance): void {\n    this.instances[this.visibleInstances++] = instance;\n  }\n\n  /**\n   * Use the scene's viewport.\n   * \n   * Should be called before `renderOpaque()` and `renderTranslucent()`.\n   * \n   * Called automatically by `render()`.\n   */\n  startFrame(): void {\n    const gl = this.viewer.gl;\n    const viewport = this.viewport;\n\n    // Set the viewport.\n    gl.viewport(viewport[0], viewport[1], viewport[2], viewport[3]);\n\n    // Allow to render only in the viewport.\n    gl.scissor(viewport[0], viewport[1], viewport[2], viewport[3]);\n\n    // If this scene doesn't want alpha, clear it.\n    if (!this.alpha) {\n      const color = this.color;\n\n      gl.depthMask(true);\n      gl.clearColor(color[0], color[1], color[2], 1);\n      gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    }\n  }\n\n  /**\n   * Render opaque things in this scene.\n   * \n   * They are rendered front to back.\n   */\n  renderOpaque(): void {\n    const instances = this.instances;\n\n    for (let i = 0, l = instances.length; i < l; i++) {\n      instances[i].renderOpaque();\n    }\n  }\n\n  /**\n   * Renders translucent things in this scene.\n   * \n   * They are rendered back to front.\n   */\n  renderTranslucent(): void {\n    const instances = this.instances;\n\n    for (let i = instances.length - 1; i >= 0; i--) {\n      instances[i].renderTranslucent();\n    }\n  }\n\n  /**\n   * Render this scene.\n   */\n  render(): void {\n    this.startFrame();\n    this.renderOpaque();\n    this.renderTranslucent();\n  }\n\n  /**\n   * Clear all of the emitted objects in this scene.\n   */\n  clearEmittedObjects(): void {\n    for (const object of this.emittedObjectUpdater.objects) {\n      object.health = 0;\n    }\n  }\n}\n","import ModelViewer from './viewer';\n\n/**\n * The data sent to every resource as a part of the loading process.\n */\nexport type ResourceData = { viewer: ModelViewer, fetchUrl: string };\n\n/**\n * A viewer resource.\n * \n * Generally speaking resources are created via viewer.load(), or viewer.loadGeneric().\n */\nexport abstract class Resource {\n  viewer: ModelViewer;\n  fetchUrl: string;\n  blockers: Promise<Resource | undefined>[] = [];\n\n  constructor(resourceData: ResourceData) {\n    this.viewer = resourceData.viewer;\n    this.fetchUrl = resourceData.fetchUrl;\n  }\n\n  /**\n   * Remove this resource from its viewer's cache.\n   * \n   * Equivalent to viewer.unload(resource).\n   */\n  detach(): boolean {\n    return this.viewer.unload(this);\n  }\n}\n","import { Resource, ResourceData } from './resource';\n\n/**\n * A generic resource.\n */\nexport default class GenericResource extends Resource {\n  data: unknown = null;\n\n  constructor(data: unknown, resourceData: ResourceData) {\n    super(resourceData);\n\n    this.data = data;\n  }\n}\n","import { ResourceData, Resource } from './resource';\n\n\nexport type SolverParams ={[key: string]: unknown };\n\n/**\n * A path solver used for resolving fetch paths.\n */\nexport type PathSolver = (src: unknown, params?: SolverParams) => unknown;\n\n/**\n * The data sent to every handler resource as part of the loading process.\n */\nexport type HandlerResourceData = ResourceData & { pathSolver?: PathSolver };\n\n/**\n * A viewer handler resource.\n * \n * Generally speaking handler resources are created via viewer.load().\n */\nexport abstract class HandlerResource extends Resource {\n  pathSolver?: PathSolver;\n\n  constructor(resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    this.pathSolver = resourceData.pathSolver;\n  }\n}\n","import { HandlerResource } from './handlerresource';\n\n/**\n * A texture.\n */\nexport default abstract class Texture extends HandlerResource {\n  webglResource: WebGLTexture | null = null;\n  width = 0;\n  height = 0;\n}\n","import { isPowerOfTwo } from '../common/math';\nimport { isGif, isJpeg, isPng, isWebP } from '../common/isformat';\nimport Texture from './texture';\nimport { HandlerResourceData } from './handlerresource';\n\n/**\n * Checks if the given source is a supported image texture source.\n */\nexport function isImageSource(src: unknown): boolean {\n  return src instanceof ImageData || src instanceof HTMLImageElement || src instanceof HTMLCanvasElement || src instanceof HTMLVideoElement;\n}\n\n/**\n * Detects whether the given buffer is a supported format, and if so returns the mime.\n * The supported formats are PNG, JPEG, GIF, and WebP.\n */\nexport function detectMime(buffer: Uint8Array): string {\n  if (isPng(buffer)) {\n    return 'image/png';\n  }\n\n  if (isJpeg(buffer)) {\n    return 'image/jpeg';\n  }\n\n  if (isGif(buffer)) {\n    return 'image/gif';\n  }\n\n  if (isWebP(buffer)) {\n    return 'image/webp';\n  }\n\n  return '';\n}\n\n/**\n * A texture handler for image sources.\n */\nexport class ImageTexture extends Texture {\n  constructor(src: TexImageSource, resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    const gl = this.viewer.gl;\n\n    this.webglResource = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, this.webglResource);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, src);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n    if (isPowerOfTwo(src.width) && isPowerOfTwo(src.height)) {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n      gl.generateMipmap(gl.TEXTURE_2D);\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      // Required for NPOT textures.\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    }\n\n    this.width = src.width;\n    this.height = src.height;\n  }\n}\n","import { EventEmitter } from 'events';\nimport { FetchDataTypeName, FetchDataType, FetchResult, fetchDataType } from '../common/fetchdatatype';\nimport WebGL from './gl/gl';\nimport Scene from './scene';\nimport { Resource } from './resource';\nimport { PathSolver, HandlerResourceData, HandlerResource, SolverParams } from './handlerresource';\nimport GenericResource from './genericresource';\nimport ClientBuffer from './gl/clientbuffer';\nimport { isImageSource, ImageTexture, detectMime } from './imagetexture';\nimport { blobToImage } from '../common/canvas';\n\nexport enum DebugRenderMode {\n  None,\n  Diffuse,\n  NormalMap,\n  Occlusion,\n  Roughness,\n  Metallic,\n  TCFactor,\n  Emissive,\n  TexCoords,\n  Normals,\n  Tangents,\n}\n\n/**\n * A viewer handler.\n */\nexport interface Handler {\n  load?: (viewer: ModelViewer, ...args: any[]) => void;\n  isValidSource: (src: unknown) => boolean;\n  resource: new (src: any, resourceData: HandlerResourceData) => HandlerResource\n}\n\n/**\n * A model viewer.\n */\nexport default class ModelViewer extends EventEmitter {\n  /**\n   * The viewer's canvas.\n   */\n  canvas: HTMLCanvasElement;\n  /**\n   * The viewer's WebGL context.\n   */\n  gl: WebGLRenderingContext;\n  /**\n   * A wrapper around the viewer's WebGL context with utility functions.\n   */\n  webgl: WebGL;\n  /**\n   * All of the loaded resources.\n   */\n  resources: Resource[] = [];\n  /**\n   * A map from urls to their resources.\n   * \n   * Only used by fetched resources.\n   */\n  resourceMap: Map<string, Resource> = new Map();\n  /**\n   * A map from urls to the promises that load them.\n   * \n   * Only used by fetched resources.\n   */\n  promiseMap: Map<string, Promise<Resource | undefined>> = new Map();\n  /**\n   * The viewer's handlers, added with `addHandler()`.\n   */\n  handlers: Set<Handler> = new Set();\n  /**\n   * The viewer's scenes, added with `addScene()`.\n   */\n  scenes: Scene[] = [];\n  /**\n   * The current frame.\n   */\n  frame = 0;\n  /**\n   * The number of visible cells on the current frame.\n   */\n  visibleCells = 0;\n  /**\n   * The number of visible instances on the current frame.\n   */\n  visibleInstances = 0;\n  /**\n   * The number of particles being updated on the current frame.\n   */\n  updatedParticles = 0;\n  /**\n   * A viewer-wide flag.\n   * \n   * If it is false, not only will audio not run, but in fact audio files won't even be fetched in the first place.\n   * \n   * If audio is desired, this should be set to true before loading models that use audio.\n   * \n   * Note that it is preferable to call enableAudio(), which checks for the existence of AudioContext.\n   */\n  audioEnabled = false;\n  /**\n   * A resizeable buffer that can be used by any part of the library.\n   * \n   * The data it contains is temporary, and can be overwritten at any time.\n   */\n  buffer: ClientBuffer;\n  /**\n   * A cache of arbitrary data, shared between all of the handlers.\n   */\n  sharedCache: Map<unknown, unknown> = new Map();\n  /**\n   * Debug rendering mode.\n   * \n   * How it affects the rendering ultimately depends on the handlers.\n   */\n  debugRenderMode = DebugRenderMode.None;\n\n  directLoadId = 0;\n\n  constructor(canvas: HTMLCanvasElement, options?: WebGLContextAttributes) {\n    super();\n\n    const webgl = new WebGL(canvas, options);\n    const gl = webgl.gl;\n\n    this.canvas = canvas;\n    this.gl = gl;\n    this.webgl = webgl;\n    this.buffer = webgl.createClientBuffer();\n\n    // The only initial setup, the rest should be handled by the handlers.\n    gl.depthFunc(gl.LEQUAL);\n    gl.enable(gl.DEPTH_TEST);\n    gl.enable(gl.SCISSOR_TEST);\n  }\n\n  /**\n   * Enable audio if AudioContext is available.\n   */\n  enableAudio(): boolean {\n    if (typeof AudioContext === 'function') {\n      this.audioEnabled = true;\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Add an handler.\n   */\n  addHandler(handler: Handler, ...args: unknown[]): boolean {\n    if (handler) {\n      const handlers = this.handlers;\n\n      // Check to see if this handler was added already.\n      if (!handlers.has(handler)) {\n        if (!handler.isValidSource) {\n          this.emit('error', { viewer: this, error: 'Handler missing the isValidSource function', handler });\n          return false;\n        }\n\n        // Check if the handler has a loader, and if so load it.\n        if (handler.load) {\n          try {\n            handler.load(this, ...args);\n          } catch (e) {\n            this.emit('error', { viewer: this, error: `Handler failed to load`, handler, reason: e });\n\n            return false;\n          }\n        }\n\n        handlers.add(handler);\n\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Add a scene.\n   */\n  addScene(): Scene {\n    const scene = new Scene(this);\n\n    this.scenes.push(scene);\n\n    return scene;\n  }\n\n  /**\n   * Remove a scene.\n   */\n  removeScene(scene: Scene): boolean {\n    const scenes = this.scenes;\n    const index = scenes.indexOf(scene);\n\n    if (index !== -1) {\n      scenes.splice(index, 1);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Removes all of the scenes in the viewer.\n   */\n  clear(): void {\n    this.scenes.length = 0;\n  }\n\n  /**\n   * Given a source and an optional path solver, loads a resource and returns a promise to it.\n   */\n  async load(src: unknown, pathSolver?: PathSolver, solverParams?: SolverParams): Promise<Resource | undefined> {\n    let finalSrc: unknown;\n    let fetchUrl = '';\n    let promise;\n\n    // Run the path solver if there is one.\n    if (pathSolver) {\n      try {\n        finalSrc = pathSolver(src, solverParams);\n      } catch (e) {\n        this.emit('error', { viewer: this, error: `Path solver failed`, src, reason: e, pathSolver, solverParams });\n\n        return;\n      }\n    } else {\n      finalSrc = src;\n    }\n\n    if (!finalSrc) {\n      return;\n    }\n\n    // Allow path solvers to return promises.\n    if (finalSrc instanceof Promise) {\n      finalSrc = await finalSrc;\n    }\n\n    // Give path solvers the option to inject resources.\n    if (finalSrc instanceof Resource) {\n      return finalSrc;\n    }\n\n    // If the final source is a string, and doesn't match any handler, it is assumed to be an URL to fetch.\n    if (typeof finalSrc === 'string' && !this.detectFormat(finalSrc)) {\n      fetchUrl = finalSrc;\n\n      // Check the promise cache and return a promise if one exists.\n      promise = this.promiseMap.get(fetchUrl);\n      if (promise) {\n        return promise;\n      }\n\n      // Check the fetch cache and return a resource if one exists.\n      const resource = this.resourceMap.get(fetchUrl);\n      if (resource) {\n        return resource;\n      }\n\n      // Otherwise promise to fetch the data and construct a resource.\n      promise = fetchDataType(fetchUrl, 'arrayBuffer')\n        .then((value) => {\n          if (value.ok) {\n            return value.data;\n          } else {\n            this.emit('error', { viewer: this, error: `Failed to fetch a resource: ${value.error}`, fetchUrl, reason: value.data });\n            return;\n          }\n        });\n    } else {\n      fetchUrl = `__DIRECT_LOAD_${this.directLoadId++}`;\n      promise = Promise.resolve(finalSrc);\n    }\n\n    promise = promise\n      .then(async (actualSrc) => {\n        // finalSrc will be undefined if this is a fetch and the fetch failed.\n        if (actualSrc) {\n          if (actualSrc instanceof ArrayBuffer) {\n            actualSrc = new Uint8Array(actualSrc);\n          }\n\n          // If the source is an image source, load it directly.\n          if (isImageSource(actualSrc)) {\n            return new ImageTexture(<TexImageSource>actualSrc, { viewer: this, fetchUrl, pathSolver });\n          }\n\n          // If the source is a buffer of an image, convert it to an image, and load it directly.\n          if (actualSrc instanceof Uint8Array) {\n            const type = detectMime(actualSrc);\n\n            if (type.length) {\n              return new ImageTexture(await blobToImage(new Blob([actualSrc.buffer], { type })), { viewer: this, fetchUrl, pathSolver });\n            }\n          }\n\n          // Attempt to match the source to a handler.\n          const handler = this.detectFormat(actualSrc);\n\n          if (handler) {\n            try {\n              const resource = new handler.resource(actualSrc, { viewer: this, fetchUrl, pathSolver });\n\n              // If the resource is blocked by internal resources being loaded, wait for them and then clear them.\n              await Promise.all(resource.blockers);\n              resource.blockers.length = 0;\n\n              return resource;\n            } catch (e) {\n              this.emit('error', { viewer: this, error: 'Failed to create a resource', fetchUrl, src, reason: e });\n            }\n          } else {\n            this.emit('error', { viewer: this, error: 'Source has no matching handler', fetchUrl, src });\n          }\n        }\n\n        return;\n      })\n      .then((resource) => {\n        this.promiseMap.delete(fetchUrl);\n\n        if (resource) {\n          this.resourceMap.set(fetchUrl, resource);\n          this.resources.push(resource);\n\n          this.emit('load', { viewer: this, fetchUrl, resource });\n        }\n\n        this.emit('loadend', { viewer: this, fetchUrl, resource });\n        this.checkLoadingStatus();\n\n        return resource;\n      });\n\n    this.promiseMap.set(fetchUrl, promise);\n    this.emit('loadstart', { viewer: this, fetchUrl, promise });\n\n    return promise;\n  }\n\n  detectFormat(src: unknown): Handler | undefined {\n    for (const handler of this.handlers) {\n      if (handler.isValidSource(src)) {\n        return handler;\n      }\n    }\n\n    return;\n  }\n\n  /**\n   * Check whether the given string maps to a resource in the cache.\n   */\n  has(key: string): boolean {\n    return this.resourceMap.has(key);\n  }\n\n  /**\n   * Get a resource from the cache.\n   */\n  get(key: string): Resource | undefined {\n    return this.resourceMap.get(key);\n  }\n\n  /**\n   * Load something generic.\n   * \n   * Unlike load(), this does not use handlers or construct any internal objects.\n   * \n   * `dataType` can be one of: `\"image\"`, `\"string\"`, `\"arrayBuffer\"`, `\"bytes\"`, `\"blob\"`.\n   * \n   * If `callback` isn't given, the resource's `data` is the fetch data, according to `dataType`.\n   * \n   * If `callback` is given, the resource's `data` is the value returned by it when called with the fetch data.\n   * \n   * If `callback` returns a promise, the resource's `data` will be whatever the promise resolved to.\n   */\n  async loadGeneric(fetchUrl: string, dataType: FetchDataTypeName, callback?: (data: FetchDataType) => unknown): Promise<GenericResource | undefined> {\n    // Check the promise cache and return a promise if one exists.\n    const promise = this.promiseMap.get(fetchUrl);\n    if (promise) {\n      return <Promise<GenericResource>>promise;\n    }\n\n    // Check the fetch cache and return a resource if one exists.\n    const resource = this.resourceMap.get(fetchUrl);\n    if (resource) {\n      return <GenericResource>resource;\n    }\n\n    const fetchPromise = fetchDataType(fetchUrl, dataType)\n      .then(async (value: FetchResult) => {\n        // Once the resource finished loading (successfully or not), the promise can be removed from the promise cache.\n        this.promiseMap.delete(fetchUrl);\n\n        let resource;\n\n        if (value.ok) {\n          let data: unknown = value.data;\n\n          if (callback) {\n            data = await callback(<FetchDataType>data);\n          }\n\n          resource = new GenericResource(data, { viewer: this, fetchUrl });\n\n          this.resourceMap.set(fetchUrl, resource);\n          this.resources.push(resource);\n\n          this.emit('load', { viewer: this, fetchUrl, resource });\n        } else {\n          this.emit('error', { viewer: this, error: 'Failed to fetch a generic resource', fetchUrl });\n        }\n\n        this.emit('loadend', { viewer: this, fetchUrl, resource });\n        this.checkLoadingStatus();\n\n        return resource;\n      });\n\n    this.promiseMap.set(fetchUrl, fetchPromise);\n    this.emit('loadstart', { viewer: this, fetchUrl });\n\n    return fetchPromise;\n  }\n\n  /**\n   * Unload a resource.\n   * Note that this only removes the resource from the viewer's cache.\n   * If it's being referenced and used e.g. by a scene, it will not be garbage collected.\n   */\n  unload(resource: Resource): boolean {\n    const fetchUrl = resource.fetchUrl;\n\n    if (fetchUrl !== '') {\n      this.resourceMap.delete(fetchUrl);\n    }\n\n    const resources = this.resources;\n    const index = resources.indexOf(resource);\n\n    if (index !== -1) {\n      resources.splice(index, 1);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Starts loading a new empty resource, and returns it.\n   * This empty resource will block the \"idle\" event (and thus whenAllLoaded) until it's resolved.\n   * This is used when a resource might get loaded in the future, but it is not known what it is yet.\n   */\n  promise(): () => void {\n    const promise = Promise.resolve(undefined);\n    const key = `${performance.now()}`;\n\n    this.promiseMap.set(key, promise);\n\n    return (): void => {\n      this.promiseMap.delete(key);\n      this.checkLoadingStatus();\n    };\n  }\n\n  checkLoadingStatus(): void {\n    if (this.promiseMap.size === 0) {\n      // A timeout is used so that this event will arrive after the current frame to let everything settle.\n      setTimeout(() => this.emit('idle'), 0);\n    }\n  }\n\n  /**\n   * Wait for all of the resources to load.\n   * \n   * If a callback is given, it will be called, otherwise, a promise is returned.\n   */\n  whenAllLoaded(): Promise<ModelViewer>;\n  whenAllLoaded(callback: (viewer: ModelViewer) => void): void;\n  whenAllLoaded(callback?: (viewer: ModelViewer) => void): Promise<ModelViewer> | void {\n    const promise = new Promise((resolve: (viewer: ModelViewer) => void) => {\n      if (this.promiseMap.size === 0) {\n        resolve(this);\n      } else {\n        this.once('idle', () => resolve(this));\n      }\n    });\n\n    if (callback) {\n      promise.then(() => callback(this));\n    } else {\n      return promise;\n    }\n  }\n\n  /**\n   * Get a blob representing the contents of the viewer's canvas.\n   * \n   * If a callback is given, it will be called, otherwise, a promise is returned.\n   */\n  toBlob(): Promise<Blob>; \n  toBlob(callback: BlobCallback): void;\n  toBlob(callback?: BlobCallback): Promise<Blob | null> | void {\n    const promise = new Promise((resolve: BlobCallback) => this.canvas.toBlob((blob) => resolve(blob)));\n\n    if (callback) {\n      promise.then((blob) => callback(blob));\n    } else {\n      return promise;\n    }\n  }\n\n  /**\n   * Update and render a frame.\n   */\n  updateAndRender(dt = 1000 / 60): void {\n    this.update(dt);\n    this.startFrame();\n    this.render();\n  }\n\n  /**\n   * Update all of the scenes, which includes updating their cameras, audio context if one exists, and all of the instances they hold.\n   */\n  update(dt = 1000 / 60): void {\n    // Animations are in milliseconds, while particle movement and such is in seconds.\n    // It's easier to pass the time in seconds here, and turn it back to milliseconds for each instance, than it is to do the opposite for each particle.\n    dt *= 0.001;\n\n    this.frame += 1;\n\n    this.visibleCells = 0;\n    this.visibleInstances = 0;\n    this.updatedParticles = 0;\n\n    for (const scene of this.scenes) {\n      scene.update(dt);\n\n      this.visibleCells += scene.visibleCells;\n      this.visibleInstances += scene.visibleInstances;\n      this.updatedParticles += scene.updatedParticles;\n    }\n  }\n\n  /**\n   * Clears the WebGL buffer.\n   * \n   * Called automatically by updateAndRender().\n   * \n   * Call this at some point before render() if you need more control.\n   */\n  startFrame(): void {\n    const gl = this.gl;\n\n    // See https://www.opengl.org/wiki/FAQ#Masking\n    gl.depthMask(true);\n    gl.clearColor(0, 0, 0, 1);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n  }\n\n  /**\n   * Render.\n   */\n  render(): void {\n    for (const scene of this.scenes) {\n      scene.render();\n    }\n  }\n\n  /**\n   * Clear all of the emitted objects in this viewer.\n   */\n  clearEmittedObjects(): void {\n    for (const scene of this.scenes) {\n      scene.clearEmittedObjects();\n    }\n  }\n}\n","import { vec3, quat, mat4 } from 'gl-matrix';\nimport { VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT, quatLookAt } from '../common/gl-matrix-addon';\nimport { SkeletalNode } from './skeletalnode';\n\nconst locationHeap = vec3.create();\nconst rotationHeap = quat.create();\nconst scalingHeap = vec3.create();\n\n/**\n * A node.\n */\nexport class Node {\n  pivot = vec3.create();\n  localLocation = vec3.create();\n  localRotation = quat.create();\n  localScale = vec3.fromValues(1, 1, 1);\n  worldLocation = vec3.create();\n  worldRotation = quat.create();\n  worldScale = vec3.fromValues(1, 1, 1);\n  inverseWorldLocation = vec3.create();\n  inverseWorldRotation = quat.create();\n  inverseWorldScale = vec3.fromValues(1, 1, 1);\n  localMatrix = mat4.create();\n  worldMatrix = mat4.create();\n  dontInheritTranslation = false;\n  dontInheritRotation = false;\n  dontInheritScaling = true;\n  parent: Node | SkeletalNode | null = null;\n  children: Node[] = [];\n\n  /**\n   * Sets the node's pivot.\n   */\n  setPivot(pivot: vec3): this {\n    vec3.copy(this.pivot, pivot);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local location.\n   */\n  setLocation(location: vec3): this {\n    vec3.copy(this.localLocation, location);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local rotation.\n   */\n  setRotation(rotation: quat): this {\n    quat.copy(this.localRotation, rotation);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local scale.\n   */\n  setScale(varying: vec3): this {\n    vec3.copy(this.localScale, varying);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local scale uniformly.\n   */\n  setUniformScale(uniform: number): this {\n    vec3.set(this.localScale, uniform, uniform, uniform);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local location, rotation, and scale.\n   */\n  setTransformation(location: vec3, rotation: quat, scale: vec3): this {\n    const localLocation = this.localLocation;\n    const localRotation = this.localRotation;\n    const localScale = this.localScale;\n\n    localLocation[0] = location[0];\n    localLocation[1] = location[1];\n    localLocation[2] = location[2];\n    // vec3.copy(this.localLocation, location);\n\n    localRotation[0] = rotation[0];\n    localRotation[1] = rotation[1];\n    localRotation[2] = rotation[2];\n    localRotation[3] = rotation[3];\n    // quat.copy(this.localRotation, rotation);\n\n    localScale[0] = scale[0];\n    localScale[1] = scale[1];\n    localScale[2] = scale[2];\n    // vec3.copy(this.localScale, scale);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Resets the node's local location, pivot, rotation, and scale, to the default values.\n   */\n  resetTransformation(): this {\n    vec3.copy(this.pivot, VEC3_ZERO);\n    vec3.copy(this.localLocation, VEC3_ZERO);\n    quat.copy(this.localRotation, QUAT_DEFAULT);\n    vec3.copy(this.localScale, VEC3_ONE);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Moves the node's pivot.\n   */\n  movePivot(offset: vec3): this {\n    vec3.add(this.pivot, this.pivot, offset);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Moves the node's local location.\n   */\n  move(offset: vec3): this {\n    vec3.add(this.localLocation, this.localLocation, offset);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Rotates the node's local rotation in world space.\n   */\n  rotate(rotation: quat): this {\n    quat.mul(this.localRotation, this.localRotation, rotation);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Rotates the node's local rotation in local space.\n   */\n  rotateLocal(rotation: quat): this {\n    quat.mul(this.localRotation, rotation, this.localRotation);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Scales the node.\n   */\n  scale(scale: vec3): this {\n    vec3.mul(this.localScale, this.localScale, scale);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Scales the node uniformly.\n   */\n  uniformScale(scale: number): this {\n    vec3.scale(this.localScale, this.localScale, scale);\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  face(to: vec3, worldUp: vec3): this {\n    quat.conjugate(this.localRotation, quatLookAt(this.localRotation, this.localLocation, to, worldUp));\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Sets the node's parent.\n   */\n  setParent(parent?: Node | SkeletalNode): this {\n    // If the node already had a parent, detach from it first.\n    if (this.parent) {\n      const children = this.parent.children;\n      const index = children.indexOf(this);\n\n      if (index !== -1) {\n        children.splice(index, 1);\n      }\n    }\n\n    this.parent = parent || null;\n\n    // If the new parent is an actual thing, add this node as a child.\n    if (parent) {\n      parent.children.push(this);\n    }\n\n    this.recalculateTransformation();\n\n    return this;\n  }\n\n  /**\n   * Recalculate this node's transformation data.\n   */\n  recalculateTransformation(): void {\n    const parent = this.parent;\n    const localMatrix = this.localMatrix;\n    const localLocation = this.localLocation;\n    const localRotation = this.localRotation;\n    const localScale = this.localScale;\n    const worldMatrix = this.worldMatrix;\n    const worldLocation = this.worldLocation;\n    const worldRotation = this.worldRotation;\n    const worldScale = this.worldScale;\n    const inverseWorldLocation = this.inverseWorldLocation;\n    const inverseWorldRotation = this.inverseWorldRotation;\n    const inverseWorldScale = this.inverseWorldScale;\n\n    if (parent) {\n      const computedLocation = locationHeap;\n      const parentPivot = parent.pivot;\n      let computedRotation;\n      let computedScaling;\n      \n      computedLocation[0] = localLocation[0] + parentPivot[0];\n      computedLocation[1] = localLocation[1] + parentPivot[1];\n      computedLocation[2] = localLocation[2] + parentPivot[2];\n      // vec3.add(computedLocation, localLocation, parentPivot);\n\n      // If this node shouldn't inherit the parent's rotation, rotate it by the inverse.\n      if (this.dontInheritRotation) {\n        computedRotation = rotationHeap;\n\n        quat.mul(computedRotation, localRotation, parent.inverseWorldRotation);\n      } else {\n        computedRotation = localRotation;\n      }\n\n      // If this node shouldn't inherit the parent's translation, translate it by the inverse.\n      // if (this.dontInheritTranslation) {\n      // mat4.translate(worldMatrix, worldMatrix, parent.inverseWorldLocation);\n      // }\n\n      if (this.dontInheritScaling) {\n        computedScaling = scalingHeap;\n\n        const parentInverseScale = parent.inverseWorldScale;\n        computedScaling[0] = parentInverseScale[0] * localScale[0];\n        computedScaling[1] = parentInverseScale[1] * localScale[1];\n        computedScaling[2] = parentInverseScale[2] * localScale[2];\n        // vec3.mul(computedScaling, parent.inverseWorldScale, localScale);\n\n        worldScale[0] = localScale[0];\n        worldScale[1] = localScale[1];\n        worldScale[2] = localScale[2];\n        // vec3.copy(worldScale, localScale);\n      } else {\n        computedScaling = localScale;\n\n        const parentScale = parent.worldScale;\n        worldScale[0] = parentScale[0] * localScale[0];\n        worldScale[1] = parentScale[1] * localScale[1];\n        worldScale[2] = parentScale[2] * localScale[2];\n        // vec3.mul(worldScale, parentScale, localScale);\n      }\n\n      mat4.fromRotationTranslationScale(localMatrix, computedRotation, computedLocation, computedScaling);\n\n      mat4.mul(worldMatrix, parent.worldMatrix, localMatrix);\n\n      quat.mul(worldRotation, parent.worldRotation, computedRotation);\n    } else {\n      // Local matrix\n      mat4.fromRotationTranslationScale(localMatrix, localRotation, localLocation, localScale);\n\n      // World matrix\n      worldMatrix[0] = localMatrix[0];\n      worldMatrix[1] = localMatrix[1];\n      worldMatrix[2] = localMatrix[2];\n      worldMatrix[3] = localMatrix[3];\n      worldMatrix[4] = localMatrix[4];\n      worldMatrix[5] = localMatrix[5];\n      worldMatrix[6] = localMatrix[6];\n      worldMatrix[7] = localMatrix[7];\n      worldMatrix[8] = localMatrix[8];\n      worldMatrix[9] = localMatrix[9];\n      worldMatrix[10] = localMatrix[10];\n      worldMatrix[11] = localMatrix[11];\n      worldMatrix[12] = localMatrix[12];\n      worldMatrix[13] = localMatrix[13];\n      worldMatrix[14] = localMatrix[14];\n      worldMatrix[15] = localMatrix[15];\n      // mat4.copy(worldMatrix, localMatrix);\n\n      // World rotation\n      worldRotation[0] = localRotation[0];\n      worldRotation[1] = localRotation[1];\n      worldRotation[2] = localRotation[2];\n      worldRotation[3] = localRotation[3];\n      // quat.copy(worldRotation, localRotation);\n\n      // World scale\n      worldScale[0] = localScale[0];\n      worldScale[1] = localScale[1];\n      worldScale[2] = localScale[2];\n      // vec3.copy(worldScale, localScale);\n    }\n\n    // Inverse world rotation\n    inverseWorldRotation[0] = -worldRotation[0];\n    inverseWorldRotation[1] = -worldRotation[1];\n    inverseWorldRotation[2] = -worldRotation[2];\n    inverseWorldRotation[3] = worldRotation[3];\n    // quat.conjugate(inverseWorldRotation, worldRotation);\n\n    // Inverse world scale\n    inverseWorldScale[0] = 1 / worldScale[0];\n    inverseWorldScale[1] = 1 / worldScale[1];\n    inverseWorldScale[2] = 1 / worldScale[2];\n    // vec3.inverse(this.inverseWorldScale, worldScale);\n\n    // World location\n    worldLocation[0] = worldMatrix[12];\n    worldLocation[1] = worldMatrix[13];\n    worldLocation[2] = worldMatrix[14];\n\n    // Inverse world location\n    inverseWorldLocation[0] = -worldLocation[0];\n    inverseWorldLocation[1] = -worldLocation[1];\n    inverseWorldLocation[2] = -worldLocation[2];\n    // vec3.negate(this.inverseWorldLocation, worldLocation);\n\n    for (const child of this.children) {\n      child.recalculateTransformation();\n    }\n  }\n\n  /**\n   * Update this node, and continue down the node hierarchy.\n   */\n  update(dt: number): void {\n    for (const child of this.children) {\n      child.update(dt);\n    }\n  }\n}\n","/**\n * An object representing both a sphere and an AABB, which is used for culling of all instances.\n * \n * By default, the size of the bounds is 0, and thus point-culling is done.\n */\nexport default class Bounds {\n  x = 0;\n  y = 0;\n  z = 0;\n  r = 0;\n\n  fromExtents(min: Float32Array, max: Float32Array): void {\n    const x = min[0];\n    const y = min[1];\n    const z = min[2];\n    const w = max[0] - x;\n    const d = max[1] - y;\n    const h = max[2] - z;\n\n    this.x = x + w / 2;\n    this.y = y + d / 2;\n    this.z = z + h / 2;\n\n    // Ensure the radius is actually 0 or bigger.\n    // Some models apparently have reversed extents, go figure.\n    this.r = Math.max(0, Math.max(w, d, h) / 2);\n  }\n}\n","import { HandlerResource } from './handlerresource';\nimport Bounds from './bounds';\nimport ModelInstance from './modelinstance';\n\n/**\n * A model.\n */\nexport default abstract class Model extends HandlerResource {\n  bounds = new Bounds();\n\n  /**\n   * Create a new instance and return it.\n   */\n  abstract addInstance(): ModelInstance;\n}\n","import { testSphere, distanceToPlane3 } from '../common/gl-matrix-addon';\nimport { Node } from './node';\nimport Model from './model';\nimport Scene from './scene';\nimport Camera from './camera';\nimport Texture from './texture';\nimport Bounds from './bounds';\n\n/**\n * A model instance.\n */\nexport default abstract class ModelInstance extends Node {\n  scene: Scene | null = null;\n  left = -1;\n  right = -1;\n  bottom = -1;\n  top = -1;\n  plane = -1;\n  depth = 0;\n  updateFrame = 0;\n  model: Model;\n  /**\n   * Allows to slow down or speed up animations of this instance, and any children.\n   */\n  timeScale = 1;\n  /**\n   * If false, this instance won't be rendered.\n   * \n   * When working with Warcraft 3 instances, it is preferable to use hide() and show().\n   * These hide and show also internal instances of this instance.\n   */\n  rendered = true;\n  textureOverrides: Map<number, Texture> = new Map();\n\n  constructor(model: Model) {\n    super();\n\n    this.model = model;\n  }\n\n  /**\n   * This instance should be shown.\n   */\n  show(): void {\n    this.rendered = true;\n  }\n\n  /**\n   * This instance should be hidden.\n   */\n  hide(): void {\n    this.rendered = false;\n  }\n\n  /**\n   * Should the instance be shown?\n   */\n  shown(): boolean {\n    return this.rendered;\n  }\n\n  /**\n   * Should the instance be hidden?\n   */\n  hidden(): boolean {\n    return !this.rendered;\n  }\n\n  /**\n   * Detach this instance from the scene it's in.\n   * \n   * Equivalent to scene.removeInstance(instance).\n   */\n  detach(): boolean {\n    if (this.scene) {\n      return this.scene.removeInstance(this);\n    }\n\n    return false;\n  }\n\n  overrideTexture(index: number, texture?: Texture): void {\n    if (texture) {\n      this.textureOverrides.set(index, texture);\n    } else {\n      this.textureOverrides.delete(index);\n    }\n  }\n\n  /**\n   * Called for instance culling.\n   */\n  getBounds(): Bounds {\n    return this.model.bounds;\n  }\n\n  /**\n   * Clears any objects that were emitted by this instance.\n   */\n  clearEmittedObjects(): void {\n\n  }\n\n  /**\n   * Sets the scene of this instance.\n   * \n   * This is equivalent to scene.addInstance(instance).\n   */\n  setScene(scene: Scene): boolean {\n    return scene.addInstance(this);\n  }\n\n  override recalculateTransformation(): void {\n    super.recalculateTransformation();\n\n    if (this.scene) {\n      this.scene.grid.moved(this);\n    }\n  }\n\n  override update(dt: number): void {\n    const scene = this.scene;\n\n    if (scene && this.rendered && this.isVisible(scene.camera)) {\n      // Add this instance to the render list.\n      scene.renderInstance(this);\n\n      // Update this instance.\n      this.updateAnimations(dt * this.timeScale);\n\n      // Update child nodes if there are any, such as instances parented to instances.\n      super.update(dt);\n    }\n  }\n\n  updateAnimations(_dt: number): void {\n\n  }\n\n  renderOpaque(): void {\n\n  }\n\n  renderTranslucent(): void {\n\n  }\n\n  isVisible(camera: Camera): boolean {\n    const [x, y, z] = this.worldLocation;\n    const [sx, sy, sz] = this.worldScale;\n    const bounds = this.getBounds();\n    const planes = camera.planes;\n    let biggest = sx;\n\n    // Get the biggest scaling dimension.\n    if (sy > biggest) {\n      biggest = sy;\n    }\n\n    if (sz > biggest) {\n      biggest = sz;\n    }\n\n    this.plane = testSphere(planes, x + bounds.x, y + bounds.y, z + bounds.z, bounds.r * biggest, this.plane);\n\n    if (this.plane === -1) {\n      this.depth = distanceToPlane3(planes[4], x, y, z);\n\n      return true;\n    }\n\n    return false;\n  }\n}\n","import WebGL from './gl';\nimport Shader from './shader';\nimport ClientBuffer from './clientbuffer';\nimport DataTexture from './datatexture';\nimport ClientDataTexture from './clientdatatexture';\n\nexport default {\n  WebGL,\n  Shader,\n  ClientBuffer,\n  DataTexture,\n  ClientDataTexture,\n};\n","import { BlpImage } from '../../../parsers/blp/image';\nimport isBlp from '../../../parsers/blp/isformat';\nimport Texture from './texture';\n\nexport default {\n  isValidSource(object: unknown): boolean {\n    if (object instanceof BlpImage) {\n      return true;\n    }\n\n    return isBlp(object);\n  },\n  resource: Texture,\n};\n","/**\n * Detects if the given object is a BLP source.\n */\nexport default function isBlp(bytes: unknown): boolean {\n  if (bytes instanceof ArrayBuffer) {\n    bytes = new Uint8Array(bytes);\n  }\n\n  if (bytes instanceof Uint8Array) {\n    if (bytes[0] === 0x42 && bytes[1] === 0x4c && bytes[2] === 0x50 && bytes[3] === 0x31) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","import { isPowerOfTwo } from '../../../common/math';\nimport { BlpImage } from '../../../parsers/blp/image';\nimport { HandlerResourceData } from '../../handlerresource';\nimport Texture from '../../texture';\n\n/**\n * A BLP texure handler.\n */\nexport default class BlpTexture extends Texture {\n  constructor(bufferOrImage: ArrayBuffer | BlpImage, resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    let image;\n\n    if (bufferOrImage instanceof BlpImage) {\n      image = bufferOrImage;\n    } else {\n      image = new BlpImage();\n\n      image.load(bufferOrImage);\n    }\n\n    const viewer = this.viewer;\n    const gl = viewer.gl;\n\n    const id = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, id);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n    const isPOT = isPowerOfTwo(image.width) && isPowerOfTwo(image.height);\n\n    if (!isPOT) {\n      // Required for NPOT textures.\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    }\n\n    const mipmaps = image.mipmaps();\n\n    // If there is one mipmap, or fake mipmaps, or it's an NPOT image, use just the first mipmap. Otherwise load all of them.\n    if (mipmaps === 1 || image.fakeMipmaps() || !isPOT) {\n      const imageData = image.getMipmap(0);\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n\n      let width = image.width;\n      let height = image.height;\n\n      for (let i = 0; i < mipmaps; i++) {\n        const imageData = image.getMipmap(i);\n\n        // Don't use the image data dimensions directly.\n        // Some JPG mipmaps out there have wrong sizes.\n        // For example the last two mipmaps being 2x1, which messes with GL.\n        gl.texImage2D(gl.TEXTURE_2D, i, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, imageData.data);\n\n        width = Math.ceil(width / 2);\n        height = Math.ceil(height / 2);\n      }\n    }\n\n    this.width = image.width;\n    this.height = image.height;\n    this.webglResource = id;\n  }\n}\n","import { DdsImage } from '../../../parsers/dds/image';\nimport isDds from '../../../parsers/dds/isformat';\nimport ModelViewer from '../../viewer';\nimport Texture from './texture';\n\nexport default {\n  load(viewer: ModelViewer): void {\n    const webgl = viewer.webgl;\n\n    // Optionally used when decoding mipmaps.\n    if (!webgl.ensureExtension('WEBGL_compressed_texture_s3tc')) {\n      console.warn('DDS: No compressed textures support! This might reduce performance.');\n    }\n  },\n  isValidSource(object: unknown): boolean {\n    if (object instanceof DdsImage) {\n      return true;\n    }\n\n    return isDds(object);\n  },\n  resource: Texture,\n};\n","import { DdsImage, FOURCC_DXT1, FOURCC_DXT3, FOURCC_DXT5, FOURCC_ATI2 } from '../../../parsers/dds/image';\nimport { HandlerResourceData } from '../../handlerresource';\nimport Texture from '../../texture';\n\n/**\n * A DDS texture handler.\n */\nexport default class DdsTexture extends Texture {\n  constructor(bufferOrImage: ArrayBuffer | DdsImage, resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    let image;\n\n    if (bufferOrImage instanceof DdsImage) {\n      image = bufferOrImage;\n    } else {\n      image = new DdsImage();\n\n      image.load(bufferOrImage);\n    }\n\n    const viewer = this.viewer;\n    const gl = viewer.gl;\n    const webgl = viewer.webgl;\n    const compressedTextures = <WEBGL_compressed_texture_s3tc>webgl.extensions['WEBGL_compressed_texture_s3tc'];\n    const format = image.format;\n    let internalFormat = 0;\n\n    if (compressedTextures) {\n      if (format === FOURCC_DXT1) {\n        internalFormat = compressedTextures.COMPRESSED_RGB_S3TC_DXT1_EXT;\n      } else if (format === FOURCC_DXT3) {\n        internalFormat = compressedTextures.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n      } else if (format === FOURCC_DXT5) {\n        internalFormat = compressedTextures.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n      }\n    }\n\n    const id = gl.createTexture();\n\n    this.width = image.width;\n    this.height = image.height;\n    this.webglResource = id;\n\n    gl.bindTexture(gl.TEXTURE_2D, id);\n\n    const mipmaps = image.mipmaps();\n\n    // DXT1 and ATI2 pixels are two bytes.\n    // This generally doesn't matter, however, when having 1x2 or 2x1 mipmaps, it does.\n    // Therefore set the proper alignment if needed.\n    if (format === FOURCC_DXT1 || format === FOURCC_ATI2) {\n      gl.pixelStorei(gl.UNPACK_ALIGNMENT, 2);\n    }\n\n    for (let i = 0; i < mipmaps; i++) {\n      // Let the GPU handle the compressed data if it supports it.\n      // Otherwise, decode the data on the client.\n      const { width, height, data } = image.getMipmap(i, internalFormat !== 0);\n\n      if (internalFormat) {\n        gl.compressedTexImage2D(gl.TEXTURE_2D, i, internalFormat, width, height, 0, data);\n      } else if (format === FOURCC_DXT1) {\n        gl.texImage2D(gl.TEXTURE_2D, i, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n      } else if (format === FOURCC_DXT3) {\n        gl.texImage2D(gl.TEXTURE_2D, i, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n      } else if (format === FOURCC_DXT5) {\n        gl.texImage2D(gl.TEXTURE_2D, i, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n      } else {\n        gl.texImage2D(gl.TEXTURE_2D, i, gl.LUMINANCE_ALPHA, width, height, 0, gl.LUMINANCE_ALPHA, gl.UNSIGNED_BYTE, data);\n      }\n    }\n\n    // Restore the alignment to the default, in case it changed.\n    gl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n    if (mipmaps > 1) {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    }\n  }\n}\n","import Texture from '../../texture';\n\n/**\n * An M3 texture.\n */\nexport default class M3Texture {\n  texture: Texture | null = null;\n  wrapS = 0x812f; // CLAMP_TO_EDGE\n  wrapT = 0x812f;\n\n  constructor(repeatS: boolean, repeatT: boolean) {\n    if (repeatS) {\n      this.wrapS = 0x2901; // REPEAT\n    }\n\n    if (repeatT) {\n      this.wrapT = 0x2901;\n    }\n  }\n}\n","import Reference from '../../../parsers/m3/reference';\nimport Layer from '../../../parsers/m3/layer';\nimport Texture from '../../texture';\nimport Shader from '../../gl/shader';\nimport { M3StandardMaterial, STANDARD_MATERIAL_OFFSET } from './standardmaterial';\nimport M3Model from './model';\nimport M3Texture from './texture';\n\nconst layerTypeToTextureUnit = {\n  diffuse: 1,\n  decal: 2,\n  specular: 3,\n  gloss: 4,\n  emissive: 5,\n  emissive2: 6,\n  evio: 7,\n  evioMask: 8,\n  alphaMask: 9,\n  alphaMask2: 10,\n  normal: 11,\n  heightMap: 12,\n  lightMap: 13,\n  ao: 14,\n};\n\n/**\n * An M3 layer.\n */\nexport default class M3Layer {\n  model: M3Model;\n  material: M3StandardMaterial;\n  index: number;\n  active = 0;\n  layer: Layer | null = null;\n  gl: WebGLRenderingContext;\n  uniformMap: { map: string; enabled: string; op: string; channels: string; teamColorMode: string; invert: string; clampResult: string; uvCoordinate: string; };\n  source = '';\n  texture: M3Texture | null = null;\n  flags = 0;\n  colorChannels = 0;\n  type = '';\n  op = 0;\n  uvCoordinate = 0;\n  textureUnit = 0;\n  invert = 0;\n  clampResult = 0;\n  teamColorMode = 0;\n\n  constructor(material: M3StandardMaterial, index: number, layerReference: Reference, type: string, op: number) {\n    const model = material.model;\n\n    this.model = model;\n    this.material = material;\n    this.gl = material.gl;\n    this.index = index;\n\n    const uniform = 'u_' + type;\n    const settings = uniform + 'LayerSettings.';\n\n    this.uniformMap = {\n      map: uniform + 'Map',\n      enabled: settings + 'enabled',\n      op: settings + 'op',\n      channels: settings + 'channels',\n      teamColorMode: settings + 'teamColorMode',\n      invert: settings + 'invert',\n      clampResult: settings + 'clampResult',\n      uvCoordinate: settings + 'uvCoordinate',\n    };\n\n    // Since Gloss doesn't exist in all versions\n    if (layerReference.entries) {\n      const layer = <Layer>layerReference.first();\n\n      this.layer = layer;\n\n      const pathSolver = model.pathSolver;\n\n      const path = layer.imagePath.get();\n\n      if (path) {\n        const source = (<string>path).toLowerCase();\n\n        if (source.length) {\n          this.source = source;\n          this.active = 1;\n\n          const uvSource = layer.uvSource;\n          const flags = layer.flags;\n\n          this.flags = flags;\n          this.colorChannels = layer.colorChannelSetting;\n\n          this.model = model;\n          this.type = type;\n          this.op = op;\n\n          let uvCoordinate = 0;\n\n          if (uvSource === 1) {\n            uvCoordinate = 1;\n          } else if (uvSource === 9) {\n            uvCoordinate = 2;\n          } else if (uvSource === 10) {\n            uvCoordinate = 3;\n          }\n\n          this.uvCoordinate = uvCoordinate;\n\n          this.textureUnit = layerTypeToTextureUnit[type];\n\n          this.invert = flags & 0x10;\n          this.clampResult = flags & 0x20;\n\n          // I am not sure if the emissive team color mode is even used, since so far combineColors takes care of it.\n          if (type === 'diffuse') {\n            this.teamColorMode = 1;\n          }\n\n          const m3Texture = new M3Texture(!!(flags & 0x4), !!(flags & 0x8));\n\n          model.viewer.load(source, pathSolver)\n            .then((texture) => {\n              if (texture) {\n                m3Texture.texture = <Texture>texture;\n              }\n            });\n\n          this.texture = m3Texture;\n        }\n      }\n    }\n  }\n\n  bind(shader: Shader, textureOverrides: Map<number, Texture>): void {\n    const gl = this.gl;\n    const uniformMap = this.uniformMap;\n    const uniforms = shader.uniforms;\n    const active = this.active;\n\n    gl.uniform1f(uniforms[uniformMap.enabled], active);\n\n    if (active) {\n      const m3Texture = <M3Texture>this.texture;\n      const texture = textureOverrides.get(this.material.index * STANDARD_MATERIAL_OFFSET + this.index) || m3Texture.texture;\n      const textureUnit = this.textureUnit;\n\n      gl.uniform1i(uniforms[uniformMap.map], textureUnit);\n\n      this.model.viewer.webgl.bindTextureAndWrap(texture, textureUnit, m3Texture.wrapS, m3Texture.wrapT);\n\n      gl.uniform1f(uniforms[uniformMap.op], this.op);\n      gl.uniform1f(uniforms[uniformMap.channels], this.colorChannels);\n      gl.uniform1f(uniforms[uniformMap.teamColorMode], this.teamColorMode);\n\n      // Alpha is probably unknown12. Can this be confirmed?\n      // Many of these flags seem to be incorrect\n      // gl.setParameter(uniform + 'multAddAlpha', [this.model.getValue(this.rgbMultiply, sequence, frame), this.model.getValue(this.rgbAdd, sequence, frame), 0]);\n      // gl.setParameter(uniform + 'useAlphaFactor', 0);\n\n      gl.uniform1f(uniforms[uniformMap.invert], this.invert);\n\n      // gl.setParameter(uniform + 'multColor', 0);\n      // gl.setParameter(uniform + 'addColor', 0);\n\n      gl.uniform1f(uniforms[uniformMap.clampResult], this.clampResult);\n\n      // gl.setParameter(uniform + 'useConstantColor', this.flags && 0x400);\n      // gl.setParameter(uniform + 'constantColor', this.model.getValue(this.color, sequence, frame));\n      // gl.setParameter(settings + 'uvSource', this.uvSource);\n\n      gl.uniform1f(uniforms[uniformMap.uvCoordinate], this.uvCoordinate);\n    }\n  }\n\n  unbind(shader: Shader): void {\n    if (this.active) {\n      this.gl.uniform1f(shader.uniforms[this.uniformMap.enabled], 0);\n    }\n  }\n}\n","import M3ParserStandardMaterial from '../../../parsers/m3/standardmaterial';\nimport Shader from '../../gl/shader';\nimport Texture from '../../texture';\nimport M3Model from './model';\nimport M3Layer from './layer';\n\n\nexport const STANDARD_MATERIAL_OFFSET = 100;\n\n/**\n * An M3 standard material.\n */\nexport class M3StandardMaterial {\n  model: M3Model;\n  gl: WebGLRenderingContext;\n  index: number;\n  name: string;\n  flags: number;\n  blendMode: number;\n  priority: number;\n  specularity: number;\n  specMult: number;\n  emisMult: number;\n  layerBlendType: number;\n  emisBlendType: number;\n  emisMode: number;\n  doubleSided: number;\n  layers: M3Layer[];\n\n  constructor(model: M3Model, index: number, material: M3ParserStandardMaterial) {\n    this.model = model;\n    this.gl = model.viewer.gl;\n    this.index = index;\n    this.name = <string>material.name.get();\n    this.flags = material.flags;\n    this.blendMode = material.blendMode;\n    this.priority = material.priority;\n    this.specularity = material.specularity;\n    this.specMult = material.specMult;\n    this.emisMult = material.emisMult;\n    this.layerBlendType = material.layerBlendType;\n    this.emisBlendType = material.emisBlendType;\n    this.emisMode = material.emisMode;\n    this.doubleSided = material.flags & 0x8;\n\n    this.layers = [\n      new M3Layer(this, 0, material.diffuseLayer, 'diffuse', 2),\n      new M3Layer(this, 1, material.decalLayer, 'decal', 2),\n      new M3Layer(this, 2, material.specularLayer, 'specular', 2),\n      new M3Layer(this, 3, material.glossLayer, 'gloss', 2),\n      new M3Layer(this, 4, material.emissiveLayer, 'emissive', material.emisBlendType),\n      new M3Layer(this, 5, material.emissive2Layer, 'emissive2', material.emisMode),\n      new M3Layer(this, 6, material.evioLayer, 'evio', 2),\n      new M3Layer(this, 7, material.evioMaskLayer, 'evioMask', 2),\n      new M3Layer(this, 8, material.alphaMaskLayer, 'alphaMask', 2),\n      new M3Layer(this, 9, material.alphaMask2Layer, 'alphaMask2', 2),\n      new M3Layer(this, 10, material.normalLayer, 'normal', 2),\n      new M3Layer(this, 11, material.heightLayer, 'heightMap', 2),\n      new M3Layer(this, 12, material.lightMapLayer, 'lightMap', 2),\n      new M3Layer(this, 13, material.ambientOcclusionLayer, 'ao', 2),\n    ];\n  }\n\n  bindCommon(): void {\n    const gl = this.gl;\n\n    if (this.blendMode === 1) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE);\n    } else if (this.blendMode === 2) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE);\n    } else {\n      gl.disable(gl.BLEND);\n    }\n\n    if (this.doubleSided) {\n      gl.disable(gl.CULL_FACE);\n    } else {\n      gl.enable(gl.CULL_FACE);\n    }\n\n    // Flags somewhere?\n    // Per layer?\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthMask(true);\n  }\n\n  bind(shader: Shader, textureOverrides: Map<number, Texture>): void {\n    const gl = this.gl;\n\n    this.bindCommon();\n\n    gl.uniform1f(shader.uniforms['u_specularity'], this.specularity);\n    gl.uniform1f(shader.uniforms['u_specMult'], this.specMult);\n    gl.uniform1f(shader.uniforms['u_emisMult'], this.emisMult);\n    gl.uniform4f(shader.uniforms['u_lightAmbient'], 0.02, 0.02, 0.02, 0);\n\n    const layers = this.layers;\n\n    layers[0].bind(shader, textureOverrides);\n    layers[1].bind(shader, textureOverrides);\n    layers[2].bind(shader, textureOverrides);\n    layers[4].bind(shader, textureOverrides);\n    layers[5].bind(shader, textureOverrides);\n    layers[10].bind(shader, textureOverrides);\n    layers[12].bind(shader, textureOverrides);\n  }\n\n  unbind(shader: Shader): void {\n    const gl = this.gl;\n\n    gl.disable(gl.BLEND);\n    gl.enable(gl.CULL_FACE);\n\n    const layers = this.layers;\n\n    layers[0].unbind(shader);\n    layers[1].unbind(shader);\n    layers[2].unbind(shader);\n    layers[4].unbind(shader);\n    layers[5].unbind(shader);\n    layers[10].unbind(shader);\n    layers[12].unbind(shader);\n  }\n}\n","import Bone from '../../../parsers/m3/bone';\nimport { Uint32AnimationReference, Vector3AnimationReference, Vector4AnimationReference } from '../../../parsers/m3/animationreference';\n\n/**\n * An M3 bone.\n */\nexport default class M3Bone {\n  name: string;\n  parent: number;\n  location: Vector3AnimationReference;\n  rotation: Vector4AnimationReference;\n  scale: Vector3AnimationReference;\n  visibility: Uint32AnimationReference;\n  inhertTranslation: number;\n  inheritScale: number;\n  inheritRotation: number;\n  billboard1: number;\n  billboard2: number;\n  twoDProjection: number;\n  animated: number;\n  inverseKinematics: number;\n  skinned: number;\n  real: number;\n\n  constructor(bone: Bone) {\n    const flags = bone.flags;\n\n    this.name = <string>bone.name.get();\n    this.parent = bone.parent;\n    this.location = bone.location;\n    this.rotation = bone.rotation;\n    this.scale = bone.scale;\n    this.visibility = bone.visibility;\n    this.inhertTranslation = flags & 0x1;\n    this.inheritScale = flags & 0x2;\n    this.inheritRotation = flags & 0x4;\n    this.billboard1 = flags & 0x10;\n    this.billboard2 = flags & 0x40;\n    this.twoDProjection = flags & 0x100;\n    this.animated = flags & 0x200;\n    this.inverseKinematics = flags & 0x400;\n    this.skinned = flags & 0x800;\n    this.real = flags & 0x2000;\n  }\n}\n","import M3ParserSequence from '../../../parsers/m3/sequence';\nimport M3ParserBoundingSphere from '../../../parsers/m3/boundingsphere';\n\n/**\n * An M3 sequence.\n */\nexport default class M3Sequence {\n  name: string;\n  interval: Uint32Array;\n  movementSpeed: number;\n  frequency: number;\n  boundingSphere: M3ParserBoundingSphere;\n  flags: number;\n\n  constructor(sequence: M3ParserSequence) {\n    this.name = <string>sequence.name.get();\n    this.interval = sequence.interval;\n    this.movementSpeed = sequence.movementSpeed;\n    this.frequency = sequence.frequency;\n    this.boundingSphere = sequence.boundingSphere;\n    this.flags = sequence.flags;\n  }\n}\n","import M3ParserSts from '../../../parsers/m3/sts';\nimport { AnimationReference } from '../../../parsers/m3/animationreference';\n\n/**\n * M3 animation data validator.\n */\nexport default class M3Sts {\n  animIds = new Map<number, number>();\n\n  constructor(sts: M3ParserSts) {\n    const animIds = <Uint32Array>sts.animIds.get();\n\n    // Allows direct checks instead of loops\n    for (let i = 0, l = animIds.length; i < l; i++) {\n      this.animIds.set(animIds[i], i);\n    }\n  }\n\n  hasData(animRef: AnimationReference): boolean {\n    return this.animIds.has(animRef.animId);\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { clamp, lerp } from '../../../common/math';\nimport { AnimationReference } from '../../../parsers/m3/animationreference';\nimport M3ParserSd from '../../../parsers/m3/sd';\n\nconst vectorHeap = vec3.create();\nconst quatHeap = quat.create();\n\n/**\n * Sequence data.\n */\nclass M3Sd {\n  keys: Int32Array;\n  values: vec3[] | quat[] | number[];\n  biggestKey: number;\n\n  constructor(sd: M3ParserSd) {\n    this.keys = <Int32Array>sd.keys.get();\n    this.values = <vec3[]>sd.values.get(); // Fake typecasting to avoid a TS error.\n    this.biggestKey = sd.biggestKey;\n  }\n}\n\n/**\n * A sequence data container.\n */\nexport default class M3SdContainer {\n  sd: M3Sd[] = [];\n\n  addSds(sds: M3ParserSd[]): void {\n    for (const sd of sds) {\n      this.sd.push(new M3Sd(sd));\n    }\n  }\n\n  getValueUnsafe(index: number, animationReference: AnimationReference, frame: number, runsConcurrent: number): number | vec3 | quat | Uint8Array | null {\n    const sd = this.sd[index];\n\n    if (runsConcurrent) {\n      frame = frame % sd.biggestKey;\n    }\n\n    const keys = sd.keys;\n    const values = sd.values;\n\n    // getInterval\n    let a = keys.length;\n    let b = 0;\n\n    while (b !== keys.length && frame > keys[b]) {\n      a = b;\n      b++;\n    }\n\n    const length = keys.length;\n\n    if (a === length) {\n      if (b === length) {\n        return animationReference.initValue;\n      } else {\n        return values[b];\n      }\n    }\n\n    if (b === length || a >= b) {\n      return values[a];\n    }\n\n    const t = clamp((frame - keys[a]) / (keys[b] - keys[a]), 0, 1);\n    const va = values[a];\n    const vb = values[b];\n    const interpolationType = animationReference.interpolationType;\n    const fakeVa = <vec3>va; /// UGLY!!!\n\n    if (fakeVa.length === 4) {\n      if (interpolationType === 0) {\n        return quat.copy(quatHeap, <quat>va);\n      } else {\n        return quat.slerp(quatHeap, <quat>va, <quat>vb, t);\n      }\n    } else if (fakeVa.length === 3) {\n      if (interpolationType === 0) {\n        return vec3.copy(vectorHeap, <vec3>va);\n      } else {\n        return vec3.lerp(vectorHeap, <vec3>va, <vec3>vb, t);\n      }\n    } else {\n      if (interpolationType === 0) {\n        return <number>va;\n      } else {\n        return lerp(<number>va, <number>vb, t);\n      }\n    }\n  }\n}\n","import M3ParserStc from '../../../parsers/m3/stc';\nimport { AnimationReference } from '../../../parsers/m3/animationreference';\nimport M3ModelInstance from './modelinstance';\nimport M3SdContainer from './sd';\nimport M3ParserSd from '../../../parsers/m3/sd';\nimport { quat, vec3 } from 'gl-matrix';\n\n/**\n * M3 sequence data.\n */\nexport default class M3Stc {\n  name: string;\n  runsConcurrent: number;\n  priority: number;\n  stsIndex: number;\n  animRefs: number[][] = [];\n  sd: M3SdContainer[] = [];\n\n  constructor(stc: M3ParserStc) {\n    const animIds = <Uint32Array>stc.animIds.get();\n\n    this.name = <string>stc.name.get();\n    this.runsConcurrent = stc.runsConcurrent;\n    this.priority = stc.priority;\n    this.stsIndex = stc.stsIndex;\n\n    const uints = <Uint32Array>stc.animRefs.get();\n    const animRefs = new Uint16Array(uints.buffer);\n\n    // Allows direct checks instead of loops\n    for (let i = 0, l = animIds.length; i < l; i++) {\n      this.animRefs[animIds[i]] = [animRefs[i * 2 + 1], animRefs[i * 2]];\n    }\n\n    for (const sd of stc.sd) {\n      const container = new M3SdContainer();\n\n      const sds = sd.get();\n      if (sds) {\n        container.addSds(<M3ParserSd[]>sds);\n      }\n\n      this.sd.push(container);\n    }\n  }\n\n  getValueUnsafe(animRef: AnimationReference, instance: M3ModelInstance): number | vec3 | quat | Uint8Array | null {\n    const ref = this.animRefs[animRef.animId];\n\n    if (ref) {\n      return this.sd[ref[0]].getValueUnsafe(ref[1], animRef, instance.frame, this.runsConcurrent);\n    }\n\n    return animRef.initValue;\n  }\n}\n","import M3ParserStg from '../../../parsers/m3/stg';\nimport { AnimationReference } from '../../../parsers/m3/animationreference';\nimport M3ModelInstance from './modelinstance';\nimport M3Sts from './sts';\nimport M3Stc from './stc';\nimport { quat, vec3 } from 'gl-matrix';\n\n/**\n * M3 animation data getter.\n */\nexport default class M3Stg {\n  name: string;\n  stcIndices: Uint32Array;\n  sts: M3Sts[];\n  stc: M3Stc[];\n\n  constructor(stg: M3ParserStg, sts: M3Sts[], stc: M3Stc[]) {\n    this.name = <string>stg.name.get();\n    this.stcIndices = <Uint32Array>stg.stcIndices.get();\n    this.sts = sts;\n    this.stc = stc;\n  }\n\n  getValueUnsafe(animRef: AnimationReference, instance: M3ModelInstance): number | vec3 | quat | Uint8Array | null {\n    const stcIndices = this.stcIndices;\n    const stcs = this.stc;\n    const stss = this.sts;\n\n    for (let i = 0, l = stcIndices.length; i < l; i++) {\n      const stc = stcs[stcIndices[i]];\n      const sts = stss[stc.stsIndex];\n\n      // First check if this STC actually has data for this animation reference\n      if (sts.hasData(animRef)) {\n        // Since this STC has data for this animation reference, return it\n        return stc.getValueUnsafe(animRef, instance);\n      }\n    }\n\n    // No STC referenced by the STG had data for this animation reference\n    return animRef.initValue;\n  }\n}\n","import AttachmentPoint from '../../../parsers/m3/attachmentpoint';\n\n/**\n * An M3 attachment.\n */\nexport default class M3Attachment {\n  name: string;\n  bone: number;\n\n  constructor(attachment: AttachmentPoint) {\n    this.name = <string>attachment.name.get();\n    this.bone = attachment.bone;\n  }\n}\n","import Camera from '../../../parsers/m3/camera';\n\n/**\n * An M3 camera.\n */\nexport default class M3Camera {\n  bone: number;\n  name: string;\n\n  constructor(camera: Camera) {\n    this.bone = camera.bone;\n    this.name = <string>camera.name.get();\n\n    // / TODO: Add animated getters, much like the Mdx structures.\n    /*\n    this.fieldOfView = new AnimationReference(reader, readFloat32);\n    this.farClip = new AnimationReference(reader, readFloat32);\n    this.nearClip = new AnimationReference(reader, readFloat32);\n    this.clip2 = new AnimationReference(reader, readFloat32);\n    this.focalDepth = new AnimationReference(reader, readFloat32);\n    this.falloffStart = new AnimationReference(reader, readFloat32);\n    this.falloffEnd = new AnimationReference(reader, readFloat32);\n    this.depthOfField = new AnimationReference(reader, readFloat32);\n    */\n  }\n}\n","import M3ParserRegion from '../../../parsers/m3/region';\nimport Shader from '../../gl/shader';\nimport M3Model from './model';\n\n/**\n * An M3 region.\n */\nexport default class M3Region {\n  gl: WebGLRenderingContext;\n  firstBoneLookupIndex: number;\n  boneWeightPairsCount: number;\n  offset: number;\n  verticesCount: number;\n  elements: number;\n\n  constructor(model: M3Model, region: M3ParserRegion, triangles: Uint16Array, elementArray: Uint16Array, offset: number) {\n    const firstVertexIndex = region.firstVertexIndex;\n    const triangleIndicesCount = region.triangleIndicesCount;\n    const firstTriangleIndex = region.firstTriangleIndex;\n\n    // Note for implementors: the one original vertex indices array could be used with access to the base-vertex draw elements function.\n    // See https://www.opengl.org/sdk/docs/man3/xhtml/glDrawElementsBaseVertex.xml\n    // firstTriangleIndex is the indices offset.\n    // firstVertexIndex is the base vertex.\n    for (let i = 0; i < triangleIndicesCount; i++) {\n      elementArray[offset + i] = triangles[firstTriangleIndex + i] + firstVertexIndex;\n    }\n\n    this.gl = model.viewer.gl;\n    this.firstBoneLookupIndex = region.firstBoneLookupIndex;\n    this.boneWeightPairsCount = region.boneWeightPairsCount;\n    this.offset = offset * 2;\n    this.verticesCount = region.verticesCount;\n    this.elements = triangleIndicesCount;\n  }\n\n  render(shader: Shader): void {\n    const gl = this.gl;\n\n    gl.uniform1f(shader.uniforms['u_firstBoneLookupIndex'], this.firstBoneLookupIndex);\n    gl.uniform1f(shader.uniforms['u_boneWeightPairsCount'], this.boneWeightPairsCount);\n\n    gl.drawElements(gl.TRIANGLES, this.elements, gl.UNSIGNED_SHORT, this.offset);\n  }\n}\n","import { vec3, quat, mat4 } from 'gl-matrix';\nimport { VEC3_UNIT_X, VEC3_UNIT_Y, VEC3_UNIT_Z } from '../common/gl-matrix-addon';\nimport Scene from './scene';\nimport { Node } from './node';\nimport ModelInstance from './modelinstance';\n\nconst locationHeap = vec3.create();\nconst rotationHeap = quat.create();\nconst scalingHeap = vec3.create();\nconst cameraRayHeap = vec3.create();\nconst rotationHeap2 = quat.create();\n\n/**\n * A skeletal node used for skeletons.\n * \n * Expected to be created with createSkeletalNodes() below.\n */\nexport class SkeletalNode {\n  pivot: vec3;\n  localLocation: vec3;\n  localRotation: quat;\n  localScale: vec3;\n  worldLocation: vec3;\n  worldRotation: quat;\n  worldScale: vec3;\n  inverseWorldLocation: vec3;\n  inverseWorldRotation: quat;\n  inverseWorldScale: vec3;\n  localMatrix: mat4;\n  worldMatrix: mat4;\n  dontInheritTranslation = false;\n  dontInheritRotation = false;\n  dontInheritScaling = false;\n  billboarded = false;\n  billboardedX = false;\n  billboardedY = false;\n  billboardedZ = false;\n  dirty = true;\n  wasDirty = false;\n  parent: SkeletalNode | Node | null = null;\n  children: Node[] = [];\n  /**\n   * The object associated with this node, if there is any.\n   */\n  object: unknown = null;\n\n  constructor(pivot: vec3,\n    localLocation: vec3, localRotation: quat, localScale: vec3,\n    worldLocation: vec3, worldRotation: quat, worldScale: vec3,\n    inverseWorldLocation: vec3, inverseWorldRotation: quat, inverseWorldScale: vec3,\n    localMatrix: mat4, worldMatrix: mat4) {\n    this.pivot = pivot;\n    this.localLocation = localLocation;\n    this.localRotation = localRotation;\n    this.localScale = localScale;\n    this.worldLocation = worldLocation;\n    this.worldRotation = worldRotation;\n    this.worldScale = worldScale;\n    this.inverseWorldLocation = inverseWorldLocation;\n    this.inverseWorldRotation = inverseWorldRotation;\n    this.inverseWorldScale = inverseWorldScale;\n    this.localMatrix = localMatrix;\n    this.worldMatrix = worldMatrix;\n\n    this.localRotation[3] = 1;\n\n    this.localScale.fill(1);\n\n    this.localMatrix[0] = 1;\n    this.localMatrix[5] = 1;\n    this.localMatrix[10] = 1;\n    this.localMatrix[15] = 1;\n  }\n\n  /**\n   * Recalculate this skeletal node.\n   */\n  recalculateTransformation(instance: ModelInstance): void {\n    const scene = <Scene>instance.scene;\n    const localMatrix = this.localMatrix;\n    const localLocation = this.localLocation;\n    const localRotation = this.localRotation;\n    const localScale = this.localScale;\n    const worldMatrix = this.worldMatrix;\n    const worldLocation = this.worldLocation;\n    const worldRotation = this.worldRotation;\n    const worldScale = this.worldScale;\n    const pivot = this.pivot;\n    const inverseWorldLocation = this.inverseWorldLocation;\n    const inverseWorldRotation = this.inverseWorldRotation;\n    const inverseWorldScale = this.inverseWorldScale;\n    const parent = <SkeletalNode | Node>this.parent;\n    let computedLocation;\n    let computedRotation;\n    let computedScaling;\n\n    if (this.dontInheritTranslation) {\n      vec3.add(locationHeap, parent.inverseWorldLocation, worldLocation);\n\n      computedLocation = vec3.add(locationHeap, locationHeap, localLocation);\n    } else {\n      computedLocation = localLocation;\n    }\n\n    if (this.dontInheritScaling) {\n      vec3.mul(locationHeap, parent.inverseWorldScale, instance.worldScale);\n\n      computedScaling = vec3.mul(locationHeap, locationHeap, localScale);\n    } else {\n      computedScaling = localScale;\n    }\n\n    if (this.billboarded) {\n      computedRotation = rotationHeap;\n\n      quat.copy(computedRotation, parent.inverseWorldRotation);\n      quat.mul(computedRotation, computedRotation, scene.camera.inverseRotation);\n\n      this.convertBasis(computedRotation);\n\n      quat.mul(computedRotation, computedRotation, localRotation);\n    } else {\n      const { billboardedX, billboardedY, billboardedZ } = this;\n\n      if (billboardedX || billboardedY || billboardedZ) {\n        if (billboardedX) {\n          if (computedScaling === localScale) {\n            computedScaling = scalingHeap;\n            vec3.copy(computedScaling, localScale);\n          }\n\n          // (Original comment from Retera's Warsmash)\n          // It took me many hours to deduce from playing around that this negative one\n          // multiplier should be here. I suggest a lot of testing before you remove it.\n          computedScaling[2] *= -1;\n        }\n\n        // Inverse that local rotation\n        rotationHeap2[0] = -localRotation[0];\n        rotationHeap2[1] = -localRotation[1];\n        rotationHeap2[2] = -localRotation[2];\n\n        quat.mul(rotationHeap2, rotationHeap2, parent.inverseWorldRotation);\n\n        vec3.transformQuat(cameraRayHeap, scene.camera.billboardedVectors[6], rotationHeap2);\n\n        if (billboardedX) {\n          quat.setAxisAngle(rotationHeap2, VEC3_UNIT_X, Math.atan2(cameraRayHeap[2], cameraRayHeap[1]));\n        } else if (billboardedY) {\n          quat.setAxisAngle(rotationHeap2, VEC3_UNIT_Y, Math.atan2(-cameraRayHeap[2], cameraRayHeap[0]));\n        } else {\n          quat.setAxisAngle(rotationHeap2, VEC3_UNIT_Z, Math.atan2(cameraRayHeap[1], cameraRayHeap[0]));\n        }\n\n        computedRotation = rotationHeap;\n\n        quat.mul(computedRotation, localRotation, rotationHeap2);\n      } else {\n        computedRotation = localRotation;\n      }\n    }\n\n    if (this.dontInheritRotation) {\n      quat.mul(rotationHeap2, parent.inverseWorldRotation, instance.worldRotation);\n      computedRotation = quat.mul(rotationHeap, rotationHeap2, computedRotation);\n    }\n\n    // Local matrix\n    mat4.fromRotationTranslationScaleOrigin(localMatrix, computedRotation, computedLocation, computedScaling, pivot);\n\n    // World matrix\n    mat4.mul(worldMatrix, parent.worldMatrix, localMatrix);\n\n    // World location\n    // vec3.transformMat4(worldLocation, pivot, worldMatrix);\n    const x = pivot[0];\n    const y = pivot[1];\n    const z = pivot[2];\n    worldLocation[0] = worldMatrix[0] * x + worldMatrix[4] * y + worldMatrix[8] * z + worldMatrix[12];\n    worldLocation[1] = worldMatrix[1] * x + worldMatrix[5] * y + worldMatrix[9] * z + worldMatrix[13];\n    worldLocation[2] = worldMatrix[2] * x + worldMatrix[6] * y + worldMatrix[10] * z + worldMatrix[14];\n\n    // Inverse world location\n    inverseWorldLocation[0] = -worldLocation[0];\n    inverseWorldLocation[1] = -worldLocation[1];\n    inverseWorldLocation[2] = -worldLocation[2];\n\n    // World rotation\n    quat.mul(worldRotation, parent.worldRotation, computedRotation);\n\n    // Inverse world rotation\n    inverseWorldRotation[0] = -worldRotation[0];\n    inverseWorldRotation[1] = -worldRotation[1];\n    inverseWorldRotation[2] = -worldRotation[2];\n    inverseWorldRotation[3] = worldRotation[3];\n\n    // World scale\n    const parentScale = parent.worldScale;\n    worldScale[0] = parentScale[0] * computedScaling[0];\n    worldScale[1] = parentScale[1] * computedScaling[1];\n    worldScale[2] = parentScale[2] * computedScaling[2];\n      \n    // Inverse world scale\n    inverseWorldScale[0] = 1 / worldScale[0];\n    inverseWorldScale[1] = 1 / worldScale[1];\n    inverseWorldScale[2] = 1 / worldScale[2];\n  }\n\n  /**\n   * Allows inherited node classes to run extra transformations when billboarding.\n   * \n   * This is needed because the different model formats are in different vector spaces.\n   */\n  convertBasis(_rotation: quat): void {\n\n  }\n}\n\ninterface SkeletalNodesData {\n  data: Float32Array;\n  nodes: SkeletalNode[];\n  pivots: Float32Array;\n  localLocations: Float32Array;\n  localRotations: Float32Array;\n  localScales: Float32Array;\n  worldLocations: Float32Array;\n  worldRotations: Float32Array;\n  worldScales: Float32Array;\n  inverseWorldLocations: Float32Array;\n  invereseWorldRotations: Float32Array;\n  inverseWorldScales: Float32Array;\n  localMatrices: Float32Array;\n  worldMatrices: Float32Array;\n}\n\nconst NODE_SHARED_SIZE = 65;\n\n/**\n * Creates an array of skeletal nodes with shared memory.\n * \n * The returned object contains the node array itself, the backing buffer, and all of the different shared arrays.\n */\nexport function createSkeletalNodes(count: number, Node = SkeletalNode): SkeletalNodesData {\n  const data = new Float32Array(count * NODE_SHARED_SIZE);\n  const nodes = [];\n  let offset = 0;\n  const count3 = count * 3;\n  const count4 = count * 4;\n  const count16 = count * 16;\n\n  const pivots = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const localLocations = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const localRotations = data.subarray(offset, offset + count4);\n  offset += count4;\n\n  const localScales = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const worldLocations = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const worldRotations = data.subarray(offset, offset + count4);\n  offset += count4;\n\n  const worldScales = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const inverseWorldLocations = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const invereseWorldRotations = data.subarray(offset, offset + count4);\n  offset += count4;\n\n  const inverseWorldScales = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  const localMatrices = data.subarray(offset, offset + count16);\n  offset += count16;\n\n  const worldMatrices = data.subarray(offset, offset + count16);\n\n  for (let i = 0; i < count; i++) {\n    const i3 = i * 3;\n    const i33 = i3 + 3;\n    const i4 = i * 4;\n    const i44 = i4 + 4;\n    const i16 = i * 16;\n    const i1616 = i16 + 16;\n\n    nodes[i] = new Node(\n      pivots.subarray(i3, i33),\n      localLocations.subarray(i3, i33),\n      localRotations.subarray(i4, i44),\n      localScales.subarray(i3, i33),\n      worldLocations.subarray(i3, i33),\n      worldRotations.subarray(i4, i44),\n      worldScales.subarray(i3, i33),\n      inverseWorldLocations.subarray(i3, i33),\n      invereseWorldRotations.subarray(i4, i44),\n      inverseWorldScales.subarray(i3, i33),\n      localMatrices.subarray(i16, i1616),\n      worldMatrices.subarray(i16, i1616),\n    );\n  }\n\n  return {\n    data,\n    nodes,\n    pivots,\n    localLocations,\n    localRotations,\n    localScales,\n    worldLocations,\n    worldRotations,\n    worldScales,\n    inverseWorldLocations,\n    invereseWorldRotations,\n    inverseWorldScales,\n    localMatrices,\n    worldMatrices,\n  };\n}\n","import { quat } from 'gl-matrix';\nimport { SkeletalNode } from '../../skeletalnode';\n\n/**\n * An M3 node.\n */\nexport default class M3Node extends SkeletalNode {\n  override convertBasis(rotation: quat): void {\n    const halfPI = Math.PI / 2;\n\n    quat.rotateZ(rotation, rotation, halfPI);\n    quat.rotateY(rotation, rotation, -halfPI);\n  }\n}\n","import { AnimationReference } from '../../../parsers/m3/animationreference';\nimport { createSkeletalNodes } from '../../skeletalnode';\nimport M3Node from './node';\nimport M3ModelInstance from './modelinstance';\nimport M3Bone from './bone';\nimport M3Sts from './sts';\nimport M3Stc from './stc';\nimport M3Stg from './stg';\nimport M3Model from './model';\nimport { quat, vec3 } from 'gl-matrix';\n\n/**\n * M3 skeleton.\n */\nexport default class M3Skeleton {\n  nodes: M3Node[];\n  worldMatrices: Float32Array;\n  instance: M3ModelInstance;\n  modelNodes: M3Bone[];\n  initialReference: Float32Array[];\n  sts: M3Sts[];\n  stc: M3Stc[];\n  stg: M3Stg[];\n  boneLookup: Uint16Array;\n\n  constructor(instance: M3ModelInstance) {\n    const model = <M3Model>instance.model;\n    const bones = model.bones;\n    const boneLookup = model.boneLookup;\n    const sharedNodeData = createSkeletalNodes(bones.length, M3Node);\n    const nodes = sharedNodeData.nodes;\n\n    this.nodes = nodes;\n    this.worldMatrices = sharedNodeData.worldMatrices;\n    this.instance = instance;\n    this.modelNodes = bones;\n    this.initialReference = model.initialReference;\n    this.sts = model.sts;\n    this.stc = model.stc;\n    this.stg = model.stg;\n    this.boneLookup = boneLookup;\n\n    // Set the bone parent references\n    for (let i = 0, l = bones.length; i < l; i++) {\n      const bone = bones[i];\n\n      if (bone.parent === -1) {\n        nodes[i].parent = instance;\n      } else {\n        nodes[i].parent = nodes[bone.parent];\n      }\n\n      if (bone.billboard1) {\n        nodes[i].billboarded = true;\n      }\n    }\n  }\n\n  update(dt: number): void {\n    const instance = this.instance;\n    const nodes = this.nodes;\n    const modelNodes = this.modelNodes;\n\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      const node = nodes[i];\n      const modelNode = modelNodes[i];\n\n      this.getValue4(<Float32Array>node.localRotation, modelNode.rotation, instance);\n      this.getValue3(<Float32Array>node.localLocation, modelNode.location, instance);\n      this.getValue3(<Float32Array>node.localScale, modelNode.scale, instance);\n\n      node.recalculateTransformation(instance);\n\n      // Recalculate and update child nodes.\n      // Note that this only affects normal nodes such as instances, and not skeletal nodes.\n      for (const child of node.children) {\n        child.recalculateTransformation();\n        child.update(dt);\n      }\n    }\n  }\n\n  getValueUnsafe(animRef: AnimationReference, instance: M3ModelInstance): number | vec3 | quat | Uint8Array | null {\n    const sequence = instance.sequence;\n\n    if (sequence !== -1) {\n      return this.stg[sequence].getValueUnsafe(animRef, instance);\n    }\n\n    return animRef.initValue;\n  }\n\n  getValue(animRef: AnimationReference, instance: M3ModelInstance): number {\n    return <number>this.getValueUnsafe(animRef, instance);\n  }\n\n  getValue2(out: Float32Array, animRef: AnimationReference, instance: M3ModelInstance): Float32Array {\n    const unsafeHeap = <Float32Array>this.getValueUnsafe(animRef, instance);\n\n    out[0] = unsafeHeap[0];\n    out[1] = unsafeHeap[1];\n\n    return out;\n  }\n\n  getValue3(out: Float32Array, animRef: AnimationReference, instance: M3ModelInstance): Float32Array {\n    const unsafeHeap = <Float32Array>this.getValueUnsafe(animRef, instance);\n\n    out[0] = unsafeHeap[0];\n    out[1] = unsafeHeap[1];\n    out[2] = unsafeHeap[2];\n\n    return out;\n  }\n\n  getValue4(out: Float32Array, animRef: AnimationReference, instance: M3ModelInstance): Float32Array {\n    const unsafeHeap = <Float32Array>this.getValueUnsafe(animRef, instance);\n\n    out[0] = unsafeHeap[0];\n    out[1] = unsafeHeap[1];\n    out[2] = unsafeHeap[2];\n    out[3] = unsafeHeap[3];\n\n    return out;\n  }\n}\n","import { mat4 } from 'gl-matrix';\nimport DataTexture from '../../gl/datatexture';\nimport Scene from '../../scene';\nimport ModelInstance from '../../modelinstance';\nimport Texture from '../../texture';\nimport M3Model from './model';\nimport M3Skeleton from './skeleton';\nimport { STANDARD_MATERIAL_OFFSET } from './standardmaterial';\nimport { M3HandlerObject } from './handler';\nimport M3Node from './node';\n\nconst boneHeap = mat4.create();\n\n/**\n * An M3 model instance.\n */\nexport default class M3ModelInstance extends ModelInstance {\n  skeleton: M3Skeleton | null = null;\n  teamColor = 0;\n  vertexColor = new Float32Array([1, 1, 1, 1]);\n  sequence = -1;\n  frame = 0;\n  sequenceLoopMode = 0;\n  sequenceEnded = false;\n  forced = true;\n  boneTexture: DataTexture | null = null;\n\n  constructor(model: M3Model) {\n    super(model);\n\n    this.skeleton = new M3Skeleton(this);\n\n    // This takes care of calling setSequence before the model is loaded.\n    // In this case, this.sequence will be set, but nothing else is changed.\n    // Now that the model is loaded, set it again to do the real work.\n    if (this.sequence !== -1) {\n      this.setSequence(this.sequence);\n    }\n\n    this.boneTexture = new DataTexture(model.viewer.gl, 3, model.boneLookup.length * 4, 1);\n  }\n\n  /**\n   * Override the texture of the layer at the given index in the material at the given index.\n   * \n   * If a texture isn't given, removes the override if there was one.\n   */\n  setTexture(material: number, layer: number, texture?: Texture): void {\n    this.overrideTexture(material * STANDARD_MATERIAL_OFFSET + layer, texture);\n  }\n\n  updateSkeletonAndBoneTexture(dt: number): void {\n    const model = <M3Model>this.model;\n    const viewer = model.viewer;\n    const buffer = viewer.buffer;\n    const boneLookup = model.boneLookup;\n    const skeleton = <M3Skeleton>this.skeleton;\n    const nodes = skeleton.nodes;\n    const bindPose = model.initialReference;\n    const count = boneLookup.length;\n    const isAnimated = this.sequence !== -1;\n    const boneTexture = <DataTexture>this.boneTexture;\n\n    skeleton.update(dt);\n\n    // Ensure there is enough memory for all of the instances data.\n    buffer.reserve(count * 48);\n\n    const floatView = <Float32Array>buffer.floatView;\n    let finalMatrix;\n\n    if (isAnimated) {\n      finalMatrix = boneHeap;\n    } else {\n      finalMatrix = this.worldMatrix;\n    }\n\n    for (let i = 0; i < count; i++) {\n      const offset = i * 12;\n\n      if (isAnimated) {\n        const bone = boneLookup[i];\n\n        // Every bone has to be multiplied by its bind pose counterpart for rendering.\n        finalMatrix = mat4.mul(boneHeap, nodes[bone].worldMatrix, <mat4>bindPose[bone]);\n      }\n\n      floatView[offset + 0] = finalMatrix[0];\n      floatView[offset + 1] = finalMatrix[1];\n      floatView[offset + 2] = finalMatrix[2];\n      floatView[offset + 3] = finalMatrix[4];\n      floatView[offset + 4] = finalMatrix[5];\n      floatView[offset + 5] = finalMatrix[6];\n      floatView[offset + 6] = finalMatrix[8];\n      floatView[offset + 7] = finalMatrix[9];\n      floatView[offset + 8] = finalMatrix[10];\n      floatView[offset + 9] = finalMatrix[12];\n      floatView[offset + 10] = finalMatrix[13];\n      floatView[offset + 11] = finalMatrix[14];\n    }\n\n    boneTexture.bindAndUpdate(floatView, boneTexture.width, 1);\n  }\n\n  override renderOpaque(): void {\n    const model = <M3Model>this.model;\n    const batches = model.batches;\n\n    if (batches.length) {\n      const viewer = model.viewer;\n      const m3Cache = <M3HandlerObject>viewer.sharedCache.get('m3');\n      const gl = viewer.gl;\n      const vertexSize = model.vertexSize;\n      const uvSetCount = model.uvSetCount;\n      const shader = m3Cache.standardShaders[uvSetCount - 1];\n      const attribs = shader.attribs;\n      const uniforms = shader.uniforms;\n      const scene = <Scene>this.scene;\n      const camera = scene.camera;\n      const textureOverrides = this.textureOverrides;\n      const boneTexture = <DataTexture>this.boneTexture;\n\n      shader.use();\n\n      gl.uniform1f(uniforms['u_teamColor'], this.teamColor);\n      gl.uniform4fv(uniforms['u_vertexColor'], this.vertexColor);\n\n      gl.uniformMatrix4fv(uniforms['u_VP'], false, camera.viewProjectionMatrix);\n      gl.uniformMatrix4fv(uniforms['u_MV'], false, camera.viewMatrix);\n\n      gl.uniform3fv(uniforms['u_eyePos'], camera.location);\n      gl.uniform3fv(uniforms['u_lightPos'], scene.lightPosition);\n\n      boneTexture.bind(15);\n      gl.uniform1i(uniforms['u_boneMap'], 15);\n      gl.uniform1f(uniforms['u_vectorSize'], 1 / boneTexture.width);\n      gl.uniform1f(uniforms['u_rowSize'], 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, model.arrayBuffer);\n      gl.vertexAttribPointer(attribs['a_position'], 3, gl.FLOAT, false, vertexSize, 0);\n      gl.vertexAttribPointer(attribs['a_weights'], 4, gl.UNSIGNED_BYTE, false, vertexSize, 12);\n      gl.vertexAttribPointer(attribs['a_bones'], 4, gl.UNSIGNED_BYTE, false, vertexSize, 16);\n      gl.vertexAttribPointer(attribs['a_normal'], 4, gl.UNSIGNED_BYTE, false, vertexSize, 20);\n\n      for (let i = 0; i < uvSetCount; i++) {\n        gl.vertexAttribPointer(attribs[`a_uv${i}`], 2, gl.SHORT, false, vertexSize, 24 + i * 4);\n      }\n\n      gl.vertexAttribPointer(attribs['a_tangent'], 4, gl.UNSIGNED_BYTE, false, vertexSize, 24 + uvSetCount * 4);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, model.elementBuffer);\n\n      for (const batch of batches) {\n        const material = batch.material;\n        const region = batch.region;\n\n        material.bind(shader, textureOverrides);\n\n        region.render(shader);\n\n        material.unbind(shader); // This is required to not use by mistake layers from this material that were bound and are not overwritten by the next material\n      }\n    }\n  }\n\n  override updateAnimations(dt: number): void {\n    const sequenceId = this.sequence;\n\n    if (sequenceId !== -1) {\n      const model = <M3Model>this.model;\n      const sequence = model.sequences[sequenceId];\n      const interval = sequence.interval;\n\n      this.frame += dt * 1000;\n\n      if (this.frame > interval[1]) {\n        if ((this.sequenceLoopMode === 0 && !(sequence.flags & 0x1)) || this.sequenceLoopMode === 2) {\n          this.frame = interval[0];\n        } else {\n          this.frame = interval[1];\n        }\n\n        this.sequenceEnded = true;\n      } else {\n        this.sequenceEnded = false;\n      }\n    }\n\n    if (this.forced || sequenceId !== -1) {\n      this.forced = false;\n\n      this.updateSkeletonAndBoneTexture(dt);\n    }\n  }\n\n  setTeamColor(id: number): this {\n    this.teamColor = id;\n\n    return this;\n  }\n\n  setVertexColor(color: Uint8Array): this {\n    this.vertexColor.set(color);\n\n    return this;\n  }\n\n  setSequence(id: number): this {\n    const model = <M3Model>this.model;\n    this.sequence = id;\n    this.frame = 0;\n\n    if (id < -1 || id > model.sequences.length - 1) {\n      id = -1;\n\n      this.sequence = id;\n    }\n\n    // Do a forced update, so non-animated data can be skipped in future updates\n    this.forced = true;\n\n    return this;\n  }\n\n  setSequenceLoopMode(mode: number): this {\n    this.sequenceLoopMode = mode;\n\n    return this;\n  }\n\n  getAttachment(id: number): M3Node | undefined {\n    const model = <M3Model>this.model;\n    const attachment = model.attachments[id];\n\n    if (attachment) {\n      return (<M3Skeleton>this.skeleton).nodes[attachment.bone];\n    }\n\n    return;\n  }\n}\n","import M3Region from './region';\nimport { M3StandardMaterial } from './standardmaterial';\n\n/**\n * An M3 batch.\n */\nexport default class M3Batch {\n  region: M3Region;\n  material: M3StandardMaterial;\n\n  constructor(region: M3Region, material: M3StandardMaterial) {\n    this.region = region;\n    this.material = material;\n  }\n}\n","const shader = `\nuniform sampler2D u_boneMap;\nuniform float u_vectorSize;\nuniform float u_rowSize;\n\nmat4 fetchMatrix(float column, float row) {\n  column *= u_vectorSize * 4.0;\n  row *= u_rowSize;\n  // Add in half a texel, to sample in the middle of the texel.\n  // Otherwise, since the sample is directly on the boundary, floating point errors can cause the sample to get the wrong pixel.\n  // This is most noticeable with NPOT textures, which the bone maps are.\n  column += 0.5 * u_vectorSize;\n  row += 0.5 * u_rowSize;\n\n  return mat4(texture2D(u_boneMap, vec2(column, row)),\n              texture2D(u_boneMap, vec2(column + u_vectorSize, row)),\n              texture2D(u_boneMap, vec2(column + u_vectorSize * 2.0, row)),\n              texture2D(u_boneMap, vec2(column + u_vectorSize * 3.0, row)));\n}\n`;\n\nexport default shader;\n","import boneTexture from '../../shaders/bonetexture.glsl';\n\nconst shader = `\nuniform mat4 u_VP;\nuniform mat4 u_MV;\nuniform vec3 u_eyePos;\nuniform vec3 u_lightPos;\nuniform float u_firstBoneLookupIndex;\nuniform float u_boneWeightPairsCount;\nuniform vec3 u_teamColors[14];\nuniform float u_teamColor;\nuniform vec4 u_vertexColor;\n\nattribute vec3 a_position;\nattribute vec4 a_normal;\nattribute vec2 a_uv0;\n\n#ifdef EXPLICITUV1\nattribute vec2 a_uv1;\n#endif\n#ifdef EXPLICITUV2\nattribute vec2 a_uv1, a_uv2;\n#endif\n#ifdef EXPLICITUV3\nattribute vec2 a_uv1, a_uv2, a_uv3;\n#endif\n\nattribute vec4 a_tangent;\nattribute vec4 a_bones;\nattribute vec4 a_weights;\n\nvarying vec3 v_normal;\nvarying vec4 v_uv[2]; // Pack 4 vec2 in 2 vec4, to reduce the varyings count\nvarying vec3 v_lightDir;\n// varying vec3 v_eyeVec;\nvarying vec3 v_halfVec;\nvarying vec3 v_teamColor;\nvarying vec4 v_vertexColor;\n\n${boneTexture}\n\nvec3 TBN(vec3 vector, vec3 tangent, vec3 binormal, vec3 normal) {\n  return vec3(dot(vector, tangent), dot(vector, binormal), dot(vector, normal));\n}\n\nvec4 decodeVector(vec4 v) {\n  return ((v / 255.0) * 2.0) - 1.0;\n}\n\nvoid transform(inout vec3 position, inout vec3 normal, inout vec3 tangent, inout vec3 binormal, vec4 bones, vec4 weights) {\n  if (u_boneWeightPairsCount > 0.0) {\n    mat4 bone;\n\n    if (u_boneWeightPairsCount == 1.0) {\n      bone = fetchMatrix(bones[0], 0.0);\n    } else {\n      bone += fetchMatrix(bones[0], 0.0) * weights[0];\n      bone += fetchMatrix(bones[1], 0.0) * weights[1];\n      bone += fetchMatrix(bones[2], 0.0) * weights[2];\n      bone += fetchMatrix(bones[3], 0.0) * weights[3];\n    }\n\n    position = vec3(bone * vec4(position, 1.0));\n    normal = mat3(bone) * normal;\n    tangent = vec3(bone * vec4(tangent, 0.0));\n    binormal = vec3(bone * vec4(binormal, 0.0));\n  }\n}\n\nvoid main() {\n  vec4 decodedNormal = decodeVector(a_normal);\n\n  vec3 position = a_position;\n  vec3 normal = decodedNormal.xyz;\n  vec3 tangent = vec3(decodeVector(a_tangent));\n  vec3 binormal = cross(normal, tangent) * decodedNormal.w;\n\n  transform(position, normal, tangent, binormal, a_bones + u_firstBoneLookupIndex, a_weights / 255.0);\n\n  vec3 position_mv = vec3(u_MV * vec4(position, 1));\n\n  mat3 mv = mat3(u_MV);\n  vec3 t = normalize(mv * tangent);\n  vec3 b = normalize(mv * binormal);\n  vec3 n = normalize(mv * normal);\n\n  vec3 lightDir = normalize(u_lightPos - position_mv);\n\n  v_lightDir = normalize(TBN(lightDir, t, b, n));\n\n  vec3 eyeVec = normalize(u_eyePos - position_mv);\n  vec3 halfVec = normalize(eyeVec - u_lightPos);\n\n  // v_eyeVec = TBN(eyeVec, t, b, n);\n  v_halfVec = TBN(halfVec, t, b, n);\n\n  v_normal = n;\n\n  vec4 uv0, uv1;\n\n  uv0.xy = a_uv0 / 2048.0;\n\n  #ifdef EXPLICITUV1\n  uv0.zw = a_uv1 / 2048.0;\n  #endif\n\n  #ifdef EXPLICITUV2\n  uv0.zw = a_uv1 / 2048.0;\n  uv1.xy = a_uv2 / 2048.0;\n  #endif\n\n  #ifdef EXPLICITUV3\n  uv0.zw = a_uv1 / 2048.0;\n  uv1.xy = a_uv2 / 2048.0;\n  uv1.zw = a_uv3 / 2048.0;\n  #endif\n\n  v_uv[0] = uv0;\n  v_uv[1] = uv1;\n\n  v_teamColor = u_teamColors[int(u_teamColor)];\n  v_vertexColor = u_vertexColor;\n\n  gl_Position = u_VP * vec4(position, 1.0);\n}\n`;\n\nexport default shader;\n","// Used by all fragment shaders.\nconst shader = `\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n`;\n\nexport default shader;\n","import precision from '../../shaders/precision.glsl';\nimport layers from './layers.glsl';\n\nconst shader = `\n${precision}\n\n${layers}\n\nvoid main() {\n  vec3 color;\n  vec4 final = u_lightAmbient;\n  vec3 normal;\n  vec3 lightMapDiffuse;\n\n  if (u_normalLayerSettings.enabled) {\n    normal = decodeNormal(u_normalMap);\n  } else {\n    normal = v_normal;\n  }\n\n  float lambertFactor = max(dot(normal, v_lightDir), 0.0);\n\n  if (lambertFactor > 0.0) {\n    if (u_diffuseLayerSettings.enabled) {\n      vec4 diffuseColor = computeLayerColor(u_diffuseMap, u_diffuseLayerSettings);\n\n      color = combineLayerColor(diffuseColor, color, u_diffuseLayerSettings);\n    }\n\n    if (u_decalLayerSettings.enabled) {\n      vec4 decalColor = computeLayerColor(u_decalMap, u_decalLayerSettings);\n\n      color = combineLayerColor(decalColor, color, u_decalLayerSettings);\n    }\n\n    vec4 specularColor = computeSpecular(u_specularMap, u_specularLayerSettings, u_specularity, u_specMult, normal);\n\n    if (u_lightMapLayerSettings.enabled) {\n      vec4 lightMapColor = computeLayerColor(u_lightMapMap, u_lightMapLayerSettings) * 2.0;\n\n      lightMapDiffuse = lightMapColor.rgb;\n    }\n\n    // final.rgb = color * lightMapDiffuse + specularColor.rgb;\n    final.rgb = (color + specularColor.rgb) * lambertFactor;\n\n    bool addEmissive = false;\n    vec3 emissiveColor;\n    vec4 tempColor;\n\n    if (u_emissiveLayerSettings.enabled) {\n      tempColor = computeLayerColor(u_emissiveMap, u_emissiveLayerSettings);\n\n      if (u_emissiveLayerSettings.op == LAYEROP_MOD || u_emissiveLayerSettings.op == LAYEROP_MOD2X || u_emissiveLayerSettings.op == LAYEROP_LERP) {\n        final.rgb = combineLayerColor(tempColor, final.rgb, u_emissiveLayerSettings);\n      } else {\n        emissiveColor = combineLayerColor(tempColor, emissiveColor, u_emissiveLayerSettings);\n        addEmissive = true;\n      }\n    }\n\n    if (u_emissive2LayerSettings.enabled) {\n      tempColor = computeLayerColor(u_emissive2Map, u_emissive2LayerSettings);\n\n      if (!addEmissive && (u_emissive2LayerSettings.op == LAYEROP_MOD || u_emissive2LayerSettings.op == LAYEROP_MOD2X || u_emissive2LayerSettings.op == LAYEROP_LERP)) {\n        final.rgb = combineLayerColor(tempColor, final.rgb, u_emissive2LayerSettings);\n      } else {\n        emissiveColor = combineLayerColor(tempColor, emissiveColor, u_emissive2LayerSettings);\n        addEmissive = true;\n      }\n    }\n\n    if (addEmissive) {\n      final.rgb += emissiveColor * u_emisMult;\n    }\n  }\n\n  gl_FragColor = final * v_vertexColor;\n}\n`;\n\nexport default shader;\n","import Parser from '../../../parsers/m3/model';\nimport isM3 from '../../../parsers/m3/isformat';\nimport ModelViewer from '../../viewer';\nimport Shader from '../../gl/shader';\nimport Model from './model';\nimport standardVert from './shaders/standard.vert';\nimport standardFrag from './shaders/standard.frag';\n\nexport interface M3HandlerObject {\n  standardShaders: Shader[];\n}\n\nexport default {\n  load(viewer: ModelViewer): void {\n    const gl = viewer.gl;\n    const webgl = viewer.webgl;\n    const teamColors = [[255, 3, 3], [0, 66, 255], [28, 230, 185], [84, 0, 129], [255, 252, 1], [254, 138, 14], [32, 192, 0], [229, 91, 176], [149, 150, 151], [126, 191, 241], [16, 98, 70], [78, 42, 4], [40, 40, 40], [0, 0, 0]];\n\n    // Bone textures.\n    if (!webgl.ensureExtension('OES_texture_float')) {\n      throw new Error('M3: No float texture support!');\n    }\n\n    const standardShaders = <Shader[]>[];\n\n    // Load shaders for 1-4 texture coordinate models.\n    for (let i = 0; i < 4; i++) {\n      const shader = webgl.createShader(`#define EXPLICITUV${i}\\n${standardVert}`, standardFrag);\n\n      // Bind the shader and set the team color uniforms.\n      shader.use();\n\n      for (let i = 0; i < 14; i++) {\n        const color = teamColors[i];\n\n        gl.uniform3f(shader.uniforms['u_teamColors[' + i + ']'], color[0] / 255, color[1] / 255, color[2] / 255);\n      }\n\n      standardShaders[i] = shader;\n    }\n\n    const handlerData: M3HandlerObject = { standardShaders };\n\n    viewer.sharedCache.set('m3', handlerData);\n  },\n  isValidSource(object: unknown): boolean {\n    if (object instanceof Parser) {\n      return true;\n    }\n\n    return isM3(object);\n  },\n  resource: Model,\n};\n","import Parser from '../../../parsers/m3/model';\nimport M3ParserModel from '../../../parsers/m3/modelheader';\nimport M3ParserDivision from '../../../parsers/m3/division';\nimport StandardMaterial from '../../../parsers/m3/standardmaterial';\nimport Sequence from '../../../parsers/m3/sequence';\nimport Region from '../../../parsers/m3/region';\nimport Bone from '../../../parsers/m3/bone';\nimport Stc from '../../../parsers/m3/stc';\nimport Sts from '../../../parsers/m3/sts';\nimport Stg from '../../../parsers/m3/stg';\nimport AttachmentPoint from '../../../parsers/m3/attachmentpoint';\nimport Camera from '../../../parsers/m3/camera';\nimport Model from '../../model';\nimport { M3StandardMaterial } from './standardmaterial';\nimport M3Bone from './bone';\nimport M3Sequence from './sequence';\nimport M3Sts from './sts';\nimport M3Stc from './stc';\nimport M3Stg from './stg';\nimport M3AttachmentPoint from './attachment';\nimport M3Camera from './camera';\nimport M3Region from './region';\nimport M3ModelInstance from './modelinstance';\nimport M3Batch from './batch';\nimport { HandlerResourceData } from '../../handlerresource';\nimport Division from '../../../parsers/m3/division';\nimport Batch from '../../../parsers/m3/batch';\nimport MaterialReference from '../../../parsers/m3/materialreference';\n\n/**\n * An M3 model.\n */\nexport default class M3Model extends Model {\n  name = '';\n  batches: M3Batch[] = [];\n  materials: [unknown[], M3StandardMaterial[]] = [[], []]; // 2D array for the possibility of adding more material types in the future\n  materialMaps: MaterialReference[] = [];\n  bones: M3Bone[] = [];\n  boneLookup: Uint16Array;\n  sequences: M3Sequence[] = [];\n  sts: M3Sts[] = [];\n  stc: M3Stc[] = [];\n  stg: M3Stg[] = [];\n  attachments: M3AttachmentPoint[] = [];\n  cameras: M3Camera[] = [];\n  regions: M3Region[] = [];\n  initialReference: Float32Array[] = [];\n  elementBuffer: WebGLBuffer | null = null;\n  arrayBuffer: WebGLBuffer | null = null;\n  vertexSize = 0;\n  uvSetCount = 0;\n\n  constructor(bufferOrParser: ArrayBuffer | Parser, resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    let parser;\n\n    if (bufferOrParser instanceof Parser) {\n      parser = bufferOrParser;\n    } else {\n      parser = new Parser();\n\n      parser.load(bufferOrParser);\n    }\n\n    const model = <M3ParserModel>parser.model;\n    const div = <Division>model.divisions.first();\n\n    this.name = <string>model.modelName.get();\n\n    this.setupGeometry(model, div);\n\n    const materialMaps = <MaterialReference[]>model.materialReferences.get();\n\n    this.materialMaps = materialMaps;\n\n    // Create concrete material objects for standard materials\n\n    const standardMaterials = <StandardMaterial[]>model.materials[0].get();\n\n    for (let i = 0, l = standardMaterials.length; i < l; i++) {\n      this.materials[1].push(new M3StandardMaterial(this, i, standardMaterials[i]));\n    }\n\n    // Create concrete batch objects\n    for (const batch of <Batch[]>div.batches.get()) {\n      const regionId = batch.regionIndex;\n      const materialMap = materialMaps[batch.materialReferenceIndex];\n\n      if (materialMap.materialType === 1) {\n        this.batches.push(new M3Batch(this.regions[regionId], this.materials[1][materialMap.materialIndex]));\n      }\n    }\n\n    /*\n    var batchGroups = [[], [], [], [], [], []];\n\n    for (i = 0, l = batches.length; i < l; i++) {\n    var blendMode = batches[i].material.blendMode;\n\n    batchGroups[blendMode].push(batches[i]);\n    }\n\n    function sortByPriority(a, b) {\n    var a = a.material.priority;\n    var b = b.material.priority;\n\n    if (a < b) {\n    return 1;\n    } else if (a == b) {\n    return 0;\n    } else {\n    return -1;\n    }\n    }\n\n    for (i = 0; i < 6; i++) {\n    batchGroups[i].sort(sortByPriority);\n    }\n    */\n    /*\n    // In the EggPortrait model the batches seem to be sorted by blend mode. Is this true for every model?\n    this.batches.sort(function (a, b) {\n    var ba = a.material.blendMode;\n    var bb = b.material.blendMode;\n\n    if (ba < bb) {\n    return -1;\n    } else if (ba == bb) {\n    return 0;\n    } else {\n    return 1;\n    }\n    });\n    */\n\n    // this.batches = batchGroups[0].concat(batchGroups[1]).concat(batchGroups[2]).concat(batchGroups[3]).concat(batchGroups[4]).concat(batchGroups[5]);\n\n    this.initialReference = <Float32Array[]>model.absoluteInverseBoneRestPositions.get();\n\n    for (const bone of <Bone[]>model.bones.get()) {\n      this.bones.push(new M3Bone(bone));\n    }\n\n    this.boneLookup = <Uint16Array>model.boneLookup.get();\n\n    const sequences = model.sequences.get();\n    if (sequences) {\n      for (const sequence of <Sequence[]>sequences) {\n        this.sequences.push(new M3Sequence(sequence));\n      }\n    }\n\n    const stss = model.sts.get();\n    if (stss) {\n      for (const sts of <Sts[]>stss) {\n        this.sts.push(new M3Sts(sts));\n      }\n    }\n\n    const stcs = model.stc.get();\n    if (stcs) {\n      for (const stc of <Stc[]>stcs) {\n        this.stc.push(new M3Stc(stc));\n      }\n    }\n\n    const stgs = model.stg.get();\n    if (stgs) {\n      for (const stg of <Stg[]>stgs) {\n        this.stg.push(new M3Stg(stg, this.sts, this.stc));\n      }\n    }\n\n    this.addGlobalAnims();\n\n    /*\n    if (parser.fuzzyHitTestObjects.length > 0) {\n        for (i = 0, l = parser.fuzzyHitTestObjects.length; i < l; i++) {\n            this.boundingShapes[i] = new M3BoundingShape(parser.fuzzyHitTestObjects[i], parser.bones, gl);\n        }\n    }\n    */\n    /*\n    if (parser.particleEmitters.length > 0) {\n    this.particleEmitters = [];\n \n    for (i = 0, l = parser.particleEmitters.length; i < l; i++) {\n    this.particleEmitters[i] = new M3ParticleEmitter(parser.particleEmitters[i], this);\n    }\n    }\n    */\n\n    const attachmentPoints = model.attachmentPoints.get();\n    if (attachmentPoints) {\n      for (const attachment of <AttachmentPoint[]>attachmentPoints) {\n        this.attachments.push(new M3AttachmentPoint(attachment));\n      }\n    }\n\n    const cameras = model.cameras.get();\n    if (cameras) {\n      for (const camera of <Camera[]>cameras) {\n        this.cameras.push(new M3Camera(camera));\n      }\n    }\n  }\n\n  addInstance(): M3ModelInstance {\n    return new M3ModelInstance(this);\n  }\n\n  setupGeometry(parser: M3ParserModel, div: M3ParserDivision): void {\n    const gl = this.viewer.gl;\n    let uvSetCount = 1;\n    const vertexFlags = parser.vertexFlags;\n\n    if (vertexFlags & 0x40000) {\n      uvSetCount = 2;\n    } else if (vertexFlags & 0x80000) {\n      uvSetCount = 3;\n    } else if (vertexFlags & 0x100000) {\n      uvSetCount = 4;\n    }\n\n    const regions = <Region[]>div.regions.get();\n    let totalElements = 0;\n    const offsets = [];\n\n    for (let i = 0, l = regions.length; i < l; i++) {\n      offsets[i] = totalElements;\n      totalElements += regions[i].triangleIndicesCount;\n    }\n\n    const elementArray = new Uint16Array(totalElements);\n\n    const triangles = <Uint16Array>div.triangles.get();\n\n    for (let i = 0, l = regions.length; i < l; i++) {\n      this.regions.push(new M3Region(this, regions[i], triangles, elementArray, offsets[i]));\n    }\n\n    const vertices = <Uint8Array>parser.vertices.get();\n\n    this.elementBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.elementBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, elementArray, gl.STATIC_DRAW);\n\n    const arrayBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, arrayBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n\n    this.arrayBuffer = arrayBuffer;\n    this.vertexSize = (7 + uvSetCount) * 4;\n    this.uvSetCount = uvSetCount;\n  }\n\n  mapMaterial(index: number): M3StandardMaterial {\n    const materialMap = this.materialMaps[index];\n\n    // return this.materials[materialMap.materialType][materialMap.materialIndex];\n    return this.materials[1][materialMap.materialIndex];\n  }\n\n  addGlobalAnims(): void {\n    /*\n    var i, l;\n    var glbirth, glstand, gldeath;\n    var stgs = this.stg;\n    var stg, name;\n \n    for (i = 0, l = stgs.length; i < l; i++) {\n    stg = stgs[i];\n    name = stg.name.toLowerCase(); // Because obviously there will be a wrong case in some model...\n \n    if (name === 'glbirth') {\n    glbirth = stg;\n    } else if (name === 'glstand') {\n    glstand = stg;\n    } else if (name === 'gldeath') {\n    gldeath = stg;\n    }\n    }\n \n    for (i = 0, l = stgs.length; i < l; i++) {\n    stg = stgs[i];\n    name = stg.name.toLowerCase(); // Because obviously there will be a wrong case in some model...\n \n    if (name !== 'glbirth' && name !== 'glstand' && name !== 'gldeath') {\n    if (name.indexOf('birth') !== -1 && glbirth) {\n    stg.stcIndices = stg.stcIndices.concat(glbirth.stcIndices);\n    } else  if (name.indexOf('death') !== -1 && gldeath) {\n    stg.stcIndices = stg.stcIndices.concat(gldeath.stcIndices);\n    } else if (glstand) {\n    stg.stcIndices = stg.stcIndices.concat(glstand.stcIndices);\n    }\n    }\n    }\n    */\n  }\n\n  // getValue(animRef: M3ParserAnimationReference, sequence: number, frame: number) {\n  //   if (sequence !== -1) {\n  //     return this.stg[sequence].getValue(animRef, frame);\n  //   } else {\n  //     return animRef.initValue;\n  //   }\n  // }\n}\n","let audioContext: OfflineAudioContext;\n\n// Some browsers don't have OfflineAudioContext or AudioContext.\nif (typeof OfflineAudioContext === 'function') {\n  audioContext = new OfflineAudioContext(1, 1, 48000);\n}\n\n/**\n * A context-less decodeAudioData().\n */\nexport async function decodeAudioData(buffer: ArrayBuffer): Promise<AudioBuffer | undefined> {\n  if (audioContext) {\n    return audioContext.decodeAudioData(buffer);\n  }\n\n  return;\n}\n","import SlkFile from '../parsers/slk/file';\nimport { IniFile } from '../parsers/ini/file';\n\n/**\n * A MappedData row.\n */\nexport class MappedDataRow {\n  map: {[key: string]: string } = {};\n\n  set(key: string, value: string | number): void {\n    if (typeof value !== 'string') {\n      value = value.toString();\n    }\n\n    this.map[key.toLowerCase()] = value;\n  }\n\n  string(key: string): string | undefined {\n    return this.map[key.toLowerCase()];\n  }\n\n  number(key: string): number {\n    const string = this.string(key);\n\n    if (!string) {\n      return 0;\n    }\n    \n    return parseFloat(string);\n  }\n}\n\n/**\n * A structure that holds mapped data from INI and SLK files.\n * \n * In the case of SLK files, the first row is expected to hold the names of the columns.\n */\nexport class MappedData {\n  map: {[key: string]: MappedDataRow } = {};\n\n  constructor(buffer?: string) {\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * Load data from an SLK file or an INI file.\n   * \n   * Note that this may override previous properties!\n   */\n  load(buffer: string): void {\n    if (buffer.startsWith('ID;')) {\n      const file = new SlkFile();\n      file.load(buffer);\n\n      const rows = file.rows;\n      const header = rows[0];\n      const map = this.map;\n\n      for (let i = 1, l = rows.length; i < l; i++) {\n        const row = rows[i];\n\n        // DialogueDemonBase.slk has an empty row.\n        if (row) {\n          const name = row[0];\n\n          // DialogueDemonBase.slk also has rows containing only a single underline.\n          if (name && name !== '_') {\n            if (!map[name]) {\n              map[name] = new MappedDataRow();\n            }\n\n            const mapped = map[name];\n\n            for (let j = 0, k = header.length; j < k; j++) {\n              let key = header[j];\n\n              // UnitBalance.slk doesn't define the name of one column.\n              if (key === undefined) {\n                key = `column${j}`;\n              }\n\n              mapped.map[key.toLowerCase()] = row[j];\n            }\n          }\n        }\n      }\n    } else {\n      const file = new IniFile();\n      file.load(buffer);\n\n      const sections = file.sections;\n      const map = this.map;\n\n      for (const [row, properties] of sections.entries()) {\n        if (!map[row]) {\n          map[row] = new MappedDataRow();\n        }\n\n        const mapped = map[row];\n\n        for (const [name, property] of properties) {\n          mapped.map[name.toLowerCase()] = property;\n        }\n      }\n    }\n  }\n\n  getRow(key: string): MappedDataRow | undefined {\n    return this.map[key];\n  }\n\n  getProperty(key: string, name: string): string {\n    return this.map[key].map[name];\n  }\n\n  setRow(key: string, values: MappedDataRow): void {\n    this.map[key] = values;\n  }\n\n  findRow(key: string, expectedValue: string): MappedDataRow | undefined {\n    for (const row of Object.values(this.map)) {\n      if (row.string(key) === expectedValue) {\n        return row;\n      }\n    }\n\n    return;\n  }\n}\n","import MdlxSequence from '../../../parsers/mdlx/sequence';\nimport Bounds from '../../bounds';\n\n/**\n * An MDX sequence.\n */\nexport default class Sequence {\n  name: string;\n  interval: Uint32Array;\n  nonLooping: number;\n  rarity: number;\n  bounds: Bounds;\n\n  constructor(sequence: MdlxSequence) {\n    this.name = sequence.name;\n    this.interval = sequence.interval;\n    this.nonLooping = sequence.nonLooping;\n    this.rarity = sequence.rarity;\n    this.bounds = new Bounds();\n\n    const extent = sequence.extent;\n    this.bounds.fromExtents(extent.min, extent.max);\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { lerp, hermite, bezier } from '../../../common/math';\nimport { Animation, UintAnimation, FloatAnimation, Vector3Animation, InterpolationType } from '../../../parsers/mdlx/animations';\nimport MdxModel from './model';\n\n/**\n * Animated data for a specific sequence.\n */\nclass SdSequence {\n  sd: Sd;\n  start: number;\n  end: number;\n  frames: number[] = [];\n  values: (Uint32Array | Float32Array)[] = [];\n  inTans: (Uint32Array | Float32Array)[] = [];\n  outTans: (Uint32Array | Float32Array)[] = [];\n  constant = false;\n\n  constructor(sd: Sd, start: number, end: number, animation: Animation, isGlobal: boolean) {\n    this.sd = sd;\n    this.start = start;\n    this.end = end;\n\n    const interpolationType = sd.interpolationType;\n    const frames = animation.frames;\n    const values = animation.values;\n    const inTans = animation.inTans;\n    const outTans = animation.outTans;\n    const defval = sd.defval;\n\n    // When using a global sequence, where the first key is outside of the sequence's length, it becomes its constant value.\n    // When having one key in the sequence's range, and one key outside of it, results seem to be non-deterministic.\n    // Sometimes the second key is used too, sometimes not.\n    // It also differs depending where the model is viewed - the WE previewer, the WE itself, or the game.\n    // All three show different results, none of them make sense.\n    // Therefore, only handle the case where the first key is outside.\n    // This fixes problems spread over many models, e.g. HeroMountainKing (compare in WE and in Magos).\n    if (isGlobal && frames[0] > end) {\n      this.frames[0] = frames[0];\n      this.values[0] = values[0];\n    }\n\n    // Go over the keyframes, and add all of the ones that are in this sequence (start <= frame <= end).\n    for (let i = 0, l = frames.length; i < l; i++) {\n      const frame = frames[i];\n\n      if (frame >= start && frame <= end) {\n        this.frames.push(frame);\n        this.values.push(values[i]);\n\n        if (interpolationType > 1) {\n          this.inTans.push(inTans[i]);\n          this.outTans.push(outTans[i]);\n        }\n      }\n    }\n\n    const tracksCount = this.frames.length;\n\n    if (tracksCount === 0) {\n      // If there are no keys, use the default value directly.\n      this.constant = true;\n\n      this.frames[0] = start;\n      this.values[0] = defval;\n    } else if (tracksCount === 1) {\n      // If there's only one key, use it directly.\n      this.constant = true;\n    } else {\n      const firstValue = this.values[0];\n\n      // If all of the values in this sequence are the same, might as well make it constant.\n      this.constant = this.values.every((value) => firstValue.every((element: number, index: number) => element === value[index]));\n    }\n  }\n\n  getValue(out: Uint32Array | Float32Array, frame: number): number {\n    const frames = this.frames;\n    const length = frames.length;\n\n    // Fixed implementation copied directly from Retera's code. Thank you!\n    if (this.constant || frame < this.start) {\n      this.sd.copy(out, this.values[0]);\n\n      return -1;\n    } else {\n      let startFrameIndex = -1;\n      let endFrameIndex = -1;\n      const lengthLessOne = length - 1;\n\n      if ((frame < this.frames[0]) || (frame >= this.frames[lengthLessOne])) {\n        startFrameIndex = lengthLessOne;\n        endFrameIndex = 0;\n      } else {\n        for (let i = 1; i < length; i++) {\n          if (this.frames[i] > frame) {\n            startFrameIndex = i - 1;\n            endFrameIndex = i;\n            break;\n          }\n        }\n      }\n\n      let startFrame = this.frames[startFrameIndex];\n      const endFrame = this.frames[endFrameIndex];\n      let timeBetweenFrames = endFrame - startFrame;\n\n      if (timeBetweenFrames < 0) {\n        timeBetweenFrames += (this.end - this.start);\n\n        if (frame < startFrame) {\n          startFrame = endFrame;\n        }\n      }\n\n      const t = ((timeBetweenFrames) == 0 ? 0 : ((frame - startFrame) / timeBetweenFrames));\n      this.sd.interpolate(out, this.values, this.inTans, this.outTans, startFrameIndex, endFrameIndex, t);\n\n      return startFrameIndex;\n    }\n  }\n}\n\nconst forcedInterpMap = {\n  KLAV: InterpolationType.DontInterp,\n  KATV: InterpolationType.DontInterp,\n  KPEV: InterpolationType.DontInterp,\n  KP2V: InterpolationType.DontInterp,\n  KRVS: InterpolationType.DontInterp,\n};\n\nconst floatDefval = new Float32Array(1);\nconst uintDefval = new Uint32Array(1);\nconst visibilityDefval = new Float32Array([1]);\nconst translationDefval = vec3.create();\nconst rotationDefval = quat.create();\nconst scaleDefval = vec3.fromValues(1, 1, 1);\nconst alphaDefval = visibilityDefval;\nconst colorDefval = translationDefval;\n\nconst defVals = {\n  // LAYS\n  KMTF: floatDefval,\n  KMTA: alphaDefval,\n  // TXAN\n  KTAT: translationDefval,\n  KTAR: rotationDefval,\n  KTAS: scaleDefval,\n  // GEOA\n  KGAO: alphaDefval,\n  KGAC: colorDefval,\n  // LITE\n  KLAS: floatDefval,\n  KLAE: floatDefval,\n  KLAC: colorDefval,\n  KLAI: floatDefval,\n  KLBI: floatDefval,\n  KLBC: colorDefval,\n  KLAV: visibilityDefval,\n  // ATCH\n  KATV: visibilityDefval,\n  // PREM\n  KPEE: floatDefval,\n  KPEG: floatDefval,\n  KPLN: floatDefval,\n  KPLT: floatDefval,\n  KPEL: floatDefval,\n  KPES: floatDefval,\n  KPEV: visibilityDefval,\n  // PRE2\n  KP2S: floatDefval,\n  KP2R: floatDefval,\n  KP2L: floatDefval,\n  KP2G: floatDefval,\n  KP2E: floatDefval,\n  KP2N: floatDefval,\n  KP2W: floatDefval,\n  KP2V: visibilityDefval,\n  // RIBB\n  KRHA: floatDefval,\n  KRHB: floatDefval,\n  KRAL: new Float32Array([0]), // Ribbon emitter alphas default to 0 rather than 1.\n  KRCO: colorDefval,\n  KRTX: floatDefval,\n  KRVS: visibilityDefval,\n  // CAMS\n  KCTR: translationDefval,\n  KTTR: translationDefval,\n  KCRL: uintDefval,\n  // NODE\n  KGTR: translationDefval,\n  KGRT: rotationDefval,\n  KGSC: scaleDefval,\n};\n\n/**\n * Animated data.\n */\nexport abstract class Sd {\n  defval: Float32Array | Uint32Array;\n  model: MdxModel;\n  name: string;\n  globalSequence: SdSequence | null = null;\n  sequences: SdSequence[] = [];\n  interpolationType: InterpolationType;\n\n  abstract copy(out: Uint32Array | Float32Array | vec3 | quat, value: Uint32Array | Float32Array | vec3 | quat): void;\n  abstract interpolate(out: Uint32Array | Float32Array | vec3 | quat, values: (Uint32Array | Float32Array | vec3 | quat)[], inTans: (Uint32Array | Float32Array | vec3 | quat)[], outTans: (Uint32Array | Float32Array | vec3 | quat)[], start: number, end: number, t: number): void;\n\n  constructor(model: MdxModel, animation: Animation) {\n    const globalSequences = model.globalSequences;\n    const globalSequenceId = animation.globalSequenceId;\n    const forcedInterp = forcedInterpMap[animation.name];\n\n    this.model = model;\n    this.name = animation.name;\n    this.defval = defVals[animation.name];\n\n    // Allow to force an interpolation type.\n    // The game seems to do this with visibility tracks, where the type is forced to None.\n    // It came up as a bug report by a user who used the wrong interpolation type.\n    this.interpolationType = forcedInterp !== undefined ? forcedInterp : animation.interpolationType;\n\n    if (globalSequenceId !== -1 && globalSequences) {\n      this.globalSequence = new SdSequence(this, 0, globalSequences[globalSequenceId], animation, true);\n    } else {\n      for (const sequence of model.sequences) {\n        const interval = sequence.interval;\n\n        this.sequences.push(new SdSequence(this, interval[0], interval[1], animation, false));\n      }\n    }\n  }\n\n  getValue(out: Uint32Array | Float32Array, sequence: number, frame: number, counter: number): number {\n    if (this.globalSequence) {\n      return this.globalSequence.getValue(out, counter % this.globalSequence.end);\n    }\n\n    return this.sequences[sequence].getValue(out, frame);\n  }\n\n  isVariant(sequence: number): boolean {\n    if (this.globalSequence) {\n      return !this.globalSequence.constant;\n    } else {\n      return !this.sequences[sequence].constant;\n    }\n  }\n}\n\n/**\n * A scalar animation.\n */\nexport class ScalarSd extends Sd {\n  copy<T extends Uint32Array | Float32Array>(out: T, value: T): void {\n    out[0] = value[0];\n  }\n\n  interpolate<T extends Uint32Array | Float32Array>(out: T, values: T[], inTans: T[], outTans: T[], start: number, end: number, t: number): void {\n    const interpolationType = this.interpolationType;\n    const startValue = values[start][0];\n\n    if (interpolationType === InterpolationType.DontInterp) {\n      out[0] = startValue;\n    } else if (interpolationType === InterpolationType.Linear) {\n      out[0] = lerp(startValue, values[end][0], t);\n    } else if (interpolationType === InterpolationType.Hermite) {\n      out[0] = hermite(startValue, outTans[start][0], inTans[end][0], values[end][0], t);\n    } else if (interpolationType === InterpolationType.Bezier) {\n      out[0] = bezier(startValue, outTans[start][0], inTans[end][0], values[end][0], t);\n    }\n  }\n}\n\n/**\n * A vector animation.\n */\nexport class VectorSd extends Sd {\n  copy(out: vec3, value: vec3): void {\n    vec3.copy(out, value);\n  }\n\n  interpolate(out: vec3, values: vec3[], inTans: vec3[], outTans: vec3[], start: number, end: number, t: number): void {\n    const interpolationType = this.interpolationType;\n\n    if (interpolationType === InterpolationType.DontInterp) {\n      vec3.copy(out, values[start]);\n    } else if (interpolationType === InterpolationType.Linear) {\n      vec3.lerp(out, values[start], values[end], t);\n    } else if (interpolationType === InterpolationType.Hermite) {\n      vec3.hermite(out, values[start], outTans[start], inTans[end], values[end], t);\n    } else if (interpolationType === InterpolationType.Bezier) {\n      vec3.bezier(out, values[start], outTans[start], inTans[end], values[end], t);\n    }\n  }\n}\n\n/**\n * A quaternion animation.\n */\nexport class QuatSd extends Sd {\n  copy(out: quat, value: quat): void {\n    quat.copy(out, value);\n  }\n\n  interpolate(out: quat, values: quat[], inTans: quat[], outTans: quat[], start: number, end: number, t: number): void {\n    const interpolationType = this.interpolationType;\n\n    if (interpolationType === InterpolationType.DontInterp) {\n      quat.copy(out, values[start]);\n    } else if (interpolationType === InterpolationType.Linear) {\n      quat.slerp(out, values[start], values[end], t);\n    } else if (interpolationType === InterpolationType.Hermite || interpolationType === InterpolationType.Bezier) {\n      quat.sqlerp(out, values[start], outTans[start], inTans[end], values[end], t);\n    }\n  }\n}\n\nexport function createTypedSd(model: MdxModel, animation: Animation): ScalarSd | VectorSd | QuatSd {\n  if (animation instanceof UintAnimation || animation instanceof FloatAnimation) {\n    return new ScalarSd(model, animation);\n  } else if (animation instanceof Vector3Animation) {\n    return new VectorSd(model, animation);\n  } else {\n    return new QuatSd(model, animation);\n  }\n}\n","import MdlxAnimatedObject from '../../../parsers/mdlx/animatedobject';\nimport MdxModel from './model';\nimport { Sd, createTypedSd } from './sd';\n\n/**\n * An animation object.\n */\nexport default class AnimatedObject {\n  model: MdxModel;\n  animations: Map<string, Sd> = new Map();\n  variants: {[key: string]: Uint8Array } = {};\n\n  constructor(model: MdxModel, object: MdlxAnimatedObject) {\n    this.model = model;\n\n    for (const animation of object.animations) {\n      this.animations.set(animation.name, createTypedSd(model, animation));\n    }\n  }\n\n  getScalarValue(out: Uint32Array | Float32Array, name: string, sequence: number, frame: number, counter: number, defaultValue: number): number {\n    if (sequence !== -1) {\n      const animation = this.animations.get(name);\n\n      if (animation) {\n        return animation.getValue(out, sequence, frame, counter);\n      }\n    }\n\n    out[0] = defaultValue;\n\n    return -1;\n  }\n\n  getVectorValue(out: Float32Array, name: string, sequence: number, frame: number, counter: number, defaultValue: Float32Array): number {\n    if (sequence !== -1) {\n      const animation = this.animations.get(name);\n\n      if (animation) {\n        return animation.getValue(out, sequence, frame, counter);\n      }\n    }\n\n    out[0] = defaultValue[0];\n    out[1] = defaultValue[1];\n    out[2] = defaultValue[2];\n\n    return -1;\n  }\n\n  getQuatValue(out: Float32Array, name: string, sequence: number, frame: number, counter: number, defaultValue: Float32Array): number {\n    if (sequence !== -1) {\n      const animation = this.animations.get(name);\n\n      if (animation) {\n        return animation.getValue(out, sequence, frame, counter);\n      }\n    }\n\n    out[0] = defaultValue[0];\n    out[1] = defaultValue[1];\n    out[2] = defaultValue[2];\n    out[3] = defaultValue[3];\n\n    return -1;\n  }\n\n  addVariants(name: string, variantName: string): void {\n    const animation = this.animations.get(name);\n    const sequences = this.model.sequences.length;\n    const variants = new Uint8Array(sequences);\n\n    if (animation) {\n      for (let i = 0; i < sequences; i++) {\n        if (animation.isVariant(i)) {\n          variants[i] = 1;\n        }\n      }\n    }\n\n    this.variants[variantName] = variants;\n  }\n\n  addVariantIntersection(names: string[], variantName: string): void {\n    const sequences = this.model.sequences.length;\n    const variants = new Uint8Array(sequences);\n\n    for (let i = 0; i < sequences; i++) {\n      for (const name of names) {\n        if (this.variants[name][i]) {\n          variants[i] = 1;\n        }\n      }\n    }\n\n    this.variants[variantName] = variants;\n  }\n}\n","import { VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT } from '../../../common/gl-matrix-addon';\nimport MdlxTextureAnimation from '../../../parsers/mdlx/textureanimation';\nimport AnimatedObject from './animatedobject';\nimport MdxModel from './model';\n\n/**\n * An MDX texture animation.\n */\nexport default class TextureAnimation extends AnimatedObject {\n  constructor(model: MdxModel, textureAnimation: MdlxTextureAnimation) {\n    super(model, textureAnimation);\n\n    this.addVariants('KTAT', 'translation');\n    this.addVariants('KTAR', 'rotation');\n    this.addVariants('KTAS', 'scale');\n  }\n\n  getTranslation(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KTAT', sequence, frame, counter, <Float32Array>VEC3_ZERO);\n  }\n\n  getRotation(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getQuatValue(out, 'KTAR', sequence, frame, counter, <Float32Array>QUAT_DEFAULT);\n  }\n\n  getScale(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KTAS', sequence, frame, counter, <Float32Array>VEC3_ONE);\n  }\n}\n","import { FilterMode as LayerFilterMode } from '../../../parsers/mdlx/layer';\nimport { FilterMode as Particle2FilterMode } from '../../../parsers/mdlx/particleemitter2';\n\nexport function layerFilterMode(filterMode: LayerFilterMode, gl: WebGLRenderingContext): number[] {\n  if (filterMode === LayerFilterMode.Blend) {\n    return [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA];\n  } else if (filterMode === LayerFilterMode.Additive) {\n    return [gl.SRC_ALPHA, gl.ONE];\n  } else if (filterMode === LayerFilterMode.AddAlpha) {\n    return [gl.SRC_ALPHA, gl.ONE];\n  } else if (filterMode === LayerFilterMode.Modulate) {\n    return [gl.ZERO, gl.SRC_COLOR];\n  } else if (filterMode === LayerFilterMode.Modulate2x) {\n    return [gl.DST_COLOR, gl.SRC_COLOR];\n  } else {\n    return [0, 0];\n  }\n}\n\nexport function emitterFilterMode(filterMode: Particle2FilterMode, gl: WebGLRenderingContext): number[] {\n  if (filterMode === Particle2FilterMode.Blend) {\n    return [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA];\n  } else if (filterMode === Particle2FilterMode.Additive) {\n    return [gl.SRC_ALPHA, gl.ONE];\n  } else if (filterMode === Particle2FilterMode.Modulate) {\n    return [gl.ZERO, gl.SRC_COLOR];\n  } else if (filterMode === Particle2FilterMode.Modulate2x) {\n    return [gl.DST_COLOR, gl.SRC_COLOR];\n  } else if (filterMode === Particle2FilterMode.AlphaKey) {\n    return [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA];\n  } else {\n    return [0, 0];\n  }\n}\n","import MdlxLayer, { FilterMode, Flags } from '../../../parsers/mdlx/layer';\nimport MdxModel from './model';\nimport AnimatedObject from './animatedobject';\nimport TextureAnimation from './textureanimation';\nimport { layerFilterMode } from './filtermode';\nimport Shader from '../../gl/shader';\n\n/**\n * An MDX layer.\n */\nexport default class Layer extends AnimatedObject {\n  index: number;\n  priorityPlane: number;\n  filterMode: FilterMode;\n  textureId = 0;\n  coordId: number;\n  alpha: number;\n  unshaded: number;\n  sphereEnvironmentMap: number;\n  twoSided: number;\n  unfogged: number;\n  noDepthTest: number;\n  noDepthSet: number;\n  depthMaskValue: boolean;\n  blendSrc = 0;\n  blendDst = 0;\n  blended = false;\n  textureAnimation: TextureAnimation | null = null;\n\n  constructor(model: MdxModel, layer: MdlxLayer, layerId: number, priorityPlane: number) {\n    super(model, layer);\n\n    let filterMode = layer.filterMode;\n    const textureAnimationId = layer.textureAnimationId;\n    const gl = model.viewer.gl;\n\n    this.index = layerId;\n    this.priorityPlane = priorityPlane;\n\n    if (filterMode > FilterMode.Modulate2x) {\n      filterMode = FilterMode.Blend;\n    }\n\n    this.filterMode = filterMode;\n\n    if (layer.textureId !== -1) {\n      this.textureId = layer.textureId;\n    }\n\n    this.coordId = layer.coordId;\n    this.alpha = layer.alpha;\n\n    const flags = layer.flags;\n\n    this.unshaded = flags & Flags.Unshaded;\n    this.sphereEnvironmentMap = flags & Flags.SphereEnvMap;\n    this.twoSided = flags & Flags.TwoSided;\n    this.unfogged = flags & Flags.Unfogged;\n    this.noDepthTest = flags & Flags.NoDepthTest;\n    this.noDepthSet = flags & Flags.NoDepthSet;\n\n    this.depthMaskValue = (filterMode === FilterMode.None || filterMode === FilterMode.Transparent);\n\n    if (filterMode > FilterMode.Transparent) {\n      this.blended = true;\n      [this.blendSrc, this.blendDst] = layerFilterMode(filterMode, gl);\n    }\n\n    if (textureAnimationId !== -1) {\n      const textureAnimation = model.textureAnimations[textureAnimationId];\n\n      if (textureAnimation) {\n        this.textureAnimation = textureAnimation;\n      }\n    }\n\n    this.addVariants('KMTA', 'alpha');\n    this.addVariants('KMTF', 'textureId');\n  }\n\n  bind(shader: Shader): void {\n    const gl = this.model.viewer.gl;\n\n    // gl.uniform1f(shader.uniforms.u_unshaded, this.unshaded);\n    gl.uniform1f(shader.uniforms['u_filterMode'], this.filterMode);\n\n    if (this.blended) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(this.blendSrc, this.blendDst);\n    } else {\n      gl.disable(gl.BLEND);\n    }\n\n    if (this.twoSided) {\n      gl.disable(gl.CULL_FACE);\n    } else {\n      gl.enable(gl.CULL_FACE);\n    }\n\n    if (this.noDepthTest) {\n      gl.disable(gl.DEPTH_TEST);\n    } else {\n      gl.enable(gl.DEPTH_TEST);\n    }\n\n    if (this.noDepthSet) {\n      gl.depthMask(false);\n    } else {\n      gl.depthMask(this.depthMaskValue);\n    }\n  }\n\n  getAlpha(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KMTA', sequence, frame, counter, this.alpha);\n  }\n\n  getTextureId(out: Uint32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KMTF', sequence, frame, counter, this.textureId);\n  }\n}\n","import MdxModel from './model';\nimport Layer from './layer';\n\n/**\n * An MDX material.\n */\nexport default class Material {\n  model: MdxModel;\n  shader: string;\n  layers: Layer[];\n\n  constructor(model: MdxModel, shader: string, layers: Layer[]) {\n    this.model = model;\n    this.shader = shader;\n    this.layers = layers;\n  }\n}\n","import { vec3 } from 'gl-matrix';\nimport MdlxGeosetAnimation from '../../../parsers/mdlx/geosetanimation';\nimport AnimatedObject from './animatedobject';\nimport MdxModel from './model';\n\n/**\n * A geoset animation.\n */\nexport default class GeosetAnimation extends AnimatedObject {\n  alpha: number;\n  color: vec3;\n  geosetId: number;\n\n  constructor(model: MdxModel, geosetAnimation: MdlxGeosetAnimation) {\n    super(model, geosetAnimation);\n\n    const color = geosetAnimation.color;\n\n    this.alpha = geosetAnimation.alpha;\n    this.color = vec3.fromValues(color[2], color[1], color[0]); // Stored as RGB, but animated colors are stored as BGR, so sizzle.\n    this.geosetId = geosetAnimation.geosetId;\n\n    this.addVariants('KGAO', 'alpha');\n    this.addVariants('KGAC', 'color');\n  }\n\n  getAlpha(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KGAO', sequence, frame, counter, this.alpha);\n  }\n\n  getColor(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KGAC', sequence, frame, counter, <Float32Array>this.color);\n  }\n}\n","export default {\n  1: 'TeamColor/TeamColor00',\n  2: 'TeamGlow/TeamGlow00',\n  11: 'Cliff/Cliff0',\n  21: '', // Used by all cursor models (HumanCursor, OrcCursor, UndeadCursor, NightElfCursor)\n  31: 'LordaeronTree/LordaeronSummerTree',\n  32: 'AshenvaleTree/AshenTree',\n  33: 'BarrensTree/BarrensTree',\n  34: 'NorthrendTree/NorthTree',\n  35: 'Mushroom/MushroomTree',\n  36: 'RuinsTree/RuinsTree',\n  37: 'OutlandMushroomTree/MushroomTree',\n};\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT } from '../../../common/gl-matrix-addon';\nimport MdlxGenericObject, { Flags } from '../../../parsers/mdlx/genericobject';\nimport AnimatedObject from './animatedobject';\nimport MdxModel from './model';\n\n/**\n * An MDX generic object.\n */\nexport default class GenericObject extends AnimatedObject {\n  index: number;\n  name: string;\n  objectId: number;\n  parentId: number;\n  pivot: vec3;\n  dontInheritTranslation: boolean;\n  dontInheritRotation: boolean;\n  dontInheritScaling: boolean;\n  billboarded: boolean;\n  billboardedX: boolean;\n  billboardedY: boolean;\n  billboardedZ: boolean;\n  cameraAnchored: boolean;\n  anyBillboarding: boolean;\n\n  constructor(model: MdxModel, object: MdlxGenericObject, index: number) {\n    super(model, object);\n\n    this.index = index;\n    this.name = object.name;\n    this.objectId = object.objectId;\n    this.parentId = object.parentId;\n    this.pivot = <vec3>model.pivotPoints[object.objectId] || vec3.create();\n\n    const flags = object.flags;\n    this.dontInheritTranslation = (flags & Flags.DontInheritTranslation) > 0;\n    this.dontInheritRotation = (flags & Flags.DontInheritRotation) > 0;\n    this.dontInheritScaling = (flags & Flags.DontInheritScaling) > 0;\n    this.billboarded = (flags & Flags.Billboarded) > 0;\n    this.billboardedX = (flags & Flags.BillboardedLockX) > 0;\n    this.billboardedY = (flags & Flags.BillboardedLockY) > 0;\n    this.billboardedZ = (flags & Flags.BillboardedLockZ) > 0;\n    this.cameraAnchored = (flags & Flags.CameraAnchored) > 0;\n    this.anyBillboarding = this.billboarded || this.billboardedX || this.billboardedY || this.billboardedZ;\n\n    if (object.objectId === object.parentId) {\n      this.parentId = -1;\n    }\n\n    this.addVariants('KGTR', 'translation');\n    this.addVariants('KGRT', 'rotation');\n    this.addVariants('KGSC', 'scale');\n    this.addVariantIntersection(['translation', 'rotation', 'scale'], 'generic');\n  }\n\n  /**\n   * Give a consistent visibility getter for all generic objects.\n   * \n   * Many of the generic objects have animated visibilities, and will override this.\n   */\n  getVisibility(out: Float32Array, _sequence: number, _frame: number, _counter: number): number {\n    out[0] = 1;\n\n    return -1;\n  }\n\n  getTranslation(out: vec3, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(<Float32Array>out, 'KGTR', sequence, frame, counter, <Float32Array>VEC3_ZERO);\n  }\n\n  getRotation(out: quat, sequence: number, frame: number, counter: number): number {\n    return this.getQuatValue(<Float32Array>out, 'KGRT', sequence, frame, counter, <Float32Array>QUAT_DEFAULT);\n  }\n\n  getScale(out: vec3, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(<Float32Array>out, 'KGSC', sequence, frame, counter, <Float32Array>VEC3_ONE);\n  }\n}\n","import MdlxBone from '../../../parsers/mdlx/bone';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\nimport GeosetAnimation from './geosetanimation';\n\n/**\n * An MDX bone.\n */\nexport default class Bone extends GenericObject {\n  geosetAnimation: GeosetAnimation;\n\n  constructor(model: MdxModel, bone: MdlxBone, index: number) {\n    super(model, bone, index);\n\n    this.geosetAnimation = model.geosetAnimations[bone.geosetAnimationId];\n  }\n\n  override getVisibility(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    if (this.geosetAnimation) {\n      return this.geosetAnimation.getAlpha(out, sequence, frame, counter);\n    }\n\n    out[0] = 1;\n\n    return -1;\n  }\n}\n","import MdlxLight, { LightType } from '../../../parsers/mdlx/light';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\n\n/**\n * An MDX light.\n */\nexport default class Light extends GenericObject {\n  type: LightType;\n  attenuation: Float32Array;\n  color: Float32Array;\n  intensity: number;\n  ambientColor: Float32Array;\n  ambientIntensity: number;\n\n  constructor(model: MdxModel, light: MdlxLight, index: number) {\n    super(model, light, index);\n\n    this.type = light.type;\n    this.attenuation = light.attenuation;\n    this.color = light.color;\n    this.intensity = light.intensity;\n    this.ambientColor = light.ambientColor;\n    this.ambientIntensity = light.ambientIntensity;\n  }\n\n  getAttenuationStart(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KLAS', sequence, frame, counter, this.attenuation[0]);\n  }\n\n  getAttenuationEnd(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KLAE', sequence, frame, counter, this.attenuation[1]);\n  }\n\n  getIntensity(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KLAI', sequence, frame, counter, this.intensity);\n  }\n\n  getColor(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KLAC', sequence, frame, counter, this.color);\n  }\n\n  getAmbientIntensity(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KLBI', sequence, frame, counter, this.ambientIntensity);\n  }\n\n  getAmbientColor(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KLBC', sequence, frame, counter, this.ambientColor);\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX helper.\n */\nexport default class Helper extends GenericObject {}\n","import MdlxAttachment from '../../../parsers/mdlx/attachment';\nimport GenericObject from './genericobject';\nimport MdxModel from './model';\n\n/**\n * An MDX attachment.\n */\nexport default class Attachment extends GenericObject {\n  path: string;\n  attachmentId: number;\n  internalModel: MdxModel | null = null;\n\n  constructor(model: MdxModel, attachment: MdlxAttachment, index: number) {\n    super(model, attachment, index);\n\n    const path = attachment.path.replace(/\\\\/g, '/').toLowerCase().replace('.mdl', '.mdx');\n\n    this.path = path;\n    this.attachmentId = attachment.attachmentId;\n\n    // Second condition is against custom resources using arbitrary paths...\n    if (path !== '' && path.indexOf('.mdx') != -1) {\n      const promise = model.viewer.load(path, model.pathSolver, model.solverParams);\n\n      promise.then((model) => {\n        if (model) {\n          this.internalModel = <MdxModel>model;\n        }\n      });\n\n      model.blockers.push(promise);\n    }\n  }\n\n  override getVisibility(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KATV', sequence, frame, counter, 1);\n  }\n}\n","import ParticleEmitter from '../../../parsers/mdlx/particleemitter';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\n\n/**\n * An MDX particle emitter.\n */\nexport default class ParticleEmitterObject extends GenericObject {\n  internalModel: MdxModel | null = null;\n  speed: number;\n  latitude: number;\n  longitude: number;\n  lifeSpan: number;\n  gravity: number;\n  emissionRate: number;\n  ok = false;\n\n  constructor(model: MdxModel, emitter: ParticleEmitter, index: number) {\n    super(model, emitter, index);\n\n    this.speed = emitter.speed;\n    this.latitude = emitter.latitude;\n    this.longitude = emitter.longitude;\n    this.lifeSpan = emitter.lifeSpan;\n    this.gravity = emitter.gravity;\n    this.emissionRate = emitter.emissionRate;\n\n    model.viewer.load(emitter.path.replace(/\\\\/g, '/').toLowerCase().replace('.mdl', '.mdx'), model.pathSolver, model.solverParams)\n      .then((model) => {\n        if (model) {\n          this.internalModel = <MdxModel>model;\n          this.ok = true;\n        }\n      });\n  }\n\n  getSpeed(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPES', sequence, frame, counter, this.speed);\n  }\n\n  getLatitude(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPLTV', sequence, frame, counter, this.latitude);\n  }\n\n  getLongitude(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPLN', sequence, frame, counter, this.longitude);\n  }\n\n  getLifeSpan(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPEL', sequence, frame, counter, this.lifeSpan);\n  }\n\n  getGravity(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPEG', sequence, frame, counter, this.gravity);\n  }\n\n  getEmissionRate(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPEE', sequence, frame, counter, this.emissionRate);\n  }\n\n  override getVisibility(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KPEV', sequence, frame, counter, 1);\n  }\n}\n","import { vec3 } from 'gl-matrix';\nimport Scene from '../../scene';\nimport Shader from '../../gl/shader';\nimport ClientBuffer from '../../gl/clientbuffer';\nimport Texture from '../../texture';\nimport ParticleEmitter2Object from './particleemitter2object';\nimport RibbonEmitterObject from './ribbonemitterobject';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport ParticleEmitter2 from './particleemitter2';\nimport RibbonEmitter from './ribbonemitter';\nimport EventObjectSplEmitter from './eventobjectsplemitter';\nimport EventObjectUbrEmitter from './eventobjectubremitter';\nimport Particle2 from './particle2';\nimport Ribbon from './ribbon';\nimport EventObjectSplUbr from './eventobjectsplubr';\nimport MdxTexture from './texture';\nimport { HeadOrTail } from '../../../parsers/mdlx/particleemitter2';\nimport { MdxHandlerObject } from './handler';\n\nconst locationHeap = vec3.create();\nconst startHeap = vec3.create();\nconst endHeap = vec3.create();\n\n// The total storage that emitted objects can use.\n// This is enough to support all of the MDX geometry emitters.\n// The memory layout is the same as this C struct:\n//\n//   struct {\n//     float p0[3]\n//     float p1[3]\n//     float p2[3]\n//     float p3[3]\n//     float health\n//     byte color[4]\n//     byte tail\n//     byte leftRightTop[3]\n//   }\n//\nexport const BYTES_PER_OBJECT = 60;\nexport const FLOATS_PER_OBJECT = BYTES_PER_OBJECT >> 2;\n\n// Offsets into the emitted object structure.\nexport const BYTE_OFFSET_P0 = 0;\nexport const BYTE_OFFSET_P1 = 12;\nexport const BYTE_OFFSET_P2 = 24;\nexport const BYTE_OFFSET_P3 = 36;\nexport const BYTE_OFFSET_HEALTH = 48;\nexport const BYTE_OFFSET_COLOR = 52;\nexport const BYTE_OFFSET_TAIL = 56;\nexport const BYTE_OFFSET_LEFT_RIGHT_TOP = 57;\n\n// Offset aliases.\nexport const FLOAT_OFFSET_P0 = BYTE_OFFSET_P0 >> 2;\nexport const FLOAT_OFFSET_P1 = BYTE_OFFSET_P1 >> 2;\nexport const FLOAT_OFFSET_P2 = BYTE_OFFSET_P2 >> 2;\nexport const FLOAT_OFFSET_P3 = BYTE_OFFSET_P3 >> 2;\nexport const FLOAT_OFFSET_HEALTH = BYTE_OFFSET_HEALTH >> 2;\nexport const BYTE_OFFSET_TEAM_COLOR = BYTE_OFFSET_LEFT_RIGHT_TOP;\n\n// Emitter types\nexport const EMITTER_PARTICLE2 = 0;\nexport const EMITTER_RIBBON = 1;\nexport const EMITTER_SPLAT = 2;\nexport const EMITTER_UBERSPLAT = 3;\n\n// Offsets for overriding emitter textures using setResource().\nexport const EMITTER_PARTICLE2_TEXTURE_OFFSET = 1000;\nexport const EMITTER_EVENT_TEXTURE_OFFSET = 10000;\n\n// The game scales the emission rate of particle emitters depending on the particles setting.\n// High seems to double the emission.\nexport const SETTING_PARTICLES_HIGH = 2;\n\nexport type GeometryEmitter = ParticleEmitter2 | RibbonEmitter | EventObjectSplEmitter | EventObjectUbrEmitter;\nexport type GeometryEmitterObject = ParticleEmitter2Object | RibbonEmitterObject | EventObjectEmitterObject;\n\nfunction bindParticleEmitter2Buffer(emitter: ParticleEmitter2, buffer: ClientBuffer): void {\n  const instance = <MdxModelInstance>emitter.instance;\n  const objects = <Particle2[]>emitter.objects;\n  const byteView = <Uint8Array>buffer.byteView;\n  const floatView = <Float32Array>buffer.floatView;\n  const emitterObject = <ParticleEmitter2Object>emitter.emitterObject;\n  const modelSpace = emitterObject.modelSpace;\n  const tailLength = emitterObject.tailLength;\n  const node = emitter.node;\n  const teamColor = instance.teamColor;\n  let offset = 0;\n\n  for (const object of objects) {\n    const byteOffset = offset * BYTES_PER_OBJECT;\n    const floatOffset = offset * FLOATS_PER_OBJECT;\n    const p0Offset = floatOffset + FLOAT_OFFSET_P0;\n    let location = object.location;\n    const scale = object.scale;\n    const tail = object.tail;\n\n    if (tail === HeadOrTail.Head) {\n      // If this is a model space emitter, the location is in local space, so convert it to world space.\n      if (modelSpace) {\n        location = vec3.transformMat4(locationHeap, location, node.worldMatrix);\n      }\n\n      floatView[p0Offset + 0] = location[0];\n      floatView[p0Offset + 1] = location[1];\n      floatView[p0Offset + 2] = location[2];\n\n      // Used to rotate XY particles to face their velocity on the XY plane.\n      floatView[p0Offset + 3] = object.facing;\n    } else {\n      const velocity = object.velocity;\n      let start = startHeap;\n      let end = location;\n\n      start[0] = end[0] - tailLength * velocity[0];\n      start[1] = end[1] - tailLength * velocity[1];\n      start[2] = end[2] - tailLength * velocity[2];\n\n      // If this is a model space emitter, the start and end are in local space, so convert them to world space.\n      if (modelSpace) {\n        start = vec3.transformMat4(start, start, node.worldMatrix);\n        end = vec3.transformMat4(endHeap, end, node.worldMatrix);\n      }\n\n      floatView[p0Offset + 0] = start[0];\n      floatView[p0Offset + 1] = start[1];\n      floatView[p0Offset + 2] = start[2];\n      floatView[p0Offset + 3] = end[0];\n      floatView[p0Offset + 4] = end[1];\n      floatView[p0Offset + 5] = end[2];\n    }\n\n    floatView[p0Offset + 6] = scale[0];\n    floatView[p0Offset + 7] = scale[0];\n    floatView[p0Offset + 8] = scale[0];\n\n    floatView[floatOffset + FLOAT_OFFSET_HEALTH] = object.health;\n\n    byteView[byteOffset + BYTE_OFFSET_TAIL] = tail;\n    byteView[byteOffset + BYTE_OFFSET_TEAM_COLOR] = teamColor;\n\n    offset += 1;\n  }\n}\n\nfunction bindParticleEmitter2Shader(emitter: ParticleEmitter2, shader: Shader): void {\n  const instance = <MdxModelInstance>emitter.instance;\n  const textureOverrides = instance.textureOverrides;\n  const scene = <Scene>instance.scene;\n  const camera = scene.camera;\n  const emitterObject = <ParticleEmitter2Object>emitter.emitterObject;\n  const model = emitterObject.model;\n  const viewer = model.viewer;\n  const gl = viewer.gl;\n  const mdxCache = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n  const uniforms = shader.uniforms;\n  const colors = emitterObject.colors;\n  const intervals = emitterObject.intervals;\n  const replaceable = emitterObject.replaceableId;\n  let vectors;\n  let mdxTexture = <MdxTexture>emitterObject.internalTexture;\n\n  gl.blendFunc(emitterObject.blendSrc, emitterObject.blendDst);\n  gl.uniform1f(uniforms['u_filterMode'], emitterObject.filterMode);\n\n  // Determine where this texture is coming from.\n  // This is to get the texture wrap modes.\n  // The texture is either a replaceable in which case it's stored internally, a team color in which case it's stored in the handler, or a reference to one of the model textures.\n  if (emitterObject.internalTexture) {\n    mdxTexture = emitterObject.internalTexture;\n  } else if (replaceable === 1) {\n    mdxTexture = mdxCache.teamColors[instance.teamColor];\n  } else if (replaceable === 2) {\n    mdxTexture = mdxCache.teamGlows[instance.teamColor];\n  } else {\n    mdxTexture = model.textures[emitterObject.textureId];\n  }\n\n  // Now get the actual texture itself.\n  // First check if there is an override for this particle emitter.\n  let texture: Texture | null | undefined = textureOverrides.get(EMITTER_PARTICLE2_TEXTURE_OFFSET + emitterObject.index);\n\n  if (!texture) {\n    // Next check if there is an override for model textures if this is one.\n    if (replaceable === 0) {\n      texture = textureOverrides.get(emitterObject.textureId);\n    }\n\n    // If there is still no override, get it from the existing texture object.\n    if (!texture) {\n      texture = mdxTexture.texture;\n    }\n  }\n\n  viewer.webgl.bindTextureAndWrap(texture, 0, mdxTexture.wrapS, mdxTexture.wrapT);\n\n  // Choose between a default rectangle or a billboarded one\n  if (emitterObject.xYQuad) {\n    vectors = camera.vectors;\n  } else {\n    vectors = camera.billboardedVectors;\n  }\n\n  gl.uniform1f(uniforms['u_lifeSpan'], emitterObject.lifeSpan);\n  gl.uniform1f(uniforms['u_timeMiddle'], emitterObject.timeMiddle);\n  gl.uniform1f(uniforms['u_columns'], emitterObject.columns);\n  gl.uniform1f(uniforms['u_rows'], emitterObject.rows);\n  gl.uniform1f(uniforms['u_teamColored'], emitterObject.teamColored);\n\n  gl.uniform3fv(uniforms['u_intervals[0]'], intervals[0]);\n  gl.uniform3fv(uniforms['u_intervals[1]'], intervals[1]);\n  gl.uniform3fv(uniforms['u_intervals[2]'], intervals[2]);\n  gl.uniform3fv(uniforms['u_intervals[3]'], intervals[3]);\n\n  gl.uniform4fv(uniforms['u_colors[0]'], colors[0]);\n  gl.uniform4fv(uniforms['u_colors[1]'], colors[1]);\n  gl.uniform4fv(uniforms['u_colors[2]'], colors[2]);\n\n  gl.uniform3fv(uniforms['u_scaling'], emitterObject.scaling);\n\n  if (emitterObject.head) {\n    gl.uniform3fv(uniforms['u_vertices[0]'], vectors[0]);\n    gl.uniform3fv(uniforms['u_vertices[1]'], vectors[1]);\n    gl.uniform3fv(uniforms['u_vertices[2]'], vectors[2]);\n    gl.uniform3fv(uniforms['u_vertices[3]'], vectors[3]);\n  }\n\n  if (emitterObject.tail) {\n    gl.uniform3fv(uniforms['u_cameraZ'], camera.directionZ);\n  }\n}\n\nfunction bindRibbonEmitterBuffer(emitter: RibbonEmitter, buffer: ClientBuffer): void {\n  let object = <Ribbon>emitter.first;\n  const byteView = <Uint8Array>buffer.byteView;\n  const floatView = <Float32Array>buffer.floatView;\n  const emitterObject = <RibbonEmitterObject>emitter.emitterObject;\n  const columns = emitterObject.columns;\n  const alive = emitter.alive;\n  const chainLengthFactor = 1 / (alive - 1);\n  let offset = 0;\n\n  while (object.next) {\n    const next = object.next.vertices;\n    const byteOffset = offset * BYTES_PER_OBJECT;\n    const floatOffset = offset * FLOATS_PER_OBJECT;\n    const p0Offset = floatOffset + FLOAT_OFFSET_P0;\n    const colorOffset = byteOffset + BYTE_OFFSET_COLOR;\n    const leftRightTopOffset = byteOffset + BYTE_OFFSET_LEFT_RIGHT_TOP;\n    const left = ((object.slot % columns) + (1 - (offset * chainLengthFactor) - chainLengthFactor)) / columns;\n    const top = object.slot / columns;\n    const right = left + chainLengthFactor;\n    const vertices = object.vertices;\n    const color = object.color;\n\n    floatView[p0Offset + 0] = vertices[0];\n    floatView[p0Offset + 1] = vertices[1];\n    floatView[p0Offset + 2] = vertices[2];\n    floatView[p0Offset + 3] = vertices[3];\n    floatView[p0Offset + 4] = vertices[4];\n    floatView[p0Offset + 5] = vertices[5];\n    floatView[p0Offset + 6] = next[3];\n    floatView[p0Offset + 7] = next[4];\n    floatView[p0Offset + 8] = next[5];\n    floatView[p0Offset + 9] = next[0];\n    floatView[p0Offset + 10] = next[1];\n    floatView[p0Offset + 11] = next[2];\n\n    byteView[colorOffset + 0] = color[0];\n    byteView[colorOffset + 1] = color[1];\n    byteView[colorOffset + 2] = color[2];\n    byteView[colorOffset + 3] = color[3];\n\n    byteView[leftRightTopOffset + 0] = left * 255;\n    byteView[leftRightTopOffset + 1] = right * 255;\n    byteView[leftRightTopOffset + 2] = top * 255;\n\n    object = object.next;\n    offset += 1;\n  }\n}\n\nfunction bindRibbonEmitterShader(emitter: RibbonEmitter, shader: Shader): void {\n  const textureOverrides = emitter.instance.textureOverrides;\n  const emitterObject = <RibbonEmitterObject>emitter.emitterObject;\n  const layer = emitterObject.layer;\n  const model = emitterObject.model;\n  const gl = model.viewer.gl;\n  const uniforms = shader.uniforms;\n  const texture = model.textures[layer.textureId];\n  const actualTexture = textureOverrides.get(layer.textureId) || texture.texture;\n\n  layer.bind(shader);\n\n  gl.uniform1f(uniforms['u_filterMode'], layer.filterMode);\n\n  model.viewer.webgl.bindTextureAndWrap(actualTexture, 0, texture.wrapS, texture.wrapT);\n\n  gl.uniform1f(uniforms['u_columns'], emitterObject.columns);\n  gl.uniform1f(uniforms['u_rows'], emitterObject.rows);\n}\n\nfunction bindEventObjectEmitterBuffer(emitter: EventObjectSplEmitter | EventObjectUbrEmitter, buffer: ClientBuffer): void {\n  const objects = <EventObjectSplUbr[]>emitter.objects;\n  const floatView = <Float32Array>buffer.floatView;\n  let offset = 0;\n\n  for (const object of objects) {\n    const floatOffset = offset * FLOATS_PER_OBJECT;\n    const p0Offset = floatOffset + FLOAT_OFFSET_P0;\n    const vertices = object.vertices;\n\n    floatView[p0Offset + 0] = vertices[0];\n    floatView[p0Offset + 1] = vertices[1];\n    floatView[p0Offset + 2] = vertices[2];\n    floatView[p0Offset + 3] = vertices[3];\n    floatView[p0Offset + 4] = vertices[4];\n    floatView[p0Offset + 5] = vertices[5];\n    floatView[p0Offset + 6] = vertices[6];\n    floatView[p0Offset + 7] = vertices[7];\n    floatView[p0Offset + 8] = vertices[8];\n    floatView[p0Offset + 9] = vertices[9];\n    floatView[p0Offset + 10] = vertices[10];\n    floatView[p0Offset + 11] = vertices[11];\n\n    floatView[floatOffset + FLOAT_OFFSET_HEALTH] = object.health;\n\n    offset += 1;\n  }\n}\n\nfunction bindEventObjectSplEmitterShader(emitter: EventObjectSplEmitter, shader: Shader): void {\n  const textureOverrides = emitter.instance.textureOverrides;\n  const emitterObject = <EventObjectEmitterObject>emitter.emitterObject;\n  const intervalTimes = emitterObject.intervalTimes;\n  const intervals = emitterObject.intervals;\n  const colors = emitterObject.colors;\n  const model = emitterObject.model;\n  const gl = model.viewer.gl;\n  const uniforms = shader.uniforms;\n  const texture = <MdxTexture>emitterObject.internalTexture;\n  const actualTexture = textureOverrides.get(EMITTER_EVENT_TEXTURE_OFFSET + emitterObject.index) || texture.texture;\n\n  gl.blendFunc(emitterObject.blendSrc, emitterObject.blendDst);\n\n  model.viewer.webgl.bindTextureAndWrap(actualTexture, 0, texture.wrapS, texture.wrapT);\n\n  gl.uniform1f(uniforms['u_lifeSpan'], emitterObject.lifeSpan);\n  gl.uniform1f(uniforms['u_columns'], emitterObject.columns);\n  gl.uniform1f(uniforms['u_rows'], emitterObject.rows);\n\n  // 3 because the uniform is shared with UBR, which has 3 values.\n  gl.uniform3f(uniforms['u_intervalTimes'], intervalTimes[0], intervalTimes[1], 0);\n\n  gl.uniform3fv(uniforms['u_intervals[0]'], intervals[0]);\n  gl.uniform3fv(uniforms['u_intervals[1]'], intervals[1]);\n\n  gl.uniform4fv(uniforms['u_colors[0]'], colors[0]);\n  gl.uniform4fv(uniforms['u_colors[1]'], colors[1]);\n  gl.uniform4fv(uniforms['u_colors[2]'], colors[2]);\n}\n\nfunction bindEventObjectUbrEmitterShader(emitter: EventObjectUbrEmitter, shader: Shader): void {\n  const textureOverrides = emitter.instance.textureOverrides;\n  const emitterObject = <EventObjectEmitterObject>emitter.emitterObject;\n  const intervalTimes = emitterObject.intervalTimes;\n  const colors = emitterObject.colors;\n  const model = emitterObject.model;\n  const viewer = model.viewer;\n  const gl = viewer.gl;\n  const uniforms = shader.uniforms;\n  const texture = <MdxTexture>emitterObject.internalTexture;\n  const actualTexture = textureOverrides.get(EMITTER_EVENT_TEXTURE_OFFSET + emitterObject.index) || texture.texture;\n\n  gl.blendFunc(emitterObject.blendSrc, emitterObject.blendDst);\n\n  model.viewer.webgl.bindTextureAndWrap(actualTexture, 0, texture.wrapS, texture.wrapT);\n\n  gl.uniform1f(uniforms['u_lifeSpan'], emitterObject.lifeSpan);\n  gl.uniform1f(uniforms['u_columns'], emitterObject.columns);\n  gl.uniform1f(uniforms['u_rows'], emitterObject.rows);\n\n  gl.uniform3fv(uniforms['u_intervalTimes'], intervalTimes);\n\n  gl.uniform4fv(uniforms['u_colors[0]'], colors[0]);\n  gl.uniform4fv(uniforms['u_colors[1]'], colors[1]);\n  gl.uniform4fv(uniforms['u_colors[2]'], colors[2]);\n}\n\nexport function renderEmitter(emitter: GeometryEmitter, shader: Shader): void {\n  let alive = emitter.alive;\n  const emitterObject = <GeometryEmitterObject>emitter.emitterObject;\n  const emitterType = emitterObject.geometryEmitterType;\n\n  if (emitterType === EMITTER_RIBBON) {\n    alive -= 1;\n  }\n\n  if (alive > 0) {\n    const viewer = emitter.instance.model.viewer;\n    const buffer = viewer.buffer;\n    const gl = viewer.gl;\n    const instancedArrays = <ANGLE_instanced_arrays>viewer.webgl.extensions['ANGLE_instanced_arrays'];\n    const size = alive * BYTES_PER_OBJECT;\n    const attribs = shader.attribs;\n\n    buffer.reserve(size);\n\n    if (emitterType === EMITTER_PARTICLE2) {\n      bindParticleEmitter2Buffer(<ParticleEmitter2>emitter, buffer);\n      bindParticleEmitter2Shader(<ParticleEmitter2>emitter, shader);\n    } else if (emitterType === EMITTER_RIBBON) {\n      bindRibbonEmitterBuffer(<RibbonEmitter>emitter, buffer);\n      bindRibbonEmitterShader(<RibbonEmitter>emitter, shader);\n    } else if (emitterType === EMITTER_SPLAT) {\n      bindEventObjectEmitterBuffer(<EventObjectSplEmitter>emitter, buffer);\n      bindEventObjectSplEmitterShader(<EventObjectSplEmitter>emitter, shader);\n    } else {\n      bindEventObjectEmitterBuffer(<EventObjectUbrEmitter>emitter, buffer);\n      bindEventObjectUbrEmitterShader(<EventObjectUbrEmitter>emitter, shader);\n    }\n\n    buffer.bindAndUpdate(size);\n\n    gl.uniform1i(shader.uniforms['u_emitter'], emitterType);\n\n    gl.vertexAttribPointer(attribs['a_p0'], 3, gl.FLOAT, false, BYTES_PER_OBJECT, BYTE_OFFSET_P0);\n    gl.vertexAttribPointer(attribs['a_p1'], 3, gl.FLOAT, false, BYTES_PER_OBJECT, BYTE_OFFSET_P1);\n    gl.vertexAttribPointer(attribs['a_p2'], 3, gl.FLOAT, false, BYTES_PER_OBJECT, BYTE_OFFSET_P2);\n    gl.vertexAttribPointer(attribs['a_p3'], 3, gl.FLOAT, false, BYTES_PER_OBJECT, BYTE_OFFSET_P3);\n    gl.vertexAttribPointer(attribs['a_health'], 1, gl.FLOAT, false, BYTES_PER_OBJECT, BYTE_OFFSET_HEALTH);\n    gl.vertexAttribPointer(attribs['a_color'], 4, gl.UNSIGNED_BYTE, true, BYTES_PER_OBJECT, BYTE_OFFSET_COLOR);\n    gl.vertexAttribPointer(attribs['a_tail'], 1, gl.UNSIGNED_BYTE, false, BYTES_PER_OBJECT, BYTE_OFFSET_TAIL);\n    gl.vertexAttribPointer(attribs['a_leftRightTop'], 3, gl.UNSIGNED_BYTE, false, BYTES_PER_OBJECT, BYTE_OFFSET_LEFT_RIGHT_TOP);\n\n    instancedArrays.drawArraysInstancedANGLE(gl.TRIANGLES, 0, 6, alive);\n  }\n}\n","import { WrapMode } from '../../../parsers/mdlx/texture';\nimport Texture from '../../texture';\n\n/**\n * An MDX texture.\n */\nexport default class MdxTexture {\n  texture: Texture | null = null;\n  replaceableId: number;\n  wrapS = 0x812f; // CLAMP_TO_EDGE\n  wrapT = 0x812f;\n\n  constructor(replaceableId: number, wrapMode: WrapMode) {\n    this.replaceableId = replaceableId;\n\n    if (wrapMode & WrapMode.WrapWidth) {\n      this.wrapS = 0x2901; // REPEAT\n    }\n\n    if (wrapMode & WrapMode.WrapHeight) {\n      this.wrapT = 0x2901;\n    }\n  }\n}\n","import MdlxParticleEmitter2, { Flags, HeadOrTail } from '../../../parsers/mdlx/particleemitter2';\nimport Texture from '../../texture';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\nimport { emitterFilterMode } from './filtermode';\nimport replaceableIds from './replaceableids';\nimport { EMITTER_PARTICLE2, SETTING_PARTICLES_HIGH } from './geometryemitterfuncs';\nimport MdxTexture from './texture';\nimport { WrapMode } from '../../../parsers/mdlx/texture';\n\n/**\n * An MDX particle emitter type 2.\n */\nexport default class ParticleEmitter2Object extends GenericObject {\n  geometryEmitterType = EMITTER_PARTICLE2;\n  width: number;\n  length: number;\n  speed: number;\n  latitude: number;\n  gravity: number;\n  emissionRate: number;\n  squirt: number;\n  lifeSpan: number;\n  variation: number;\n  tailLength: number;\n  timeMiddle: number;\n  columns: number;\n  rows: number;\n  teamColored = 0;\n  internalTexture: MdxTexture | null = null;\n  replaceableId: number;\n  textureId: number;\n  head: boolean;\n  tail: boolean;\n  cellWidth: number;\n  cellHeight: number;\n  colors: Float32Array[] = [];\n  scaling: Float32Array;\n  intervals: Float32Array[];\n  filterMode: number;\n  blendSrc: number;\n  blendDst: number;\n  priorityPlane: number;\n  lineEmitter: number;\n  unfogged: number;\n  modelSpace: number;\n  xYQuad: number;\n  /**\n   * Even if the internal texture isn't loaded, it's fine to run emitters based on this emitter object.\n   * \n   * The particles will simply be black.\n   */\n  ok = true;\n\n  constructor(model: MdxModel, emitter: MdlxParticleEmitter2, index: number) {\n    super(model, emitter, index);\n\n    this.width = emitter.width;\n    this.length = emitter.length;\n    this.speed = emitter.speed;\n    this.latitude = emitter.latitude;\n    this.gravity = emitter.gravity;\n    this.emissionRate = emitter.emissionRate * SETTING_PARTICLES_HIGH;\n    this.squirt = emitter.squirt;\n    this.lifeSpan = emitter.lifeSpan;\n    this.variation = emitter.variation;\n    this.tailLength = emitter.tailLength;\n    this.timeMiddle = emitter.timeMiddle;\n\n    const flags = emitter.flags;\n    this.lineEmitter = flags & Flags.LineEmitter;\n    this.unfogged = flags & Flags.Unfogged;\n    this.modelSpace = flags & Flags.ModelSpace;\n    this.xYQuad = flags & Flags.XYQuad;\n\n    const replaceableId = emitter.replaceableId;\n\n    this.columns = emitter.columns;\n    this.rows = emitter.rows;\n\n    if (replaceableId === 1 || replaceableId === 2) {\n      this.teamColored = 1;\n    } else if (replaceableId > 2) {\n      const texturesExt = model.reforged ? '.dds' : '.blp';\n\n      this.internalTexture = new MdxTexture(replaceableId, WrapMode.RepeatBoth);\n\n      model.viewer.load(`ReplaceableTextures\\\\${replaceableIds[replaceableId]}${texturesExt}`, model.pathSolver, model.solverParams)\n        .then((texture) => {\n          if (texture) {\n            (<MdxTexture>this.internalTexture).texture = <Texture>texture;\n          }\n        });\n    }\n\n    this.replaceableId = emitter.replaceableId;\n    this.textureId = emitter.textureId;\n\n    const headOrTail = emitter.headOrTail;\n\n    this.head = (headOrTail === HeadOrTail.Head || headOrTail === HeadOrTail.Both);\n    this.tail = (headOrTail === HeadOrTail.Tail || headOrTail === HeadOrTail.Both);\n\n    this.cellWidth = 1 / emitter.columns;\n    this.cellHeight = 1 / emitter.rows;\n\n    const colors = emitter.segmentColors;\n    const alpha = emitter.segmentAlphas;\n\n    for (let i = 0; i < 3; i++) {\n      const color = colors[i];\n\n      this.colors[i] = new Float32Array([color[0], color[1], color[2], alpha[i] / 255]);\n    }\n\n    this.scaling = emitter.segmentScaling;\n\n    const headIntervals = emitter.headIntervals;\n    const tailIntervals = emitter.tailIntervals;\n\n    // Change to Float32Array instead of Uint32Array to be able to pass the intervals directly using uniform3fv().\n    this.intervals = [\n      new Float32Array(headIntervals[0]),\n      new Float32Array(headIntervals[1]),\n      new Float32Array(tailIntervals[0]),\n      new Float32Array(tailIntervals[1]),\n    ];\n\n    const blendModes = emitterFilterMode(emitter.filterMode, this.model.viewer.gl);\n\n    this.filterMode = emitter.filterMode;\n    this.blendSrc = blendModes[0];\n    this.blendDst = blendModes[1];\n\n    this.priorityPlane = emitter.priorityPlane;\n  }\n\n  getWidth(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2N', sequence, frame, counter, this.width);\n  }\n\n  getLength(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2W', sequence, frame, counter, this.length);\n  }\n\n  getSpeed(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2S', sequence, frame, counter, this.speed);\n  }\n\n  getLatitude(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2L', sequence, frame, counter, this.latitude);\n  }\n\n  getGravity(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2G', sequence, frame, counter, this.gravity);\n  }\n\n  getEmissionRate(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2E', sequence, frame, counter, this.emissionRate);\n  }\n\n  getVariation(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2R', sequence, frame, counter, this.variation);\n  }\n\n  override getVisibility(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KP2V', sequence, frame, counter, 1);\n  }\n}\n","import RibbonEmitter from '../../../parsers/mdlx/ribbonemitter';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\nimport Layer from './layer';\nimport { EMITTER_RIBBON, SETTING_PARTICLES_HIGH } from './geometryemitterfuncs';\n\n/**\n * An MDX ribbon emitter.\n */\nexport default class RibbonEmitterObject extends GenericObject {\n  geometryEmitterType = EMITTER_RIBBON;\n  layer: Layer;\n  heightAbove: number;\n  heightBelow: number;\n  alpha: number;\n  color: Float32Array;\n  lifeSpan: number;\n  textureSlot: number;\n  emissionRate: number;\n  gravity: number;\n  columns: number;\n  rows: number;\n  /**\n   * Even if the internal texture isn't loaded, it's fine to run emitters based on this emitter object.\n   * \n   * The ribbons will simply be black.\n   */\n  ok = true;\n\n  constructor(model: MdxModel, emitter: RibbonEmitter, index: number) {\n    super(model, emitter, index);\n\n    this.layer = model.materials[emitter.materialId].layers[0];\n    this.heightAbove = emitter.heightAbove;\n    this.heightBelow = emitter.heightBelow;\n    this.alpha = emitter.alpha;\n    this.color = emitter.color;\n    this.lifeSpan = emitter.lifeSpan;\n    this.textureSlot = emitter.textureSlot;\n    this.emissionRate = emitter.emissionRate * SETTING_PARTICLES_HIGH;\n    this.gravity = emitter.gravity;\n    this.columns = emitter.columns;\n    this.rows = emitter.rows;\n  }\n\n  getHeightBelow(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KRHB', sequence, frame, counter, this.heightBelow);\n  }\n\n  getHeightAbove(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KRHA', sequence, frame, counter, this.heightAbove);\n  }\n\n  getTextureSlot(out: Uint32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KRTX', sequence, frame, counter, 0);\n  }\n\n  getColor(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KRCO', sequence, frame, counter, this.color);\n  }\n\n  getAlpha(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KRAL', sequence, frame, counter, this.alpha);\n  }\n\n  /**\n   * Ribbon emitters specifically have an alpha.\n   * \n   * When this alpha is 0, naturally ribbons shouldn't be emitted.\n   * \n   * Therefore first check the alpha animation, and only if it's >0 check the visibility animation.\n   */\n  override getVisibility(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    const keyframe = this.getAlpha(out, sequence,frame,counter);\n    \n    if (out[0] === 0) {\n      return keyframe;\n    }\n\n    return this.getScalarValue(out, 'KRVS', sequence, frame, counter, 1);\n  }\n}\n","import { VEC3_ZERO } from '../../../common/gl-matrix-addon';\nimport MdlxCamera from '../../../parsers/mdlx/camera';\nimport AnimatedObject from './animatedobject';\nimport MdxModel from './model';\n\n/**\n * An MDX camera.\n */\nexport default class Camera extends AnimatedObject {\n  name: string;\n  position: Float32Array;\n  fieldOfView: number;\n  farClippingPlane: number;\n  nearClippingPlane: number;\n  targetPosition: Float32Array;\n\n  constructor(model: MdxModel, camera: MdlxCamera) {\n    super(model, camera);\n\n    this.name = camera.name;\n    this.position = camera.position;\n    this.fieldOfView = camera.fieldOfView;\n    this.farClippingPlane = camera.farClippingPlane;\n    this.nearClippingPlane = camera.nearClippingPlane;\n    this.targetPosition = camera.targetPosition;\n  }\n\n  getTranslation(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KCTR', sequence, frame, counter, <Float32Array>VEC3_ZERO);\n  }\n\n  getTargetTranslation(out: Float32Array, sequence: number, frame: number, counter: number): number {\n    return this.getVectorValue(out, 'KTTR', sequence, frame, counter, <Float32Array>VEC3_ZERO);\n  }\n\n  getRotation(out: Uint32Array, sequence: number, frame: number, counter: number): number {\n    return this.getScalarValue(out, 'KCRL', sequence, frame, counter, 0);\n  }\n}\n","import EventObject from '../../../parsers/mdlx/eventobject';\nimport Texture from '../../texture';\nimport GenericResource from '../../genericresource';\nimport mdxHandler from './handler';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\nimport { emitterFilterMode } from './filtermode';\nimport { EMITTER_SPLAT, EMITTER_UBERSPLAT } from './geometryemitterfuncs';\nimport MdxModelInstance from './modelinstance';\nimport MdxTexture from './texture';\nimport { WrapMode } from '../../../parsers/mdlx/texture';\n\n/**\n * An event object.\n */\nexport default class EventObjectEmitterObject extends GenericObject {\n  geometryEmitterType = -1;\n  type: string;\n  id: string;\n  tracks: Uint32Array;\n  globalSequence = -1;\n  defval = new Uint32Array(1);\n  internalModel: MdxModel | null = null;\n  internalTexture: MdxTexture | null = null;\n  colors: Float32Array[] = [];\n  intervalTimes = new Float32Array(3);\n  scale = 0;\n  columns = 0;\n  rows = 0;\n  lifeSpan = 0;\n  blendSrc = 0;\n  blendDst = 0;\n  intervals: Float32Array[] = [];\n  distanceCutoff = 0;\n  maxDistance = 0;\n  minDistance = 0;\n  pitch = 0;\n  pitchVariance = 0;\n  volume = 0;\n  decodedBuffers: AudioBuffer[] = [];\n  ok = false;\n\n  constructor(model: MdxModel, eventObject: EventObject, index: number) {\n    super(model, eventObject, index);\n\n    const viewer = model.viewer;\n    const name = eventObject.name;\n    let type = name.substring(0, 3);\n    const id = name.substring(4);\n\n    // Same thing\n    if (type === 'FPT') {\n      type = 'SPL';\n    }\n\n    if (type === 'SPL') {\n      this.geometryEmitterType = EMITTER_SPLAT;\n    } else if (type === 'UBR') {\n      this.geometryEmitterType = EMITTER_UBERSPLAT;\n    }\n\n    this.type = type;\n    this.id = id;\n    this.tracks = eventObject.tracks;\n\n    const globalSequenceId = eventObject.globalSequenceId;\n    if (globalSequenceId !== -1) {\n      this.globalSequence = model.globalSequences[globalSequenceId];\n    }\n\n    // If this is a sound event object, and the viewer doesn't have audio enabled, don't do anything.\n    // This saves bandwidth when audio is not desired.\n    if (type === 'SND' && !viewer.audioEnabled) {\n      return;\n    }\n\n    // It's not possible to know ahead of time what file(s) event objects would need.\n    // This is because the SLKs are lazily loaded, and might not exist at this point.\n    // Therefore make a promise, and resolve it after all of the files loaded.\n    const resolve = viewer.promise();\n\n    mdxHandler.getEventObjectData(viewer, type, id, model.hd)\n      .then((data) => {\n        // Now the promise can be resolved to allow the viewer to handle events correctly.\n        resolve();\n\n        if (data) {\n          const { row, resources } = data;\n\n          this.ok = true;\n\n          if (type === 'SPN') {\n            this.internalModel = <MdxModel>resources[0];\n          } else if (type === 'SPL' || type === 'UBR') {\n            this.internalTexture = new MdxTexture(0, WrapMode.WrapBoth);\n            this.internalTexture.texture = <Texture>resources[0];\n\n            this.scale = row.number('Scale');\n            this.colors[0] = new Float32Array([row.number('StartR'), row.number('StartG'), row.number('StartB'), row.number('StartA')]);\n            this.colors[1] = new Float32Array([row.number('MiddleR'), row.number('MiddleG'), row.number('MiddleB'), row.number('MiddleA')]);\n            this.colors[2] = new Float32Array([row.number('EndR'), row.number('EndG'), row.number('EndB'), row.number('EndA')]);\n\n            if (type === 'SPL') {\n              this.columns = row.number('Columns');\n              this.rows = row.number('Rows');\n              this.lifeSpan = row.number('Lifespan') + row.number('Decay');\n\n              this.intervalTimes[0] = row.number('Lifespan');\n              this.intervalTimes[1] = row.number('Decay');\n\n              this.intervals[0] = new Float32Array([row.number('UVLifespanStart'), row.number('UVLifespanEnd'), row.number('LifespanRepeat')]);\n              this.intervals[1] = new Float32Array([row.number('UVDecayStart'), row.number('UVDecayEnd'), row.number('DecayRepeat')]);\n            } else {\n              this.columns = 1;\n              this.rows = 1;\n              this.lifeSpan = row.number('BirthTime') + row.number('PauseTime') + row.number('Decay');\n\n              this.intervalTimes[0] = row.number('BirthTime');\n              this.intervalTimes[1] = row.number('PauseTime');\n              this.intervalTimes[2] = row.number('Decay');\n            }\n\n            const blendModes = emitterFilterMode(row.number('BlendMode'), viewer.gl);\n\n            this.blendSrc = blendModes[0];\n            this.blendDst = blendModes[1];\n          } else {\n            this.distanceCutoff = row.number('DistanceCutoff');\n            this.maxDistance = row.number('MaxDistance');\n            this.minDistance = row.number('MinDistance');\n            this.pitch = row.number('Pitch');\n            this.pitchVariance = row.number('PitchVariance');\n            this.volume = row.number('Volume');\n\n            for (const resource of resources) {\n              this.decodedBuffers.push(<AudioBuffer>(<GenericResource>resource).data);\n            }\n          }\n        }\n      });\n  }\n\n  getValue(out: Uint32Array, instance: MdxModelInstance): number {\n    if (this.globalSequence !== -1) {\n      const globalSequence = this.globalSequence;\n\n      return this.getValueAtTime(out, instance.counter % globalSequence, 0, globalSequence);\n    } else if (instance.sequence !== -1) {\n      const interval = this.model.sequences[instance.sequence].interval;\n\n      return this.getValueAtTime(out, instance.frame, interval[0], interval[1]);\n    } else {\n      out[0] = this.defval[0];\n\n      return -1;\n    }\n  }\n\n  getValueAtTime(out: Uint32Array, frame: number, start: number, end: number): number {\n    const tracks = this.tracks;\n\n    if (frame >= start && frame <= end) {\n      for (let i = tracks.length - 1; i > -1; i--) {\n        if (tracks[i] < start) {\n          out[0] = 0;\n\n          return i;\n        } else if (tracks[i] <= frame) {\n          out[0] = 1;\n\n          return i;\n        }\n      }\n    }\n\n    out[0] = 0;\n\n    return -1;\n  }\n}\n","import MdlxCollisionShape, { Shape } from '../../../parsers/mdlx/collisionshape';\nimport GenericObject from './genericobject';\nimport MdxModel from './model';\n\n/**\n * A collision shape.\n */\nexport default class CollisionShape extends GenericObject {\n  type: Shape;\n  vertices: Float32Array[];\n  boundsRadius: number;\n\n  constructor(model: MdxModel, collisionShape: MdlxCollisionShape, index: number) {\n    super(model, collisionShape, index);\n\n    this.type = collisionShape.type;\n    this.vertices = collisionShape.vertices;\n    this.boundsRadius = collisionShape.boundsRadius;\n  }\n}\n","import Geoset from './geoset';\nimport Layer from './layer';\nimport Material from './material';\n\n/**\n * The type of skinning a batch uses.\n * \n * Vertex groups are used for SD batches with a range of 0-4 bones per vertex.\n * \n * Extended vertex groups are used for SD batches with a range of 0-8 bones per vertex.\n * \n * Skin is used for HD batches with a range of 0-4 bones per vertex.\n */\nexport enum SkinningType  {\n  VertexGroups,\n  ExtendedVertexGroups,\n  Skin,\n}\n\n/**\n * An MDX batch.\n */\nexport class Batch {\n  index: number;\n  geoset: Geoset;\n  layer: Layer;\n  material: Material | null;\n  skinningType: SkinningType;\n  isHd: boolean;\n\n  constructor(index: number, geoset: Geoset, layerOrMaterial: Layer | Material, skinningType: SkinningType, isHd: boolean) {\n    let material;\n    let layer;\n\n    if (isHd) {\n      material = <Material>layerOrMaterial;\n      layer = material.layers[0];\n    } else {\n      material = null;\n      layer = <Layer>layerOrMaterial;\n    }\n\n    this.index = index;\n    this.geoset = geoset;\n    this.skinningType = skinningType;\n    this.isHd = isHd;\n    this.layer = layer;\n    this.material = material;\n  }\n}\n","import Shader from '../../gl/shader';\nimport MdxModel from './model';\nimport GeosetAnimation from './geosetanimation';\nimport { SkinningType } from './batch';\n\n/**\n * A geoset.\n */\nexport default class Geoset {\n  model: MdxModel;\n  index: number;\n  positionOffset: number;\n  normalOffset: number;\n  uvOffset: number;\n  tangentOffset: number;\n  skinOffset: number;\n  faceOffset: number;\n  vertices: number;\n  elements: number;\n  faceType: number;\n  geosetAnimation: GeosetAnimation | null = null;\n\n  constructor(model: MdxModel, index: number, positionOffset: number, normalOffset: number, uvOffset: number, tangentOffset: number, skinOffset: number, faceOffset: number, vertices: number, elements: number, faceType: number) {\n    this.model = model;\n    this.index = index;\n    this.positionOffset = positionOffset;\n    this.normalOffset = normalOffset;\n    this.uvOffset = uvOffset;\n    this.tangentOffset = tangentOffset;\n    this.skinOffset = skinOffset;\n    this.faceOffset = faceOffset;\n    this.vertices = vertices;\n    this.elements = elements;\n    this.faceType = faceType;\n\n    for (const geosetAnimation of model.geosetAnimations) {\n      if (geosetAnimation.geosetId === index) {\n        this.geosetAnimation = geosetAnimation;\n      }\n    }\n  }\n\n  bindShared(gl: WebGLRenderingContext, attribs: {[key: string]: number }, coordId: number): void {\n    gl.vertexAttribPointer(attribs['a_position'], 3, gl.FLOAT, false, 0, this.positionOffset);\n    gl.vertexAttribPointer(attribs['a_normal'], 3, gl.FLOAT, false, 0, this.normalOffset);\n    gl.vertexAttribPointer(attribs['a_uv'], 2, gl.FLOAT, false, 0, this.uvOffset + coordId * this.vertices * 8);\n  }\n\n  bindVertexGroups(gl: WebGLRenderingContext, attribs: {[key: string]: number }): void {\n    const model = this.model;\n    const skinDataType = model.skinDataType;\n    const bytesPerSkinElement = model.bytesPerSkinElement;\n\n    gl.vertexAttribPointer(attribs['a_bones'], 4, skinDataType, false, 5 * bytesPerSkinElement, this.skinOffset);\n    gl.vertexAttribPointer(attribs['a_boneNumber'], 1, skinDataType, false, 5 * bytesPerSkinElement, this.skinOffset + 4 * bytesPerSkinElement);\n  }\n\n  bindVertexGroupsExtended(gl: WebGLRenderingContext, attribs: {[key: string]: number }): void {\n    const model = this.model;\n    const skinDataType = model.skinDataType;\n    const bytesPerSkinElement = model.bytesPerSkinElement;\n\n    gl.vertexAttribPointer(attribs['a_bones'], 4, skinDataType, false, 9 * bytesPerSkinElement, this.skinOffset);\n    gl.vertexAttribPointer(attribs['a_extendedBones'], 4, skinDataType, false, 9 * bytesPerSkinElement, this.skinOffset + 4 * bytesPerSkinElement);\n    gl.vertexAttribPointer(attribs['a_boneNumber'], 1, skinDataType, false, 9 * bytesPerSkinElement, this.skinOffset + 8 * bytesPerSkinElement);\n  }\n\n  bindSkin(gl: WebGLRenderingContext, attribs: {[key: string]: number }): void {\n    gl.vertexAttribPointer(attribs['a_bones'], 4, gl.UNSIGNED_BYTE, false, 8, this.skinOffset);\n    gl.vertexAttribPointer(attribs['a_weights'], 4, gl.UNSIGNED_BYTE, true, 8, this.skinOffset + 4);\n  }\n\n  bind(shader: Shader, coordId: number): void {\n    const gl = this.model.viewer.gl;\n    const attribs = shader.attribs;\n\n    this.bindShared(gl, attribs, coordId);\n    this.bindVertexGroups(gl, attribs);\n  }\n\n  bindExtended(shader: Shader, coordId: number): void{\n    const gl = this.model.viewer.gl;\n    const attribs = shader.attribs;\n\n    this.bindShared(gl, attribs, coordId);\n    this.bindVertexGroupsExtended(gl, attribs);\n  }\n\n  bindHd(shader: Shader, skinningType: SkinningType, coordId: number): void {\n    const gl = this.model.viewer.gl;\n    const attribs = shader.attribs;\n\n    this.bindShared(gl, attribs, coordId);\n\n    gl.vertexAttribPointer(attribs['a_tangent'], 4, gl.FLOAT, false, 0, this.tangentOffset);\n\n    if (skinningType === SkinningType.Skin) {\n      this.bindSkin(gl, attribs);\n    } else if (skinningType === SkinningType.ExtendedVertexGroups) {\n      this.bindVertexGroupsExtended(gl, attribs);\n    } else {\n      this.bindVertexGroups(gl, attribs);\n    }\n  }\n\n  render(): void {\n    const gl = this.model.viewer.gl;\n\n    gl.drawElements(this.faceType, this.elements, gl.UNSIGNED_SHORT, this.faceOffset);\n  }\n}\n","import Scene from '../../scene';\nimport Texture from '../../texture';\nimport MdxModel from './model';\nimport MdxModelInstance from './modelinstance';\nimport Material from './material';\nimport mdxHandler, { MdxHandlerObject } from './handler';\nimport { SkinningType } from './batch';\n\n/**\n * A group of batches that are going to be rendered together.\n */\nexport default class BatchGroup {\n  model: MdxModel;\n  skinningType: SkinningType;\n  isHd: boolean;\n  objects: number[] = [];\n\n  constructor(model: MdxModel, skinningType: SkinningType, isHd: boolean) {\n    this.model = model;\n    this.skinningType = skinningType;\n    this.isHd = isHd;\n  }\n\n  render(instance: MdxModelInstance): void {\n    const scene = <Scene>instance.scene;\n    const camera = scene.camera;\n    const textureOverrides = instance.textureOverrides;\n    const layerAlphas = instance.layerAlphas;\n    const model = this.model;\n    const textures = model.textures;\n    const batches = model.batches;\n    const viewer = model.viewer;\n    const mdxCache = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n    const gl = viewer.gl;\n    const webgl = viewer.webgl;\n    const skinningType = this.skinningType;\n    const isHd = this.isHd;\n    const teamColors = mdxCache.teamColors;\n    const teamGlows = mdxCache.teamGlows;\n    const shader = mdxHandler.getBatchShader(viewer, skinningType, isHd);\n\n    shader.use();\n\n    const uniforms = shader.uniforms;\n\n    gl.uniformMatrix4fv(uniforms['u_VP'], false, camera.viewProjectionMatrix);\n\n    const boneTexture = instance.boneTexture;\n\n    // Instances of models with no bones don't have a bone texture.\n    if (boneTexture) {\n      boneTexture.bind(15);\n\n      gl.uniform1f(uniforms['u_hasBones'], 1);\n      gl.uniform1i(uniforms['u_boneMap'], 15);\n      gl.uniform1f(uniforms['u_vectorSize'], 1 / boneTexture.width);\n      gl.uniform1f(uniforms['u_rowSize'], 1);\n    } else {\n      gl.uniform1f(uniforms['u_hasBones'], 0);\n    }\n\n    gl.uniform3fv(uniforms['u_lightPos'], scene.lightPosition);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, model.arrayBuffer);\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, model.elementBuffer);\n\n    if (isHd) {\n      gl.uniform1i(uniforms['u_diffuseMap'], 0);\n      gl.uniform1i(uniforms['u_normalsMap'], 1);\n      gl.uniform1i(uniforms['u_ormMap'], 2);\n      gl.uniform1i(uniforms['u_emissiveMap'], 3);\n      gl.uniform1i(uniforms['u_teamColorMap'], 4);\n      gl.uniform1i(uniforms['u_environmentMap'], 5);\n\n      // gl.uniform1i(uniforms['u_lutMap'], 6);\n      // gl.uniform1i(uniforms['u_envDiffuseMap'], 7);\n      // gl.uniform1i(uniforms['u_envSpecularMap'], 8);\n\n      gl.disable(gl.BLEND);\n      gl.enable(gl.DEPTH_TEST);\n      gl.depthMask(true);\n\n      gl.uniformMatrix4fv(uniforms['u_MV'], false, camera.viewMatrix);\n\n      gl.uniform3fv(uniforms['u_eyePos'], camera.location);\n\n      for (const index of this.objects) {\n        const batch = batches[index];\n        const geoset = batch.geoset;\n        const material = <Material>batch.material;\n        const [diffuseLayer, normalsLayer, ormLayer, emissiveLayer, teamColorLayer, environmentMapLayer] = material.layers;\n        const layerAlpha = layerAlphas[diffuseLayer.index];\n\n        if (layerAlpha > 0) {\n          gl.uniform1f(uniforms['u_layerAlpha'], layerAlpha);\n          gl.uniform1f(uniforms['u_filterMode'], diffuseLayer.filterMode);\n\n          const diffuseId = diffuseLayer.textureId;\n          const normalsId = normalsLayer.textureId;\n          const ormId = ormLayer.textureId;\n          const emissiveId = emissiveLayer.textureId;\n          const teamColorId = teamColorLayer.textureId;\n          const environmentMapId = environmentMapLayer.textureId;\n\n          const diffuseTexture = textures[diffuseId];\n          const normalsTexture = textures[normalsId];\n          const ormTexture = textures[ormId];\n          const emissiveTexture = textures[emissiveId];\n          let teamColorTexture = textures[teamColorId];\n          const environmentMapTexture = textures[environmentMapId];\n\n          if (teamColorTexture.replaceableId === 0 || teamColorTexture.replaceableId === 1) {\n            teamColorTexture = teamColors[instance.teamColor];\n          }\n          \n          const actualDiffuseTexture = textureOverrides.get(diffuseId) || diffuseTexture.texture;\n          const actualNormalsTexture = textureOverrides.get(normalsId) || normalsTexture.texture;\n          const actualOrmTexture = textureOverrides.get(ormId) || ormTexture.texture;\n          const actualEmissiveTexture = textureOverrides.get(emissiveId) || emissiveTexture.texture;\n          const actualTeamColorTexture = textureOverrides.get(teamColorId) || teamColorTexture.texture;\n          const actualEnvironmentMapTexture = textureOverrides.get(environmentMapId) || environmentMapTexture.texture;\n\n          webgl.bindTextureAndWrap(actualDiffuseTexture, 0, diffuseTexture.wrapS, diffuseTexture.wrapT);\n          webgl.bindTextureAndWrap(actualNormalsTexture, 1, normalsTexture.wrapS, normalsTexture.wrapT);\n          webgl.bindTextureAndWrap(actualOrmTexture, 2, ormTexture.wrapS, ormTexture.wrapT);\n          webgl.bindTextureAndWrap(actualEmissiveTexture, 3, emissiveTexture.wrapS, emissiveTexture.wrapT);\n          webgl.bindTextureAndWrap(actualTeamColorTexture, 4, teamColorTexture.wrapS, teamColorTexture.wrapT);\n          webgl.bindTextureAndWrap(actualEnvironmentMapTexture, 5, environmentMapTexture.wrapS, environmentMapTexture.wrapT);\n\n          // const { lutTexture, envDiffuseTexture, envSpecularTexture }= mdxCache;\n          // if (lutTexture && envDiffuseTexture && envSpecularTexture) {\n          //   webgl.bindTextureAndWrap(lutTexture.texture, 6, lutTexture.wrapS, lutTexture.wrapT);\n          //   webgl.bindTextureAndWrap(envDiffuseTexture.texture, 7, envDiffuseTexture.wrapS, envDiffuseTexture.wrapT);\n          //   webgl.bindTextureAndWrap(envSpecularTexture.texture, 8, envSpecularTexture.wrapS, envSpecularTexture.wrapT);\n          // }\n\n          geoset.bindHd(shader, batch.skinningType, diffuseLayer.coordId);\n          geoset.render();\n        }\n      }\n    } else {\n      const geosetColors = instance.geosetColors;\n      const layerTextures = instance.layerTextures;\n      const uvAnims = instance.uvAnims;\n\n      gl.uniform4fv(uniforms['u_vertexColor'], instance.vertexColor);\n      gl.uniform1i(uniforms['u_texture'], 0);\n      \n      for (const object of this.objects) {\n        const batch = batches[object];\n        const geoset = batch.geoset;\n        const layer = batch.layer;\n        const geosetIndex = geoset.index;\n        const layerIndex = layer.index;\n        const geosetColor = geosetColors[geosetIndex];\n        const layerAlpha = layerAlphas[layerIndex];\n\n        if (geosetColor[3] > 0.01 && layerAlpha > 0.01) {\n          const textureIndex = layerTextures[layerIndex];\n          const layerTexture = textures[textureIndex];\n          const uvAnim = uvAnims[layerIndex];\n\n          gl.uniform4fv(uniforms['u_geosetColor'], geosetColor);\n\n          gl.uniform1f(uniforms['u_layerAlpha'], layerAlpha);\n          gl.uniform1f(uniforms['u_unshaded'], layer.unshaded);\n\n          gl.uniform2f(uniforms['u_uvTrans'], uvAnim[0], uvAnim[1]);\n          gl.uniform2f(uniforms['u_uvRot'], uvAnim[2], uvAnim[3]);\n          gl.uniform1f(uniforms['u_uvScale'], uvAnim[4]);\n\n          layer.bind(shader);\n\n          let texture: Texture | null | undefined = textureOverrides.get(textureIndex);\n\n          if (!texture) {\n            const replaceable = layerTexture.replaceableId;\n            let mdxTexture;\n\n            if (replaceable === 1) {\n              mdxTexture = teamColors[instance.teamColor];\n            } else if (replaceable === 2) {\n              mdxTexture = teamGlows[instance.teamColor];\n            } else {\n              mdxTexture = layerTexture;\n            }\n\n            if (mdxTexture) {\n              texture = mdxTexture.texture;\n            }\n          }\n\n          webgl.bindTextureAndWrap(texture, 0, layerTexture.wrapS, layerTexture.wrapT);\n\n          if (skinningType === SkinningType.ExtendedVertexGroups) {\n            geoset.bindExtended(shader, layer.coordId);\n          } else {\n            geoset.bind(shader, layer.coordId);\n          }\n\n          geoset.render();\n        }\n      }\n    }\n  }\n}\n","import Scene from '../../scene';\nimport MdxModel from './model';\nimport MdxModelInstance from './modelinstance';\nimport { GeometryEmitter, renderEmitter } from './geometryemitterfuncs';\nimport { MdxHandlerObject } from './handler';\n\n/**\n * A group of emitters that are going to be rendered together.\n */\nexport default class EmitterGroup {\n  model: MdxModel;\n  objects: number[] = [];\n\n  constructor(model: MdxModel) {\n    this.model = model;\n  }\n\n  render(instance: MdxModelInstance): void {\n    const scene = <Scene>instance.scene;\n    const nodes = instance.nodes;\n    const model = instance.model;\n    const viewer = model.viewer;\n    const gl = viewer.gl;\n    const instancedArrays = <ANGLE_instanced_arrays>viewer.webgl.extensions['ANGLE_instanced_arrays'];\n    const mdxCache = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n    const shader = mdxCache.particlesShader;\n    const uniforms = shader.uniforms;\n    const attribs = shader.attribs;\n    const rectBuffer = mdxCache.rectBuffer;\n\n    gl.depthMask(false);\n    gl.enable(gl.BLEND);\n    gl.disable(gl.CULL_FACE);\n    gl.enable(gl.DEPTH_TEST);\n\n    shader.use();\n\n    gl.uniformMatrix4fv(uniforms['u_VP'], false, scene.camera.viewProjectionMatrix);\n    gl.uniform1i(uniforms['u_texture'], 0);\n\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_position'], 0);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, rectBuffer);\n    gl.vertexAttribPointer(attribs['a_position'], 1, gl.UNSIGNED_BYTE, false, 0, 0);\n\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p0'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p1'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p2'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p3'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_health'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_color'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_tail'], 1);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_leftRightTop'], 1);\n\n    for (const index of this.objects) {\n      renderEmitter(<GeometryEmitter>nodes[index].object, shader);\n    }\n\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_leftRightTop'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_tail'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_color'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_health'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p3'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p2'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p1'], 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs['a_p0'], 0);\n  }\n}\n","import MdxModel from './model';\nimport { Batch } from './batch';\nimport BatchGroup from './batchgroup';\nimport EmitterGroup from './emittergroup';\nimport GenericObject from './genericobject';\nimport ParticleEmitter2Object from './particleemitter2object';\nimport RibbonEmitterObject from './ribbonemitterobject';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\n\nfunction getPrio(object: Batch | ParticleEmitter2Object | RibbonEmitterObject | EventObjectEmitterObject): number {\n  if (object instanceof Batch || object instanceof RibbonEmitterObject) {\n    return object.layer.priorityPlane;\n  } else if (object instanceof ParticleEmitter2Object) {\n    return object.priorityPlane;\n  } else {\n    return 0;\n  }\n}\n\nfunction matchingGroup(group: BatchGroup | EmitterGroup, object: Batch | ParticleEmitter2Object | RibbonEmitterObject | EventObjectEmitterObject): boolean {\n  if (group instanceof BatchGroup) {\n    return (object instanceof Batch) && (object.skinningType === group.skinningType) && (object.isHd === group.isHd);\n  } else {\n    // All of the emitter objects are generic objects.\n    return (object instanceof GenericObject);\n  }\n}\n\nfunction createMatchingGroup(model: MdxModel, object: Batch | ParticleEmitter2Object | RibbonEmitterObject | EventObjectEmitterObject): BatchGroup | EmitterGroup {\n  if (object instanceof Batch) {\n    return new BatchGroup(model, object.skinningType, object.isHd);\n  } else {\n    return new EmitterGroup(model);\n  }\n}\n\nexport default function setupGroups(model: MdxModel): void {\n  const opaqueBatches = [];\n  let translucentBatches = [];\n\n  for (const batch of model.batches) {\n    if (batch.layer.filterMode < 2) {\n      opaqueBatches.push(batch);\n    } else {\n      translucentBatches.push(batch);\n    }\n  }\n\n  const opaqueGroups = model.opaqueGroups;\n  const translucentGroups = model.translucentGroups;\n  let currentGroup = null;\n\n  for (const object of opaqueBatches) {\n    if (!currentGroup || !matchingGroup(currentGroup, object)) {\n      currentGroup = <BatchGroup>createMatchingGroup(model, object);\n\n      opaqueGroups.push(currentGroup);\n    }\n\n    currentGroup.objects.push(object.index);\n  }\n\n  // Sort the translucent batches based on filter mode.\n  translucentBatches = translucentBatches.sort((a, b) => a.layer.filterMode - b.layer.filterMode);  \n\n  // Sort between all of the translucent batches and emitters based on their priority planes.\n  // Event objects have no explicit priority planes, and default to 0.\n  const objects = [...translucentBatches, ...model.eventObjects, ...model.particleEmitters2, ...model.ribbonEmitters].sort((a, b) => getPrio(a) - getPrio(b));\n\n  currentGroup = null;\n\n  for (const object of objects) {\n    if (object instanceof Batch || object.geometryEmitterType !== -1) {\n      if (!currentGroup || !matchingGroup(currentGroup, object)) {\n        currentGroup = createMatchingGroup(model, object);\n\n        translucentGroups.push(currentGroup);\n      }\n\n      currentGroup.objects.push(object.index);\n    }\n  }\n}\n","import { quat } from 'gl-matrix';\nimport { SkeletalNode } from '../../skeletalnode';\n\n/**\n * An MDX node.\n */\nexport default class MdxNode extends SkeletalNode {\n  override convertBasis(rotation: quat): void {\n    quat.rotateY(rotation, rotation, -Math.PI / 2);\n    quat.rotateX(rotation, rotation, -Math.PI / 2);\n  }\n}\n","import MdxModel from './model';\nimport MdxModelInstance from './modelinstance';\nimport Attachment from './attachment';\n\n// Heap allocations needed for this module.\nconst visibilityHeap = new Float32Array(1);\n\n/**\n * An attachment instance.\n */\nexport default class AttachmentInstance {\n  instance: MdxModelInstance;\n  attachment: Attachment;\n  internalInstance: MdxModelInstance;\n\n  constructor(instance: MdxModelInstance, attachment: Attachment) {\n    const internalModel = <MdxModel>attachment.internalModel;\n    const internalInstance = internalModel.addInstance();\n\n    internalInstance.setSequenceLoopMode(2);\n    internalInstance.dontInheritScaling = false;\n    internalInstance.hide();\n    internalInstance.setParent(instance.nodes[attachment.objectId]);\n\n    this.instance = instance;\n    this.attachment = attachment;\n    this.internalInstance = internalInstance;\n  }\n\n  update(): void {\n    const instance = this.instance;\n    const internalInstance = this.internalInstance;\n\n    if (instance.scene && instance.sequence !== -1) {\n      this.attachment.getVisibility(visibilityHeap, instance.sequence, instance.frame, instance.counter);\n\n      if (visibilityHeap[0] > 0.1) {\n        // The parent instance might not actually be in a scene.\n        // This happens if loading a local model, where loading is instant and adding to a scene always comes afterwards.\n        // Therefore, do it here dynamically.\n        instance.scene.addInstance(internalInstance);\n\n        if (internalInstance.hidden()) {\n          internalInstance.show();\n\n          // Every time the attachment becomes visible again, restart its first sequence.\n          internalInstance.setSequence(0);\n        }\n      } else {\n        internalInstance.hide();\n      }\n    }\n  }\n}\n","import Scene from './scene';\nimport ModelInstance from './modelinstance';\nimport EmittedObject from './emittedobject';\n\n/**\n * An emitter.\n */\nexport default abstract class Emitter {\n  instance: ModelInstance;\n  objects: EmittedObject[] = [];\n  alive = 0;\n  currentEmission = 0;\n\n  abstract createObject(): EmittedObject;\n  abstract updateEmission(dt: number): void;\n  abstract emit(): void;\n\n  constructor(instance: ModelInstance) {\n    this.instance = instance;\n  }\n\n  /**\n   * Update this emitter.\n   */\n  update(dt: number): void {\n    // Emit new objects if needed.\n    this.updateEmission(dt);\n\n    const currentEmission = this.currentEmission;\n\n    if (currentEmission >= 1) {\n      for (let i = 0; i < currentEmission; i += 1) {\n        this.emit();\n      }\n    }\n  }\n\n  /**\n   * Clear any emitted objects.\n   */\n  clear(): void {\n    const objects = this.objects;\n\n    for (let i = 0, l = this.alive; i < l; i++) {\n      const object = objects[i];\n\n      object.health = 0;\n    }\n\n    this.currentEmission = 0;\n  }\n\n  emitObject(emitData?: unknown): EmittedObject {\n    const objects = this.objects;\n\n    // If there are no unused objects, create a new one.\n    if (this.alive === objects.length) {\n      objects.push(this.createObject());\n    }\n\n    // Get the first unused object.\n    const object = objects[this.alive];\n\n    object.index = this.alive;\n\n    object.bind(emitData);\n\n    this.alive += 1;\n    this.currentEmission -= 1;\n\n    const scene = <Scene>this.instance.scene;\n\n    scene.emittedObjectUpdater.add(object);\n\n    return object;\n  }\n\n  kill(object: EmittedObject): void {\n    const objects = this.objects;\n\n    this.alive -= 1;\n\n    const otherObject = objects[this.alive];\n\n    objects[object.index] = otherObject;\n    objects[this.alive] = object;\n\n    otherObject.index = object.index;\n    object.index = -1;\n  }\n}\n","import Emitter from '../../emitter';\nimport ParticleEmitterObject from './particleemitterobject';\nimport ParticleEmitter2Object from './particleemitter2object';\nimport RibbonEmitterObject from './ribbonemitterobject';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\nimport MdxModelInstance from './modelinstance';\n\n/**\n * The base of all MDX emitters.\n */\nexport default abstract class MdxEmitter extends Emitter {\n  emitterObject: ParticleEmitterObject | ParticleEmitter2Object | RibbonEmitterObject | EventObjectEmitterObject;\n\n  constructor(instance: MdxModelInstance, emitterObject: ParticleEmitterObject | ParticleEmitter2Object | RibbonEmitterObject | EventObjectEmitterObject) {\n    super(instance);\n\n    this.emitterObject = emitterObject;\n  }\n\n  override update(dt: number): void {\n    if (this.emitterObject.ok) {\n      super.update(dt);\n    }\n  }\n}\n","import Emitter from './emitter';\n\n/**\n * An emitted object.\n */\nexport default abstract class EmittedObject {\n  emitter: Emitter;\n  index = -1;\n  health = 0;\n\n  abstract bind(emitData?: unknown): void;\n  abstract update(dt: number): void;\n\n  constructor(emitter: Emitter) {\n    this.emitter = emitter;\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_UNIT_Z } from '../../../common/gl-matrix-addon';\nimport { randomInRange } from '../../../common/math';\nimport Scene from '../../scene';\nimport EmittedObject from '../../emittedobject';\nimport ParticleEmitterObject from './particleemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport ParticleEmitter from './particleemitter';\nimport MdxModel from './model';\n\nconst rotationHeap = quat.create();\nconst velocityHeap = vec3.create();\nconst latitudeHeap = new Float32Array(1);\n// const longitudeHeap = new Float32Array(1);\nconst lifeSpanHeap = new Float32Array(1);\nconst gravityHeap = new Float32Array(1);\nconst speedHeap = new Float32Array(1);\n\n/**\n * A spawned model particle.\n */\nexport default class Particle extends EmittedObject {\n  internalInstance: MdxModelInstance;\n  velocity = vec3.create();\n  gravity = 0;\n\n  constructor(emitter: ParticleEmitter) {\n    super(emitter);\n\n    const emitterObject = <ParticleEmitterObject>emitter.emitterObject;\n    const model = <MdxModel>emitterObject.internalModel;\n\n    this.internalInstance = model.addInstance();\n  }\n\n  bind(): void {\n    const emitter = <ParticleEmitter>this.emitter;\n    const instance = <MdxModelInstance>emitter.instance;\n    const sequence = instance.sequence;\n    const frame = instance.frame;\n    const counter = instance.counter;\n    const scene = <Scene>instance.scene;\n    const emitterObject = <ParticleEmitterObject>emitter.emitterObject;\n    const node = instance.nodes[emitterObject.index];\n    const internalInstance = this.internalInstance;\n    const scale = node.worldScale;\n    const velocity = this.velocity;\n\n    emitterObject.getLatitude(latitudeHeap, sequence, frame, counter);\n    // emitterObject.getLongitude(longitudeHeap, sequence, frame, counter);\n    emitterObject.getLifeSpan(lifeSpanHeap, sequence, frame, counter);\n    emitterObject.getGravity(gravityHeap, sequence, frame, counter);\n    emitterObject.getSpeed(speedHeap, sequence, frame, counter);\n\n    this.health = lifeSpanHeap[0];\n    this.gravity = gravityHeap[0] * scale[2];\n\n    // Local rotation\n    quat.identity(rotationHeap);\n    quat.rotateZ(rotationHeap, rotationHeap, randomInRange(-Math.PI, Math.PI));\n    quat.rotateY(rotationHeap, rotationHeap, randomInRange(-latitudeHeap[0], latitudeHeap[0]));\n    vec3.transformQuat(velocity, VEC3_UNIT_Z, rotationHeap);\n\n    // World rotation\n    vec3.transformQuat(velocity, velocity, node.worldRotation);\n\n    // Apply speed\n    vec3.scale(velocity, velocity, speedHeap[0]);\n\n    // Apply the parent's scale\n    vec3.mul(velocity, velocity, scale);\n\n    internalInstance.setScene(scene);\n    internalInstance.setSequence(0);\n    internalInstance.setTransformation(node.worldLocation, quat.setAxisAngle(rotationHeap, VEC3_UNIT_Z, randomInRange(0, Math.PI * 2)), node.worldScale);\n    internalInstance.show();\n  }\n\n  update(dt: number): void {\n    const internalInstance = this.internalInstance;\n\n    this.health -= dt;\n\n    if (this.health > 0) {\n      const velocity = this.velocity;\n\n      velocity[2] -= this.gravity * dt;\n\n      internalInstance.move(vec3.scale(velocityHeap, velocity, dt));\n    } else {\n      internalInstance.hide();\n    }\n  }\n}\n","import ParticleEmitterObject from './particleemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport MdxEmitter from './emitter';\nimport Particle from './particle';\n\nconst emissionRateHeap = new Float32Array(1);\n\n/**\n * An MDX particle emitter.\n */\nexport default class ParticleEmitter extends MdxEmitter {\n  updateEmission(dt: number): void {\n    const instance = <MdxModelInstance>this.instance;\n\n    if (instance.allowParticleSpawn) {\n      const emitterObject = <ParticleEmitterObject>this.emitterObject;\n\n      emitterObject.getEmissionRate(emissionRateHeap, instance.sequence, instance.frame, instance.counter);\n\n      this.currentEmission += emissionRateHeap[0] * dt;\n    }\n  }\n\n  emit(): void {\n    this.emitObject();\n  }\n\n  createObject(): Particle {\n    return new Particle(this);\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_UNIT_Z } from '../../../common/gl-matrix-addon';\nimport { degToRad, randomInRange } from '../../../common/math';\nimport EmittedObject from '../../emittedobject';\nimport ParticleEmitter2Object from './particleemitter2object';\nimport ParticleEmitter2 from './particleemitter2';\nimport MdxModelInstance from './modelinstance';\n\nconst rotationHeap = quat.create();\nconst widthHeap = new Float32Array(1);\nconst lengthHeap = new Float32Array(1);\nconst latitudeHeap = new Float32Array(1);\nconst variationHeap = new Float32Array(1);\nconst speedHeap = new Float32Array(1);\nconst gravityHeap = new Float32Array(1);\n\n/**\n * A type 2 particle.\n */\nexport default class Particle2 extends EmittedObject {\n  tail = 0;\n  gravity = 0;\n  location = vec3.create();\n  velocity = vec3.create();\n  scale = vec3.create();\n  facing = 0; // XYQuad\n\n  bind(tail: number): void {\n    const emitter = <ParticleEmitter2>this.emitter;\n    const instance = <MdxModelInstance>emitter.instance;\n    const sequence = instance.sequence;\n    const frame = instance.frame;\n    const counter = instance.counter;\n    const emitterObject = <ParticleEmitter2Object>emitter.emitterObject;\n\n    emitterObject.getWidth(widthHeap, sequence, frame, counter);\n    emitterObject.getLength(lengthHeap, sequence, frame, counter);\n    emitterObject.getLatitude(latitudeHeap, sequence, frame, counter);\n    emitterObject.getVariation(variationHeap, sequence, frame, counter);\n    emitterObject.getSpeed(speedHeap, sequence, frame, counter);\n    emitterObject.getGravity(gravityHeap, sequence, frame, counter);\n\n    const node = emitter.node;\n    const pivot = node.pivot;\n    const scale = node.worldScale;\n    const width = widthHeap[0] * 0.5;\n    const length = lengthHeap[0] * 0.5;\n    const latitude = degToRad(latitudeHeap[0]);\n    const variation = variationHeap[0];\n    const speed = speedHeap[0];\n    const location = this.location;\n    const velocity = this.velocity;\n\n    this.health = emitterObject.lifeSpan;\n    this.tail = tail;\n    this.gravity = gravityHeap[0] * scale[2];\n\n    vec3.copy(this.scale, scale);\n\n    // Local location\n    location[0] = pivot[0] + randomInRange(-width, width);\n    location[1] = pivot[1] + randomInRange(-length, length);\n    location[2] = pivot[2];\n\n    // World location\n    if (!emitterObject.modelSpace) {\n      vec3.transformMat4(location, location, node.worldMatrix);\n    }\n\n    // Local rotation\n    quat.identity(rotationHeap);\n    quat.rotateZ(rotationHeap, rotationHeap, Math.PI / 2);\n    quat.rotateY(rotationHeap, rotationHeap, randomInRange(-latitude, latitude));\n\n    // If this is not a line emitter, emit in a sphere rather than a circle.\n    if (!emitterObject.lineEmitter) {\n      quat.rotateX(rotationHeap, rotationHeap, randomInRange(-latitude, latitude));\n    }\n\n    // World rotation\n    if (!emitterObject.modelSpace) {\n      quat.mul(rotationHeap, node.worldRotation, rotationHeap);\n    }\n\n    // Apply the rotation\n    vec3.transformQuat(velocity, VEC3_UNIT_Z, rotationHeap);\n\n    // Apply speed\n    vec3.scale(velocity, velocity, speed * (1 + randomInRange(-variation, variation)));\n\n    // Apply the parent's scale\n    if (!emitterObject.modelSpace) {\n      vec3.mul(velocity, velocity, scale);\n    }\n\n    // XY particles are rotated to face their velocity on the XY plane.\n    if (emitterObject.xYQuad) {\n      this.facing = Math.atan2(velocity[1], velocity[0]) - Math.PI + Math.PI / 8;\n    }\n  }\n\n  update(dt: number): void {\n    this.health -= dt;\n\n    if (this.health > 0) {\n      const location = this.location;\n      const velocity = this.velocity;\n\n      velocity[2] -= this.gravity * dt;\n\n      location[0] += velocity[0] * dt;\n      location[1] += velocity[1] * dt;\n      location[2] += velocity[2] * dt;\n    }\n  }\n}\n","import ParticleEmitter2Object from './particleemitter2object';\nimport MdxModelInstance from './modelinstance';\nimport MdxNode from './node';\nimport MdxEmitter from './emitter';\nimport Particle2 from './particle2';\n\nconst emissionRateHeap = new Float32Array(1);\n\n/**\n * An MDX particle emitter type 2.\n */\nexport default class ParticleEmitter2 extends MdxEmitter {\n  node: MdxNode;\n  lastEmissionKey = -1;\n\n  constructor(instance: MdxModelInstance, emitterObject: ParticleEmitter2Object) {\n    super(instance, emitterObject);\n\n    this.node = instance.nodes[emitterObject.index];\n  }\n\n  updateEmission(dt: number): void {\n    const instance = <MdxModelInstance>this.instance;\n\n    if (instance.allowParticleSpawn) {\n      const emitterObject = <ParticleEmitter2Object>this.emitterObject;\n      const keyframe = emitterObject.getEmissionRate(emissionRateHeap, instance.sequence, instance.frame, instance.counter);\n\n      if (emitterObject.squirt) {\n        if (keyframe !== this.lastEmissionKey) {\n          this.currentEmission += emissionRateHeap[0];\n        }\n\n        this.lastEmissionKey = keyframe;\n      } else {\n        this.currentEmission += emissionRateHeap[0] * dt;\n      }\n    }\n  }\n\n  emit(): void {\n    const emitterObject = <ParticleEmitter2Object>this.emitterObject;\n\n    if (emitterObject.head) {\n      this.emitObject(0);\n    }\n\n    if (emitterObject.tail) {\n      this.emitObject(1);\n    }\n  }\n\n  createObject(): Particle2 {\n    return new Particle2(this);\n  }\n}\n","import { vec3 } from 'gl-matrix';\nimport EmittedObject from '../../emittedobject';\nimport RibbonEmitterObject from './ribbonemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport RibbonEmitter from './ribbonemitter';\n\nconst belowHeap = vec3.create();\nconst aboveHeap = vec3.create();\nconst colorHeap = new Float32Array(3);\nconst alphaHeap = new Float32Array(1);\nconst slotHeap = new Uint32Array(1);\n\n/**\n * A ribbon.\n */\nexport default class Ribbon extends EmittedObject {\n  vertices = new Float32Array(6);\n  color = new Uint8Array(4);\n  slot = 0;\n  prev: Ribbon | null = null;\n  next: Ribbon | null = null;\n\n  bind(): void {\n    const emitter = <RibbonEmitter>this.emitter;\n    const instance = <MdxModelInstance>emitter.instance;\n    const sequence = instance.sequence;\n    const frame = instance.frame;\n    const counter = instance.counter;\n    const emitterObject = <RibbonEmitterObject>emitter.emitterObject;\n    const node = instance.nodes[emitterObject.index];\n    const [x, y, z] = node.pivot;\n    const worldMatrix = node.worldMatrix;\n    const vertices = this.vertices;\n\n    this.health = emitter.emitterObject.lifeSpan;\n\n    emitterObject.getHeightBelow(<Float32Array>belowHeap, sequence, frame, counter);\n    emitterObject.getHeightAbove(<Float32Array>aboveHeap, sequence, frame, counter);\n\n    belowHeap[1] = y - belowHeap[0];\n    belowHeap[0] = x;\n    belowHeap[2] = z;\n\n    aboveHeap[1] = y + aboveHeap[0];\n    aboveHeap[0] = x;\n    aboveHeap[2] = z;\n\n    vec3.transformMat4(belowHeap, belowHeap, worldMatrix);\n    vec3.transformMat4(aboveHeap, aboveHeap, worldMatrix);\n\n    vertices[0] = aboveHeap[0];\n    vertices[1] = aboveHeap[1];\n    vertices[2] = aboveHeap[2];\n    vertices[3] = belowHeap[0];\n    vertices[4] = belowHeap[1];\n    vertices[5] = belowHeap[2];\n  }\n\n  update(dt: number): void {\n    this.health -= dt;\n\n    if (this.health > 0) {\n      const emitter = <RibbonEmitter>this.emitter;\n      const instance = <MdxModelInstance>emitter.instance;\n      const sequence = instance.sequence;\n      const frame = instance.frame;\n      const counter = instance.counter;\n      const emitterObject = <RibbonEmitterObject>emitter.emitterObject;\n      const color = this.color;\n      const vertices = this.vertices;\n      const gravity = emitterObject.gravity * dt * dt;\n\n      emitterObject.getColor(colorHeap, sequence, frame, counter);\n      emitterObject.getAlpha(alphaHeap, sequence, frame, counter);\n      emitterObject.getTextureSlot(slotHeap, sequence, frame, counter);\n\n      vertices[1] -= gravity;\n      vertices[4] -= gravity;\n\n      color[0] = colorHeap[0] * 255;\n      color[1] = colorHeap[1] * 255;\n      color[2] = colorHeap[2] * 255;\n      color[3] = alphaHeap[0] * 255;\n\n      this.slot = slotHeap[0];\n    }\n  }\n}\n","import RibbonEmitterObject from './ribbonemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport MdxEmitter from './emitter';\nimport Ribbon from './ribbon';\n\n/**\n * A ribbon emitter.\n */\nexport default class RibbonEmitter extends MdxEmitter {\n  first: Ribbon | null = null;\n  last: Ribbon | null = null;\n\n  updateEmission(dt: number): void {\n    const instance = <MdxModelInstance>this.instance;\n\n    if (instance.allowParticleSpawn) {\n      const emitterObject = <RibbonEmitterObject>this.emitterObject;\n\n      // It doesn't make sense to emit more than 1 ribbon at the same time.\n      this.currentEmission += emitterObject.emissionRate * dt;\n    }\n  }\n\n  emit(): void {\n    const ribbon = <Ribbon>this.emitObject();\n    const last = this.last;\n\n    if (last) {\n      last.next = ribbon;\n      ribbon.prev = last;\n    } else {\n      this.first = ribbon;\n    }\n\n    this.last = ribbon;\n  }\n\n  override kill(object: Ribbon): void {\n    super.kill(object);\n\n    const prev = object.prev;\n    const next = object.next;\n\n    if (object === this.first) {\n      this.first = next;\n    }\n\n    if (object === this.last) {\n      this.first = null;\n      this.last = null;\n    }\n\n    if (prev) {\n      prev.next = next;\n    }\n\n    if (next) {\n      next.prev = prev;\n    }\n\n    object.prev = null;\n    object.next = null;\n  }\n\n  createObject(): Ribbon {\n    return new Ribbon(this);\n  }\n}\n","import MdxModelInstance from './modelinstance';\nimport MdxEmitter from './emitter';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\n\nconst valueHeap = new Uint32Array(1);\n\n/**\n * The abstract base MDX event object emitter.\n */\nexport default abstract class EventObjectEmitter extends MdxEmitter {\n  lastValue = 0;\n\n  updateEmission(_dt: number): void {\n    const instance = <MdxModelInstance>this.instance;\n\n    if (instance.allowParticleSpawn) {\n      const emitterObject = <EventObjectEmitterObject>this.emitterObject;\n\n      emitterObject.getValue(valueHeap, instance);\n\n      const value = valueHeap[0];\n\n      if (value === 1 && value !== this.lastValue) {\n        this.currentEmission += 1;\n      }\n\n      this.lastValue = value;\n    }\n  }\n\n  emit(): void {\n    this.emitObject();\n  }\n}\n","import Scene from '../../scene';\nimport EmittedObject from '../../emittedobject';\nimport MdxModel from './model';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport EventObjectSpnEmitter from './eventobjectspnemitter';\n\n/**\n * An MDX spawned model object.\n */\nexport default class EventObjectSpn extends EmittedObject {\n  internalInstance: MdxModelInstance;\n\n  constructor(emitter: EventObjectSpnEmitter) {\n    super(emitter);\n\n    const emitterObject = <EventObjectEmitterObject>emitter.emitterObject;\n    const internalModel = <MdxModel>emitterObject.internalModel;\n\n    this.internalInstance = internalModel.addInstance();\n  }\n\n  bind(): void {\n    const emitter = <EventObjectSpnEmitter>this.emitter;\n    const instance = <MdxModelInstance>emitter.instance;\n    const scene = <Scene>instance.scene;\n    const node = instance.nodes[emitter.emitterObject.index];\n    const internalInstance = this.internalInstance;\n\n    internalInstance.setScene(scene);\n    internalInstance.setSequence(0);\n    internalInstance.setTransformation(node.worldLocation, node.worldRotation, node.worldScale);\n    internalInstance.show();\n\n    this.health = 1;\n  }\n\n  update(_dt: number): void{\n    const instance = this.internalInstance;\n    const model = <MdxModel>instance.model;\n\n    // Once the sequence finishes, this event object dies\n    if (instance.frame >= model.sequences[0].interval[1]) {\n      this.health = 0;\n\n      instance.hide();\n    }\n  }\n}\n","import EventObjectEmitter from './eventobjectemitter';\nimport EventObjectSpn from './eventobjectspn';\n\n/**\n * An MDX model emitter.\n */\nexport default class EventObjectSpnEmitter extends EventObjectEmitter {\n  createObject(): EventObjectSpn {\n    return new EventObjectSpn(this);\n  }\n}\n","import { vec3 } from 'gl-matrix';\nimport EmittedObject from '../../emittedobject';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport EventObjectSplEmitter from './eventobjectsplemitter';\nimport EventObjectUbrEmitter from './eventobjectubremitter';\n\nconst vertexHeap = vec3.create();\n\n/**\n * An MDX splat or ubersplat object.\n */\nexport default class EventObjectSplUbr extends EmittedObject {\n  vertices = new Float32Array(12);\n\n  bind(): void {\n    const emitter = <EventObjectSplEmitter | EventObjectUbrEmitter>this.emitter;\n    const instance = <MdxModelInstance>emitter.instance;\n    const emitterObject = <EventObjectEmitterObject>emitter.emitterObject;\n    const vertices = this.vertices;\n    const scale = emitterObject.scale;\n    const { worldLocation, worldRotation } = instance.nodes[emitterObject.index];\n\n    this.health = emitterObject.lifeSpan;\n\n    vec3.set(vertexHeap, scale, scale, 0);\n    vec3.transformQuat(vertexHeap, vertexHeap, worldRotation);\n    vec3.add(<vec3>vertices.subarray(0, 2), vertexHeap, worldLocation);\n\n    vec3.set(vertexHeap, -scale, scale, 0);\n    vec3.transformQuat(vertexHeap, vertexHeap, worldRotation);\n    vec3.add(<vec3>vertices.subarray(3, 5), vertexHeap, worldLocation);\n\n    vec3.set(vertexHeap, -scale, -scale, 0);\n    vec3.transformQuat(vertexHeap, vertexHeap, worldRotation);\n    vec3.add(<vec3>vertices.subarray(6, 8), vertexHeap, worldLocation);\n\n    vec3.set(vertexHeap, scale, -scale, 0);\n    vec3.transformQuat(vertexHeap, vertexHeap, worldRotation);\n    vec3.add(<vec3>vertices.subarray(9, 11), vertexHeap, worldLocation);\n  }\n\n  update(dt: number): void {\n    this.health -= dt;\n  }\n}\n","import EventObjectEmitter from './eventobjectemitter';\nimport EventObjectSplUbr from './eventobjectsplubr';\n\n/**\n * An MDX splat emitter.\n */\nexport default class EventObjectSplEmitter extends EventObjectEmitter {\n  createObject(): EventObjectSplUbr {\n    return new EventObjectSplUbr(this);\n  }\n}\n","import EventObjectEmitter from './eventobjectemitter';\nimport EventObjectSplUbr from './eventobjectsplubr';\n\n/**\n * An MDX ubersplat emitter.\n */\nexport default class EventObjectUbrEmitter extends EventObjectEmitter {\n  createObject(): EventObjectSplUbr {\n    return new EventObjectSplUbr(this);\n  }\n}\n","import Scene from '../../scene';\nimport EmittedObject from '../../emittedobject';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\nimport MdxModelInstance from './modelinstance';\nimport EventObjectSndEmitter from './eventobjectsndemitter';\n\n/**\n * An MDX spawned sound object.\n */\nexport default class EventObjectSnd extends EmittedObject {\n  bind(): void {\n    const emitter = <EventObjectSndEmitter>this.emitter;\n    const instance = <MdxModelInstance>emitter.instance;\n    const viewer = instance.model.viewer;\n    const scene = <Scene>instance.scene;\n\n    // Is audio enabled both viewer-wide and in this scene?\n    if (viewer.audioEnabled && scene.audioEnabled) {\n      const emitterObject = <EventObjectEmitterObject>emitter.emitterObject;\n      const node = instance.nodes[emitterObject.index];\n      const audioContext = <AudioContext>scene.audioContext;\n      const decodedBuffers = emitterObject.decodedBuffers;\n      const panner = audioContext.createPanner();\n      const source = audioContext.createBufferSource();\n      const location = node.worldLocation;\n\n      // Panner settings.\n      panner.positionX.value = location[0];\n      panner.positionY.value = location[1];\n      panner.positionZ.value = location[2];\n      panner.maxDistance = emitterObject.distanceCutoff;\n      panner.refDistance = emitterObject.minDistance;\n      panner.connect(audioContext.destination);\n\n      // Source.\n      source.buffer = decodedBuffers[(Math.random() * decodedBuffers.length) | 0];\n      source.connect(panner);\n\n      // Make a sound.\n      source.start(0);\n    }\n  }\n\n  update(_dt: number): void {\n\n  }\n}\n","import EventObjectEmitter from './eventobjectemitter';\nimport EventObjectSnd from './eventobjectsnd';\n\n/**\n * An MDX sound emitter.\n */\nexport default class EventObjectSndEmitter extends EventObjectEmitter {\n  createObject(): EventObjectSnd {\n    return new EventObjectSnd(this);\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport ModelInstance from '../../modelinstance';\nimport { createSkeletalNodes, SkeletalNode } from '../../skeletalnode';\nimport DataTexture from '../../gl/datatexture';\nimport Texture from '../../texture';\nimport MdxNode from './node';\nimport AttachmentInstance from './attachmentinstance';\nimport ParticleEmitter from './particleemitter';\nimport ParticleEmitter2 from './particleemitter2';\nimport RibbonEmitter from './ribbonemitter';\nimport EventObjectEmitter from './eventobjectemitter';\nimport EventObjectSpnEmitter from './eventobjectspnemitter';\nimport EventObjectSplEmitter from './eventobjectsplemitter';\nimport EventObjectUbrEmitter from './eventobjectubremitter';\nimport EventObjectSndEmitter from './eventobjectsndemitter';\nimport MdxModel from './model';\nimport GenericObject from './genericobject';\nimport { EMITTER_PARTICLE2_TEXTURE_OFFSET, EMITTER_EVENT_TEXTURE_OFFSET } from './geometryemitterfuncs';\nimport Bounds from '../../bounds';\n\nconst visibilityHeap = new Float32Array(1);\nconst translationHeap = vec3.create();\nconst rotationHeap = quat.create();\nconst scaleHeap = vec3.create();\nconst colorHeap = new Float32Array(3);\nconst alphaHeap = new Float32Array(1);\nconst textureIdHeap = new Uint32Array(1);\n\ntype SkeletalNodeObject = AttachmentInstance | ParticleEmitter | ParticleEmitter2 | RibbonEmitter | EventObjectEmitter;\n\n/**\n * An MDX model instance.\n */\nexport default class MdxModelInstance extends ModelInstance {\n  attachments: AttachmentInstance[] = [];\n  particleEmitters: ParticleEmitter[] = [];\n  particleEmitters2: ParticleEmitter2[] = [];\n  ribbonEmitters: RibbonEmitter[] = [];\n  eventObjectEmitters: (EventObjectSpnEmitter | EventObjectSplEmitter | EventObjectUbrEmitter | EventObjectSndEmitter)[] = [];\n  nodes: SkeletalNode[] = [];\n  sortedNodes: SkeletalNode[] = [];\n  frame = 0;\n  // Global sequences\n  counter = 0;\n  sequence = -1;\n  sequenceLoopMode = 0;\n  sequenceEnded = false;\n  teamColor = 0;\n  vertexColor = new Float32Array([1, 1, 1, 1]);\n  // Particles do not spawn when the sequence is -1, or when the sequence finished and it's not repeating\n  allowParticleSpawn = false;\n  // If forced is true, everything will update regardless of variancy.\n  // Any later non-forced update can then use variancy to skip updating things.\n  // It is set to true every time the sequence is set with setSequence().\n  forced = true;\n  geosetColors: Float32Array[] = [];\n  layerAlphas: number[] = [];\n  layerTextures: number[] = [];\n  uvAnims: Float32Array[] = [];\n  worldMatrices: Float32Array | null = null;\n  boneTexture: DataTexture | null = null;\n\n  constructor(model: MdxModel) {\n    super(model);\n\n    for (let i = 0, l = model.geosets.length; i < l; i++) {\n      this.geosetColors[i] = new Float32Array(4);\n    }\n\n    for (let i = 0, l = model.layers.length; i < l; i++) {\n      this.layerAlphas[i] = 0;\n      this.layerTextures[i] = 0;\n      this.uvAnims[i] = new Float32Array(5);\n    }\n\n    // Create the needed amount of shared nodes.\n    const sharedNodeData = createSkeletalNodes(model.genericObjects.length, MdxNode);\n    const nodes = sharedNodeData.nodes;\n    let nodeIndex = 0;\n\n    this.nodes.push(...nodes);\n\n    // A shared typed array for all world matrices of the internal nodes.\n    this.worldMatrices = sharedNodeData.worldMatrices;\n\n    // And now initialize all of the nodes and objects\n    for (const bone of model.bones) {\n      this.initNode(nodes, nodes[nodeIndex++], bone);\n    }\n\n    for (const light of model.lights) {\n      this.initNode(nodes, nodes[nodeIndex++], light);\n    }\n\n    for (const helper of model.helpers) {\n      this.initNode(nodes, nodes[nodeIndex++], helper);\n    }\n\n    for (const attachment of model.attachments) {\n      let attachmentInstance;\n\n      // Attachments may have game models attached to them, such as Undead and Nightelf building animations.\n      if (attachment.internalModel) {\n        attachmentInstance = new AttachmentInstance(this, attachment);\n\n        this.attachments.push(attachmentInstance);\n      }\n\n      this.initNode(nodes, nodes[nodeIndex++], attachment, attachmentInstance);\n    }\n\n    for (const emitterObject of model.particleEmitters) {\n      const emitter = new ParticleEmitter(this, emitterObject);\n\n      this.particleEmitters.push(emitter);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitterObject, emitter);\n    }\n\n    for (const emitterObject of model.particleEmitters2) {\n      const emitter = new ParticleEmitter2(this, emitterObject);\n\n      this.particleEmitters2.push(emitter);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitterObject, emitter);\n    }\n\n    for (const emitterObject of model.ribbonEmitters) {\n      const emitter = new RibbonEmitter(this, emitterObject);\n\n      this.ribbonEmitters.push(emitter);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitterObject, emitter);\n    }\n\n    for (const emitterObject of model.eventObjects) {\n      const type = emitterObject.type;\n      let emitter;\n\n      if (type === 'SPN') {\n        emitter = new EventObjectSpnEmitter(this, emitterObject);\n      } else if (type === 'SPL') {\n        emitter = new EventObjectSplEmitter(this, emitterObject);\n      } else if (type === 'UBR') {\n        emitter = new EventObjectUbrEmitter(this, emitterObject);\n      } else {\n        emitter = new EventObjectSndEmitter(this, emitterObject);\n      }\n\n      this.eventObjectEmitters.push(emitter);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitterObject, emitter);\n    }\n\n    for (const collisionShape of model.collisionShapes) {\n      this.initNode(nodes, nodes[nodeIndex++], collisionShape);\n    }\n\n    // Save a sorted array of all of the nodes, such that every child node comes after its parent.\n    // This allows for flat iteration when updating.\n    const hierarchy = model.hierarchy;\n\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      this.sortedNodes[i] = nodes[hierarchy[i]];\n    }\n\n    if (model.bones.length) {\n      this.boneTexture = new DataTexture(model.viewer.gl, 4, model.bones.length * 4, 1);\n    }\n  }\n\n\n  /**\n   * Override the texture at the given index.\n   * \n   * If a texture isn't given, removes the override if there was one.\n   */\n  setTexture(index: number, texture?: Texture): void {\n    this.overrideTexture(index, texture);\n  }\n\n  /**\n   * Override the texture of the particle emitter the given index.\n   * \n   * If a texture isn't given, removes the override if there was one.\n   */\n  setParticle2Texture(index: number, texture?: Texture): void {\n    this.overrideTexture(EMITTER_PARTICLE2_TEXTURE_OFFSET + index, texture);\n  }\n\n  /**\n   * Override the texture of the event emitter the given index.\n   * \n   * If a texture isn't given, removes the override if there was one.\n   */\n  setEventTexture(index: number, texture?: Texture): void {\n    this.overrideTexture(EMITTER_EVENT_TEXTURE_OFFSET + index, texture);\n  }\n\n  /**\n   * Clear all of the emitted objects that belong to this instance.\n   */\n  override clearEmittedObjects(): void {\n    for (const emitter of this.particleEmitters) {\n      emitter.clear();\n    }\n\n    for (const emitter of this.particleEmitters2) {\n      emitter.clear();\n    }\n\n    for (const emitter of this.ribbonEmitters) {\n      emitter.clear();\n    }\n\n    for (const emitter of this.eventObjectEmitters) {\n      emitter.clear();\n    }\n  }\n\n  /**\n   * Initialize a skeletal node.\n   */\n  initNode(nodes: SkeletalNode[], node: SkeletalNode, genericObject: GenericObject, object?: SkeletalNodeObject): void {\n    vec3.copy(node.pivot, genericObject.pivot);\n\n    if (genericObject.parentId === -1) {\n      node.parent = this;\n    } else {\n      node.parent = nodes[genericObject.parentId];\n    }\n\n    node.dontInheritTranslation = genericObject.dontInheritTranslation;\n    node.dontInheritRotation = genericObject.dontInheritRotation;\n    node.dontInheritScaling = genericObject.dontInheritScaling;\n    \n    if (genericObject.billboarded) {\n      node.billboarded = true;\n    } else if (genericObject.billboardedX) {\n      node.billboardedX = true;\n    } else if (genericObject.billboardedY) {\n      node.billboardedY = true;\n    } else if (genericObject.billboardedZ) {\n      node.billboardedZ = true;\n    }\n\n    if (object) {\n      node.object = object;\n    }\n  }\n\n  /**\n   * Overriden to hide also attachment models.\n   */\n  override hide(): void {\n    super.hide();\n\n    this.resetAttachments();\n  }\n\n  /**\n   * Updates all of this instance internal nodes and objects.\n   * Nodes that are determined to not be visible will not be updated, nor will any of their children down the hierarchy.\n   */\n  updateNodes(dt: number, forced: boolean): void {\n    const sequence = this.sequence;\n    const frame = this.frame;\n    const counter = this.counter;\n    const sortedNodes = this.sortedNodes;\n    const model = <MdxModel>this.model;\n    const sortedGenericObjects = model.sortedGenericObjects;\n\n    // Update the nodes\n    for (let i = 0, l = sortedNodes.length; i < l; i++) {\n      const genericObject = sortedGenericObjects[i];\n      const node = sortedNodes[i];\n      const parent = <MdxNode | SkeletalNode>node.parent;\n      let wasDirty = forced || parent.wasDirty || genericObject.anyBillboarding;\n      const variants = genericObject.variants;\n\n      // Local node transformation.\n      // Use variants to skip animation data when possible.\n      if (forced || variants['generic'][sequence]) {\n        wasDirty = true;\n\n        // Translation\n        if (forced || variants['translation'][sequence]) {\n          genericObject.getTranslation(node.localLocation, sequence, frame, counter);\n        }\n\n        // Rotation\n        if (forced || variants['rotation'][sequence]) {\n          genericObject.getRotation(node.localRotation, sequence, frame, counter);\n        }\n\n        // Scale\n        if (forced || variants['scale'][sequence]) {\n          genericObject.getScale(node.localScale, sequence, frame, counter);\n        }\n      }\n\n      node.wasDirty = wasDirty;\n\n      // If this is a forced update, or this node's local data was updated, or the parent node was updated, do a full world update.\n      if (wasDirty) {\n        node.recalculateTransformation(this);\n      }\n\n      // If there is an instance object associated with this node (emitter/attachment), and it is visible, update it.\n      if (node.object) {\n        genericObject.getVisibility(visibilityHeap, sequence, frame, counter);\n\n        // If the attachment/emitter is visible, update it.\n        if (visibilityHeap[0] > 0) {\n          (<SkeletalNodeObject>node.object).update(dt);\n        }\n      }\n\n      // Recalculate and update child nodes.\n      // Note that this only affects normal nodes such as instances, and not skeletal nodes.\n      for (const child of node.children) {\n        if (wasDirty) {\n          child.recalculateTransformation();\n        }\n\n        child.update(dt);\n      }\n    }\n  }\n\n  /**\n   * If a model has no sequences or is running no sequence, it will only update once since it will never be forced to update.\n   * This is generally the desired behavior, except when it is moved by the client.\n   * Therefore, if an instance is transformed, always do a forced update.\n   */\n  override recalculateTransformation(): void {\n    super.recalculateTransformation();\n\n    this.forced = true;\n  }\n\n  /**\n   * Update the batch data.\n   */\n  updateBatches(forced: boolean): void {\n    const sequence = this.sequence;\n    const frame = this.frame;\n    const counter = this.counter;\n    const model = <MdxModel>this.model;\n    const geosets = model.geosets;\n    const layers = model.layers;\n    const geosetColors = this.geosetColors;\n    const layerAlphas = this.layerAlphas;\n    const layerTextures = this.layerTextures;\n    const uvAnims = this.uvAnims;\n\n    // Geosets\n    for (let i = 0, l = geosets.length; i < l; i++) {\n      const geoset = geosets[i];\n      const geosetAnimation = geoset.geosetAnimation;\n      const geosetColor = geosetColors[i];\n\n      if (geosetAnimation) {\n        // Color\n        if (forced || geosetAnimation.variants['color'][sequence]) {\n          geosetAnimation.getColor(colorHeap, sequence, frame, counter);\n\n          geosetColor[0] = colorHeap[0];\n          geosetColor[1] = colorHeap[1];\n          geosetColor[2] = colorHeap[2];\n        }\n\n        // Alpha\n        if (forced || geosetAnimation.variants['alpha'][sequence]) {\n          geosetAnimation.getAlpha(alphaHeap, sequence, frame, counter);\n\n          geosetColor[3] = alphaHeap[0];\n        }\n      } else if (forced) {\n        geosetColor[0] = 1;\n        geosetColor[1] = 1;\n        geosetColor[2] = 1;\n        geosetColor[3] = 1;\n      }\n    }\n\n    // Layers\n    for (let i = 0, l = layers.length; i < l; i++) {\n      const layer = layers[i];\n      const textureAnimation = layer.textureAnimation;\n      const uvAnim = uvAnims[i];\n\n      // Alpha\n      if (forced || layer.variants['alpha'][sequence]) {\n        layer.getAlpha(alphaHeap, sequence, frame, counter);\n\n        layerAlphas[i] = alphaHeap[0];\n      }\n\n      // Sprite animation\n      if (forced || layer.variants['textureId'][sequence]) {\n        layer.getTextureId(textureIdHeap, sequence, frame, counter);\n\n        layerTextures[i] = textureIdHeap[0];\n      }\n\n      if (textureAnimation) {\n        // UV translation animation\n        if (forced || textureAnimation.variants['translation'][sequence]) {\n          textureAnimation.getTranslation(<Float32Array>translationHeap, sequence, frame, counter);\n\n          uvAnim[0] = translationHeap[0];\n          uvAnim[1] = translationHeap[1];\n        }\n\n        // UV rotation animation\n        if (forced || textureAnimation.variants['rotation'][sequence]) {\n          textureAnimation.getRotation(<Float32Array>rotationHeap, sequence, frame, counter);\n\n          uvAnim[2] = rotationHeap[2];\n          uvAnim[3] = rotationHeap[3];\n        }\n\n        // UV scale animation\n        if (forced || textureAnimation.variants['scale'][sequence]) {\n          textureAnimation.getScale(<Float32Array>scaleHeap, sequence, frame, counter);\n\n          uvAnim[4] = scaleHeap[0];\n        }\n      } else if (forced) {\n        uvAnim[0] = 0;\n        uvAnim[1] = 0;\n        uvAnim[2] = 0;\n        uvAnim[3] = 1;\n        uvAnim[4] = 1;\n      }\n    }\n  }\n\n  updateBoneTexture(): void {\n    if (this.boneTexture) {\n      this.boneTexture.bindAndUpdate(<Float32Array>this.worldMatrices);\n    }\n  }\n\n  override renderOpaque(): void {\n    const model = <MdxModel>this.model;\n\n    for (const group of model.opaqueGroups) {\n      group.render(this);\n    }\n  }\n\n  override renderTranslucent(): void {\n    const model = <MdxModel>this.model;\n\n    for (const group of model.translucentGroups) {\n      group.render(this);\n    }\n  }\n\n  override updateAnimations(dt: number): void {\n    const model = <MdxModel>this.model;\n    const sequenceId = this.sequence;\n\n    if (sequenceId !== -1) {\n      const sequence = model.sequences[sequenceId];\n      const interval = sequence.interval;\n      const frameTime = dt * 1000;\n\n      this.frame += frameTime;\n      this.counter += frameTime;\n      this.allowParticleSpawn = true;\n\n      if (this.frame >= interval[1]) {\n        if (this.sequenceLoopMode === 2 || (this.sequenceLoopMode === 0 && sequence.nonLooping === 0)) {\n          this.frame = interval[0];\n\n          this.resetEventEmitters();\n        } else {\n          this.frame = interval[1];\n          this.counter -= frameTime;\n          this.allowParticleSpawn = false;\n        }\n\n        this.sequenceEnded = true;\n      } else {\n        this.sequenceEnded = false;\n      }\n    }\n\n    const forced = this.forced;\n\n    if (sequenceId !== -1 || forced) {\n      // Update the nodes\n      this.updateNodes(dt, forced);\n\n      // Update the bone texture.\n      this.updateBoneTexture();\n\n      // Update the batches\n      this.updateBatches(forced);\n    }\n\n    this.forced = false;\n  }\n\n  /**\n   * Set the team color of this instance.\n   */\n  setTeamColor(id: number): this {\n    this.teamColor = id;\n\n    return this;\n  }\n\n  /**\n   * Set the vertex color of this instance.\n   */\n  setVertexColor(color: Float32Array | number[]): this {\n    this.vertexColor.set(color);\n\n    return this;\n  }\n\n  /**\n   * Set the sequence of this instance.\n   */\n  setSequence(id: number): this {\n    const model = <MdxModel>this.model;\n    const sequences = model.sequences;\n\n    this.sequence = id;\n\n    if (id < 0 || id > sequences.length - 1) {\n      this.sequence = -1;\n      this.frame = 0;\n      this.allowParticleSpawn = false;\n    } else {\n      this.frame = sequences[id].interval[0];\n    }\n\n    this.resetEventEmitters();\n    this.resetAttachments();\n\n    this.forced = true;\n\n    return this;\n  }\n\n  override getBounds(): Bounds {\n    const model = <MdxModel>this.model;\n\n    if (this.sequence === -1) {\n      return model.bounds;\n    }\n\n    const bounds = model.sequences[this.sequence].bounds;\n\n    if (bounds.r === 0) {\n      return model.bounds;\n    }\n\n    return bounds;\n  }\n\n  /**\n   * Set the sequence loop mode.\n   * 0 to never loop, 1 to loop based on the model, and 2 to always loop.\n   */\n  setSequenceLoopMode(mode: number): this {\n    this.sequenceLoopMode = mode;\n\n    return this;\n  }\n\n  /**\n   * Get an attachment node.\n   */\n  getAttachment(id: number): SkeletalNode | undefined {\n    const model = <MdxModel>this.model;\n    const attachment = model.attachments[id];\n\n    if (attachment) {\n      return this.nodes[attachment.index];\n    }\n\n    return;\n  }\n\n  resetEventEmitters(): void {\n    for (const emitter of this.eventObjectEmitters) {\n      emitter.lastValue = 0;\n    }\n  }\n\n  resetAttachments(): void {\n    for (const attachment of this.attachments) {\n      attachment.internalInstance.hide();\n    }\n  }\n}\n","const shader = `\n#ifdef SKIN\nattribute vec4 a_bones;\nattribute vec4 a_weights;\n\nvoid transformSkin(inout vec3 position, inout vec3 normal, inout vec3 tangent, inout vec3 binormal) {\n  mat4 bone;\n\n  bone += fetchMatrix(a_bones[0], 0.0) * a_weights[0];\n  bone += fetchMatrix(a_bones[1], 0.0) * a_weights[1];\n  bone += fetchMatrix(a_bones[2], 0.0) * a_weights[2];\n  bone += fetchMatrix(a_bones[3], 0.0) * a_weights[3];\n\n  mat3 rotation = mat3(bone);\n\n  position = vec3(bone * vec4(position, 1.0));\n  normal = rotation * normal;\n  tangent = rotation * tangent;\n  binormal = rotation * binormal;\n}\n#else\nattribute vec4 a_bones;\n#ifdef EXTENDED_BONES\nattribute vec4 a_extendedBones;\n#endif\nattribute float a_boneNumber;\n\nmat4 getVertexGroupMatrix() {\n  mat4 bone;\n\n  // For the broken models out there, since the game supports this.\n  if (a_boneNumber > 0.0) {\n    for (int i = 0; i < 4; i++) {\n      if (a_bones[i] > 0.0) {\n        bone += fetchMatrix(a_bones[i] - 1.0, 0.0);\n      }\n    }\n\n    #ifdef EXTENDED_BONES\n      for (int i = 0; i < 4; i++) {\n        if (a_extendedBones[i] > 0.0) {\n          bone += fetchMatrix(a_extendedBones[i] - 1.0, 0.0);\n        }\n      }\n    #endif\n  }\n\n  return bone / a_boneNumber;\n}\n\nvoid transformVertexGroups(inout vec3 position, inout vec3 normal) {\n  mat4 bone = getVertexGroupMatrix();\n  mat3 rotation = mat3(bone);\n\n  position = vec3(bone * vec4(position, 1.0));\n  normal = normalize(rotation * normal);\n}\n\nvoid transformVertexGroupsHD(inout vec3 position, inout vec3 normal, inout vec3 tangent, inout vec3 binormal) {\n  mat4 bone = getVertexGroupMatrix();\n  mat3 rotation = mat3(bone);\n\n  position = vec3(bone * vec4(position, 1.0));\n  normal = normalize(rotation * normal);\n  tangent = normalize(rotation * tangent);\n  binormal = normalize(rotation * binormal);\n}\n#endif\n`;\n\nexport default shader;\n","import boneTexture from '../../shaders/bonetexture.glsl';\nimport transforms from './transforms.glsl';\n\nconst shader = `\nuniform mat4 u_VP;\nuniform vec3 u_lightPos;\nuniform vec4 u_vertexColor;\nuniform vec4 u_geosetColor;\nuniform float u_layerAlpha;\nuniform vec2 u_uvTrans;\nuniform vec2 u_uvRot;\nuniform float u_uvScale;\nuniform bool u_hasBones;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec4 v_color;\nvarying vec4 v_uvTransRot;\nvarying float v_uvScale;\nvarying vec3 v_lightDir;\n\n${boneTexture}\n${transforms}\n\nvoid main() {\n  vec3 position = a_position;\n  vec3 normal = a_normal;\n\n  if (u_hasBones) {\n    transformVertexGroups(position, normal);\n  }\n\n  v_uv = a_uv;\n  v_normal = normal;\n  v_color = u_vertexColor * u_geosetColor.bgra * vec4(1.0, 1.0, 1.0, u_layerAlpha);\n  v_uvTransRot = vec4(u_uvTrans, u_uvRot);\n  v_uvScale = u_uvScale;\n  v_lightDir = normalize(u_lightPos - position);\n\n  gl_Position = u_VP * vec4(position, 1.0);\n}\n`;\n\nexport default shader;\n","import precision from '../../shaders/precision.glsl';\nimport quatTransform from '../../shaders/quattransform.glsl';\n\nconst shader = `\n${precision}\n\n${quatTransform}\n\nuniform sampler2D u_texture;\nuniform float u_filterMode;\nuniform bool u_unshaded;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec4 v_color;\nvarying vec4 v_uvTransRot;\nvarying float v_uvScale;\nvarying vec3 v_lightDir;\n\nvec4 getDiffuseColor() {\n  vec2 uv = v_uv;\n\n  // Translation animation\n  uv += v_uvTransRot.xy;\n\n  // Rotation animation\n  uv = quat_transform(v_uvTransRot.zw, uv - 0.5) + 0.5;\n\n  // Scale animation\n  uv = v_uvScale * (uv - 0.5) + 0.5;\n\n  vec4 texel = texture2D(u_texture, uv);\n  vec4 color = texel * v_color;\n\n  // 1bit Alpha\n  if (u_filterMode == 1.0 && color.a < 0.75) {\n    discard;\n  }\n\n  // \"Close to 0 alpha\"\n  if (u_filterMode >= 5.0 && color.a < 0.02) {\n    discard;\n  }\n\n  return color;\n}\n\nvoid onlyTexCoords() {\n  gl_FragColor = vec4(v_uv, 0.0, 1.0);\n}\n\nvoid onlyNormals() {\n  gl_FragColor = vec4(v_normal, 1.0);\n}\n\nvoid onlyDiffuse() {\n  gl_FragColor = getDiffuseColor();\n}\n\nvoid lambert() {\n  vec4 color = getDiffuseColor();\n\n  if (!u_unshaded) {\n    float lambertFactor = clamp(dot(v_normal, v_lightDir), 0.0, 1.0);\n    lambertFactor = clamp(lambertFactor + 0.7, 0.0, 1.0);\n\n    color.rgb *= lambertFactor;\n  }\n\n  gl_FragColor = color;\n}\n\nvoid main() {\n  #if defined(ONLY_DIFFUSE)\n  onlyDiffuse();\n  #elif defined(ONLY_TEXCOORDS)\n  onlyTexCoords();\n  #elif defined(ONLY_NORMALS)\n  onlyNormals();\n  #else\n  lambert();\n  #endif\n}\n`;\n\nexport default shader;\n","\nimport boneTexture from '../../shaders/bonetexture.glsl';\nimport transforms from './transforms.glsl';\n\nconst shader = `\nuniform mat4 u_VP;\nuniform mat4 u_MV;\nuniform vec3 u_eyePos;\nuniform vec3 u_lightPos;\nuniform float u_layerAlpha;\nuniform bool u_hasBones;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\nattribute vec4 a_tangent;\n\nvarying vec2 v_uv;\nvarying float v_layerAlpha;\nvarying vec3 v_lightDir;\nvarying vec3 v_eyeVec;\nvarying vec3 v_normal;\n// varying vec3 v_lightDirWorld;\n\n#if defined(ONLY_TANGENTS)\nvarying vec3 v_tangent;\n#endif\n\n${boneTexture}\n${transforms}\n\nvec3 TBN(vec3 vector, vec3 tangent, vec3 binormal, vec3 normal) {\n  return vec3(dot(vector, tangent), dot(vector, binormal), dot(vector, normal));\n}\n\nvoid main() {\n  vec3 position = a_position;\n  vec3 normal = a_normal;\n  vec3 tangent = a_tangent.xyz;\n\n  // Re-orthogonalize the tangent in case it wasnt normalized.\n  // See \"One last thing\" at https://learnopengl.com/Advanced-Lighting/Normal-Mapping\n  tangent = normalize(tangent - dot(tangent, normal) * normal);\n\n  vec3 binormal = cross(normal, tangent) * a_tangent.w;\n\n  if (u_hasBones) {\n    #ifdef SKIN\n      transformSkin(position, normal, tangent, binormal);\n    #else\n      transformVertexGroupsHD(position, normal, tangent, binormal);\n    #endif\n  }\n\n  vec3 position_mv = vec3(u_MV * vec4(position, 1));\n\n  mat3 mv = mat3(u_MV);\n  vec3 t = normalize(mv * tangent);\n  vec3 b = normalize(mv * binormal);\n  vec3 n = normalize(mv * normal);\n\n  v_eyeVec = normalize(u_eyePos - position_mv);\n\n  vec3 lightDir = normalize(u_lightPos - position_mv);\n  v_lightDir = normalize(TBN(lightDir, t, b, n));\n  \n  v_uv = a_uv;\n  v_layerAlpha = u_layerAlpha;\n\n  v_normal = normal;\n  // v_lightDirWorld = normalize(lightDir);\n\n  #if defined(ONLY_TANGENTS)\n  v_tangent = tangent;\n  #endif\n\n  gl_Position = u_VP * vec4(position, 1.0);\n}\n`;\n\nexport default shader;\n","import precision from '../../shaders/precision.glsl';\n\nconst shader = `\n${precision}\n\nuniform sampler2D u_diffuseMap;\nuniform sampler2D u_normalsMap;\nuniform sampler2D u_ormMap;\nuniform sampler2D u_emissiveMap;\nuniform sampler2D u_teamColorMap;\nuniform sampler2D u_environmentMap;\nuniform float u_filterMode;\n\n// uniform sampler2D u_lutMap;\n// uniform sampler2D u_envDiffuseMap;\n// uniform sampler2D u_envSpecularMap;\n\nvarying vec2 v_uv;\nvarying float v_layerAlpha;\nvarying vec3 v_lightDir;\nvarying vec3 v_eyeVec;\nvarying vec3 v_normal;\n// varying vec3 v_lightDirWorld;\n\n#if defined(ONLY_TANGENTS)\nvarying vec3 v_tangent;\n#endif\n\nvec3 decodeNormal() {\n  vec2 xy = texture2D(u_normalsMap, v_uv).xy * 2.0 - 1.0;\n  \n  return vec3(xy, sqrt(1.0 - dot(xy, xy)));\n}\n\nconst vec2 invAtan = vec2(0.1591, 0.3183);\nvec2 sampleEnvironmentMap(vec3 normal) {\n  vec2 uv = vec2(atan(normal.x, normal.y), -asin(normal.z));\n  uv *= invAtan;\n  uv += 0.5;\n  return uv;\n}\n\nvec4 getDiffuseColor() {\n  vec4 color = texture2D(u_diffuseMap, v_uv);\n\n  // 1bit Alpha\n  if (u_filterMode == 1.0 && color.a < 0.75) {\n    discard;\n  }\n\n  return color;\n}\n\nvec4 getOrmColor() {\n  return texture2D(u_ormMap, v_uv);\n}\n\nvec3 getEmissiveColor() {\n  return texture2D(u_emissiveMap, v_uv).rgb;\n}\n\nvec3 getTeamColor() {\n  return texture2D(u_teamColorMap, v_uv).rgb;\n}\n\n// const float PI = 3.14159265359;\n// const float RECIPROCAL_PI = 0.31830988618;\n// const float RECIPROCAL_PI2 = 0.15915494;\n// const float LN2 = 0.6931472;\n// const float ENV_LODS = 6.0;\n// vec4 SRGBtoLinear(vec4 srgb) {\n//     vec3 linOut = pow(srgb.xyz, vec3(2.2));\n//     return vec4(linOut, srgb.w);;\n// }\n// vec4 RGBMToLinear(in vec4 value) {\n//     float maxRange = 6.0;\n//     return vec4(value.xyz * value.w * maxRange, 1.0);\n// }\n// vec3 linearToSRGB(vec3 color) {\n//     return pow(color, vec3(1.0 / 2.2));\n// }\n// // vec3 getNormal() {\n// //     vec3 pos_dx = dFdx(vMPos.xyz);\n// //     vec3 pos_dy = dFdy(vMPos.xyz);\n// //     vec2 tex_dx = dFdx(vUv);\n// //     vec2 tex_dy = dFdy(vUv);\n// //     vec3 t = normalize(pos_dx * tex_dy.t - pos_dy * tex_dx.t);\n// //     vec3 b = normalize(-pos_dx * tex_dy.s + pos_dy * tex_dx.s);\n// //     mat3 tbn = mat3(t, b, normalize(vNormal));\n// //     vec3 n = texture2D(tNormal, vUv * uNormalUVScale).rgb * 2.0 - 1.0;\n// //     n.xy *= uNormalScale;\n// //     vec3 normal = normalize(tbn * n);\n// //     // Get world normal from view normal (normalMatrix * normal)\n// //     return normalize((vec4(normal, 0.0) * viewMatrix).xyz);\n// // }\n// vec3 specularReflection(vec3 specularEnvR0, vec3 specularEnvR90, float VdH) {\n//     return specularEnvR0 + (specularEnvR90 - specularEnvR0) * pow(clamp(1.0 - VdH, 0.0, 1.0), 5.0);\n// }\n// float geometricOcclusion(float NdL, float NdV, float roughness) {\n//     float r = roughness;\n//     float attenuationL = 2.0 * NdL / (NdL + sqrt(r * r + (1.0 - r * r) * (NdL * NdL)));\n//     float attenuationV = 2.0 * NdV / (NdV + sqrt(r * r + (1.0 - r * r) * (NdV * NdV)));\n//     return attenuationL * attenuationV;\n// }\n// float microfacetDistribution(float roughness, float NdH) {\n//     float roughnessSq = roughness * roughness;\n//     float f = (NdH * roughnessSq - NdH) * NdH + 1.0;\n//     return roughnessSq / (PI * f * f);\n// }\n// vec2 cartesianToPolar(vec3 n) {\n//     vec2 uv;\n//     uv.x = atan(n.z, n.x) * RECIPROCAL_PI2 + 0.5;\n//     uv.y = asin(n.y) * RECIPROCAL_PI + 0.5;\n//     return uv;\n// }\n// void getIBLContribution(inout vec3 diffuse, inout vec3 specular, float NdV, float roughness, vec3 n, vec3 reflection, vec3 diffuseColor, vec3 specularColor) {\n//   vec3 brdf = SRGBtoLinear(texture2D(u_lutMap, vec2(NdV, roughness))).rgb;\n//   vec3 diffuseLight = RGBMToLinear(texture2D(u_envDiffuseMap, sampleEnvironmentMap(n))).rgb;\n//   // Sample 2 levels and mix between to get smoother degradation\n//   float blend = roughness * ENV_LODS;\n//   float level0 = floor(blend);\n//   float level1 = min(ENV_LODS, level0 + 1.0);\n//   blend -= level0;\n  \n//   // Sample the specular env map atlas depending on the roughness value\n//   vec2 uvSpec = sampleEnvironmentMap(reflection);\n//   uvSpec.y /= 2.0;\n//   vec2 uv0 = uvSpec;\n//   vec2 uv1 = uvSpec;\n//   uv0 /= pow(2.0, level0);\n//   uv0.y += 1.0 - exp(-LN2 * level0);\n//   uv1 /= pow(2.0, level1);\n//   uv1.y += 1.0 - exp(-LN2 * level1);\n//   vec3 specular0 = RGBMToLinear(texture2D(u_envSpecularMap, uv0)).rgb;\n//   vec3 specular1 = RGBMToLinear(texture2D(u_envSpecularMap, uv1)).rgb;\n//   vec3 specularLight = mix(specular0, specular1, blend);\n//   diffuse = diffuseLight * diffuseColor;\n  \n//   // Bit of extra reflection for smooth materials\n//   float reflectivity = pow((1.0 - roughness), 2.0) * 0.05;\n//   specular = specularLight * (specularColor * brdf.x + brdf.y + reflectivity);\n//   // specular *= uEnvSpecular;\n// }\n\n// void PBR() {\n//   vec4 baseDiffuseColor = getDiffuseColor();\n//   vec3 baseColor = baseDiffuseColor.rgb;\n//   vec4 orm = getOrmColor();\n//   vec3 tc = getTeamColor();\n//   float tcFactor = getOrmColor().a;\n\n//   if (tcFactor > 0.1) {\n//     baseColor *= tc * tcFactor;\n//   }\n\n//   float roughness = clamp(orm.g, 0.04, 1.0);\n//   float metallic = clamp(orm.b, 0.04, 1.0);\n\n//   vec3 f0 = vec3(0.04);\n//   vec3 diffuseColor = baseColor * (vec3(1.0) - f0) * (1.0 - metallic);\n//   vec3 specularColor = mix(f0, baseColor, metallic);\n//   vec3 specularEnvR0 = specularColor;\n//   vec3 specularEnvR90 = vec3(clamp(max(max(specularColor.r, specularColor.g), specularColor.b) * 25.0, 0.0, 1.0));\n\n//   vec3 N = v_normal;\n//   vec3 V = normalize(v_eyeVec);\n//   vec3 L = normalize(v_lightDirWorld);\n//   vec3 H = normalize(L + V);\n//   vec3 reflection = normalize(reflect(-V, N));\n\n//   float NdL = clamp(dot(N, L), 0.001, 1.0);\n//   float NdV = clamp(abs(dot(N, V)), 0.001, 1.0);\n//   float NdH = clamp(dot(N, H), 0.0, 1.0);\n//   float LdH = clamp(dot(L, H), 0.0, 1.0);\n//   float VdH = clamp(dot(V, H), 0.0, 1.0);\n\n//   vec3 F = specularReflection(specularEnvR0, specularEnvR90, VdH);\n//   float G = geometricOcclusion(NdL, NdV, roughness);\n//   float D = microfacetDistribution(roughness, NdH);\n\n//   vec3 diffuseContrib = (1.0 - F) * (diffuseColor / PI);\n//   vec3 specContrib = F * G * D / (4.0 * NdL * NdV);\n  \n//   // Shading based off lights\n//   // vec3 color = NdL * uLightColor * (diffuseContrib + specContrib);\n//   vec3 color = NdL * (diffuseContrib + specContrib);\n\n//   // Calculate IBL lighting\n//   vec3 diffuseIBL;\n//   vec3 specularIBL;\n//   getIBLContribution(diffuseIBL, specularIBL, NdV, roughness, N, reflection, diffuseColor, specularColor);\n\n//   // Add IBL on top of color\n//   color +=  specularIBL;\n\n//   color *= orm.r;\n\n//   color += getEmissiveColor();\n\n//   // Convert to sRGB to display\n//   gl_FragColor.rgb = color;\n//   gl_FragColor.a = baseDiffuseColor.a;\n// }\n\nvoid onlyDiffuse() {\n  vec4 baseColor = getDiffuseColor();\n  vec3 tc = getTeamColor();\n  float tcFactor = getOrmColor().a;\n\n  if (tcFactor > 0.1) {\n    baseColor.rgb *= tc * tcFactor;\n  }\n\n  gl_FragColor = baseColor;\n}\n\nvoid onlyNormalMap() {\n  gl_FragColor = vec4(decodeNormal(), 1.0);\n}\n\nvoid onlyOcclusion() {\n  gl_FragColor = vec4(getOrmColor().rrr, 1.0);\n}\n\nvoid onlyRoughness() {\n  gl_FragColor = vec4(getOrmColor().ggg, 1.0);\n}\n\nvoid onlyMetallic() {\n  gl_FragColor = vec4(getOrmColor().bbb, 1.0);\n}\n\nvoid onlyTeamColorFactor() {\n  gl_FragColor = vec4(getOrmColor().aaa, 1.0);\n}\n\nvoid onlyEmissiveMap() {\n  gl_FragColor = vec4(getEmissiveColor(), 1.0);\n}\n\nvoid onlyTexCoords() {\n  gl_FragColor = vec4(v_uv, 0.0, 1.0);\n}\n\nvoid onlyNormals() {\n  gl_FragColor = vec4(v_normal, 1.0);\n}\n\n#if defined(ONLY_TANGENTS)\nvoid onlyTangents() {\n  gl_FragColor = vec4(v_tangent, 1.0);\n}\n#endif\n\nvoid lambert() {\n  vec4 baseColor = getDiffuseColor();\n  vec3 normal = decodeNormal();\n  vec4 orm = getOrmColor();\n  vec3 emissive = getEmissiveColor();\n  vec3 tc = getTeamColor();\n  float aoFactor = orm.r;\n  float tcFactor = orm.a;\n  float lambertFactor = clamp(dot(normal, v_lightDir), 0.0, 1.0);\n  vec3 color = baseColor.rgb;\n\n  if (tcFactor > 0.1) {\n    color *= tc * tcFactor;\n  }\n  \n  color *= clamp(lambertFactor * aoFactor + 0.1, 0.0, 1.0);\n  color += emissive;\n\n  gl_FragColor = vec4(color, baseColor.a);\n}\n\nvoid main() {\n  #if defined(ONLY_DIFFUSE)\n  onlyDiffuse();\n  #elif defined(ONLY_NORMAL_MAP)\n  onlyNormalMap();\n  #elif defined(ONLY_OCCLUSION)\n  onlyOcclusion();\n  #elif defined(ONLY_ROUGHNESS)\n  onlyRoughness();\n  #elif defined(ONLY_METALLIC)\n  onlyMetallic();\n  #elif defined(ONLY_TC_FACTOR)\n  onlyTeamColorFactor();\n  #elif defined(ONLY_EMISSIVE)\n  onlyEmissiveMap();\n  #elif defined(ONLY_TEXCOORDS)\n  onlyTexCoords();\n  #elif defined(ONLY_NORMALS)\n  onlyNormals();\n  #elif defined(ONLY_TANGENTS)\n  onlyTangents();\n  #else\n  lambert();\n  #endif\n}\n`;\n\nexport default shader;\n","import precision from '../../shaders/precision.glsl';\n\nconst shader = `\n${precision}\n\n#define EMITTER_PARTICLE2 0\n#define EMITTER_RIBBON 1\n\nuniform sampler2D u_texture;\nuniform highp int u_emitter;\nuniform float u_filterMode;\n\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\n\nvoid main() {\n  vec4 texel = texture2D(u_texture, v_texcoord);\n  vec4 color = texel * v_color;\n\n  // 1bit Alpha, used by ribbon emitters.\n  if (u_emitter == EMITTER_RIBBON && u_filterMode == 1.0 && color.a < 0.75) {\n    discard;\n  }\n\n  // \"Close to 0 alpha\"\n  if (u_emitter == EMITTER_PARTICLE2 && (u_filterMode == 2.0 || u_filterMode == 3.0) && color.a < 0.02) {\n    discard;\n  }\n\n  // Alpha key.\n  if (u_emitter == EMITTER_PARTICLE2 && (u_filterMode == 4.0) && color.a < 0.75) {\n    discard;\n  }\n\n  gl_FragColor = color;\n}\n`;\n\nexport default shader;\n","import { extname } from '../../../common/path';\nimport { FetchDataType } from '../../../common/fetchdatatype';\nimport { decodeAudioData } from '../../../common/audio';\nimport MdlxModel from '../../../parsers/mdlx/model';\nimport { isMdx, isMdl } from '../../../parsers/mdlx/isformat';\nimport { MappedData, MappedDataRow } from '../../../utils/mappeddata';\nimport ModelViewer, { DebugRenderMode } from '../../viewer';\nimport Shader from '../../gl/shader';\nimport { PathSolver, SolverParams } from '../../handlerresource';\nimport { Resource } from '../../resource';\nimport GenericResource from '../../genericresource';\nimport Texture from '../../texture';\nimport Model from './model';\nimport MdxTexture from './texture';\nimport sdVert from './shaders/sd.vert';\nimport sdFrag from './shaders/sd.frag';\nimport hdVert from './shaders/hd.vert';\nimport hdFrag from './shaders/hd.frag';\nimport particlesVert from './shaders/particles.vert';\nimport particlesFrag from './shaders/particles.frag';\nimport { SkinningType } from './batch';\nimport { WrapMode } from '../../../parsers/mdlx/texture';\n\nexport interface EventObjectData {\n  row: MappedDataRow;\n  resources: Resource[];\n}\n\nexport interface MdxHandlerObject {\n  pathSolver?: PathSolver;\n  reforged: boolean;\n  sdShader: Shader;\n  sdExtendedShader: Shader;\n  hdShader: Shader;\n  hdExtendedShader: Shader;\n  hdSkinShader: Shader;\n  particlesShader: Shader;\n  sdDebugShaders: Shader[][];\n  hdDebugShaders: Shader[][];\n  rectBuffer: WebGLBuffer;\n  teamColors: MdxTexture[];\n  teamGlows: MdxTexture[];\n  eventObjectTables: {[key: string]: GenericResource[] };\n\n  // lutTexture: MdxTexture | null;\n  // envDiffuseTexture: MdxTexture | null;\n  // envSpecularTexture: MdxTexture | null;\n}\n\nconst mappedDataCallback = (data: FetchDataType): MappedData => new MappedData(<string>data);\nconst decodedDataCallback = (data: FetchDataType): Promise<AudioBuffer | undefined> => decodeAudioData(<ArrayBuffer>data);\n\nexport default {\n  load(viewer: ModelViewer, pathSolver?: PathSolver, reforged = false): void {\n    const gl = viewer.gl;\n    const webgl = viewer.webgl;\n\n    // Bone textures.\n    if (!webgl.ensureExtension('OES_texture_float')) {\n      throw new Error('MDX: No float texture support!');\n    }\n\n    // Geometry emitters.\n    if (!webgl.ensureExtension('ANGLE_instanced_arrays')) {\n      throw new Error('MDX: No instanced rendering support!');\n    }\n\n    // Shaders. Lots of them.\n    const sdExtendedVert = '#define EXTENDED_BONES\\n' + sdVert;\n    const sdDiffuse = '#define ONLY_DIFFUSE\\n' + sdFrag;\n    const sdTexcoords = '#define ONLY_TEXCOORDS\\n' + sdFrag;\n    const sdNormals = '#define ONLY_NORMALS\\n' + sdFrag;\n    const hdExtendedVert = '#define EXTENDED_BONES\\n' + hdVert;\n    const hdSkinVert = '#define SKIN\\n' + hdVert;\n    const hdDiffuse = '#define ONLY_DIFFUSE\\n' + hdFrag;\n    const hdNormalMap = '#define ONLY_NORMAL_MAP\\n' + hdFrag;\n    const hdOcclusion = '#define ONLY_OCCLUSION\\n' + hdFrag;\n    const hdRoughness = '#define ONLY_ROUGHNESS\\n' + hdFrag;\n    const hdMetallic = '#define ONLY_METALLIC\\n' + hdFrag;\n    const hdTCFactor = '#define ONLY_TC_FACTOR\\n' + hdFrag;\n    const hdEmissive = '#define ONLY_EMISSIVE\\n' + hdFrag;\n    const hdTexCoords = '#define ONLY_TEXCOORDS\\n' + hdFrag;\n    const hdNormals = '#define ONLY_NORMALS\\n' + hdFrag;\n    const hdTangents = '#define ONLY_TANGENTS\\n' + hdFrag;\n    \n    const sdShader = webgl.createShader(sdVert, sdFrag);\n    const sdExtendedShader = webgl.createShader(sdExtendedVert, sdFrag);\n    const hdShader = webgl.createShader(hdVert, hdFrag);\n    const hdExtendedShader = webgl.createShader(hdExtendedVert, hdFrag);\n    const hdSkinShader = webgl.createShader(hdSkinVert, hdFrag);\n    const particlesShader = webgl.createShader(particlesVert, particlesFrag);\n\n    const sdDebugShaders: Shader[][] = [];\n    const hdDebugShaders: Shader[][] = [];\n\n    let shaders: Shader[] = [];\n    shaders[DebugRenderMode.Diffuse] = webgl.createShader(sdVert, sdDiffuse);\n    shaders[DebugRenderMode.TexCoords] = webgl.createShader(sdVert, sdTexcoords);\n    shaders[DebugRenderMode.Normals] = webgl.createShader(sdVert, sdNormals);\n    sdDebugShaders[SkinningType.VertexGroups] = shaders;\n\n    shaders = [];\n    shaders[DebugRenderMode.Diffuse] = webgl.createShader(sdExtendedVert, sdDiffuse);\n    shaders[DebugRenderMode.TexCoords] = webgl.createShader(sdExtendedVert, sdTexcoords);\n    shaders[DebugRenderMode.Normals] = webgl.createShader(sdExtendedVert, sdNormals);\n    sdDebugShaders[SkinningType.ExtendedVertexGroups] = shaders;\n\n    shaders = [];\n    shaders[DebugRenderMode.Diffuse] = webgl.createShader(hdVert, hdDiffuse);\n    shaders[DebugRenderMode.NormalMap] = webgl.createShader(hdVert, hdNormalMap);\n    shaders[DebugRenderMode.Occlusion] = webgl.createShader(hdVert, hdOcclusion);\n    shaders[DebugRenderMode.Roughness] = webgl.createShader(hdVert, hdRoughness);\n    shaders[DebugRenderMode.Metallic] = webgl.createShader(hdVert, hdMetallic);\n    shaders[DebugRenderMode.TCFactor] = webgl.createShader(hdVert, hdTCFactor);\n    shaders[DebugRenderMode.Emissive] = webgl.createShader(hdVert, hdEmissive);\n    shaders[DebugRenderMode.TexCoords] = webgl.createShader(hdVert, hdTexCoords);\n    shaders[DebugRenderMode.Normals] = webgl.createShader(hdVert, hdNormals);\n    shaders[DebugRenderMode.Tangents] = webgl.createShader('#define ONLY_TANGENTS\\n' + hdVert, hdTangents);\n    hdDebugShaders[SkinningType.VertexGroups] = shaders;\n\n    shaders = [];\n    shaders[DebugRenderMode.Diffuse] = webgl.createShader(hdExtendedVert, hdDiffuse);\n    shaders[DebugRenderMode.NormalMap] = webgl.createShader(hdExtendedVert, hdNormalMap);\n    shaders[DebugRenderMode.Occlusion] = webgl.createShader(hdExtendedVert, hdOcclusion);\n    shaders[DebugRenderMode.Roughness] = webgl.createShader(hdExtendedVert, hdRoughness);\n    shaders[DebugRenderMode.Metallic] = webgl.createShader(hdExtendedVert, hdMetallic);\n    shaders[DebugRenderMode.TCFactor] = webgl.createShader(hdExtendedVert, hdTCFactor);\n    shaders[DebugRenderMode.Emissive] = webgl.createShader(hdExtendedVert, hdEmissive);\n    shaders[DebugRenderMode.TexCoords] = webgl.createShader(hdExtendedVert, hdTexCoords);\n    shaders[DebugRenderMode.Normals] = webgl.createShader(hdExtendedVert, hdNormals);\n    shaders[DebugRenderMode.Tangents] = webgl.createShader('#define ONLY_TANGENTS\\n' + hdExtendedVert, hdTangents);\n    hdDebugShaders[SkinningType.ExtendedVertexGroups] = shaders;\n\n    shaders = [];\n    shaders[DebugRenderMode.Diffuse] = webgl.createShader(hdSkinVert, hdDiffuse);\n    shaders[DebugRenderMode.NormalMap] = webgl.createShader(hdSkinVert, hdNormalMap);\n    shaders[DebugRenderMode.Occlusion] = webgl.createShader(hdSkinVert, hdOcclusion);\n    shaders[DebugRenderMode.Roughness] = webgl.createShader(hdSkinVert, hdRoughness);\n    shaders[DebugRenderMode.Metallic] = webgl.createShader(hdSkinVert, hdMetallic);\n    shaders[DebugRenderMode.TCFactor] = webgl.createShader(hdSkinVert, hdTCFactor);\n    shaders[DebugRenderMode.Emissive] = webgl.createShader(hdSkinVert, hdEmissive);\n    shaders[DebugRenderMode.TexCoords] = webgl.createShader(hdSkinVert, hdTexCoords);\n    shaders[DebugRenderMode.Normals] = webgl.createShader(hdSkinVert, hdNormals);\n    shaders[DebugRenderMode.Tangents] = webgl.createShader('#define ONLY_TANGENTS\\n' + hdSkinVert, hdTangents);\n    hdDebugShaders[SkinningType.Skin] = shaders;\n\n    const rectBuffer = <WebGLBuffer>gl.createBuffer();\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, rectBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Uint8Array([0, 1, 2, 0, 2, 3]), gl.STATIC_DRAW);\n\n    const handlerData: MdxHandlerObject = {\n      pathSolver,\n      reforged,\n      // Shaders.\n      sdShader,\n      sdExtendedShader,\n      hdShader,\n      hdExtendedShader,\n      hdSkinShader,\n      particlesShader,\n      sdDebugShaders,\n      hdDebugShaders,\n      // Geometry emitters buffer.\n      rectBuffer,\n      // Team color/glow textures - loaded when the first model that uses team textures is loaded.\n      teamColors: [],\n      teamGlows: [],\n      eventObjectTables: {},\n\n      // lutTexture: null,\n      // envDiffuseTexture: null,\n      // envSpecularTexture: null,\n    };\n\n    viewer.sharedCache.set('mdx', handlerData);\n  },\n  isValidSource(object: unknown): boolean {\n    if (object instanceof MdlxModel) {\n      return true;\n    }\n\n    return isMdx(object) || isMdl(object);\n  },\n  resource: Model,\n  // async loadEnv(viewer: ModelViewer) {\n  //   const mdxHandler = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n\n  //   if (!mdxHandler.lutTexture) {\n  //     mdxHandler.lutTexture = new MdxTexture(0, WrapMode.WrapBoth);\n  //     mdxHandler.envDiffuseTexture = new MdxTexture(0, WrapMode.WrapBoth);\n  //     mdxHandler.envSpecularTexture = new MdxTexture(0, WrapMode.WrapBoth);\n\n  //     const [lutTexture, diffuseTexture, specularTexture] = await Promise.all([\n  //       viewer.load('env/lut.png'),\n  //       viewer.load('env/diffuse-sRGB.png'),\n  //       viewer.load('env/specular-sRGB.png'),\n  //     ]);\n\n  //     mdxHandler.lutTexture.texture = <Texture>lutTexture;\n  //     mdxHandler.envDiffuseTexture.texture = <Texture>diffuseTexture;\n  //     mdxHandler.envSpecularTexture.texture = <Texture>specularTexture;\n  //   }\n\n  // },\n  loadTeamTextures(viewer: ModelViewer): void {\n    const { pathSolver, reforged, teamColors, teamGlows } = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n\n    if (teamColors.length === 0) {\n      const teams = reforged ? 28 : 16;\n      const ext = reforged ? 'dds' : 'blp';\n      const params = reforged ? { reforged: true } : undefined;\n\n      for (let i = 0; i < teams; i++) {\n        const id = `${i}`.padStart(2, '0');\n        const end = `${id}.${ext}`;\n\n        const teamColor = new MdxTexture(1, WrapMode.WrapBoth);\n        const teamGlow = new MdxTexture(2, WrapMode.WrapBoth);\n\n        viewer.load(`ReplaceableTextures\\\\TeamColor\\\\TeamColor${end}`, pathSolver, params)\n          .then((texture) => teamColor.texture = <Texture>texture);\n\n        viewer.load(`ReplaceableTextures\\\\TeamGlow\\\\TeamGlow${end}`, pathSolver, params)\n          .then((texture) => teamGlow.texture = <Texture>texture);\n\n        teamColors[i] = teamColor;\n        teamGlows[i] = teamGlow;\n      }\n    }\n  },\n  getEventObjectSoundFile(file: string, reforged: boolean, isHd: boolean, tables: GenericResource[]): string | undefined {\n    if (!reforged || extname(file) === '.flac') {\n      return file;\n    }\n\n    for (let i = 1, l = tables.length; i < l; i++) {\n      const raceRow = (<MappedData>tables[i].data).getRow(file);\n\n      if (raceRow) {\n        const flags = raceRow.string('Flags');\n        const filePath = raceRow.string('Filepath');\n\n        if (flags === 'SD_ONLY') {\n          if (!isHd) {\n            return filePath;\n          }\n        } else if (flags === 'HD_ONLY') {\n          if (isHd) {\n            return filePath;\n          }\n        } else {\n          return filePath;\n        }\n      }\n    }\n\n    return;\n  },\n  async getEventObjectData(viewer: ModelViewer, type: string, id: string, isHd: boolean): Promise<EventObjectData | undefined> {\n    // Units\\Critters\\BlackStagMale\\BlackStagMale.mdx has an event object named \"Point01\".\n    if (type !== 'SPN' && type !== 'SPL' && type !== 'UBR' && type !== 'SND') {\n      return;\n    }\n\n    const { pathSolver, reforged, eventObjectTables } = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n    const params: SolverParams = reforged ? { reforged: true } : {};\n    const safePathSolver: PathSolver = async (src: unknown, params?: SolverParams): Promise<unknown> =>{\n      if (pathSolver) {\n        return pathSolver(src, params);\n      }\n\n      return src;\n    };\n\n    if (!eventObjectTables[type]) {\n      const paths = [];\n\n      if (type === 'SPN') {\n        paths.push('Splats\\\\SpawnData.slk');\n      } else if (type === 'SPL') {\n        paths.push('Splats\\\\SplatData.slk');\n      } else if (type === 'UBR') {\n        paths.push('Splats\\\\UberSplatData.slk');\n      } else if (type === 'SND') {\n        paths.push('UI\\\\SoundInfo\\\\AnimSounds.slk');\n\n        // Reforged changed the data layout.\n        if (reforged) {\n          paths.push(\n            'UI\\\\SoundInfo\\\\DialogueHumanBase.slk',\n            'UI\\\\SoundInfo\\\\DialogueOrcBase.slk',\n            'UI\\\\SoundInfo\\\\DialogueUndeadBase.slk',\n            'UI\\\\SoundInfo\\\\DialogueNightElfBase.slk',\n            'UI\\\\SoundInfo\\\\DialogueNagaBase.slk',\n            'UI\\\\SoundInfo\\\\DialogueDemonBase.slk',\n            'UI\\\\SoundInfo\\\\DialogueCreepsBase.slk');\n        } else {\n          paths.push('UI\\\\SoundInfo\\\\AnimLookups.slk');\n        }\n      }\n // Allow path solvers to return promises.\n      const promises = paths.map(async (path) => viewer.loadGeneric( <string> await safePathSolver(path, params), 'text', mappedDataCallback));\n      const resources = await Promise.all(promises);\n\n      for (const resource of resources) {\n        if (!resource) {\n          return;\n        }\n      }\n\n      eventObjectTables[type] = <GenericResource[]>resources;\n    }\n\n    const tables = eventObjectTables[type];\n    const mappedData = <MappedData>tables[0].data;\n    let row: MappedDataRow | undefined;\n    const promises = [];\n\n    if (type === 'SND') {\n      // How to get the sound row?\n      // TFT has AnimLookups.slk, which stores a ID->Label. Give it the event object ID, get back the label to look for in AnimSounds.slk.\n      // Reforged removed AnimLookups.slk, and instead has the ID under a new column in AnimSounds.slk called AnimationEventCode.\n      // In addition, Reforged can have SD/HD flags per sound, to determine whether it should load in SD or HD modes.\n      // When a sound has both modes, the path to it in AnimSounds.slk won't be an actual file path (ending with .flac) but rather a label.\n      // This label can be queried in other sound SLKs such as DialogueHumanBase.slk, which contains the full path and the mentioned flags.\n      if (reforged) {\n        row = mappedData.findRow('AnimationEventCode', id);\n      } else {\n        const lookupRow = (<MappedData>tables[1].data).getRow(id);\n\n        if (lookupRow) {\n          row = mappedData.getRow(<string>lookupRow.string('SoundLabel'));\n        }\n      }\n\n      if (row) {\n        for (const fileName of (<string>row.string('FileNames')).split(',')) {\n          const file = this.getEventObjectSoundFile(fileName, reforged, isHd, tables);\n\n          if (file) {\n            promises.push(viewer.loadGeneric(<string> await safePathSolver(file, params), 'arrayBuffer', decodedDataCallback));\n          }\n        }\n      }\n    } else {\n      // Model and texture event objects are simpler than sounds - just get the right model or texture file.\n      row = mappedData.getRow(id);\n\n      if (row) {\n        if (type === 'SPN') {\n          promises.push(viewer.load((<string>row.string('Model')).replace('.mdl', '.mdx'), safePathSolver, params));\n        } else if (type === 'SPL' || type === 'UBR') {\n          promises.push(viewer.load(`ReplaceableTextures\\\\Splats\\\\${row.string('file')}${reforged ? '.dds' : '.blp'}`, safePathSolver, params));\n        }\n      }\n    }\n\n    if (row && promises.length) {\n      const resources = await Promise.all(promises);\n\n      // Make sure the resources actually loaded properly.\n      const filtered = <Resource[]>resources.filter((resource) => resource);\n\n      if (filtered.length) {\n        return { row, resources: filtered };\n      }\n    }\n\n    return;\n  },\n  getBatchShader(viewer: ModelViewer, skinningType: SkinningType, isHd: boolean): Shader {\n    const mdxCache = <MdxHandlerObject>viewer.sharedCache.get('mdx');\n    const debugRenderMode = viewer.debugRenderMode;\n\n    if (isHd) {\n      if (debugRenderMode !== DebugRenderMode.None) {\n        const shaders = mdxCache.hdDebugShaders[skinningType];\n        if (shaders) {\n          const shader = shaders[debugRenderMode];\n          if (shader) {\n            return shader;\n          }\n        }\n      }\n      \n      if (skinningType === SkinningType.Skin) {\n        return mdxCache.hdSkinShader;\n      } else if (skinningType === SkinningType.VertexGroups) {\n        return mdxCache.hdShader;\n      } else {\n        return mdxCache.hdExtendedShader;\n      }\n    } else {\n      if (debugRenderMode !== DebugRenderMode.None) {\n        const shaders = mdxCache.sdDebugShaders[skinningType];\n        if (shaders) {\n          const shader = shaders[debugRenderMode];\n          if (shader) {\n            return shader;\n          }\n        }\n      }\n\n      if (skinningType === SkinningType.VertexGroups) {\n        return mdxCache.sdShader;\n      } else {\n        return mdxCache.sdExtendedShader;\n      }\n    }\n  }\n};\n","const shader = `\n#define EMITTER_PARTICLE2 0\n#define EMITTER_RIBBON 1\n#define EMITTER_SPLAT 2\n#define EMITTER_UBERSPLAT 3\n#define HEAD 0.0\n\nuniform mat4 u_VP;\nuniform int u_emitter;\n\n// Shared\nuniform vec4 u_colors[3];\nuniform vec3 u_vertices[4];\nuniform vec3 u_intervals[4];\nuniform float u_lifeSpan;\nuniform float u_columns;\nuniform float u_rows;\n\n// Particle2\nuniform vec3 u_scaling;\nuniform vec3 u_cameraZ;\nuniform float u_timeMiddle;\nuniform bool u_teamColored;\n\n// Splat and Uber.\nuniform vec3 u_intervalTimes;\n\n// Vertices\nattribute float a_position;\n\n// Instances\nattribute vec3 a_p0;\nattribute vec3 a_p1;\nattribute vec3 a_p2;\nattribute vec3 a_p3;\nattribute float a_health;\nattribute vec4 a_color;\nattribute float a_tail;\nattribute vec3 a_leftRightTop;\n\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\n\nfloat getCell(vec3 interval, float factor) {\n  float start = interval[0];\n  float end = interval[1];\n  float repeat = interval[2];\n  float spriteCount = end - start;\n\n  if (spriteCount > 0.0) {\n    // Repeating speeds up the sprite animation, which makes it effectively run N times in its interval.\n    // E.g. if repeat is 4, the sprite animation will be seen 4 times, and thus also run 4 times as fast.\n    // The sprite index is limited to the number of actual sprites.\n    return min(start + mod(floor(spriteCount * repeat * factor), spriteCount), u_columns * u_rows - 1.0);\n  }\n\n  return start;\n}\n\nvoid particle2() {\n  float factor = (u_lifeSpan - a_health) / u_lifeSpan;\n  int index = 0;\n\n  if (factor < u_timeMiddle) {\n    factor = factor / u_timeMiddle;\n    index = 0;\n  } else {\n    factor = (factor - u_timeMiddle) / (1.0 - u_timeMiddle);\n    index = 1;\n  }\n\n  factor = min(factor, 1.0);\n\n  float scale = mix(u_scaling[index], u_scaling[index + 1], factor);\n  vec4 color = mix(u_colors[index], u_colors[index + 1], factor);\n\n  float cell = 0.0;\n\n  if (u_teamColored) {\n    cell = a_leftRightTop[0];\n  } else {\n    vec3 interval;\n\n    if (a_tail == HEAD) {\n      interval = u_intervals[index];\n    } else {\n      interval = u_intervals[index + 2];\n    }\n\n    cell = getCell(interval, factor);\n  }\n\n  float left = floor(mod(cell, u_columns));\n  float top = floor(cell / u_columns);\n  float right = left + 1.0;\n  float bottom = top + 1.0;\n\n  left /= u_columns;\n  right /= u_columns;\n  top /= u_rows;\n  bottom /= u_rows;\n\n  if (a_position == 0.0) {\n    v_texcoord = vec2(right, top);\n  } else if (a_position == 1.0) {\n    v_texcoord = vec2(left, top);\n  } else if (a_position == 2.0) {\n    v_texcoord = vec2(left, bottom);\n  } else if (a_position == 3.0) {\n    v_texcoord = vec2(right, bottom);\n  }\n\n  v_color = color;\n  \n  if (a_tail == HEAD) {\n    vec3 v = u_vertices[int(a_position)];\n    float cs = cos(a_p1.x);\n    float sn = sin(a_p1.x);\n\n    float x = v.x * cs - v.y * sn;\n    float y = v.x * sn + v.y * cs;\n\n    vec3 fv = vec3(\n      v.x * cs - v.y * sn,\n      v.x * sn + v.y * cs,\n      v.z);\n\n    gl_Position = u_VP * vec4(a_p0 + fv * scale, 1.0);\n  } else {\n    // Get the normal to the tail in camera space.\n    // This allows to build a 2D rectangle around the 3D tail.\n    vec3 normal = cross(u_cameraZ, normalize(a_p1 - a_p0));\n    vec3 boundary = normal * scale * a_p2[0];\n    vec3 position;\n\n    if (a_position == 0.0) {\n      position = a_p0 - boundary;\n    } else if (a_position == 1.0) {\n      position = a_p1 - boundary;\n    } else if (a_position == 2.0) {\n      position = a_p1 + boundary;\n    } else if (a_position == 3.0) {\n      position = a_p0 + boundary;\n    }\n\n    gl_Position = u_VP * vec4(position, 1.0);\n  }\n}\n\nvoid ribbon() {\n  vec3 position;\n  float left = a_leftRightTop[0] / 255.0;\n  float right = a_leftRightTop[1] / 255.0;\n  float top = a_leftRightTop[2] / 255.0;\n  float bottom = top + 1.0;\n\n  if (a_position == 0.0) {\n    v_texcoord = vec2(right, top);\n    position = a_p0;\n  } else if (a_position == 1.0) {\n    v_texcoord = vec2(right, bottom);\n    position = a_p1;\n  } else if (a_position == 2.0) {\n    v_texcoord = vec2(left, bottom);\n    position = a_p2;\n  } else if (a_position == 3.0) {\n    v_texcoord = vec2(left, top);\n    position = a_p3;\n  }\n\n  v_texcoord[0] /= u_columns;\n  v_texcoord[1] /= u_rows;\n\n  v_color = a_color;\n\n  gl_Position = u_VP * vec4(position, 1.0);\n}\n\nvoid splat() {\n  float factor = u_lifeSpan - a_health;\n  int index;\n\n  if (factor < u_intervalTimes[0]) {\n    factor = factor / u_intervalTimes[0];\n    index = 0;\n  } else {\n    factor = (factor - u_intervalTimes[0]) / u_intervalTimes[1];\n    index = 1;\n  }\n\n  float cell = getCell(u_intervals[index], factor);\n  float left = floor(mod(cell, u_columns));\n  float top = floor(cell / u_columns);\n  float right = left + 1.0;\n  float bottom = top + 1.0;\n  vec3 position;\n\n  if (a_position == 0.0) {\n    v_texcoord = vec2(left, top);\n    position = a_p0;\n  } else if (a_position == 1.0) {\n    v_texcoord = vec2(left, bottom);\n    position = a_p1;\n  } else if (a_position == 2.0) {\n    v_texcoord = vec2(right, bottom);\n    position = a_p2;\n  } else if (a_position == 3.0) {\n    v_texcoord = vec2(right, top);\n    position = a_p3;\n  }\n\n  v_texcoord[0] /= u_columns;\n  v_texcoord[1] /= u_rows;\n\n  v_color = mix(u_colors[index], u_colors[index + 1], factor) / 255.0;\n\n  gl_Position = u_VP * vec4(position, 1.0);\n}\n\nvoid ubersplat() {\n  float factor = u_lifeSpan - a_health;\n  vec4 color;\n\n  if (factor < u_intervalTimes[0]) {\n    color = mix(u_colors[0], u_colors[1], factor / u_intervalTimes[0]);\n  } else if (factor < u_intervalTimes[0] + u_intervalTimes[1]) {\n    color = u_colors[1];\n  } else {\n    color = mix(u_colors[1], u_colors[2], (factor - u_intervalTimes[0] - u_intervalTimes[1]) / u_intervalTimes[2]);\n  }\n\n  vec3 position;\n\n  if (a_position == 0.0) {\n    v_texcoord = vec2(0.0, 0.0);\n    position = a_p0;\n  } else if (a_position == 1.0) {\n    v_texcoord = vec2(0.0, 1.0);\n    position = a_p1;\n  } else if (a_position == 2.0) {\n    v_texcoord = vec2(1.0, 1.0);\n    position = a_p2;\n  } else if (a_position == 3.0) {\n    v_texcoord = vec2(1.0, 0.0);\n    position = a_p3;\n  }\n\n  v_color = color / 255.0;\n\n  gl_Position = u_VP * vec4(position, 1.0);\n}\n\nvoid main() {\n  if (u_emitter == EMITTER_PARTICLE2) {\n    particle2();\n  } else if (u_emitter == EMITTER_RIBBON) {\n    ribbon();\n  } else if (u_emitter == EMITTER_SPLAT) {\n    splat();\n  } else if (u_emitter == EMITTER_UBERSPLAT) {\n    ubersplat();\n  }\n}\n`;\n\nexport default shader;\n","\nimport Parser from '../../../parsers/mdlx/model';\nimport Sequence from './sequence';\nimport { HandlerResourceData } from '../../handlerresource';\nimport Model from '../../model';\nimport Texture from '../../texture';\nimport mdxHandler from './handler';\nimport TextureAnimation from './textureanimation';\nimport Layer from './layer';\nimport Material from './material';\nimport GeosetAnimation from './geosetanimation';\nimport replaceableIds from './replaceableids';\nimport Bone from './bone';\nimport Light from './light';\nimport Helper from './helper';\nimport Attachment from './attachment';\nimport ParticleEmitterObject from './particleemitterobject';\nimport ParticleEmitter2Object from './particleemitter2object';\nimport RibbonEmitterObject from './ribbonemitterobject';\nimport Camera from './camera';\nimport EventObjectEmitterObject from './eventobjectemitterobject';\nimport CollisionShape from './collisionshape';\nimport setupGeosets from './setupgeosets';\nimport setupGroups from './setupgroups';\nimport BatchGroup from './batchgroup';\nimport EmitterGroup from './emittergroup';\nimport GenericObject from './genericobject';\nimport { Batch } from './batch';\nimport Geoset from './geoset';\nimport MdxModelInstance from './modelinstance';\nimport MdxTexture from './texture';\n\n/**\n * An MDX model.\n */\nexport default class MdxModel extends Model {\n  reforged = false;\n  hd = false;\n  solverParams: { reforged?: boolean, hd?: boolean } = {};\n  name = '';\n  sequences: Sequence[] = [];\n  globalSequences: number[] = [];\n  materials: Material[] = [];\n  layers: Layer[] = [];\n  textures: MdxTexture[] = [];\n  textureAnimations: TextureAnimation[] = [];\n  geosets: Geoset[] = [];\n  geosetAnimations: GeosetAnimation[] = [];\n  bones: Bone[] = [];\n  lights: Light[] = [];\n  helpers: Helper[] = [];\n  attachments: Attachment[] = [];\n  pivotPoints: Float32Array[] = [];\n  particleEmitters: ParticleEmitterObject[] = [];\n  particleEmitters2: ParticleEmitter2Object[] = [];\n  ribbonEmitters: RibbonEmitterObject[] = [];\n  cameras: Camera[] = [];\n  eventObjects: EventObjectEmitterObject[] = [];\n  collisionShapes: CollisionShape[] = [];\n  hasLayerAnims = false;\n  hasGeosetAnims = false;\n  batches: Batch[] = [];\n  genericObjects: GenericObject[] = [];\n  sortedGenericObjects: GenericObject[] = [];\n  hierarchy: number[] = [];\n  opaqueGroups: BatchGroup[] = [];\n  translucentGroups: (BatchGroup | EmitterGroup)[] = [];\n  arrayBuffer: WebGLBuffer | null = null;\n  elementBuffer: WebGLBuffer | null = null;\n  skinDataType = 0;\n  bytesPerSkinElement = 1;\n\n  constructor(bufferOrParser: ArrayBuffer | string | Parser, resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    let parser;\n\n    if (bufferOrParser instanceof Parser) {\n      parser = bufferOrParser;\n    } else {\n      parser = new Parser();\n\n      try {\n        parser.load(bufferOrParser);\n      } catch (e) {\n        // If we get here, the parser failed to load.\n        // It still may have loaded enough data to support rendering though!\n        // I have encountered a model that is missing data, but still works in-game.\n        // So just let the code continue.\n        // If the handler manages to load the model, nothing happened.\n        // If critical data is missing, it will fail and throw its own exception.\n      }\n    }\n\n    const viewer = this.viewer;\n    const pathSolver = this.pathSolver;\n    const solverParams = this.solverParams;\n    const reforged = parser.version > 800;\n    const texturesExt = reforged ? '.dds' : '.blp';\n    let hasTeamColors = false;\n\n    this.reforged = reforged;\n    this.name = parser.name;\n\n    // Initialize the bounds.\n    const extent = parser.extent;\n    this.bounds.fromExtents(extent.min, extent.max);\n\n    // Sequences\n    for (const sequence of parser.sequences) {\n      this.sequences.push(new Sequence(sequence));\n    }\n\n    // Global sequences\n    for (const globalSequence of parser.globalSequences) {\n      this.globalSequences.push(globalSequence);\n    }\n\n    // Texture animations\n    for (const textureAnimation of parser.textureAnimations) {\n      this.textureAnimations.push(new TextureAnimation(this, textureAnimation));\n    }\n\n    // Materials\n    let layerId = 0;\n    for (const material of parser.materials) {\n      const layers = [];\n\n      for (const layer of material.layers) {\n        const vLayer = new Layer(this, layer, layerId++, material.priorityPlane);\n\n        layers.push(vLayer);\n\n        this.layers.push(vLayer);\n      }\n\n      this.materials.push(new Material(this, material.shader, layers));\n\n      if (material.shader !== '') {\n        this.hd = true;\n      }\n    }\n\n    if (reforged) {\n      solverParams.reforged = true;\n    }\n\n    if (this.hd) {\n      solverParams.hd = true;\n\n      // mdxHandler.loadEnv(viewer);\n    }\n\n    // Textures.\n    const textures = parser.textures;\n    for (let i = 0, l = textures.length; i < l; i++) {\n      const texture = textures[i];\n      let path = texture.path;\n      const replaceableId = texture.replaceableId;\n      const wrapMode = texture.wrapMode;\n\n      if (path === '' && replaceableId !== 0) {\n        path = `ReplaceableTextures\\\\${replaceableIds[replaceableId]}${texturesExt}`;\n\n        if (replaceableId === 1 || replaceableId === 2) {\n          hasTeamColors = true;\n        }\n      }\n\n      const mdxTexture = new MdxTexture(replaceableId, wrapMode);\n\n      viewer.load(path, pathSolver, solverParams)\n        .then((texture) => {\n          if (texture) {\n            mdxTexture.texture = <Texture>texture;\n          }\n        });\n\n      this.textures[i] = mdxTexture;\n    }\n\n    // Geoset animations\n    for (const geosetAnimation of parser.geosetAnimations) {\n      this.geosetAnimations.push(new GeosetAnimation(this, geosetAnimation));\n    }\n\n    this.pivotPoints = parser.pivotPoints;\n\n    // Tracks the IDs of all generic objects.\n    let objectId = 0;\n\n    // Bones\n    for (const bone of parser.bones) {\n      this.bones.push(new Bone(this, bone, objectId++));\n    }\n\n    // Lights\n    for (const light of parser.lights) {\n      this.lights.push(new Light(this, light, objectId++));\n    }\n\n    // Helpers\n    for (const helper of parser.helpers) {\n      this.helpers.push(new Helper(this, helper, objectId++));\n    }\n\n    // Attachments\n    for (const attachment of parser.attachments) {\n      this.attachments.push(new Attachment(this, attachment, objectId++));\n    }\n\n    // Particle emitters\n    for (const particleEmitter of parser.particleEmitters) {\n      this.particleEmitters.push(new ParticleEmitterObject(this, particleEmitter, objectId++));\n    }\n\n    // Particle emitters 2\n    for (const particleEmitter2 of parser.particleEmitters2) {\n      const emitter = new ParticleEmitter2Object(this, particleEmitter2, objectId++);\n\n      this.particleEmitters2.push(emitter);\n\n      if (emitter.teamColored) {\n        hasTeamColors = true;\n      }\n    }\n\n    // Ribbon emitters\n    for (const ribbonEmitter of parser.ribbonEmitters) {\n      this.ribbonEmitters.push(new RibbonEmitterObject(this, ribbonEmitter, objectId++));\n    }\n\n    // Cameras\n    for (const camera of parser.cameras) {\n      this.cameras.push(new Camera(this, camera));\n    }\n\n    // Event objects\n    for (const eventObject of parser.eventObjects) {\n      this.eventObjects.push(new EventObjectEmitterObject(this, eventObject, objectId++));\n    }\n\n    // Collision shapes\n    for (const collisionShape of parser.collisionShapes) {\n      this.collisionShapes.push(new CollisionShape(this, collisionShape, objectId++));\n    }\n\n    // One array for all generic objects.\n    this.genericObjects.push(...this.bones, ...this.lights, ...this.helpers, ...this.attachments, ...this.particleEmitters, ...this.particleEmitters2, ...this.ribbonEmitters, ...this.eventObjects, ...this.collisionShapes);\n\n    // Geosets\n    setupGeosets(this, parser.geosets);\n\n    // Render groups.\n    setupGroups(this);\n\n    // Creates the sorted indices array of the generic objects.\n    this.setupHierarchy(-1);\n\n    // Keep a sorted array.\n    for (let i = 0, l = this.genericObjects.length; i < l; i++) {\n      this.sortedGenericObjects[i] = this.genericObjects[this.hierarchy[i]];\n    }\n\n    // Lazy loading team colors.\n    if (hasTeamColors) {\n      mdxHandler.loadTeamTextures(viewer);\n    }\n  }\n\n  addInstance(): MdxModelInstance {\n    return new MdxModelInstance(this);\n  }\n\n  setupHierarchy(parent: number): void {\n    for (let i = 0, l = this.genericObjects.length; i < l; i++) {\n      const object = this.genericObjects[i];\n\n      if (object.parentId === parent) {\n        this.hierarchy.push(i);\n\n        this.setupHierarchy(object.objectId);\n      }\n    }\n  }\n}\n","import MdlxGeoset from '../../../parsers/mdlx/geoset';\nimport MdxModel from './model';\nimport Geoset from './geoset';\nimport { SkinningType, Batch } from './batch';\n\nexport default function setupGeosets(model: MdxModel, geosets: MdlxGeoset[]): void {\n  if (geosets.length > 0) {\n    const gl = model.viewer.gl;\n    let positionBytes = 0;\n    let normalBytes = 0;\n    let uvBytes = 0;\n    let tangentBytes = 0;\n    let skinBytes = 0;\n    let faceBytes = 0;\n    const skinTypes: SkinningType[] = [];\n\n    for (let i = 0, l = geosets.length; i < l; i++) {\n      const geoset = geosets[i];\n\n      if (geoset.lod === 0 || geoset.lod === -1) {\n        const vertices = geoset.vertices.length / 3;\n\n        positionBytes += vertices * 12;\n        normalBytes += vertices * 12;\n        uvBytes += geoset.uvSets.length * vertices * 8;\n\n        if (geoset.tangents.length) {\n          tangentBytes += vertices * 16;\n        }\n\n        if (geoset.skin.length) {\n          skinBytes += vertices * 8;\n\n          skinTypes[i] = SkinningType.Skin;\n        } else {\n          let biggestGroup = 0;\n\n          for (const group of geoset.matrixGroups) {\n            if (group > biggestGroup) {\n              biggestGroup = group;\n            }\n          }\n\n          if (biggestGroup > 4) {\n            skinBytes += vertices * 9;\n\n            skinTypes[i] = SkinningType.ExtendedVertexGroups;\n          } else {\n            skinBytes += vertices * 5;\n\n            skinTypes[i] = SkinningType.VertexGroups;\n          }\n        }\n\n        faceBytes += geoset.faces.byteLength;\n      }\n    }\n\n    let positionOffset = 0;\n    let normalOffset = positionOffset + positionBytes;\n    let uvOffset = normalOffset + normalBytes;\n    let tangentOffset = uvOffset + uvBytes;\n    let skinOffset = tangentOffset + tangentBytes;\n    let faceOffset = 0;\n    let SkinTypedArray: typeof Uint8Array | typeof Uint16Array = Uint8Array;\n    let skinGlType = gl.UNSIGNED_BYTE;\n\n    if (model.bones.length > 255) {\n      skinBytes *= 2;\n      SkinTypedArray = Uint16Array;\n      skinGlType = gl.UNSIGNED_SHORT;\n    }\n\n    model.skinDataType = skinGlType;\n    model.bytesPerSkinElement = SkinTypedArray.BYTES_PER_ELEMENT;\n\n    model.arrayBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, model.arrayBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, skinOffset + skinBytes, gl.STATIC_DRAW);\n\n    model.elementBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, model.elementBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faceBytes, gl.STATIC_DRAW);\n\n    for (let i = 0, l = geosets.length; i < l; i++) {\n      const geoset = geosets[i];\n\n      if (geoset.lod === 0 || geoset.lod === -1) {\n        const positions = geoset.vertices;\n        const normals = geoset.normals;\n        const uvSets = geoset.uvSets;\n        const tangents = geoset.tangents;\n        const faces = geoset.faces;\n        let skin;\n        const vertices = geoset.vertices.length / 3;\n        const skinType = skinTypes[i];\n\n        if (skinType === SkinningType.Skin) {\n          skin = geoset.skin;\n        } else {\n          const matrixIndices = geoset.matrixIndices;\n          const vertexGroups = geoset.vertexGroups;\n          const matrixGroups = [];\n          let offset = 0;\n\n          // Normally the shader supports up to 4 bones per vertex.\n          // This is enough for almost every existing Warcraft 3 model.\n          // That being said, there are a few models with geosets that need more, for example the Water Elemental.\n          // These geosets use a different shader, which support up to 8 bones per vertex.\n          let maxBones = 4;\n\n          if (skinType === SkinningType.ExtendedVertexGroups) {\n            maxBones = 8;\n          }\n\n          skin = new SkinTypedArray(vertices * (maxBones + 1));\n\n          // Slice the matrix groups.\n          for (const size of geoset.matrixGroups) {\n            matrixGroups.push(matrixIndices.subarray(offset, offset + size));\n            offset += size;\n          }\n\n          // Parse the skinning.\n          for (let i = 0; i < vertices; i++) {\n            const matrixGroup = matrixGroups[vertexGroups[i]];\n\n            offset = i * (maxBones + 1);\n\n            // Somehow in some bad models a vertex group index refers to an invalid matrix group.\n            // Such models are still loaded by the game.\n            if (matrixGroup) {\n              const bones = Math.min(matrixGroup.length, maxBones);\n\n              for (let j = 0; j < bones; j++) {\n                skin[offset + j] = matrixGroup[j] + 1; // 1 is added to diffrentiate between matrix 0, and no matrix.\n              }\n\n              skin[offset + maxBones] = bones;\n            }\n          }\n        }\n\n        const vGeoset = new Geoset(model, model.geosets.length, positionOffset, normalOffset, uvOffset, tangentOffset, skinOffset, faceOffset, vertices, faces.length, geoset.faceTypeGroups[0]);\n        model.geosets.push(vGeoset);\n\n        const material = model.materials[geoset.materialId];\n        const isHd = material.shader === 'Shader_HD_DefaultUnit';\n\n        if (isHd) {\n          model.batches.push(new Batch(model.batches.length, vGeoset, material, skinType, true));\n        } else {\n          for (const layer of material.layers) {\n            model.batches.push(new Batch(model.batches.length, vGeoset, layer, skinType, false));\n          }\n        }\n\n        // Positions.\n        gl.bufferSubData(gl.ARRAY_BUFFER, positionOffset, positions);\n        positionOffset += positions.byteLength;\n\n        // Normals.\n        gl.bufferSubData(gl.ARRAY_BUFFER, normalOffset, normals);\n        normalOffset += normals.byteLength;\n\n        // Texture coordinates.\n        for (const uvSet of uvSets) {\n          gl.bufferSubData(gl.ARRAY_BUFFER, uvOffset, uvSet);\n          uvOffset += uvSet.byteLength;\n        }\n\n        // Tangents.\n        if (tangents.length) {\n          gl.bufferSubData(gl.ARRAY_BUFFER, tangentOffset, tangents);\n          tangentOffset += tangents.byteLength;\n        }\n\n        // Skin.\n        gl.bufferSubData(gl.ARRAY_BUFFER, skinOffset, skin);\n        skinOffset += skin.byteLength;\n\n        // Faces.\n        gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, faceOffset, faces);\n        faceOffset += faces.byteLength;\n      }\n    }\n  }\n}\n","import TgaImage from '../../../parsers/tga/image';\nimport isTga from '../../../parsers/tga/isformat';\nimport Texture from './texture';\n\nexport default {\n  isValidSource(object: unknown): boolean {\n    if (object instanceof TgaImage) {\n      return true;\n    }\n\n    return isTga(object);\n  },\n  resource: Texture,\n};\n","import { isPowerOfTwo } from '../../../common/math';\nimport TgaImage from '../../../parsers/tga/image';\nimport { HandlerResourceData } from '../../handlerresource';\nimport Texture from '../../texture';\n\n/**\n * A TGA texture handler.\n */\nexport default class TgaTexture extends Texture {\n  constructor(bufferOrImage: ArrayBuffer | TgaImage, resourceData: HandlerResourceData) {\n    super(resourceData);\n\n    let image;\n\n    if (bufferOrImage instanceof TgaImage) {\n      image = bufferOrImage;\n    } else {\n      image = new TgaImage();\n\n      image.load(bufferOrImage);\n    }\n\n    const width = image.width;\n    const height = image.height;\n\n    const gl = this.viewer.gl;\n    const id = gl.createTexture();\n\n    gl.bindTexture(gl.TEXTURE_2D, id);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, <ImageData>image.data);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n    if (isPowerOfTwo(width) && isPowerOfTwo(height)) {\n      gl.generateMipmap(gl.TEXTURE_2D);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    }\n\n    this.webglResource = id;\n    this.width = width;\n    this.height = height;\n  }\n}\n","import precision from '../../shaders/precision.glsl';\n\nconst shader = `\n${precision}\n\nuniform sampler2D u_tilesets[15];\n\nvarying vec4 v_tilesets;\nvarying vec2 v_uv[4];\nvarying vec3 v_normal;\n\nconst vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\nvec4 sample(float tileset, vec2 uv) {\n  // 1.0 - 1.0 == 0.0 is not always true.\n  int i = int(tileset - 0.6);\n\n  if (i == 0) {\n    return texture2D(u_tilesets[0], uv);\n  } else if (i == 1) {\n    return texture2D(u_tilesets[1], uv);\n  } else if (i == 2) {\n    return texture2D(u_tilesets[2], uv);\n  } else if (i == 3) {\n    return texture2D(u_tilesets[3], uv);\n  } else if (i == 4) {\n    return texture2D(u_tilesets[4], uv);\n  } else if (i == 5) {\n    return texture2D(u_tilesets[5], uv);\n  } else if (i == 6) {\n    return texture2D(u_tilesets[6], uv);\n  } else if (i == 7) {\n    return texture2D(u_tilesets[7], uv);\n  } else if (i == 8) {\n    return texture2D(u_tilesets[8], uv);\n  } else if (i == 9) {\n    return texture2D(u_tilesets[9], uv);\n  } else if (i == 10) {\n    return texture2D(u_tilesets[10], uv);\n  } else if (i == 11) {\n    return texture2D(u_tilesets[11], uv);\n  } else if (i == 12) {\n    return texture2D(u_tilesets[12], uv);\n  } else if (i == 13) {\n    return texture2D(u_tilesets[13], uv);\n  } else if (i == 14) {\n    return texture2D(u_tilesets[14], uv);\n  }\n}\n\nvec4 blend(vec4 color, float tileset, vec2 uv) {\n  vec4 texel = sample(tileset, uv);\n\n  return mix(color, texel, texel.a);\n}\n\nvoid main() {\n  vec4 color = sample(v_tilesets[0], v_uv[0]);\n\n  if (v_tilesets[1] > 0.5) {\n    color = blend(color, v_tilesets[1], v_uv[1]);\n  }\n\n  if (v_tilesets[2] > 0.5) {\n    color = blend(color, v_tilesets[2], v_uv[2]);\n  }\n\n  if (v_tilesets[3] > 0.5) {\n    color = blend(color, v_tilesets[3], v_uv[3]);\n  }\n\n  //color *= clamp(dot(v_normal, lightDirection) + 0.45, 0.0, 1.0);\n\n  gl_FragColor = vec4(color.rgb, 1.0);\n}\n`;\n\nexport default shader;\n","import precision from '../../shaders/precision.glsl';\n\nconst shader = `\n${precision}\n\nuniform sampler2D u_waterTexture;\n\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = texture2D(u_waterTexture, v_uv) * v_color;\n}\n`;\n\nexport default shader;\n","import precision from '../../shaders/precision.glsl';\n\nconst shader = `\n// #extension GL_OES_standard_derivatives : enable\n\n${precision}\n\nuniform sampler2D u_texture1;\nuniform sampler2D u_texture2;\n\nvarying vec3 v_normal;\nvarying vec2 v_uv;\nvarying float v_texture;\nvarying vec3 v_position;\n\n// const vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\nvec4 sample(float texture, vec2 uv) {\n  // int(0.0) == 0 is not always true.\n  int i = int(texture + 0.1);\n\n  if (i == 0) {\n    return texture2D(u_texture1, uv);\n  } else {\n    return texture2D(u_texture2, uv);\n  }\n}\n\nvoid main() {\n  vec4 color = sample(v_texture, v_uv);\n\n  // vec3 faceNormal = cross(dFdx(v_position), dFdy(v_position));\n  // vec3 normal = normalize((faceNormal + v_normal) * 0.5);\n\n  // color *= clamp(dot(normal, lightDirection) + 0.45, 0.1, 1.0);\n\n  gl_FragColor = color;\n}\n`;\n\nexport default shader;\n","/**\n * Returns an array that only contains unique values found in the source array.\n */\nexport default function unique<T>(a: T[]): T[] {\n  return a.reverse().filter((e, i, arr) => {\n    return arr.indexOf(e, i + 1) === -1;\n  }).reverse();\n}\n","const cliffVariations = {\n  AAAB: 1,\n  AAAC: 1,\n  AABA: 1,\n  AABB: 2,\n  AABC: 0,\n  AACA: 1,\n  AACB: 0,\n  AACC: 1,\n  ABAA: 1,\n  ABAB: 1,\n  ABAC: 0,\n  ABBA: 2,\n  ABBB: 1,\n  ABBC: 0,\n  ABCA: 0,\n  ABCB: 0,\n  ABCC: 0,\n  ACAA: 1,\n  ACAB: 0,\n  ACAC: 1,\n  ACBA: 0,\n  ACBB: 0,\n  ACBC: 0,\n  ACCA: 1,\n  ACCB: 0,\n  ACCC: 1,\n  BAAA: 1,\n  BAAB: 1,\n  BAAC: 0,\n  BABA: 1,\n  BABB: 1,\n  BABC: 0,\n  BACA: 0,\n  BACB: 0,\n  BACC: 0,\n  BBAA: 1,\n  BBAB: 1,\n  BBAC: 0,\n  BBBA: 1,\n  BBCA: 0,\n  BCAA: 0,\n  BCAB: 0,\n  BCAC: 0,\n  BCBA: 0,\n  BCCA: 0,\n  CAAA: 1,\n  CAAB: 0,\n  CAAC: 1,\n  CABA: 0,\n  CABB: 0,\n  CABC: 0,\n  CACA: 1,\n  CACB: 0,\n  CACC: 1,\n  CBAA: 0,\n  CBAB: 0,\n  CBAC: 0,\n  CBBA: 0,\n  CBCA: 0,\n  CCAA: 1,\n  CCAB: 0,\n  CCAC: 1,\n  CCBA: 0,\n  CCCA: 1,\n};\n\nconst cityCliffVariations = {\n  AAAB: 2,\n  AAAC: 1,\n  AABA: 1,\n  AABB: 3,\n  AABC: 0,\n  AACA: 1,\n  AACB: 0,\n  AACC: 3,\n  ABAA: 1,\n  ABAB: 2,\n  ABAC: 0,\n  ABBA: 3,\n  ABBB: 0,\n  ABBC: 0,\n  ABCA: 0,\n  ABCB: 0,\n  ABCC: 0,\n  ACAA: 1,\n  ACAB: 0,\n  ACAC: 2,\n  ACBA: 0,\n  ACBB: 0,\n  ACBC: 0,\n  ACCA: 3,\n  ACCB: 0,\n  ACCC: 1,\n  BAAA: 1,\n  BAAB: 3,\n  BAAC: 0,\n  BABA: 2,\n  BABB: 0,\n  BABC: 0,\n  BACA: 0,\n  BACB: 0,\n  BACC: 0,\n  BBAA: 3,\n  BBAB: 1,\n  BBAC: 0,\n  BBBA: 1,\n  BBCA: 0,\n  BCAA: 0,\n  BCAB: 0,\n  BCAC: 0,\n  BCBA: 0,\n  BCCA: 0,\n  CAAA: 1,\n  CAAB: 0,\n  CAAC: 3,\n  CABA: 0,\n  CABB: 0,\n  CABC: 0,\n  CACA: 2,\n  CACB: 0,\n  CACC: 1,\n  CBAA: 0,\n  CBAB: 0,\n  CBAC: 0,\n  CBBA: 0,\n  CBCA: 0,\n  CCAA: 3,\n  CCAB: 0,\n  CCAC: 1,\n  CCBA: 0,\n  CCCA: 1,\n};\n\nexport default function getCliffVariation(dir: string, tag: string, variation: number): number {\n  if (dir === 'Cliffs') {\n    return Math.min(variation, cliffVariations[tag]);\n  } else {\n    return Math.min(variation, cityCliffVariations[tag]);\n  }\n}\n","import MdlxModel from '../../../parsers/mdlx/model';\nimport Shader from '../../gl/shader';\nimport War3MapViewerMap from './map';\n\n/**\n * A static terrain model.\n */\nexport default class TerrainModel {\n  map: War3MapViewerMap;\n  vertexBuffer: WebGLBuffer;\n  faceBuffer: WebGLBuffer;\n  normalsOffset: number;\n  uvsOffset: number;\n  elements: number;\n  locationAndTextureBuffer: WebGLBuffer;\n  texturesOffset: number;\n  instances: number;\n  vao: WebGLVertexArrayObjectOES | null;\n\n  constructor(map: War3MapViewerMap, arrayBuffer: ArrayBuffer, locations: number[], textures: number[], shader: Shader) {\n    const gl = map.viewer.gl;\n    const webgl = map.viewer.webgl;\n    const instancedArrays = <ANGLE_instanced_arrays>webgl.extensions['ANGLE_instanced_arrays'];\n    const vertexArrayObject = <OES_vertex_array_object>webgl.extensions['OES_vertex_array_object'];\n\n    const parser = new MdlxModel();\n    parser.load(arrayBuffer);\n\n    const geoset = parser.geosets[0];\n    const vertices = geoset.vertices;\n    const normals = geoset.normals;\n    const uvs = geoset.uvSets[0];\n    const faces = geoset.faces;\n    const normalsOffset = vertices.byteLength;\n    const uvsOffset = normalsOffset + normals.byteLength;\n    let vao = null;\n    const attribs = shader.attribs;\n\n    if (vertexArrayObject) {\n      vao = vertexArrayObject.createVertexArrayOES();\n      vertexArrayObject.bindVertexArrayOES(vao);\n    }\n\n    const vertexBuffer = <WebGLBuffer>gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, uvsOffset + uvs.byteLength, gl.STATIC_DRAW);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, vertices);\n    gl.bufferSubData(gl.ARRAY_BUFFER, normalsOffset, normals);\n    gl.bufferSubData(gl.ARRAY_BUFFER, uvsOffset, uvs);\n\n    if (vertexArrayObject) {\n      gl.vertexAttribPointer(attribs['a_position'], 3, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(attribs['a_position']);\n\n      gl.vertexAttribPointer(attribs['a_normal'], 3, gl.FLOAT, false, 0, normalsOffset);\n      gl.enableVertexAttribArray(attribs['a_normal']);\n\n      gl.vertexAttribPointer(attribs['a_uv'], 2, gl.FLOAT, false, 0, uvsOffset);\n      gl.enableVertexAttribArray(attribs['a_uv']);\n    }\n\n    const texturesOffset = locations.length * 4;\n    const locationAndTextureBuffer = <WebGLBuffer>gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, locationAndTextureBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, texturesOffset + textures.length, gl.STATIC_DRAW);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(locations));\n    gl.bufferSubData(gl.ARRAY_BUFFER, texturesOffset, new Uint8Array(textures));\n\n    if (vertexArrayObject) {\n      gl.vertexAttribPointer(attribs['a_instancePosition'], 3, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(attribs['a_instancePosition']);\n      instancedArrays.vertexAttribDivisorANGLE(attribs['a_instancePosition'], 1);\n\n      gl.vertexAttribPointer(attribs['a_instanceTexture'], 1, gl.UNSIGNED_BYTE, false, 0, texturesOffset);\n      gl.enableVertexAttribArray(attribs['a_instanceTexture']);\n      instancedArrays.vertexAttribDivisorANGLE(attribs['a_instanceTexture'], 1);\n\n    }\n\n    const faceBuffer = <WebGLBuffer>gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\n\n    if (vertexArrayObject) {\n      vertexArrayObject.bindVertexArrayOES(null);\n    }\n\n    this.map = map;\n    this.vertexBuffer = vertexBuffer;\n    this.faceBuffer = faceBuffer;\n    this.normalsOffset = normalsOffset;\n    this.uvsOffset = uvsOffset;\n    this.elements = faces.length;\n    this.locationAndTextureBuffer = locationAndTextureBuffer;\n    this.texturesOffset = texturesOffset;\n    this.instances = locations.length / 3;\n    this.vao = vao;\n  }\n\n  render(shader: Shader): void {\n    const viewer = this.map.viewer;\n    const gl = viewer.gl;\n    const webgl = viewer.webgl;\n    const instancedArrays = <ANGLE_instanced_arrays>webgl.extensions['ANGLE_instanced_arrays'];\n    const vertexArrayObject = <OES_vertex_array_object>webgl.extensions['OES_vertex_array_object'];\n    const attribs = shader.attribs;\n\n    if (vertexArrayObject) {\n      vertexArrayObject.bindVertexArrayOES(this.vao);\n    } else {\n      // Locations and textures.\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.locationAndTextureBuffer);\n      gl.vertexAttribPointer(attribs['a_instancePosition'], 3, gl.FLOAT, false, 0, 0);\n      gl.vertexAttribPointer(attribs['a_instanceTexture'], 1, gl.UNSIGNED_BYTE, false, 0, this.texturesOffset);\n\n      // Vertices.\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n      gl.vertexAttribPointer(attribs['a_position'], 3, gl.FLOAT, false, 0, 0);\n      gl.vertexAttribPointer(attribs['a_normal'], 3, gl.FLOAT, false, 0, this.normalsOffset);\n      gl.vertexAttribPointer(attribs['a_uv'], 2, gl.FLOAT, false, 0, this.uvsOffset);\n\n      // Faces.\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.faceBuffer);\n    }\n\n    // Draw.\n    instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, this.elements, gl.UNSIGNED_SHORT, 0, this.instances);\n\n    if (vertexArrayObject) {\n      vertexArrayObject.bindVertexArrayOES(null);\n    }\n  }\n}\n","import Sequence from '../mdx/sequence';\nimport MdxModel from '../mdx/model';\nimport MdxModelInstance from '../mdx/modelinstance';\n\ninterface FilteredSequence {\n  sequence: Sequence;\n  index: number;\n}\n\nfunction sequenceSorter(a: FilteredSequence, b: FilteredSequence): number {\n  return a.sequence.rarity - b.sequence.rarity;\n}\n\nfunction filterSequences(type: string, sequences: Sequence[]): FilteredSequence[] {\n  const filtered = [];\n\n  for (let i = 0, l = sequences.length; i < l; i++) {\n    const sequence = sequences[i],\n      name = sequence.name.split('-')[0].replace(/\\d/g, '').trim().toLowerCase();\n\n    if (name === type) {\n      filtered.push({ sequence, index: i });\n    }\n  }\n\n  return filtered;\n}\n\nfunction selectSequence(type: string, sequences: Sequence[]): FilteredSequence {\n  const filtered = filterSequences(type, sequences);\n  let i, l;\n\n  filtered.sort(sequenceSorter);\n\n  for (i = 0, l = filtered.length; i < l; i++) {\n    const sequence = filtered[i].sequence;\n    const rarity = sequence.rarity;\n\n    if (rarity === 0) {\n      break;\n    }\n\n    if (Math.random() * 10 > rarity) {\n      return filtered[i];\n    }\n  }\n\n  const sequencesLeft = filtered.length - i;\n  const random = i + Math.floor(Math.random() * sequencesLeft);\n  const sequence = filtered[random];\n\n  return sequence;\n}\n\nexport default function randomStandSequence(target: MdxModelInstance): void {\n  const model = <MdxModel>target.model;\n  const sequences = model.sequences;\n  const sequence = selectSequence('stand', sequences);\n\n  if (sequence) {\n    target.setSequence(sequence.index);\n  }\n}\n","import MdxModel from '../mdx/model';\nimport MdxModelInstance from '../mdx/modelinstance';\nimport War3MapViewerMap from './map';\nimport randomStandSequence from './standsequence';\n\nexport enum WidgetState {\n  IDLE,\n  WALK,\n}\n\n/**\n * A widget.\n */\nexport class Widget {\n  instance: MdxModelInstance;\n  state = WidgetState.IDLE;\n\n  constructor(map: War3MapViewerMap, model: MdxModel) {\n    this.instance = model.addInstance();\n\n    this.instance.setScene(map.worldScene);\n  }\n\n  update(): void {\n    if (this.instance.sequenceEnded || this.instance.sequence === -1) {\n      if (this.state === WidgetState.IDLE) {\n        randomStandSequence(this.instance);\n      }\n    }\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_UNIT_Z } from '../../../common/gl-matrix-addon';\nimport { MappedDataRow } from '../../../utils/mappeddata';\nimport DooUnit from '../../../parsers/w3x/unitsdoo/unit';\nimport MdxModel from '../mdx/model';\nimport War3MapViewerMap from './map';\nimport { Widget } from './widget';\n\nconst heapZ = vec3.create();\n\n/**\n * A unit.\n */\nexport default class Unit extends Widget {\n  /**\n   * StartLocation.mdx (and others?) seems to be built-in, and has no row.\n   */\n  row: MappedDataRow | undefined;\n\n  constructor(map: War3MapViewerMap, model: MdxModel, row: MappedDataRow | undefined, unit: DooUnit) {\n    super(map, model);\n\n    const instance = this.instance;\n\n    instance.move(<vec3>unit.location);\n    instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, unit.angle));\n    instance.scale(<vec3>unit.scale);\n    instance.setTeamColor(unit.player);\n    instance.setScene(map.worldScene);\n\n    if (row) {\n      heapZ[2] = row.number('moveHeight');\n\n      instance.move(heapZ);\n      instance.setVertexColor([row.number('red') / 255, row.number('green') / 255, row.number('blue') / 255, 1]);\n      instance.uniformScale(row.number('modelScale'));\n    }\n\n    this.instance = instance;\n    this.row = row;\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_UNIT_Z } from '../../../common/gl-matrix-addon';\nimport { MappedDataRow } from '../../../utils/mappeddata';\nimport DooDoodad from '../../../parsers/w3x/doo/doodad';\nimport MdxModel from '../mdx/model';\nimport War3MapViewerMap from './map';\nimport { Widget } from './widget';\n\n/**\n * A doodad.\n */\nexport default class Doodad extends Widget {\n  row: MappedDataRow;\n\n  constructor(map: War3MapViewerMap, model: MdxModel, row: MappedDataRow, doodad: DooDoodad) {\n    super(map, model);\n\n    const instance = this.instance;\n\n    instance.move(<vec3>doodad.location);\n    instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, doodad.angle));\n    instance.scale(<vec3>doodad.scale);\n    instance.setScene(map.worldScene);\n\n    this.instance = instance;\n    this.row = row;\n  }\n}\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_UNIT_Z } from '../../../common/gl-matrix-addon';\nimport { degToRad } from '../../../common/math';\nimport { MappedDataRow } from '../../../utils/mappeddata';\nimport DooTerrainDoodad from '../../../parsers/w3x/doo/terraindoodad';\nimport MdxModel from '../mdx/model';\nimport MdxModelInstance from '../mdx/modelinstance';\nimport War3MapViewerMap from './map';\n\n\nconst locationHeap = vec3.create();\n/**\n * A cliff/terrain doodad.\n */\nexport default class TerrainDoodad {\n  instance: MdxModelInstance;\n  row: MappedDataRow;\n\n  constructor(map: War3MapViewerMap, model: MdxModel, row: MappedDataRow, doodad: DooTerrainDoodad) {\n    const centeroffset = map.centerOffset;\n    const instance = model.addInstance();\n\n    locationHeap[0] = doodad.location[0] * 128 + centeroffset[0] + 128;\n    locationHeap[1] = doodad.location[1] * 128 + centeroffset[1] + 128;\n\n    instance.move(locationHeap);\n    instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, degToRad(row.number('fixedRot'))));\n    instance.setScene(map.worldScene);\n\n    this.instance = instance;\n    this.row = row;\n  }\n}\n","import { vec3 } from 'gl-matrix';\nimport unique from '../../../common/arrayunique';\nimport War3Map from '../../../parsers/w3x/map';\nimport War3MapW3i from '../../../parsers/w3x/w3i/file';\nimport War3MapW3e from '../../../parsers/w3x/w3e/file';\nimport Corner from '../../../parsers/w3x/w3e/corner';\nimport War3MapW3u from '../../../parsers/w3x/w3u/file';\nimport War3MapW3d from '../../../parsers/w3x/w3d/file';\nimport ModificationTable from '../../../parsers/w3x/w3u/modificationtable';\nimport { MappedData, MappedDataRow } from '../../../utils/mappeddata';\nimport Scene from '../../scene';\nimport Grid from '../../grid';\nimport { PathSolver } from '../../handlerresource';\nimport Texture from '../../texture';\nimport MdxModel from '../mdx/model';\nimport getCliffVariation from './variations';\nimport TerrainModel from './terrainmodel';\nimport Unit from './unit';\nimport Doodad from './doodad';\nimport TerrainDoodad from './terraindoodad';\nimport War3MapViewer from './viewer';\nimport War3MapDoo from '../../../parsers/w3x/doo/file';\nimport War3MapUnitsDoo from '../../../parsers/w3x/unitsdoo/file';\nimport { Resource } from '../../resource';\n\nconst normalHeap1 = vec3.create();\nconst normalHeap2 = vec3.create();\n\nexport default class War3MapViewerMap {\n  viewer: War3MapViewer;\n  map: War3Map;\n  pathSolver: PathSolver;\n  buildVersion = 0;\n  solverParams: { tileset: string, reforged?: boolean, hd?: boolean } = { tileset: 'a' };\n  worldScene: Scene;\n  waterIndex = 0;\n  waterIncreasePerFrame = 0;\n  waterHeightOffset = 0;\n  waterTextures: Texture[] = [];\n  maxDeepColor = new Float32Array(4);\n  minDeepColor = new Float32Array(4);\n  maxShallowColor = new Float32Array(4);\n  minShallowColor = new Float32Array(4);\n  anyReady = false;\n  terrainReady = false;\n  cliffsReady = false;\n  doodads: Doodad[] = [];\n  terrainDoodads: TerrainDoodad[] = [];\n  doodadsReady = false;\n  units: Unit[] = [];\n  unitsReady = false;\n  tilesetTextures: Texture[] = [];\n  cliffTextures: Texture[] = [];\n  cliffModels: TerrainModel[] = [];\n  corners: Corner[][] = [];\n  centerOffset = new Float32Array(2);\n  mapSize = new Int32Array(2);\n  tilesets: MappedDataRow[] = [];\n  blightTextureIndex = -1;\n  cliffTilesets: MappedDataRow[] = [];\n  columns = 0;\n  rows = 0;\n  vertexBuffer: WebGLBuffer | null = null;\n  faceBuffer: WebGLBuffer | null = null;\n  instanceBuffer: WebGLBuffer | null = null;\n  textureBuffer: WebGLBuffer | null = null;\n  variationBuffer: WebGLBuffer | null = null;\n  waterBuffer: WebGLBuffer | null = null;\n  heightMap: WebGLTexture | null = null;\n  waterHeightMap: WebGLTexture | null = null;\n  cliffHeightMap: WebGLTexture | null = null;\n\n  constructor(viewer: War3MapViewer, buffer: ArrayBuffer | Uint8Array) {\n    this.viewer = viewer;\n    this.worldScene = viewer.addScene();\n\n    this.map = new War3Map();\n\n    // Readonly mode to optimize memory usage.\n    this.map.load(buffer, true);\n\n    this.loadMapInformation();\n\n    this.pathSolver = (src, params): unknown => {\n      // The type won't be a string for loads from memory, where the final source is the input source.\n      // The primitive constructor is one example of this.\n      if (typeof src === 'string') {\n        // MPQ paths have backwards slashes...always? Don't know.\n        const path = src.replace(/\\//g, '\\\\');\n\n        // If the file is in the map, return it.\n        const file = this.map.get(path);\n\n        if (file) {\n          return file.arrayBuffer();\n        }\n\n        // Try to get the file from the server.\n        return viewer.wc3PathSolver(src, params);\n      }\n\n      return src;\n    };\n\n    this.loadTerrainCliffsAndWater();\n\n    // Global tables like WC3. It's bad.\n    const modifications = this.map.readModifications();\n    this.applyModificationFile(viewer.doodadsData, viewer.doodadMetaData, modifications.w3d);\n    this.applyModificationFile(viewer.doodadsData, viewer.destructableMetaData, modifications.w3b);\n    this.applyModificationFile(viewer.unitsData, viewer.unitMetaData, modifications.w3u);\n    this.applyModificationFile(viewer.unitsData, viewer.unitMetaData, modifications.w3t);\n\n    this.loadDoodadsAndDestructibles();\n    this.loadUnitsAndItems();\n  }\n\n  die(): void {\n    this.worldScene.detach();\n  }\n\n  load(src: unknown): Promise<Resource | undefined> {\n    return this.viewer.load(src, this.pathSolver, this.solverParams);\n  }\n\n  loadMapInformation(): void {\n    const mpqFile = this.map.get('war3map.w3i');\n\n    if (!mpqFile) {\n      console.warn('Attempted to load war3map.w3i but it is not there. Using default tileset A.');\n      return;\n    }\n\n    const parser = new War3MapW3i();\n\n    try {\n      parser.load(mpqFile.bytes());\n    } catch (e) {\n      console.warn('Failed to correctly parse the map information file');\n    }\n\n    this.solverParams.tileset = parser.tileset.toLowerCase();\n\n    this.buildVersion = parser.getBuildVersion();\n\n    if (this.buildVersion > 131) {\n      this.solverParams.reforged = true;\n    }\n  }\n\n  async loadTerrainCliffsAndWater(): Promise<void> {\n    const mpqFile = this.map.get('war3map.w3e');\n\n    if (!mpqFile) {\n      console.warn('Attempted to load war3map.w3e, but it is not there.');\n      return;\n    }\n\n    const parser = new War3MapW3e();\n\n    try {\n      parser.load(mpqFile.bytes());\n    } catch (e) {\n      console.warn(`Failed to load war3map.w3e: ${e}`);\n      return;\n    }\n\n    const viewer = this.viewer;\n    const centerOffset = parser.centerOffset;\n    const mapSize = parser.mapSize;\n\n    this.corners = parser.corners;\n    this.centerOffset.set(centerOffset);\n    this.mapSize.set(mapSize);\n\n    // Override the grid based on the map.\n    this.worldScene.grid = new Grid(centerOffset[0], centerOffset[1], mapSize[0] * 128 - 128, mapSize[1] * 128 - 128, 16 * 128, 16 * 128);\n\n    const texturesExt = this.solverParams.reforged ? '.dds' : '.blp';\n    const tileset = parser.tileset;\n\n    const tilesetTextures = [];\n    const cliffTextures = [];\n    const waterTextures = [];\n\n    for (const groundTileset of parser.groundTilesets) {\n      const row = <MappedDataRow>viewer.terrainData.getRow(groundTileset);\n\n      this.tilesets.push(row);\n      \n      tilesetTextures.push(this.load(`${row.string('dir')}\\\\${row.string('file')}${texturesExt}`));\n    }\n\n    const blights = {\n      A: 'Ashen',\n      B: 'Barrens',\n      C: 'Felwood',\n      D: 'Cave',\n      F: 'Lordf',\n      G: 'Dungeon',\n      I: 'Ice',\n      J: 'DRuins',\n      K: 'Citadel',\n      L: 'Lords',\n      N: 'North',\n      O: 'Outland',\n      Q: 'VillageFall',\n      V: 'Village',\n      W: 'Lordw',\n      X: 'Village',\n      Y: 'Village',\n      Z: 'Ruins',\n    };\n\n    this.blightTextureIndex = this.tilesetTextures.length;\n    tilesetTextures.push(this.load(`TerrainArt\\\\Blight\\\\${blights[tileset]}_Blight${texturesExt}`));\n\n    for (const cliffTileset of parser.cliffTilesets) {\n      const row = <MappedDataRow>viewer.cliffTypesData.getRow(cliffTileset);\n\n      this.cliffTilesets.push(row);\n      cliffTextures.push(this.load(`${row.string('texDir')}\\\\${row.string('texFile')}${texturesExt}`));\n    }\n\n    const waterRow = <MappedDataRow>viewer.waterData.getRow(`${tileset}Sha`);\n\n    this.waterHeightOffset = waterRow.number('height');\n    this.waterIncreasePerFrame = waterRow.number('texRate') / 60;\n    this.waterTextures.length = 0;\n    this.maxDeepColor.set([waterRow.number('Dmax_R'), waterRow.number('Dmax_G'), waterRow.number('Dmax_B'), waterRow.number('Dmax_A')]);\n    this.minDeepColor.set([waterRow.number('Dmin_R'), waterRow.number('Dmin_G'), waterRow.number('Dmin_B'), waterRow.number('Dmin_A')]);\n    this.maxShallowColor.set([waterRow.number('Smax_R'), waterRow.number('Smax_G'), waterRow.number('Smax_B'), waterRow.number('Smax_A')]);\n    this.minShallowColor.set([waterRow.number('Smin_R'), waterRow.number('Smin_G'), waterRow.number('Smin_B'), waterRow.number('Smin_A')]);\n\n    for (let i = 0, l = waterRow.number('numTex'); i < l; i++) {\n      waterTextures.push(this.load(`${waterRow.string('texFile')}${i < 10 ? '0' : ''}${i}${texturesExt}`));\n    }\n\n    this.tilesetTextures = <Texture[]>await Promise.all(tilesetTextures);\n    this.cliffTextures = <Texture[]>await Promise.all(cliffTextures);\n    this.waterTextures = <Texture[]>await Promise.all(waterTextures);\n\n    const corners = parser.corners;\n    const [columns, rows] = this.mapSize;\n    const instanceCount = (columns - 1) * (rows - 1);\n    const cliffHeights = new Float32Array(columns * rows);\n    const cornerHeights = new Float32Array(columns * rows);\n    const waterHeights = new Float32Array(columns * rows);\n    const cornerTextures = new Uint8Array(instanceCount * 4);\n    const cornerVariations = new Uint8Array(instanceCount * 4);\n    const waterFlags = new Uint8Array(instanceCount);\n    let instance = 0;\n    const cliffs: {[key: string]: { locations: number[], textures: number[] }} = {};\n\n    this.columns = columns - 1;\n    this.rows = rows - 1;\n\n    for (let y = 0; y < rows; y++) {\n      for (let x = 0; x < columns; x++) {\n        const bottomLeft = corners[y][x];\n        const index = y * columns + x;\n\n        cliffHeights[index] = bottomLeft.groundHeight;\n        cornerHeights[index] = bottomLeft.groundHeight + bottomLeft.layerHeight - 2;\n        waterHeights[index] = bottomLeft.waterHeight;\n\n        if (y < rows - 1 && x < columns - 1) {\n          // Water can be used with cliffs and normal corners, so store water state regardless.\n          waterFlags[instance] = this.isWater(x, y);\n\n          // Is this a cliff, or a normal corner?\n          if (this.isCliff(x, y)) {\n            const bottomLeftLayer = bottomLeft.layerHeight;\n            const bottomRightLayer = corners[y][x + 1].layerHeight;\n            const topLeftLayer = corners[y + 1][x].layerHeight;\n            const topRightLayer = corners[y + 1][x + 1].layerHeight;\n            const base = Math.min(bottomLeftLayer, bottomRightLayer, topLeftLayer, topRightLayer);\n            const fileName = this.cliffFileName(bottomLeftLayer, bottomRightLayer, topLeftLayer, topRightLayer, base);\n\n            if (fileName !== 'AAAA') {\n              let cliffTexture = bottomLeft.cliffTexture;\n\n              /// ?\n              if (cliffTexture === 15) {\n                cliffTexture = 1;\n              }\n\n              const cliffRow = this.cliffTilesets[cliffTexture];\n              const dir = <string>cliffRow.string('cliffModelDir');\n              const path = `Doodads\\\\Terrain\\\\${dir}\\\\${dir}${fileName}${getCliffVariation(dir, fileName, bottomLeft.cliffVariation)}.mdx`;\n\n              if (!cliffs[path]) {\n                cliffs[path] = { locations: [], textures: []};\n              }\n\n              cliffs[path].locations.push((x + 1) * 128 + centerOffset[0], y * 128 + centerOffset[1], (base - 2) * 128);\n              cliffs[path].textures.push(cliffTexture);\n            }\n          } else {\n            const bottomLeftTexture = this.cornerTexture(x, y);\n            const bottomRightTexture = this.cornerTexture(x + 1, y);\n            const topLeftTexture = this.cornerTexture(x, y + 1);\n            const topRightTexture = this.cornerTexture(x + 1, y + 1);\n            const textures = unique([bottomLeftTexture, bottomRightTexture, topLeftTexture, topRightTexture]).sort();\n            let texture = textures[0];\n\n            cornerTextures[instance * 4] = texture + 1;\n            cornerVariations[instance * 4] = this.getVariation(texture, bottomLeft.groundVariation);\n\n            textures.shift();\n\n            for (let i = 0, l = textures.length; i < l; i++) {\n\n              let bitset = 0;\n\n              texture = textures[i];\n\n              if (bottomRightTexture === texture) {\n                bitset |= 0b0001;\n              }\n\n              if (bottomLeftTexture === texture) {\n                bitset |= 0b0010;\n              }\n\n              if (topRightTexture === texture) {\n                bitset |= 0b0100;\n              }\n\n              if (topLeftTexture === texture) {\n                bitset |= 0b1000;\n              }\n\n              cornerTextures[instance * 4 + 1 + i] = texture + 1;\n              cornerVariations[instance * 4 + 1 + i] = bitset;\n            }\n          }\n\n          instance += 1;\n        }\n      }\n    }\n\n    const gl = this.viewer.gl;\n    const webgl = this.viewer.webgl;\n\n    this.vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), gl.STATIC_DRAW);\n\n    this.faceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.faceBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint8Array([0, 1, 2, 1, 3, 2]), gl.STATIC_DRAW);\n\n    this.cliffHeightMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, this.cliffHeightMap);\n    webgl.setTextureMode(gl.CLAMP_TO_EDGE, gl.CLAMP_TO_EDGE, gl.NEAREST, gl.NEAREST);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.ALPHA, columns, rows, 0, gl.ALPHA, gl.FLOAT, cliffHeights);\n\n    this.heightMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, this.heightMap);\n    webgl.setTextureMode(gl.CLAMP_TO_EDGE, gl.CLAMP_TO_EDGE, gl.NEAREST, gl.NEAREST);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.ALPHA, columns, rows, 0, gl.ALPHA, gl.FLOAT, cornerHeights);\n\n    this.waterHeightMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, this.waterHeightMap);\n    webgl.setTextureMode(gl.CLAMP_TO_EDGE, gl.CLAMP_TO_EDGE, gl.NEAREST, gl.NEAREST);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.ALPHA, columns, rows, 0, gl.ALPHA, gl.FLOAT, waterHeights);\n\n    this.instanceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.instanceBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(instanceCount).map((currentValue, index) => index), gl.STATIC_DRAW);\n\n    this.textureBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, cornerTextures, gl.STATIC_DRAW);\n\n    this.variationBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.variationBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, cornerVariations, gl.STATIC_DRAW);\n\n    this.waterBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.waterBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, waterFlags, gl.STATIC_DRAW);\n\n    this.terrainReady = true;\n    this.anyReady = true;\n\n    const cliffShader = viewer.cliffShader;\n\n    const cliffPromises = Object.entries(cliffs).map(async (cliff) => {\n      const path = cliff[0];\n      const { locations, textures } = cliff[1];\n      const resource = await viewer.loadBaseFile(path, 'arrayBuffer');\n\n      if (resource) {\n        return new TerrainModel(this, <ArrayBuffer>resource.data, locations, textures, cliffShader);\n      }\n\n      return;\n    }).filter(x => x);\n\n    // Sometimes TS isn't the brightest.\n    const cliffPromisesForReal = <Promise<TerrainModel>[]>cliffPromises;\n\n    this.cliffModels = await Promise.all(cliffPromisesForReal);\n    this.cliffsReady = true;\n  }\n\n  loadDoodadsAndDestructibles(): void {\n    const mpqFile = this.map.get('war3map.doo');\n\n    if (!mpqFile) {\n      console.warn('Attempted to load war3map.doo but it is not there');\n      return;\n    }\n\n    const parser = new War3MapDoo();\n\n    try {\n      parser.load(mpqFile.bytes(), this.buildVersion);\n    } catch (e) {\n      console.warn(`Failed to load war3map.doo: ${e}`);\n      return;\n    }\n\n    // Doodads and destructibles.\n    for (const doodad of parser.doodads) {\n      try {\n        const row = this.viewer.doodadsData.getRow(doodad.id);\n\n        if (row) {\n          let file = row.string('file');\n\n          if (file) {\n            const numVar = row.number('numVar');\n\n            if (file.endsWith('.mdl')) {\n              file = file.slice(0, -4);\n            }\n\n            let fileVar = file;\n\n            file += '.mdx';\n\n            if (numVar > 1) {\n              fileVar += Math.min(doodad.variation, numVar - 1);\n            }\n\n            fileVar += '.mdx';\n\n            // First see if the model is local.\n            // Doodads refering to local models may have invalid variations, so if the variation doesn't exist, try without a variation.\n            const mpqFile = this.map.get(fileVar) || this.map.get(file);\n            let promise;\n\n            if (mpqFile) {\n              promise = this.load(mpqFile.name);\n            } else {\n              promise = this.load(fileVar);\n            }\n\n            promise.then((model) => {\n              if (model) {\n                this.doodads.push(new Doodad(this, <MdxModel>model, row, doodad));\n              }\n            });\n          } else {\n            console.log('Unknown doodad ID', doodad.id, doodad);\n          }\n        }\n      } catch (e) {\n        console.warn(`Failed to load doodad/destructible ID ${doodad.id}: ${e}`);\n      }\n    }\n\n    // Cliff/Terrain doodads.\n    for (const doodad of parser.terrainDoodads) {\n      try {\n        const row = <MappedDataRow>this.viewer.doodadsData.getRow(doodad.id);\n\n        this.load(`${row.string('file')}.mdx`)\n          .then((model) => {\n            if (model) {\n              this.terrainDoodads.push(new TerrainDoodad(this, <MdxModel>model, row, doodad));\n            }\n          });\n\n        // let pathTexture = <Texture>this.load(row.pathTex);\n\n        // pathTexture.whenLoaded(() => {\n        //   let startx = doodad.location[0];\n        //   let starty = doodad.location[1];\n        //   let endx = startx + pathTexture.width / 4;\n        //   let endy = starty + pathTexture.height / 4;\n\n        //   for (let x = startx; x < endx; x++) {\n        //     for (let y = starty; y < endy; y++) {\n\n        //     }\n        //   }\n        // });\n      } catch (e) {\n        console.warn(`Failed to load cliff/terrain doodad ID ${doodad.id}: ${e}`);\n      }\n    }\n\n    this.doodadsReady = true;\n    this.anyReady = true;\n  }\n\n  loadUnitsAndItems(): void {\n    const mpqFile = this.map.get('war3mapUnits.doo');\n\n    if (!mpqFile) {\n      console.warn('Attempted to load war3mapUnits.doo but it is not there');\n      return;\n    }\n\n    const parser = new War3MapUnitsDoo();\n\n    try {\n      parser.load(mpqFile.bytes(), this.buildVersion);\n    } catch (e) {\n      console.warn(`Failed to load war3mapUnits.doo: ${e}`);\n      return;\n    }\n\n    // Collect the units and items data.\n    for (const unit of parser.units) {\n      try {\n        let row: MappedDataRow | undefined;\n        let path;\n\n        // Hardcoded?\n        if (unit.id === 'sloc') {\n          path = 'Objects\\\\StartLocation\\\\StartLocation.mdx';\n        } else {\n          row = this.viewer.unitsData.getRow(unit.id);\n\n          if (row) {\n            path = row.string('file');\n\n            if (path) {\n              if (path.endsWith('.mdl')) {\n                path = path.slice(0, -4);\n              }\n\n              path += '.mdx';\n            }\n          }\n        }\n\n        if (path) {\n          this.load(path)\n            .then((model) => {\n              if (model) {\n                this.units.push(new Unit(this, <MdxModel>model, row, unit));\n              }\n            });\n        } else {\n          console.log('Unknown unit ID', unit.id, unit);\n        }\n      } catch (e) {\n        console.warn(`Failed to load unit/item ID ${unit.id}: ${e}`);\n      }\n    }\n\n    this.unitsReady = true;\n    this.anyReady = true;\n  }\n\n  /**\n   * Update the map.\n   */\n  update(): void {\n    if (this.anyReady) {\n      this.waterIndex += this.waterIncreasePerFrame;\n\n      if (this.waterIndex >= this.waterTextures.length) {\n        this.waterIndex = 0;\n      }\n\n      for (const doodad of this.doodads) {\n        doodad.update();\n      }\n\n      for (const unit of this.units) {\n        unit.update();\n      }\n    }\n  }\n\n  /**\n   * Render the map.\n   */\n  render(): void {\n    if (this.anyReady) {\n      const worldScene = this.worldScene;\n\n      worldScene.startFrame();\n      this.renderGround();\n      this.renderCliffs();\n      worldScene.renderOpaque();\n      this.renderWater();\n      worldScene.renderTranslucent();\n    }\n  }\n\n  renderGround(): void {\n    if (this.terrainReady) {\n      const gl = this.viewer.gl;\n      const webgl = this.viewer.webgl;\n      const instancedArrays = <ANGLE_instanced_arrays>webgl.extensions['ANGLE_instanced_arrays'];\n      const shader = this.viewer.groundShader;\n      const uniforms = shader.uniforms;\n      const attribs = shader.attribs;\n      const tilesetTextures = this.tilesetTextures;\n      const instanceAttrib = attribs['a_InstanceID'];\n      const positionAttrib = attribs['a_position'];\n      const texturesAttrib = attribs['a_textures'];\n      const variationsAttrib = attribs['a_variations'];\n      const tilesetCount = tilesetTextures.length; // This includes the blight texture.\n\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n      webgl.useShader(shader);\n\n      gl.uniformMatrix4fv(uniforms['u_VP'], false, this.worldScene.camera.viewProjectionMatrix);\n      gl.uniform2fv(uniforms['u_offset'], this.centerOffset);\n      gl.uniform2f(uniforms['u_size'], this.columns, this.rows);\n      gl.uniform1i(uniforms['u_heightMap'], 15);\n\n      gl.activeTexture(gl.TEXTURE15);\n      gl.bindTexture(gl.TEXTURE_2D, this.heightMap);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n      gl.vertexAttribPointer(positionAttrib, 2, gl.FLOAT, false, 0, 0);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.instanceBuffer);\n      gl.vertexAttribPointer(instanceAttrib, 1, gl.FLOAT, false, 0, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\n      gl.vertexAttribPointer(texturesAttrib, 4, gl.UNSIGNED_BYTE, false, 0, 0);\n      instancedArrays.vertexAttribDivisorANGLE(texturesAttrib, 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.variationBuffer);\n      gl.vertexAttribPointer(variationsAttrib, 4, gl.UNSIGNED_BYTE, false, 0, 0);\n      instancedArrays.vertexAttribDivisorANGLE(variationsAttrib, 1);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.faceBuffer);\n\n      gl.uniform1f(uniforms['u_baseTileset'], 0);\n\n      for (let i = 0, l = Math.min(tilesetCount, 15); i < l; i++) {\n        const isExtended = tilesetTextures[i].width > tilesetTextures[i].height ? 1 : 0;\n\n        gl.uniform1f(uniforms[`u_extended[${i}]`], isExtended);\n        gl.uniform1i(uniforms[`u_tilesets[${i}]`], i);\n\n        webgl.bindTexture(tilesetTextures[i], i);\n      }\n\n      instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, 6, gl.UNSIGNED_BYTE, 0, this.rows * this.columns);\n\n      if (tilesetCount > 15) {\n        gl.uniform1f(uniforms['u_baseTileset'], 15);\n\n        for (let i = 0, l = tilesetCount - 15; i < l; i++) {\n          const isExtended = tilesetTextures[i + 15].width > tilesetTextures[i + 15].height ? 1 : 0;\n\n          gl.uniform1f(uniforms[`u_extended[${i}]`], isExtended);\n\n          webgl.bindTexture(tilesetTextures[i + 15], i);\n        }\n\n        instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, 6, gl.UNSIGNED_BYTE, 0, this.rows * this.columns);\n      }\n\n      instancedArrays.vertexAttribDivisorANGLE(texturesAttrib, 0);\n      instancedArrays.vertexAttribDivisorANGLE(variationsAttrib, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 0);\n    }\n  }\n\n  renderWater(): void {\n    if (this.terrainReady) {\n      const gl = this.viewer.gl;\n      const webgl = this.viewer.webgl;\n      const instancedArrays = <ANGLE_instanced_arrays>webgl.extensions['ANGLE_instanced_arrays'];\n      const shader = this.viewer.waterShader;\n      const uniforms = shader.uniforms;\n      const attribs = shader.attribs;\n      const instanceAttrib = attribs['a_InstanceID'];\n      const positionAttrib = attribs['a_position'];\n      const isWaterAttrib = attribs['a_isWater'];\n\n      gl.depthMask(false);\n\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n      webgl.useShader(shader);\n\n      gl.uniformMatrix4fv(uniforms['u_VP'], false, this.worldScene.camera.viewProjectionMatrix);\n      gl.uniform2fv(uniforms['u_offset'], this.centerOffset);\n      gl.uniform2f(uniforms['u_size'], this.columns, this.rows);\n      gl.uniform1i(uniforms['u_heightMap'], 0);\n      gl.uniform1i(uniforms['u_waterHeightMap'], 1);\n      gl.uniform1i(uniforms['u_waterTexture'], 2);\n      gl.uniform1f(uniforms['u_offsetHeight'], this.waterHeightOffset);\n      gl.uniform4fv(uniforms['u_maxDeepColor'], this.maxDeepColor);\n      gl.uniform4fv(uniforms['u_minDeepColor'], this.minDeepColor);\n      gl.uniform4fv(uniforms['u_maxShallowColor'], this.maxShallowColor);\n      gl.uniform4fv(uniforms['u_minShallowColor'], this.minShallowColor);\n\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, this.heightMap);\n\n      gl.activeTexture(gl.TEXTURE1);\n      gl.bindTexture(gl.TEXTURE_2D, this.waterHeightMap);\n\n      webgl.bindTexture(this.waterTextures[this.waterIndex | 0], 2);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n      gl.vertexAttribPointer(positionAttrib, 2, gl.FLOAT, false, 8, 0);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.instanceBuffer);\n      gl.vertexAttribPointer(instanceAttrib, 1, gl.FLOAT, false, 4, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.waterBuffer);\n      gl.vertexAttribPointer(isWaterAttrib, 1, gl.UNSIGNED_BYTE, false, 1, 0);\n      instancedArrays.vertexAttribDivisorANGLE(isWaterAttrib, 1);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.faceBuffer);\n      instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, 6, gl.UNSIGNED_BYTE, 0, this.rows * this.columns);\n\n      instancedArrays.vertexAttribDivisorANGLE(isWaterAttrib, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 0);\n    }\n  }\n\n  renderCliffs(): void {\n    if (this.cliffsReady) {\n      const gl = this.viewer.gl;\n      const webgl = this.viewer.webgl;\n      const instancedArrays = <ANGLE_instanced_arrays>webgl.extensions['ANGLE_instanced_arrays'];\n      const vertexArrayObject = <OES_vertex_array_object>webgl.extensions['OES_vertex_array_object'];\n      const shader = this.viewer.cliffShader;\n      const attribs = shader.attribs;\n      const uniforms = shader.uniforms;\n\n      gl.disable(gl.BLEND);\n\n      shader.use();\n\n      gl.uniformMatrix4fv(uniforms['u_VP'], false, this.worldScene.camera.viewProjectionMatrix);\n      gl.uniform1i(uniforms['u_heightMap'], 0);\n      gl.uniform2f(uniforms['u_pixel'], 1 / (this.columns + 1), 1 / (this.rows + 1));\n      gl.uniform2fv(uniforms['u_centerOffset'], this.centerOffset);\n      gl.uniform1i(uniforms['u_texture1'], 1);\n      gl.uniform1i(uniforms['u_texture2'], 2);\n\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, this.cliffHeightMap);\n\n      gl.activeTexture(gl.TEXTURE1);\n      gl.bindTexture(gl.TEXTURE_2D, this.cliffTextures[0].webglResource);\n\n      if (this.cliffTextures.length > 1) {\n        gl.activeTexture(gl.TEXTURE2);\n        gl.bindTexture(gl.TEXTURE_2D, this.cliffTextures[1].webglResource);\n      }\n\n      // Set instanced attributes.\n      if (!vertexArrayObject) {\n        instancedArrays.vertexAttribDivisorANGLE(attribs['a_instancePosition'], 1);\n        instancedArrays.vertexAttribDivisorANGLE(attribs['a_instanceTexture'], 1);\n      }\n\n      // Render the cliffs.\n      for (const cliff of this.cliffModels) {\n        cliff.render(shader);\n      }\n\n      // Clear instanced attributes.\n      if (!vertexArrayObject) {\n        instancedArrays.vertexAttribDivisorANGLE(attribs['a_instancePosition'], 0);\n        instancedArrays.vertexAttribDivisorANGLE(attribs['a_instanceTexture'], 0);\n      }\n    }\n  }\n\n  cliffFileName(bottomLeftLayer: number, bottomRightLayer: number, topLeftLayer: number, topRightLayer: number, base: number): string {\n    return String.fromCharCode(65 + bottomLeftLayer - base) +\n      String.fromCharCode(65 + topLeftLayer - base) +\n      String.fromCharCode(65 + topRightLayer - base) +\n      String.fromCharCode(65 + bottomRightLayer - base);\n  }\n\n  getVariation(groundTexture: number, variation: number): number {\n    const texture = this.tilesetTextures[groundTexture];\n\n    // Extended?\n    if (texture.width > texture.height) {\n      if (variation < 16) {\n        return 16 + variation;\n      } else if (variation === 16) {\n        return 15;\n      } else {\n        return 0;\n      }\n    } else {\n      if (variation === 0) {\n        return 0;\n      } else {\n        return 15;\n      }\n    }\n  }\n\n  /**\n   * Is the corner at the given column and row a cliff?\n   */\n  isCliff(column: number, row: number): boolean {\n    if (column < 1 || column > this.columns - 1 || row < 1 || row > this.rows - 1) {\n      return false;\n    }\n\n    const corners = this.corners;\n    const bottomLeft = corners[row][column].layerHeight;\n    const bottomRight = corners[row][column + 1].layerHeight;\n    const topLeft = corners[row + 1][column].layerHeight;\n    const topRight = corners[row + 1][column + 1].layerHeight;\n\n    return bottomLeft !== bottomRight || bottomLeft !== topLeft || bottomLeft !== topRight;\n  }\n\n  /**\n   * Is the tile at the given column and row water?\n   */\n  isWater(column: number, row: number): number {\n    const corners = this.corners;\n\n    return corners[row][column].water || corners[row][column + 1].water || corners[row + 1][column].water || corners[row + 1][column + 1].water;\n  }\n\n  /**\n   * Given a cliff index, get its ground texture index.\n   * This is an index into the tilset textures.\n   */\n  cliffGroundIndex(whichCliff: number): number {\n    const whichTileset = this.cliffTilesets[whichCliff].string('groundTile');\n    const tilesets = this.tilesets;\n\n    for (let i = 0, l = tilesets.length; i < l; i++) {\n      if (tilesets[i].string('tileID') === whichTileset) {\n        return i;\n      }\n    }\n\n    return 0;\n  }\n\n  /**\n   * Get the ground texture of a corner, whether it's normal ground, a cliff, or a blighted corner.\n   */\n  cornerTexture(column: number, row: number): number {\n    const corners = this.corners;\n    const columns = this.columns;\n    const rows = this.rows;\n\n    for (let y = -1; y < 1; y++) {\n      for (let x = -1; x < 1; x++) {\n        if (column + x > 0 && column + x < columns - 1 && row + y > 0 && row + y < rows - 1) {\n          if (this.isCliff(column + x, row + y)) {\n            let texture = corners[row + y][column + x].cliffTexture;\n\n            if (texture === 15) {\n              texture = 1;\n            }\n\n            return this.cliffGroundIndex(texture);\n          }\n        }\n      }\n    }\n\n    const corner = corners[row][column];\n\n    // Is this corner blighted?\n    if (corner.blight) {\n      return this.blightTextureIndex;\n    }\n\n    return corner.groundTexture;\n  }\n\n  applyModificationFile(dataMap: MappedData, metadataMap: MappedData, modificationFile: War3MapW3u | War3MapW3d | undefined): void {\n    if (modificationFile) {\n      // Modifications to built-in objects\n      this.applyModificationTable(dataMap, metadataMap, modificationFile.originalTable);\n\n      // Declarations of user-defined objects\n      this.applyModificationTable(dataMap, metadataMap, modificationFile.customTable);\n    }\n  }\n\n  applyModificationTable(dataMap: MappedData, metadataMap: MappedData, modificationTable: ModificationTable): void {\n    for (const modificationObject of modificationTable.objects) {\n      let row;\n\n      if (modificationObject.newId !== '') {\n        row = dataMap.getRow(modificationObject.newId);\n\n        if (!row) {\n          row = new MappedDataRow();\n\n          row.map = Object.assign({}, (<MappedDataRow>dataMap.getRow(modificationObject.oldId)).map);\n\n          dataMap.setRow(modificationObject.newId, row);\n        }\n      } else {\n        row = <MappedDataRow>dataMap.getRow(modificationObject.oldId);\n      }\n\n      for (const modification of modificationObject.modifications) {\n        const metadata = metadataMap.getRow(modification.id);\n\n        if (metadata) {\n          row.set(<string>metadata.string('field'), modification.value);\n        } else {\n          console.warn('Unknown modification ID', modification);\n        }\n      }\n    }\n  }\n\n  groundNormal(out: vec3, x: number, y: number): vec3 {\n    const centerOffset = this.centerOffset;\n    const mapSize = this.mapSize;\n\n    x = (x - centerOffset[0]) / 128;\n    y = (y - centerOffset[1]) / 128;\n\n    const cellX = x | 0;\n    const cellY = y | 0;\n\n    // See if this coordinate is in the map\n    if (cellX >= 0 && cellX < mapSize[0] - 1 && cellY >= 0 && cellY < mapSize[1] - 1) {\n      // See http://gamedev.stackexchange.com/a/24574\n      const corners = this.corners;\n      const bottomLeft = corners[cellY][cellX].groundHeight;\n      const bottomRight = corners[cellY][cellX + 1].groundHeight;\n      const topLeft = corners[cellY + 1][cellX].groundHeight;\n      const topRight = corners[cellY + 1][cellX + 1].groundHeight;\n      const sqX = x - cellX;\n      const sqY = y - cellY;\n\n      if (sqX + sqY < 1) {\n        vec3.set(normalHeap1, 1, 0, bottomRight - bottomLeft);\n        vec3.set(normalHeap2, 0, 1, topLeft - bottomLeft);\n      } else {\n        vec3.set(normalHeap1, -1, 0, topRight - topLeft);\n        vec3.set(normalHeap2, 0, 1, topRight - bottomRight);\n      }\n\n      vec3.normalize(out, vec3.cross(out, normalHeap1, normalHeap2));\n    } else {\n      vec3.set(out, 0, 0, 1);\n    }\n\n    return out;\n  }\n}\n\n/*\n  heightAt(location) {\n    let heightMap = this.heightMap,\n      offset = this.offset,\n      x = (location[0] / 128) + offset[0],\n      y = (location[1] / 128) + offset[1];\n\n    let minY = Math.floor(y),\n      maxY = Math.ceil(y),\n      minX = Math.floor(x),\n      maxX = Math.ceil(x);\n\n    // See if this coordinate is in the map\n    if (maxY > 0 && minY < heightMap.length - 1 && maxX > 0 && minX < heightMap[0].length - 1) {\n      // See http://gamedev.stackexchange.com/a/24574\n      let triZ0 = heightMap[minY][minX],\n        triZ1 = heightMap[minY][maxX],\n        triZ2 = heightMap[maxY][minX],\n        triZ3 = heightMap[maxY][maxX],\n        sqX = x - minX,\n        sqZ = y - minY,\n        height;\n\n      if ((sqX + sqZ) < 1) {\n        height = triZ0 + (triZ1 - triZ0) * sqX + (triZ2 - triZ0) * sqZ;\n      } else {\n        height = triZ3 + (triZ1 - triZ3) * (1 - sqZ) + (triZ2 - triZ3) * (1 - sqX);\n      }\n\n      return height * 128;\n    }\n\n    return 0;\n  }\n  */\n","import blp from './blp/handler';\nimport dds from './dds/handler';\nimport m3 from './m3/handler';\nimport mdx from './mdx/handler';\nimport tga from './tga/handler';\nimport War3MapViewer from './w3x/viewer';\n\nexport default {\n  blp,\n  dds,\n  m3,\n  mdx,\n  tga,\n  War3MapViewer,\n};\n","import { FetchDataTypeName } from '../../../common/fetchdatatype';\nimport { MappedData } from '../../../utils/mappeddata';\nimport ModelViewer from '../../viewer';\nimport Shader from '../../gl/shader';\nimport { PathSolver } from '../../handlerresource';\nimport mdxHandler from '../mdx/handler';\nimport blpHandler from '../blp/handler';\nimport tgaHandler from '../tga/handler';\nimport ddsHandler from '../dds/handler';\nimport groundVert from './shaders/ground.vert';\nimport groundFrag from './shaders/ground.frag';\nimport waterVert from './shaders/water.vert';\nimport waterFrag from './shaders/water.frag';\nimport cliffsVert from './shaders/cliffs.vert';\nimport cliffsFrag from './shaders/cliffs.frag';\nimport War3MapViewerMap from './map';\nimport GenericResource from '../../genericresource';\n\nexport default class War3MapViewer extends ModelViewer {\n  wc3PathSolver: PathSolver;\n  isReforged: boolean;\n  groundShader: Shader;\n  waterShader: Shader;\n  cliffShader: Shader;\n  terrainData = new MappedData();\n  cliffTypesData = new MappedData();\n  waterData = new MappedData();\n  doodadsData = new MappedData();\n  doodadMetaData = new MappedData();\n  destructableMetaData = new MappedData();\n  unitsData = new MappedData();\n  unitMetaData = new MappedData();\n  loadedBaseFiles = false;\n  map: War3MapViewerMap | null = null;\n\n  constructor(canvas: HTMLCanvasElement, wc3PathSolver: PathSolver, isReforged: boolean) {\n    super(canvas);\n\n    const webgl = this.webgl;\n\n    // Data textures.\n    if (!webgl.ensureExtension('OES_texture_float')) {\n      throw new Error('War3MapViewer: No float texture support!');\n    }\n\n    // Optionally used for cliff renering.\n    if (!webgl.ensureExtension('OES_vertex_array_object')) {\n      console.warn('War3MapViewer: No vertex array object support! This might reduce performance.');\n    }\n\n    this.on('error', (e) => console.log(e));\n\n    this.addHandler(mdxHandler, wc3PathSolver, isReforged);\n    this.addHandler(blpHandler);\n    this.addHandler(tgaHandler);\n    this.addHandler(ddsHandler);\n\n    this.wc3PathSolver = wc3PathSolver;\n    this.isReforged = isReforged;\n\n    this.groundShader = this.webgl.createShader(groundVert, groundFrag);\n    this.waterShader = this.webgl.createShader(waterVert, waterFrag);\n    this.cliffShader = this.webgl.createShader(cliffsVert, cliffsFrag);\n\n    this.loadBaseFiles();\n  }\n\n  async loadBaseFiles(): Promise<void> {\n    const promises = [\n      this.loadBaseFile('TerrainArt\\\\Terrain.slk', 'text'),\n      this.loadBaseFile('TerrainArt\\\\CliffTypes.slk', 'text'),\n      this.loadBaseFile('TerrainArt\\\\Water.slk', 'text'),\n      this.loadBaseFile('Doodads\\\\Doodads.slk', 'text'),\n      this.loadBaseFile('Doodads\\\\DoodadMetaData.slk', 'text'),\n      this.loadBaseFile('Units\\\\DestructableData.slk', 'text'),\n      this.loadBaseFile('Units\\\\DestructableMetaData.slk', 'text'),\n      this.loadBaseFile('Units\\\\UnitData.slk', 'text'),\n      this.loadBaseFile('Units\\\\unitUI.slk', 'text'),\n      this.loadBaseFile('Units\\\\ItemData.slk', 'text'),\n      this.loadBaseFile('Units\\\\UnitMetaData.slk', 'text'),\n    ];\n\n    let reforgedPromises;\n\n    if (this.isReforged) {\n      reforgedPromises = [\n        this.loadBaseFile('Doodads\\\\doodadSkins.txt', 'text'),\n        this.loadBaseFile('Units\\\\destructableSkin.txt', 'text'),\n        this.loadBaseFile('Units\\\\unitSkin.txt', 'text'),\n        this.loadBaseFile('Units\\\\itemSkin.txt', 'text'),\n      ];\n    }\n\n    const [terrain, cliffTypes, water, doodads, doodadMetaData, destructableData, destructableMetaData, unitData, unitUi, itemData, unitMetaData] = await Promise.all(promises);\n\n    if (!terrain || !cliffTypes || !water || !doodads || !doodadMetaData || !destructableData || !destructableMetaData || !unitData || !unitUi || !itemData || !unitMetaData) {\n      throw new Error('Failed to load the base files');\n    }\n\n    this.terrainData.load(<string>terrain.data);\n    this.cliffTypesData.load(<string>cliffTypes.data);\n    this.waterData.load(<string>water.data);\n    this.doodadsData.load(<string>doodads.data);\n    this.doodadMetaData.load(<string>doodadMetaData.data);\n    this.doodadsData.load(<string>destructableData.data);\n    this.destructableMetaData.load(<string>destructableMetaData.data);\n    this.unitsData.load(<string>unitData.data);\n    this.unitsData.load(<string>unitUi.data);\n    this.unitsData.load(<string>itemData.data);\n    this.unitMetaData.load(<string>unitMetaData.data);\n\n    if (reforgedPromises) {\n      const [doodadSkins, destructableSkin, unitSkin, itemSkin] = await Promise.all(reforgedPromises);\n\n      if (!doodadSkins || !destructableSkin || !unitSkin || !itemSkin) {\n        throw new Error('Failed to load the base Reforged files');\n      }\n\n      this.doodadsData.load(<string>doodadSkins.data);\n      this.doodadsData.load(<string>destructableSkin.data);\n      this.unitsData.load(<string>unitSkin.data);\n      this.unitsData.load(<string>itemSkin.data);\n    }\n\n    this.loadedBaseFiles = true;\n    this.emit('loadedbasefiles');\n  }\n\n  loadBaseFile(path: string, dataType: FetchDataTypeName): Promise<GenericResource | undefined> {\n    return super.loadGeneric(<string>this.wc3PathSolver(path), dataType);\n  }\n\n  /**\n   * Load a map from a buffer.\n   */\n  loadMap(buffer: ArrayBuffer | Uint8Array): void {\n    if (this.loadedBaseFiles) {\n      if (this.map) {\n        this.map.die();\n      }\n\n      this.map = new War3MapViewerMap(this, buffer);\n    }\n  }\n\n  /**\n   * Update the map.\n   */\n  override update(): void {\n    if (this.map) {\n      super.update();\n\n      this.map.update();\n    }\n  }\n\n  /**\n   * Render the map.\n   */\n  override render(): void {\n    if (this.map) {\n      this.map.render();\n    }\n  }\n}\n","const shader = `\nuniform mat4 u_VP;\nuniform sampler2D u_heightMap;\nuniform vec2 u_size;\nuniform vec2 u_offset;\nuniform bool u_extended[14];\nuniform float u_baseTileset;\n\nattribute vec2 a_position;\nattribute float a_InstanceID;\nattribute vec4 a_textures;\nattribute vec4 a_variations;\n\nvarying vec4 v_tilesets;\nvarying vec2 v_uv[4];\nvarying vec3 v_normal;\n\nvec2 getCell(float variation) {\n  if (variation < 16.0) {\n    return vec2(mod(variation, 4.0), floor(variation / 4.0));\n  } else {\n    variation -= 16.0;\n\n    return vec2(4.0 + mod(variation, 4.0), floor(variation / 4.0));\n  }\n}\n\nvec2 getUV(vec2 position, bool extended, float variation) {\n  vec2 cell = getCell(variation);\n  vec2 cellSize = vec2(extended ? 0.125 : 0.25, 0.25);\n  vec2 uv = vec2(position.x, 1.0 - position.y);\n  vec2 pixelSize = vec2(1.0 / 512.0, 1.0 / 256.0); /// Note: hardcoded to 512x256 for now.\n\n  return clamp((cell + uv) * cellSize, cell * cellSize + pixelSize, (cell + 1.0) * cellSize - pixelSize); \n}\n\nvoid main() {\n  vec4 textures = a_textures - u_baseTileset;\n  \n  if (textures[0] > 0.0 || textures[1] > 0.0 || textures[2] > 0.0 || textures[3] > 0.0) {\n    v_tilesets = textures;\n\n    v_uv[0] = getUV(a_position, u_extended[int(textures[0]) - 1], a_variations[0]);\n    v_uv[1] = getUV(a_position, u_extended[int(textures[1]) - 1], a_variations[1]);\n    v_uv[2] = getUV(a_position, u_extended[int(textures[2]) - 1], a_variations[2]);\n    v_uv[3] = getUV(a_position, u_extended[int(textures[3]) - 1], a_variations[3]);\n\n    vec2 corner = vec2(mod(a_InstanceID, u_size.x), floor(a_InstanceID / u_size.x));\n    vec2 base = corner + a_position;\n    float height = texture2D(u_heightMap, base / u_size).a;\n\n    float hL = texture2D(u_heightMap, vec2(base - vec2(1.0, 0.0)) / (u_size)).a;\n    float hR = texture2D(u_heightMap, vec2(base + vec2(1.0, 0.0)) / (u_size)).a;\n    float hD = texture2D(u_heightMap, vec2(base - vec2(0.0, 1.0)) / (u_size)).a;\n    float hU = texture2D(u_heightMap, vec2(base + vec2(0.0, 1.0)) / (u_size)).a;\n\n    v_normal = normalize(vec3(hL - hR, hD - hU, 2.0));\n\n    gl_Position = u_VP * vec4(base * 128.0 + u_offset, height * 128.0, 1.0);\n  } else {\n    v_tilesets = vec4(0.0);\n\n    v_uv[0] = vec2(0.0);\n    v_uv[1] = vec2(0.0);\n    v_uv[2] = vec2(0.0);\n    v_uv[3] = vec2(0.0);\n\n    v_normal = vec3(0.0);\n\n    gl_Position = vec4(0.0);\n  }\n}\n`;\n\nexport default shader;\n","const shader = `\nuniform mat4 u_VP;\nuniform sampler2D u_heightMap;\nuniform sampler2D u_waterHeightMap;\nuniform vec2 u_size;\nuniform vec2 u_offset;\nuniform float u_offsetHeight;\nuniform vec4 u_minDeepColor;\nuniform vec4 u_maxDeepColor;\nuniform vec4 u_minShallowColor;\nuniform vec4 u_maxShallowColor;\n\nattribute vec2 a_position;\nattribute float a_InstanceID;\nattribute float a_isWater;\n\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nconst float minDepth = 10.0 / 128.0;\nconst float deepLevel = 64.0 / 128.0;\nconst float maxDepth = 72.0 / 128.0;\n\nvoid main() {\n  if (a_isWater > 0.5) {\n    v_uv = a_position;\n\n    vec2 corner = vec2(mod(a_InstanceID, u_size.x), floor(a_InstanceID / u_size.x));\n    vec2 base = corner + a_position;\n    float height = texture2D(u_heightMap, base / u_size).a;\n    float waterHeight = texture2D(u_waterHeightMap, base / u_size).a + u_offsetHeight;\n    float value = clamp(waterHeight - height, 0.0, 1.0);\n\n    if (value <= deepLevel) {\n      value = max(0.0, value - minDepth) / (deepLevel - minDepth);\n      v_color = mix(u_minShallowColor, u_maxShallowColor, value) / 255.0;\n    } else {\n      value = clamp(value - deepLevel, 0.0, maxDepth - deepLevel) / (maxDepth - deepLevel);\n      v_color = mix(u_minDeepColor, u_maxDeepColor, value) / 255.0;\n    }\n\n    gl_Position = u_VP * vec4(base * 128.0 + u_offset, waterHeight * 128.0, 1.0);\n  } else {\n    v_uv = vec2(0.0);\n    v_color = vec4(0.0);\n\n    gl_Position = vec4(0.0);\n  }\n}\n`;\n\nexport default shader;\n","const shader = `\nuniform mat4 u_VP;\nuniform sampler2D u_heightMap;\nuniform vec2 u_pixel;\nuniform vec2 u_centerOffset;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\nattribute vec3 a_instancePosition;\nattribute float a_instanceTexture;\n\nvarying vec3 v_normal;\nvarying vec2 v_uv;\nvarying float v_texture;\nvarying vec3 v_position;\n\nvoid main() {\n  // Half of a pixel in the cliff height map.\n  vec2 halfPixel = u_pixel * 0.5;\n\n  // The bottom left corner of the map tile this vertex is on.\n  vec2 corner = floor((a_instancePosition.xy - vec2(1.0, 0.0) - u_centerOffset.xy) / 128.0);\n\n  // Get the 4 closest heights in the height map.\n  float bottomLeft = texture2D(u_heightMap, corner * u_pixel + halfPixel).a;\n  float bottomRight = texture2D(u_heightMap, (corner + vec2(1.0, 0.0)) * u_pixel + halfPixel).a;\n  float topLeft = texture2D(u_heightMap, (corner + vec2(0.0, 1.0)) * u_pixel + halfPixel).a;\n  float topRight = texture2D(u_heightMap, (corner + vec2(1.0, 1.0)) * u_pixel + halfPixel).a;\n  \n  // Do a bilinear interpolation between the heights to get the final value.\n  float bottom = mix(bottomRight, bottomLeft, -a_position.x / 128.0);\n  float top = mix(topRight, topLeft, -a_position.x / 128.0);\n  float height = mix(bottom, top, a_position.y / 128.0);\n\n  v_normal = a_normal;\n  v_uv = a_uv;\n  v_texture = a_instanceTexture;\n  v_position = a_position + vec3(a_instancePosition.xy, a_instancePosition.z + height * 128.0);\n\n  gl_Position = u_VP * vec4(v_position, 1.0);\n}\n`;\n\nexport default shader;\n","import ModelViewer, { DebugRenderMode } from './viewer';\nimport Scene from './scene';\nimport Camera from './camera';\nimport { Node } from './node';\nimport Model from './model';\nimport ModelInstance from './modelinstance';\nimport Texture from './texture';\nimport GenericResource from './genericresource';\nimport gl from './gl';\nimport handlers from './handlers';\n\nexport default {\n  ModelViewer,\n  DebugRenderMode,\n  Scene,\n  Camera,\n  Node,\n  Model,\n  ModelInstance,\n  Texture,\n  GenericResource,\n  gl,\n  handlers,\n};\n","/**\n * type handle\n */\nexport default class JassHandle {\n  handleId = -1;\n}\n","import JassHandle from './handle';\n\n/**\n * type agent\n */\nexport default class JassAgent extends JassHandle {}\n","import JassAgent from './agent';\n\nexport interface Alliance {\n  passive: boolean,\n  helpRequest: boolean,\n  helpResponse: boolean,\n  sharedXp: boolean,\n  sharedSpells: boolean,\n  sharedVision: boolean,\n  sharedControl: boolean,\n  sharedAdvancedControl: boolean,\n  rescuable: boolean,\n  sharedVisionForced: boolean,\n}\n\n/**\n * type player\n */\nexport default class JassPlayer extends JassAgent {\n  index: number;\n  name: string;\n  team = -1;\n  startLocation = -1;\n  forcedStartLocation = -1;\n  color = -1;\n  race = 0;\n  racePreference = -1;\n  raceSelectable = false;\n  controller = -1;\n  alliances: Map<number, Alliance> = new Map();\n\n  constructor(index: number, maxPlayers: number) {\n    super();\n\n    this.index = index;\n    this.name = `Player ${index}`;\n\n    for (let i = 0; i < maxPlayers; i++) {\n      if (i !== index) {\n        this.alliances.set(i, {\n          passive: false,\n          helpRequest: false,\n          helpResponse: false,\n          sharedXp: false,\n          sharedSpells: false,\n          sharedVision: false,\n          sharedControl: false,\n          sharedAdvancedControl: false,\n          rescuable: false,\n          sharedVisionForced: false,\n        });\n      }\n    }\n  }\n}\n","import JassAgent from './agent';\n\n/**\n * type widget\n */\nexport default class JassWidget extends JassAgent {\n  health = 0;\n  maxHealth = 0;\n}\n","import { base256ToString } from '../../../common/typecast';\nimport JassWidget from './widget';\nimport JassPlayer from './player';\n\n/**\n * type unit\n */\nexport default class JassUnit extends JassWidget {\n  player: JassPlayer;\n  unitId: string;\n  x: number;\n  y: number;\n  face: number;\n  acquireRange = 500;\n\n  constructor(player: JassPlayer, unitId: number, x: number, y: number, face: number) {\n    super();\n\n    this.player = player;\n    this.unitId = base256ToString(unitId);\n    this.x = x;\n    this.y = y;\n    this.face = face;\n\n    // if (balanceRow) {\n    //   this.balanceRow = balanceRow;\n    //   this.health = balanceRow.realHP;\n    //   this.maxHealth = this.health;\n    //   this.mana = parseFloat(balanceRow.realM) || 0;\n    //   this.maxMana = this.mana;\n    // } else if (jass.debugMode) {\n    //   console.log('Unknown unitid', unitId);\n    // }\n  }\n}\n","import JassAgent from './agent';\nimport JassPlayer from './player';\n\n/**\n * type force\n */\nexport default class JassForce extends JassAgent {\n  players: Set<JassPlayer> = new Set();\n}\n","import JassAgent from './agent';\nimport JassUnit from './unit';\n\n/**\n * type group\n */\nexport default class JassGroup extends JassAgent {\n  units: Set<JassUnit> = new Set();\n}\n","import JassAgent from './agent';\n\n/**\n * type trigger\n */\nexport default class JassTrigger extends JassAgent {\n  events: number[] = [];\n  conditions: number[] = [];\n  actions: number[] = [];\n  enabled = true;\n}\n","import JassAgent from './agent';\n\n/**\n * type timer\n */\nexport default class JassTimer extends JassAgent {\n  elapsed = 0;\n  timeout = 0;\n  periodic = false;\n  handlerFunc = -1;\n}\n","import JassAgent from './agent';\n\n/**\n * type location\n */\nexport default class JassLocation extends JassAgent {\n  x: number;\n  y: number;\n  z = 0;\n\n  constructor(x: number, y: number) {\n    super();\n\n    this.x = x;\n    this.y = y;\n  }\n}\n","import JassAgent from './agent';\nimport JassRect from './rect';\n\n/**\n * type region\n */\nexport default class JassRegion extends JassAgent {\n  rects: Set<JassRect> = new Set();\n}\n","import JassAgent from './agent';\n\n/**\n * type rect\n */\nexport default class JassRect extends JassAgent {\n  center: Float32Array;\n  min: Float32Array;\n  max: Float32Array;\n\n  constructor(minx: number, miny: number, maxx: number, maxy: number) {\n    super();\n\n    this.center = new Float32Array([maxx - minx, maxy - miny]);\n    this.min = new Float32Array([minx, miny]);\n    this.max = new Float32Array([maxx, maxy]);\n  }\n}\n","import JassHandle from './handle';\n\n/**\n * Parent class for all enum types.\n */\nexport default class JassEnum extends JassHandle {\n  id: number;\n\n  constructor(value: number) {\n    super();\n\n    this.id = value;\n  }\n}\n","import JassEnum from './enum';\n\n/**\n * type race\n */\nexport default class JassRace extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type alliancetype\n */\nexport default class JassAllianceType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type racepreference\n */\nexport default class JassRacePreference extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type gamestate\n */\nexport default class JassGameState extends JassEnum {}\n","import JassGameState from './gamestate';\n\n/**\n * type igamestate\n */\nexport default class JassIGameState extends JassGameState {}\n","import JassGameState from './gamestate';\n\n/**\n * type fgamestate\n */\nexport default class JassFGameState extends JassGameState {}\n","import JassEnum from './enum';\n\n/**\n * type playerstate\n */\nexport default class JassPlayerState extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type playerscore\n */\nexport default class JassPlayerScore extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type playergameresult\n */\nexport default class JassPlayerGameResult extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type unitstate\n */\nexport default class JassUnitState extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type aidifficulty\n */\nexport default class JassAiDifficulty extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type eventid\n */\nexport default class JassEventId extends JassEnum {}\n","import JassEventId from './eventid';\n\n/**\n * type gameevent\n */\nexport default class JassGameEvent extends JassEventId {}\n","import JassEventId from './eventid';\n\n/**\n * type playerevent\n */\nexport default class JassPlayerEvent extends JassEventId {}\n","import JassEventId from './eventid';\n\n/**\n * type playerunitevent\n */\nexport default class JassPlayerUnitEvent extends JassEventId {}\n","import JassEventId from './eventid';\n\n/**\n * type unitevent\n */\nexport default class JassUnitEvent extends JassEventId {}\n","import JassEventId from './eventid';\n\n/**\n * type limitop\n */\nexport default class JassLimitOp extends JassEventId {}\n","import JassEventId from './eventid';\n\n/**\n * type widgetevent\n */\nexport default class JassWidgetEvent extends JassEventId {}\n","import JassEventId from './eventid';\n\n/**\n * type dialogevent\n */\nexport default class JassDialogEvent extends JassEventId {}\n","import JassEnum from './enum';\n\n/**\n * type unittype\n */\nexport default class JassUnitType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type gamespeed\n */\nexport default class JassGameSpeed extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type gamedifficulty\n */\nexport default class JassGameDifficulty extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type gametype\n */\nexport default class JassGameType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type mapflag\n */\nexport default class JassMapFlag extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type mapvisibility\n */\nexport default class JassMapVisibility extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type mapflag\n */\nexport default class JassMapFlag extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type mapdensity\n */\nexport default class JassMapDensity extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type mapcontrol\n */\nexport default class JassMapControl extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type playerslotstate\n */\nexport default class JassPlayerSlotState extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type volumegroup\n */\nexport default class JassVolumeGroup extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type camerafield\n */\nexport default class JassCameraField extends JassEnum {}\n","import JassHandle from './handle';\nimport JassLocation from './location';\n\n/**\n * type camerasetup\n */\nexport default class JassCameraSetup extends JassHandle {\n  targetDistance = 0;\n  farZ = 0;\n  angleOfAttack = 0;\n  fieldOfView = 0;\n  roll = 0;\n  rotation = 0;\n  zOffset = 0;\n  destPosition = new JassLocation(0, 0);\n}\n","import JassEnum from './enum';\n\n/**\n * type playercolor\n */\nexport default class JassPlayerColor extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type placement\n */\nexport default class JassPlacement extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type startlocprio\n */\nexport default class JassStartLocPrio extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type raritycontrol\n */\nexport default class JassRarityControl extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type blendmode\n */\nexport default class JassBlendMode extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type texmapflags\n */\nexport default class JassTexMapFlags extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type effecttype\n */\nexport default class JassEffectType extends JassEnum {}\n","import JassHandle from './handle';\nimport JassRect from './rect';\n\n/**\n * type weathereffect\n */\nexport default class JassWeatherEffect extends JassHandle {\n  whichRect: JassRect;\n  effectId: string;\n  enabled = false;\n\n  constructor(whichRect: JassRect, effectId: string) {\n    super();\n\n    this.whichRect = whichRect;\n    this.effectId = effectId;\n  }\n}\n","import JassEnum from './enum';\n\n/**\n * type fogstate\n */\nexport default class JassFogState extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type version\n */\nexport default class JassVersion extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type itemtype\n */\nexport default class JassItemType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type attacktype\n */\nexport default class JassAttackType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type damagetype\n */\nexport default class JassDamageType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type weapontype\n */\nexport default class JassWeaponType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type soundtype\n */\nexport default class JassSoundType extends JassEnum {}\n","import JassEnum from './enum';\n\n/**\n * type pathingtype\n */\nexport default class JassPathingType extends JassEnum {}\n","import JassAgent from './agent';\n\n/**\n * type unit\n */\nexport default class JassHashTable extends JassAgent {\n  table: Map<number, Map<number, unknown>> = new Map();\n\n  save(parentKey: number, childKey: number, value: unknown): void {\n    const table = this.table;\n    let childTable = table.get(parentKey);\n\n    if (!childTable) {\n      childTable = new Map();\n\n      table.set(parentKey, childTable);\n    }\n\n    childTable.set(childKey, value);\n  }\n\n  load(parentKey: number, childKey: number, defaultValue?: unknown): unknown {\n    const table = this.table;\n    const childTable = table.get(parentKey);\n\n    if (childTable) {\n      const value = childTable.get(childKey);\n\n      if (value !== undefined) {\n        return value;\n      }\n    }\n\n    return defaultValue;\n  }\n\n  have(parentKey: number, childKey: number): boolean {\n    const table = this.table;\n    const childTable = table.get(parentKey);\n\n    if (!childTable) {\n      return false;\n    }\n\n    return childTable.has(childKey);\n  }\n\n  remove(parentKey: number, childKey: number): void {\n    const table = this.table;\n    const childTable = table.get(parentKey);\n\n    if (childTable) {\n      childTable.delete(childKey);\n\n      if (!childTable.size) {\n        table.delete(parentKey);\n      }\n    }\n  }\n\n  flush(): void {\n    this.table.clear();\n  }\n\n  flushChild(parentKey: number): void {\n    const child = this.table.get(parentKey);\n\n    if (child) {\n      child.clear();\n    }\n  }\n}\n","\nimport { EventEmitter } from 'events';\nimport { lua_State } from 'fengari/src/lstate';\nimport { lua_atnativeerror, lua_getglobal, lua_pcall, lua_pop, lua_pushstring, lua_rawgeti, lua_touserdata } from 'fengari/src/lapi';\nimport { LUA_REGISTRYINDEX, thread_status, to_jsstring, to_luastring } from 'fengari/src/defs';\nimport { luaL_checknumber, luaL_loadstring, luaL_newstate, luaL_tolstring } from 'fengari/src/lauxlib';\nimport { lua_resume } from 'fengari/src/ldo';\nimport War3Map from '../../parsers/w3x/map';\nimport jass2lua from './jass2lua';\nimport bindNatives from './natives';\nimport JassPlayer from './types/player';\nimport constantHandles from './constanthandles';\nimport Thread from './thread';\nimport JassHandle from './types/handle';\nimport JassLocation from './types/location';\nimport JassTimer from './types/timer';\nimport { JassTrigger } from './types/index';\n\n/**\n * A Jass2 context.\n */\nexport default class Context extends EventEmitter {\n  L: lua_State;\n  map: War3Map | null = null;\n  handle = 0;\n  freeHandles: number[] = [];\n  handles: (JassHandle | null)[] = [];\n  name = '';\n  description = '';\n  players: JassPlayer[] = [];\n  actualPlayers = 0;\n  startLocations: JassLocation[] = [];\n  constantHandles = constantHandles();\n  timers: Set<JassTimer> = new Set();\n  triggers: Set<JassTrigger> = new Set();\n  threads: Set<Thread> = new Set();\n  currentThread: Thread | null = null;\n  enumUnit: JassHandle | null = null;\n  filterUnit: JassHandle | null = null;\n  enumPlayer: JassHandle | null = null;\n  t = 0;\n\n  constructor() {\n    super();\n\n    this.L = luaL_newstate();\n\n    //luaL_openlibs(this.L);\n\n    bindNatives(this);\n\n    lua_atnativeerror(this.L, (L: lua_State) => {\n      const e = <Error>lua_touserdata(L, -1);\n\n      lua_pushstring(L, e.stack || 'An unknown error occured');\n\n      return 1;\n    });\n\n    for (let i = 0; i < 28; i++) {\n      this.players[i] = <JassPlayer>this.addHandle(new JassPlayer(i, 28));\n    }\n\n    // this.mappedData = new MappedData();\n\n    // this.mapName = '';\n    // this.mapDescription = '';\n    // this.gamePlacement = null;\n    // this.gameSpeed = null;\n    // this.gameDifficulty = null;\n    // this.playerCount = 0;\n    // this.teamCount = 0;\n    // this.startLocations = [];\n    // this.players = [];\n    // this.teams = [];\n\n    // this.stringTable = map.readStringTable();\n  }\n\n  start(): void {\n    this.t = performance.now();\n  }\n\n  step(): void {\n    const t = performance.now();\n    const dt = (t - this.t) * 0.001;\n    const timers = this.timers;\n    const threads = this.threads;\n\n    for (const timer of timers) {\n      timer.elapsed += dt;\n\n      if (timer.elapsed >= timer.timeout) {\n        const thread = new Thread(this.L, { expiredTimer: timer });\n        const L = thread.L;\n\n        // Push the entry point onto the thread's stack, so when the thread is resumed it will immediately be called.\n        lua_rawgeti(L, LUA_REGISTRYINDEX, timer.handlerFunc);\n\n        this.threads.add(thread);\n\n        if (timer.periodic) {\n          timer.elapsed = 0;\n        } else {\n          timers.delete(timer);\n\n          /// TODO: better way to clean references.\n          // If the timer isn't periodic, the callback reference can be collected.\n          ///luaL_unref(timer.handlerFunc);\n        }\n      }\n    }\n\n    for (const thread of threads) {\n      thread.sleep -= dt;\n\n      if (thread.sleep <= 0) {\n        this.currentThread = thread;\n\n        const L = thread.L;\n        const status = lua_resume(L, this.L, 0);\n\n        if (status === thread_status.LUA_OK) {\n          threads.delete(thread);\n        } else if (status === thread_status.LUA_YIELD) {\n          thread.sleep = luaL_checknumber(L, 1);\n        } else {\n          console.log('[JS] Something went wrong during execution');\n          console.log(to_jsstring(luaL_tolstring(L, -1)));\n          lua_pop(L, 2);\n        }\n      }\n    }\n\n    this.t = t;\n  }\n\n  addHandle(handle: JassHandle): JassHandle {\n    if (handle.handleId === -1) {\n      let handleId;\n\n      if (this.freeHandles.length) {\n        handleId = <number>this.freeHandles.pop();\n      } else {\n        handleId = this.handle++;\n      }\n\n      this.handles[handleId] = handle;\n\n      handle.handleId = handleId;\n    }\n\n    return handle;\n  }\n\n  freeHandle(handle: JassHandle): void {\n    if (handle.handleId !== -1) {\n      this.freeHandles.push(handle.handleId);\n\n      this.handles[handle.handleId] = null;\n\n      handle.handleId = -1;\n    }\n  }\n\n  call(name?: string | number): void {\n    const L = this.L;\n\n    if (typeof name === 'string') {\n      lua_getglobal(L, name);\n    } else if (typeof name === 'number') {\n      lua_rawgeti(L, LUA_REGISTRYINDEX, name);\n    }\n\n    if (lua_pcall(L, 0, 0, 0)) {\n      console.log('Something went wrong during execution');\n      console.log(to_jsstring(luaL_tolstring(L, -1)));\n      lua_pop(L, 2);\n    }\n  }\n\n  run(code: string, isJass: boolean): void {\n    const L = this.L;\n\n    if (isJass) {\n      code = jass2lua(code);\n    }\n\n    if (luaL_loadstring(L, to_luastring(code))) {\n      console.log('Something went wrong during execution');\n      console.log(to_jsstring(luaL_tolstring(L, -1)));\n      lua_pop(L, 2);\n    }\n\n    if (lua_pcall(L, 0, 0, 0)) {\n      console.log('Something went wrong during execution');\n      console.log(to_jsstring(luaL_tolstring(L, -1)));\n      lua_pop(L, 2);\n    }\n  }\n\n  open(map: War3Map): void {\n    this.map = map;\n\n    const file = map.getScriptFile();\n\n    if (file) {\n      const buffer = file.text();\n\n      if (buffer) {\n        const isJass = file.name.endsWith('.j');\n\n        this.run(buffer, isJass);\n      }\n    }\n  }\n}\n","import unique from '../../../common/arrayunique';\nimport { basename } from '../../../common/path';\nimport { Animation, InterpolationType } from '../../../parsers/mdlx/animations';\nimport AnimatedObject from '../../../parsers/mdlx/animatedobject';\nimport GenericObject from '../../../parsers/mdlx/genericobject';\nimport Extent from '../../../parsers/mdlx/extent';\nimport Sequence from '../../../parsers/mdlx/sequence';\nimport Texture from '../../../parsers/mdlx/texture';\nimport Material from '../../../parsers/mdlx/material';\nimport Layer from '../../../parsers/mdlx/layer';\nimport TextureAnimation from '../../../parsers/mdlx/textureanimation';\nimport Geoset from '../../../parsers/mdlx/geoset';\nimport GeosetAnimation from '../../../parsers/mdlx/geosetanimation';\nimport Bone from '../../../parsers/mdlx/bone';\nimport Light from '../../../parsers/mdlx/light';\nimport Helper from '../../../parsers/mdlx/helper';\nimport Attachment from '../../../parsers/mdlx/attachment';\nimport ParticleEmitter from '../../../parsers/mdlx/particleemitter';\nimport ParticleEmitter2 from '../../../parsers/mdlx/particleemitter2';\nimport ParticleEmitterPopcorn from '../../../parsers/mdlx/particleemitterpopcorn';\nimport RibbonEmitter from '../../../parsers/mdlx/ribbonemitter';\nimport EventObject from '../../../parsers/mdlx/eventobject';\nimport Camera from '../../../parsers/mdlx/camera';\nimport CollisionShape from '../../../parsers/mdlx/collisionshape';\nimport FaceEffect from '../../../parsers/mdlx/faceeffect';\nimport SanityTestData from './data';\nimport testTracks from './tracks';\nimport { SanityTestNode } from './data';\n\nexport function isBetween(x: number, minVal: number, maxVal: number): boolean {\n  return x >= minVal && x <= maxVal;\n}\n\nexport const sequenceNames = new Set([\n  'attack',\n  'birth',\n  'cinematic',\n  'death',\n  'decay',\n  'dissipate',\n  'morph',\n  'portrait',\n  'sleep',\n  'spell',\n  'stand',\n  'walk',\n  'ready', // HeroMountainKing.mdx has \"Alternate Ready\" which I assume is the same as or a replacement to \"Alternate Stand Ready\"?\n]);\n\nexport const replaceableIds = new Set([\n  1,\n  2,\n  11,\n  21,\n  31,\n  32,\n  33,\n  34,\n  35,\n  36,\n  37,\n]);\n\nexport const animatedTypeNames = new Map([\n  // Layer\n  ['KMTF', 'Texture ID'],\n  ['KMTA', 'Alpha'],\n  ['KMTE', 'Emissive Gain'],\n  ['KFC3', 'Fresnel Color'],\n  ['KFCA', 'Fresnel Opacity'],\n  ['KFTC', 'Fresnel Team Color'],\n  // TextureAnimation\n  ['KTAT', 'Translation'],\n  ['KTAR', 'Rotation'],\n  ['KTAS', 'Scaling'],\n  // GeosetAnimation\n  ['KGAO', 'Alpha'],\n  ['KGAC', 'Color'],\n  // GenericObject\n  ['KGTR', 'Translation'],\n  ['KGRT', 'Rotation'],\n  ['KGSC', 'Scaling'],\n  // Light\n  ['KLAS', 'Attenuation Start'],\n  ['KLAE', 'Attenuation End'],\n  ['KLAC', 'Color'],\n  ['KLAI', 'Intensity'],\n  ['KLBI', 'Ambient Intensity'],\n  ['KLBC', 'Ambient Color'],\n  ['KLAV', 'Visibility'],\n  // Attachment\n  ['KATV', 'Visibility'],\n  // ParticleEmitter\n  ['KPEE', 'Emission Rate'],\n  ['KPEG', 'Gravity'],\n  ['KPLN', 'Longitude'],\n  ['KPLT', 'Latitude'],\n  ['KPEL', 'Lifespan'],\n  ['KPES', 'Speed'],\n  ['KPEV', 'Visibility'],\n  // ParticleEmitter2\n  ['KP2E', 'Emission Rate'],\n  ['KP2G', 'Gravity'],\n  ['KP2L', 'Latitude'],\n  ['KP2R', 'Variation'],\n  ['KP2N', 'Length'],\n  ['KP2W', 'Width'],\n  ['KP2S', 'Speed'],\n  ['KP2V', 'Visibility'],\n  // ParticleEmitterCorn\n  ['KPPA', 'Alpha'],\n  ['KPPC', 'Color'],\n  ['KPPE', 'EmissionRate'],\n  ['KPPL', 'LifeSpan'],\n  ['KPPS', 'Speed'],\n  ['KPPV', 'Visibility'],\n  // RibbonEmitter\n  ['KRHA', 'Height Above'],\n  ['KRHB', 'Height Below'],\n  ['KRAL', 'Alpha'],\n  ['KRCO', 'Color'],\n  ['KRTX', 'Texture Slot'],\n  ['KRVS', 'Visibility'],\n  // Camera\n  ['KCTR', 'Translation'],\n  ['KTTR', 'Rotation'],\n  ['KCRL', 'Target Translation'],\n]);\n\nexport function hasAnimation(object: AnimatedObject, name: string): boolean {\n  for (const animation of object.animations) {\n    if (animation.name === name) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport type MdlxType = Extent | Sequence | number | Texture | Material | Layer | TextureAnimation | Geoset | GeosetAnimation | Bone | Light | Helper | Attachment | ParticleEmitter | ParticleEmitter2 | ParticleEmitterPopcorn | RibbonEmitter | EventObject | Camera | CollisionShape | FaceEffect | Animation;\n\nexport function getObjectTypeName(object: MdlxType): string {\n  if (object instanceof Extent) {\n    return 'Extent';\n  } else if (object instanceof Sequence) {\n    return 'Sequence';\n  } else if (typeof object === 'number') {\n    return 'GlobalSequence';\n  } else if (object instanceof Texture) {\n    return 'Texture';\n  } else if (object instanceof Material) {\n    return 'Material';\n  } else if (object instanceof Layer) {\n    return 'Layer';\n  } else if (object instanceof TextureAnimation) {\n    return 'TextureAnimation';\n  } else if (object instanceof Geoset) {\n    return 'Geoset';\n  } else if (object instanceof GeosetAnimation) {\n    return 'GeosetAnimation';\n  } else if (object instanceof Bone) {\n    return 'Bone';\n  } else if (object instanceof Light) {\n    return 'Light';\n  } else if (object instanceof Helper) {\n    return 'Helper';\n  } else if (object instanceof Attachment) {\n    return 'Attachment';\n  } else if (object instanceof ParticleEmitter) {\n    return 'ParticleEmitter';\n  } else if (object instanceof ParticleEmitter2) {\n    return 'ParticleEmitter2';\n  } else if (object instanceof ParticleEmitterPopcorn) {\n    return 'ParticleEmitterPopcorn';\n  } else if (object instanceof RibbonEmitter) {\n    return 'RibbonEmitter';\n  } else if (object instanceof EventObject) {\n    return 'EventObject';\n  } else if (object instanceof Camera) {\n    return 'Camera';\n  } else if (object instanceof CollisionShape) {\n    return 'CollisionShape';\n  } else if (object instanceof FaceEffect) {\n    return 'FaceEffect';\n  } else if (object instanceof Animation) {\n    return <string>animatedTypeNames.get(object.name);\n  } else {\n    console.warn('Unknown object type', object);\n    return 'Unknown';\n  }\n}\n\nexport function getObjectName(object: MdlxType, index: number): string {\n  let name = getObjectTypeName(object);\n\n  if (!(object instanceof Animation) && !(object instanceof Extent)) {\n    name += ` ${index}`;\n  }\n\n  if (object instanceof Sequence || object instanceof GenericObject || object instanceof Camera) {\n    name += ` - \"${object.name}\"`;\n  }\n\n  if (object instanceof Texture || object instanceof FaceEffect) {\n    if (object.path.length) {\n      name += ` - \"${basename(object.path)}\"`;\n    }\n\n    if (object instanceof Texture) {\n      if (object.replaceableId === 1) {\n        name += ' - Team color';\n      } else if (object.replaceableId === 2) {\n        name += ' - Team glow';\n      } else if (object.replaceableId > 0) {\n        name += ` - Replaceable ID ${object.replaceableId}`;\n      }\n    }\n  }\n\n  return name;\n}\n\nexport function testObjects<T extends MdlxType>(data: SanityTestData, objects: T[], handler?: (data: SanityTestData, object: T, index: number) => void): void {\n  const l = objects.length;\n\n  if (l) {\n    const isAnimated = objects[0] instanceof AnimatedObject;\n    const isGeneric = objects[0] instanceof GenericObject;\n\n    for (let i = 0; i < l; i++) {\n      const object = objects[i];\n\n      data.push(object, i);\n\n      if (handler) {\n        handler(data, object, i);\n      }\n\n      if (isAnimated) {\n        const asAnimated = <AnimatedObject>object;\n\n        testObjects(data, asAnimated.animations, testAnimation);\n      }\n\n      if (isGeneric) {\n        const asGeneric = <GenericObject>object;\n\n        const objectId = asGeneric.objectId;\n        const parentId = asGeneric.parentId;\n\n        data.assertError(parentId === -1 || hasGenericObject(data, parentId), `Invalid parent ${parentId}`);\n        data.assertError(objectId !== parentId, 'Same object and parent');\n      }\n\n      data.pop();\n    }\n  }\n}\n\nexport function testAndGetReference<T extends MdlxType>(data: SanityTestData, objects: T[], index: number, typeNameIfError: string): T | undefined {\n  if (index >= 0 && index < objects.length) {\n    data.addReference(objects[index]);\n\n    return objects[index];\n  } else {\n    data.addError(`Invalid ${typeNameIfError} ${index}`);\n\n    return;\n  }\n}\n\nexport function testReference<T extends MdlxType>(data: SanityTestData, objects: T[], index: number, typeNameIfError: string): boolean {\n  // This explicit test against undefined is needed because global sequences are numbers and could be equal to 0.\n  return testAndGetReference(data, objects, index, typeNameIfError) !== undefined;\n}\n\n/**\n * Get all of the texture indices referenced by a layer.\n */\nexport function getTextureIds(layer: Layer): number[] {\n  for (const animation of layer.animations) {\n    if (animation.name === 'KMTF') {\n      return unique(animation.values.map((value) => value[0]));\n    }\n  }\n\n  return [layer.textureId];\n}\n\nfunction testVertexSkinning(data: SanityTestData, vertex: number, bone: number, isHd: boolean): void {\n  const object = data.objects[bone];\n\n  if (isHd) {\n    data.assertError(isBetween(bone, 0, 255), `Vertex ${vertex}: References bone ${bone} but there can only be 256 bones in an HD model`);\n  }\n\n  if (object) {\n    if (!(object instanceof Bone)) {\n      data.addSevere(`Vertex ${vertex}: Attached to \"${object.name}\" which is not a bone`);\n    } else {\n      // Add a use for this bone, to check later if bones have vertices attached to them.\n      const uses = data.boneUsageMap.get(bone) || 0;\n     \n      data.boneUsageMap.set(bone, uses + 1);\n    }\n  } else {\n    data.addError(`Vertex ${vertex}: Attached to object ${bone} which does not exist`);\n  }\n}\n\n/**\n * Test geoset skinning.\n */\nexport function testGeosetSkinning(data: SanityTestData, geoset: Geoset): void {\n  if (data.model.version > 800 && geoset.skin.length) {\n    data.assertWarning(geoset.vertexGroups.length === 0, 'This geoset has both skin/weights and vertex groups');\n\n    const skin = geoset.skin;\n\n    for (let i = 0, l = skin.length / 8; i < l; i++) {\n      const offset = i * 8;\n      const bone0 = skin[offset];\n      const bone1 = skin[offset + 1];\n      const bone2 = skin[offset + 2];\n      const bone3 = skin[offset + 3];\n      const weight0 = skin[offset + 4];\n      const weight1 = skin[offset + 5];\n      const weight2 = skin[offset + 6];\n      const weight3 = skin[offset + 7];\n\n      if (weight0 > 0) {\n        testVertexSkinning(data, i, bone0, true);\n      }\n\n      if (weight1 > 0) {\n        testVertexSkinning(data, i, bone1, true);\n      }\n\n      if (weight2 > 0) {\n        testVertexSkinning(data, i, bone2, true);\n      }\n\n      if (weight3 > 0) {\n        testVertexSkinning(data, i, bone3, true);\n      }\n\n      const weight = weight0 + weight1 + weight2 + weight3;\n\n      if (weight === 0) {\n        data.addSevere(`Vertex ${i}: Not attached to anything`);\n      } else if (weight !== 255) {\n        data.addSevere(`Vertex ${i}: The weights are not normalized to 1`);\n      }\n    }\n  } else {\n    // A model having no bones at all is also valid.\n    // I don't know if the skinning information in that case can be anything whatsoever, or if there are rules.\n    if (data.model.bones.length) {\n      const vertexGroups = geoset.vertexGroups;\n      const matrixGroups = geoset.matrixGroups;\n      const matrixIndices = geoset.matrixIndices;\n      const slices = [];\n\n      for (let i = 0, l = matrixGroups.length, k = 0; i < l; i++) {\n        slices.push(matrixIndices.subarray(k, k + matrixGroups[i]));\n        k += matrixGroups[i];\n      }\n\n      for (let i = 0, l = vertexGroups.length; i < l; i++) {\n        const slice = slices[vertexGroups[i]];\n\n        if (slice) {\n          for (const bone of slice) {\n            testVertexSkinning(data, i, bone, false);\n          }\n        } else {\n          const vertexGroup = vertexGroups[i];\n\n          if (vertexGroup === 255) {\n            data.addSevere(`Vertex ${i}: Not attached to anything`);\n          } else {\n            data.addSevere(`Vertex ${i}: Attached to vertex group ${vertexGroup} which does not exist`);\n          }\n        }\n      }\n    }\n  }\n}\n\n/**\n * Is the given ID a valid generic object?\n */\nfunction hasGenericObject(data: SanityTestData, id: number): boolean {\n  for (const object of data.objects) {\n    if (object.objectId === id) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function testAnimation(data: SanityTestData, animation: Animation): void {\n  const name = animation.name;\n  const interpolationType = animation.interpolationType;\n\n  // Particle emitter 2 variation animations are not implemented in Magos for the MDX format.\n  data.assertWarning(name !== 'KP2R', 'Using a variation animation.');\n\n  // Particle emitter 2 gravity animations are not implemented in Magos for the MDX format.\n  data.assertWarning(name !== 'KP2G', 'Using a gravity animation.');\n\n  // The game seems to force visiblity (and others?) interpolation types to none.\n  data.assertWarning(animatedTypeNames.get(name) !== 'Visibility' || interpolationType === InterpolationType.DontInterp, 'Interpolation type not set to None');\n\n  testTracks(data, animation);\n}\n\nexport function cleanNode(node: SanityTestNode): void {\n  const nodes = node.nodes;\n\n  for (let i = nodes.length - 1; i >= 0; i--) {\n    const child = nodes[i];\n\n    if (child.type === 'node') {\n      if (child.errors || child.severe || child.warnings || child.unused || (child.uses !== undefined && !child.uses)) {\n        cleanNode(child);\n      } else {\n        nodes.splice(i, 1);\n      }\n    }\n  }\n}\n\nexport function getAnimation(object: AnimatedObject, name: string): Animation | undefined {\n  for (const animation of object.animations) {\n    if (animation.name === name) {\n      return animation;\n    }\n  }\n\n  return;\n}\n\nexport function testExtent(data: SanityTestData, extent: Extent): void {\n  data.push(extent, 0);\n\n  const { max, min } = extent;\n\n  if ((max[0] - min[0] < 0) || (max[1] - min[1] < 0) || (max[2] - min[2] < 0)) {\n    data.addWarning('Negative extents');\n  }\n\n  data.pop();\n}\n\n/*\nlet attachmentNames = new Set([\n    'chest',\n    'feet',\n    'foot',\n    'hand',\n    'head',\n    'origin',\n    'overhead',\n    'sprite',\n    'weapon',\n]);\n\nlet attachmentQualifiers = new Set([\n    'alternate',\n    'left',\n    'mount',\n    'right',\n    'rear',\n    'smart',\n    'first',\n    'second',\n    'third',\n    'fourth',\n    'fifth',\n    'sixth',\n    'small',\n    'medium',\n    'large',\n    'gold',\n    'rallypoint',\n    'eattree',\n]);\n\nfunction testAttachmentName(attachment) {\n    let tokens = attachment.node.name.toLowerCase().trim().split(/\\s+/),\n        valid = true;\n\n    if (tokens.length > 1) {\n        let names = attachmentNames,\n            firstToken = tokens[0],\n            lastToken = tokens[tokens.length - 1];\n\n        if (!names.has(tokens[0]) || lastToken !== 'ref') {\n            valid = false;\n        }\n\n        if (tokens.length > 2) {\n            let qualifiers = attachmentQualifiers;\n\n            for (let i = 1, l = tokens.length - 1; i < l; i++) {\n                if (!qualifiers.has(tokens[i])) {\n                    valid = false;\n                }\n            }\n        }\n    } else {\n        valid = false;\n    }\n\n    return valid;\n}\n*/\n","interface PrimitiveShape {\n  vertices: Float32Array;\n  uvs: Float32Array;\n  faces: Uint16Array;\n  edges: Uint16Array;\n  boundingRadius: number;\n}\n\n/**\n * Creates a rectangle geometry object.\n */\nexport function createRectangle(w: number, d: number): PrimitiveShape {\n  return {\n    vertices: new Float32Array([-w, d, 0, -w, -d, 0, w, -d, 0, w, d, 0]),\n    uvs: new Float32Array([0, 0, 0, 1, 1, 1, 1, 0]),\n    faces: new Uint16Array([0, 1, 2, 0, 2, 3]),\n    edges: new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0]),\n    boundingRadius: Math.hypot(w, d),\n  };\n}\n\n/**\n * Creates a unit rectangle geometry object.\n */\nexport function createUnitRectangle(): PrimitiveShape {\n  return createRectangle(1, 1);\n}\n\n/**\n * Creates a cube geometry object.\n */\nexport function createCube(w: number, d: number, h: number): PrimitiveShape {\n  return {\n    vertices: new Float32Array([-w, -d, -h, -w, -d, h, -w, d, -h, -w, d, h, w, d, -h, w, d, h, w, -d, -h, w, -d, h]),\n    uvs: new Float32Array([0, 0, 0, 1, 0.25, 0, 0.25, 1, 0.5, 0, 0.5, 1, 0.75, 0, 0.75, 1]),\n    faces: new Uint16Array([0, 1, 2, 1, 3, 2, 2, 3, 4, 3, 5, 4, 4, 5, 6, 5, 7, 6, 6, 7, 0, 7, 1, 0, 0, 2, 4, 0, 4, 6, 1, 5, 3, 1, 7, 5]),\n    edges: new Uint16Array([0, 1, 2, 3, 4, 5, 6, 7, 0, 2, 2, 4, 4, 6, 6, 0, 1, 3, 3, 5, 5, 7, 7, 1]),\n    boundingRadius: Math.hypot(w, d, h),\n  };\n}\n\n/**\n * Creates a unit cube geometry object.\n */\nexport function createUnitCube(): PrimitiveShape {\n  return createCube(1, 1, 1);\n}\n\n/**\n * Creates a sphere geometry object.\n */\nexport function createSphere(radius: number, stacks: number, slices: number): PrimitiveShape {\n  const points = (stacks + 1) * (slices + 1);\n  const vertices = new Float32Array(points * 3);\n  const uvs = new Float32Array(points * 2);\n  const faces = new Uint16Array(stacks * slices * 6);\n  const edges = new Uint16Array(stacks * slices * 6);\n\n  for (let stack = 0, vOffset = 0, uOffset = 0; stack <= stacks; stack++) {\n    const theta = stack * Math.PI / stacks;\n    const sinTheta = Math.sin(theta);\n    const cosTheta = Math.cos(theta);\n\n    for (let slice = 0; slice <= slices; slice += 1, vOffset += 3, uOffset += 2) {\n      const phi = slice * 2 * Math.PI / slices;\n      const sinPhi = Math.sin(phi);\n      const cosPhi = Math.cos(phi);\n\n      vertices[vOffset + 0] = cosPhi * sinTheta * radius;\n      vertices[vOffset + 1] = sinPhi * sinTheta * radius;\n      vertices[vOffset + 2] = cosTheta * radius;\n\n      uvs[uOffset + 0] = slice / slices;\n      uvs[uOffset + 1] = 1 - (stack / stacks);\n    }\n  }\n\n  for (let stack = 0, fOffset = 0; stack < stacks; stack++) {\n    for (let slice = 0; slice < slices; slice += 1, fOffset += 6) {\n      const first = (stack * (slices + 1)) + slice;\n      const second = first + slices + 1;\n\n      // Faces\n      faces[fOffset + 0] = first;\n      faces[fOffset + 1] = second;\n      faces[fOffset + 2] = first + 1;\n\n      faces[fOffset + 3] = second;\n      faces[fOffset + 4] = second + 1;\n      faces[fOffset + 5] = first + 1;\n\n      // Edges\n      edges[fOffset + 0] = first;\n      edges[fOffset + 1] = second;\n\n      edges[fOffset + 2] = first;\n      edges[fOffset + 3] = first + 1;\n\n      edges[fOffset + 4] = second;\n      edges[fOffset + 5] = second + 1;\n    }\n  }\n\n  return {\n    vertices: vertices,\n    uvs: uvs,\n    faces: faces,\n    edges: edges,\n    boundingRadius: radius,\n  };\n}\n\n/**\n * Creates a unit sphere geometry object.\n */\nexport function createUnitSphere(stacks: number, slices: number): PrimitiveShape {\n  return createSphere(1, stacks, slices);\n}\n\n/**\n * Creates a cylinder geometry object.\n */\nexport function createCylinder(radius: number, height: number, slices: number): PrimitiveShape {\n  slices = Math.max(slices, 3);\n\n  const points = (slices + 1) * 2 + 2;\n  const vertices = new Float32Array(points * 3);\n  const uvs = new Float32Array(points * 2);\n  const faces = new Uint16Array(slices * 12);\n  const edges = new Uint16Array(slices * 10);\n  const step = (Math.PI * 2) / slices;\n  let vOffset = 0;\n  let uOffset = 0;\n\n  for (let slice = 0; slice < slices + 1; slice += 1, vOffset += 6, uOffset += 4) {\n    const x = Math.cos(step * slice) * radius;\n    const y = Math.sin(step * slice) * radius;\n    const u = slice / slices;\n\n    vertices[vOffset + 0] = x;\n    vertices[vOffset + 1] = y;\n    vertices[vOffset + 2] = height;\n    vertices[vOffset + 3] = x;\n    vertices[vOffset + 4] = y;\n    vertices[vOffset + 5] = -height;\n\n    uvs[uOffset + 0] = u;\n    uvs[uOffset + 1] = 1;\n    uvs[uOffset + 2] = u;\n    uvs[uOffset + 3] = 0;\n  }\n\n  // Poles\n  vertices[vOffset + 0] = 0;\n  vertices[vOffset + 1] = 0;\n  vertices[vOffset + 2] = height;\n\n  vertices[vOffset + 3] = 0;\n  vertices[vOffset + 4] = 0;\n  vertices[vOffset + 5] = -height;\n\n  uvs[uOffset + 0] = 0;\n  uvs[uOffset + 1] = 1;\n\n  uvs[uOffset + 2] = 0;\n  uvs[uOffset + 3] = 0;\n\n  for (let slice = 0, fOffset = 0, eOffset = 0; slice < slices; slice += 1, fOffset += 12, eOffset += 10) {\n    const first = slice * 2;\n\n    // Faces\n    faces[fOffset + 0] = first + 0;\n    faces[fOffset + 1] = first + 1;\n    faces[fOffset + 2] = (first + 3) % (points - 2);\n\n    faces[fOffset + 3] = first + 0;\n    faces[fOffset + 4] = (first + 3) % (points - 2);\n    faces[fOffset + 5] = (first + 2) % (points - 2);\n\n    faces[fOffset + 6] = first + 0;\n    faces[fOffset + 7] = (first + 2) % (points - 2);\n    faces[fOffset + 8] = points - 2;\n\n    faces[fOffset + 9] = first + 1;\n    faces[fOffset + 10] = (first + 3) % (points - 2);\n    faces[fOffset + 11] = points - 1;\n\n    // Edges\n    edges[eOffset + 0] = first + 0;\n    edges[eOffset + 1] = first + 1;\n\n    edges[eOffset + 2] = first + 0;\n    edges[eOffset + 3] = (first + 2) % (points - 2);\n\n    edges[eOffset + 4] = first + 1;\n    edges[eOffset + 5] = (first + 3) % (points - 2);\n\n    edges[eOffset + 6] = first + 0;\n    edges[eOffset + 7] = points - 2;\n\n    edges[eOffset + 8] = first + 1;\n    edges[eOffset + 9] = points - 1;\n  }\n\n  return {\n    vertices: vertices,\n    uvs: uvs,\n    faces: faces,\n    edges: edges,\n    boundingRadius: Math.hypot(radius, height),\n  };\n}\n\n/**\n * Creates a unit cylinder geometry object.\n */\nexport function createUnitCylinder(slices: number): PrimitiveShape {\n  return createCylinder(1, 1, slices);\n}\n\n/**\n * Create a furstum geometry.\n */\nexport function createFrustum(fieldOfView: number, aspectRatio: number, nearClipPlane: number, farClipPlane: number): PrimitiveShape {\n  const tanFov = 2 * Math.tan(fieldOfView / 2);\n  const nearHeight = (tanFov * nearClipPlane) / 2;\n  const nearWidth = (nearClipPlane * aspectRatio) / 2;\n  const farHeight = (tanFov * farClipPlane) / 2;\n  const farWidth = (farClipPlane * aspectRatio) / 2;\n\n  return {\n    vertices: new Float32Array([\n      -nearWidth, -nearHeight, nearClipPlane,\n      -nearWidth, nearHeight, nearClipPlane,\n      -farWidth, -farHeight, farClipPlane,\n      -farWidth, farHeight, farClipPlane,\n      farWidth, -farHeight, farClipPlane,\n      farWidth, farHeight, farClipPlane,\n      nearWidth, -nearHeight, nearClipPlane,\n      nearWidth, nearHeight, nearClipPlane]),\n    uvs: new Float32Array([0, 0, 0, 1, 0.25, 0, 0.25, 1, 0.5, 0, 0.5, 1, 0.75, 0, 0.75, 1]),\n    faces: new Uint16Array([0, 1, 2, 1, 3, 2, 2, 3, 4, 3, 5, 4, 4, 5, 6, 5, 7, 6, 6, 7, 0, 7, 1, 0, 0, 2, 4, 0, 4, 6, 1, 5, 3, 1, 7, 5]),\n    edges: new Uint16Array([0, 1, 2, 3, 4, 5, 6, 7, 0, 2, 2, 4, 4, 6, 6, 0, 1, 3, 3, 5, 5, 7, 7, 1]),\n    boundingRadius: Math.hypot(farWidth, farHeight),\n  };\n}\n","import Trigger from '../../../parsers/w3x/wtg/trigger';\nimport ECA from '../../../parsers/w3x/wtg/eca';\nimport Parameter from '../../../parsers/w3x/wtg/parameter';\nimport SubParameters from '../../../parsers/w3x/wtg/subparameters';\nimport WeuData from './data';\nimport { createCustomScriptECA, ensureNameSafety } from './utils';\n\n/**\n * A list of vanilla operators that take 3 parameters.\n * The only one not here, which takes 2 parameters, is OperatorString.\n */\nconst OPERATOR_NAMES = new Set([\n  'OperatorCompareBoolean',\n  'OperatorCompareAbilityId',\n  'OperatorCompareBuffId',\n  'OperatorCompareDestructible',\n  'OperatorCompareDestructableCode',\n  'OperatorCompareButton',\n  'OperatorCompareGameDifficulty',\n  'OperatorCompareGameSpeed',\n  'OperatorCompareHeroSkill',\n  'OperatorCompareInteger',\n  'OperatorCompareItem',\n  'OperatorCompareItemType',\n  'OperatorCompareItemCode',\n  'OperatorCompareMouseButton',\n  'OperatorCompareMeleeDifficulty',\n  'OperatorCompareOrderCode',\n  'OperatorComparePlayer',\n  'OperatorComparePlayerColor',\n  'OperatorComparePlayerControl',\n  'OperatorComparePlayerSlotStatus',\n  'OperatorCompareRace',\n  'OperatorCompareReal',\n  'OperatorCompareString',\n  'OperatorCompareTechCode',\n  'OperatorCompareTerrainType',\n  'OperatorCompareTrigger',\n  'OperatorCompareUnit',\n  'OperatorCompareUnitCode',\n  'OperatorInt',\n  'OperatorReal',\n]);\n\n/**\n * A list of vanilla functions which have an implicit code parameter.\n * The control flow \"functions\" such as IfThenElseMultiple and ForLoopAMultiple are handled specifically.\n */\nconst HAS_IMPLICIT_CODE = new Set([\n  'EnumDestructablesInRectAllMultiple',\n  'EnumDestructablesInCircleBJMultiple',\n  'EnumItemsInRectBJMultiple',\n  'ForForceMultiple',\n  'ForGroupMultiple',\n]);\n\n/**\n * Converts a Trigger to a custom script string.\n * Callbacks that are generated due to the conversion are added to the input callbacks array.\n */\nexport function convertTrigger(data: WeuData, trigger: Trigger, callbacks: string[]): string {\n  const name = ensureNameSafety(trigger.name);\n  const events = [];\n  const conditions = [];\n  const actions = [];\n\n  // Separate the events/conditions/actions.\n  for (const eca of trigger.ecas) {\n    if (eca.type === 0) {\n      events.push(eca);\n    } else if (eca.type === 1) {\n      conditions.push(eca);\n    } else {\n      actions.push(eca);\n    }\n  }\n\n  const functions = [];\n\n  if (events.length || conditions.length || actions.length) {\n    const initBody = [];\n    const conditionsBody = [];\n    const actionsBody = [];\n\n    // Reference the global trigger that WE generates.\n    const triggerName = `gg_trg_${name}`;\n\n    // Events don't explicitly define the trigger parameter.\n    // Therefore it is created here, and prepended below to the parameters of each event.\n    const triggerParameter = new Parameter();\n    triggerParameter.type = 3;\n    triggerParameter.value = triggerName;\n\n    initBody.push(`set ${triggerName} = CreateTrigger()`);\n\n    // Convert the events.\n    for (const event of events) {\n      event.parameters.unshift(triggerParameter);\n\n      for (const eca of convertFunctionCall(data, event, callbacks)) {\n        initBody.push(eca.parameters[0].value);\n      }\n    }\n\n    // Convert the conditions.\n    if (conditions.length) {\n      initBody.push(`call TriggerAddCondition(${triggerName}, Condition(function Trig_${name}_Conditions)`);\n\n      for (const condition of conditions) {\n        for (const eca of convertFunctionCall(data, condition, callbacks)) {\n          conditionsBody.push(`if ${eca.parameters[0].value} then\\r\\n return true\\r\\nendif`);\n        }\n      }\n    }\n\n    // Convert the actions.\n    if (actions.length) {\n      initBody.push(`call TriggerAddAction(${triggerName}, function Trig_${name}_Actions)`);\n\n      for (const action of actions) {\n        for (const eca of convertFunctionCall(data, action, callbacks)) {\n          actionsBody.push(eca.parameters[0].value);\n        }\n      }\n    }\n\n    // Add the actions function.\n    if (actionsBody.length) {\n      functions.push(`function Trig_${name}_Actions takes nothing returns nothing\\r\\n${actionsBody.join('\\r\\n')}\\r\\nendfunction`);\n    }\n\n    // Add the conditions function.\n    if (conditionsBody.length) {\n      functions.push(`function Trig_${name}_Conditions takes nothing returns boolean\\r\\n${conditionsBody.join('\\r\\n')}\\r\\nreturn false\\r\\nendfunction`);\n    }\n\n    // Add the initalization function.\n    functions.push(`function InitTrig_${name} takes nothing returns nothing\\r\\n${initBody.join('\\r\\n')}\\r\\nendfunction`);\n  }\n\n  // Finally, return the whole trigger as Jass.\n  return functions.join('\\r\\n');\n}\n\n/**\n * Converts an ECA or SubParameters to an array of custom script ECAs.\n * Callbacks that are generated due to the conversion are added to the input callbacks array.\n */\nexport function convertFunctionCall(data: WeuData, object: ECA | SubParameters, callbacks: string[]): ECA[] {\n  const name = object.name;\n  const ecas: string[] = [];\n  const parameters = object.parameters;\n  const signature = data.triggerData.getFunction(object.type, object.name);\n\n  if (!signature) {\n    throw new Error(`Could not find a function signature: ${name}. Stack: ${data.stackToString()}`);\n  }\n\n  let { args, scriptName } = signature;\n  const argCount = args.length;\n  let isCode = false;\n  let isBoolexpr = false;\n  let isScriptCode = false;\n  const ecaObject = <ECA>object; // Get correct typing for the cases where the object is known to be an ECA.\n\n  scriptName = scriptName || object.name;\n\n  if (argCount) {\n    const lastArg = args[argCount - 1];\n\n    if (lastArg === 'code' || HAS_IMPLICIT_CODE.has(name)) {\n      isCode = true;\n    } else if (lastArg === 'boolexpr') {\n      isBoolexpr = true;\n    } else if (lastArg === 'scriptcode') {\n      isScriptCode = true;\n    }\n  }\n\n  // IfThenElse and other control flow \"functions\" must come before the generic code/boolexpr callback handling, since they don't follow the same rules.\n  if (name === 'IfThenElse') {\n    ecas.push(`if ${convertParameter(data, parameters[0], args[0], callbacks)} then`);\n    ecas.push(`call ${convertParameter(data, parameters[1], args[1], callbacks)}`);\n    ecas.push('else');\n    ecas.push(`call ${convertParameter(data, parameters[2], args[2], callbacks)}`);\n    ecas.push('endif');\n  } else if (name === 'OrMultiple') {\n    ecas.push(ecaObject.ecas.slice().map((eca) => convertFunctionCall(data, eca, callbacks).map((eca) => eca.parameters[0].value)).join(' or '));\n  } else if (name === 'AndMultiple') {\n    ecas.push(ecaObject.ecas.slice().map((eca) => convertFunctionCall(data, eca, callbacks).map((eca) => eca.parameters[0].value)).join(' and '));\n  } else if (name === 'ForLoopAMultiple' || name === 'ForLoopBMultiple' || name === 'ForLoopVarMultiple') {\n    let loopName = 'A';\n\n    if (name === 'ForLoopBMultiple') {\n      loopName = 'B';\n    } else if (name === 'ForLoopVarMultiple') {\n      loopName = 'Var';\n    }\n\n    let index;\n\n    if (loopName === 'A' || loopName === 'B') {\n      index = `bj_forLoop${loopName}Index`;\n\n      const indexEnd = `${index}End`;\n\n      ecas.push(`set ${index} = ${convertParameter(data, parameters[0], args[0], callbacks)}`);\n      ecas.push(`set ${indexEnd} = ${convertParameter(data, parameters[1], args[1], callbacks)}`);\n      ecas.push('loop');\n      ecas.push(`exitwhen ${index} > ${indexEnd}`);\n    } else {\n      index = convertParameter(data, parameters[0], args[0], callbacks);\n\n      ecas.push(`set ${index} = ${convertParameter(data, parameters[1], args[1], callbacks)}`);\n      ecas.push('loop');\n      ecas.push(`exitwhen ${index} > ${convertParameter(data, parameters[2], args[2], callbacks)}`);\n    }\n\n    for (const action of ecaObject.ecas) {\n      const replacements = convertFunctionCall(data, action, callbacks);\n\n      for (const replacement of replacements) {\n        ecas.push(`${replacement.parameters[0].value}`);\n      }\n    }\n\n    ecas.push(`set ${index} = ${index} + 1`);\n    ecas.push('endloop');\n  } else if (name === 'IfThenElseMultiple') {\n    let condition;\n    const thenActions = [];\n    const elseActions = [];\n\n    for (const eca of ecaObject.ecas) {\n      if (eca.group === 0) {\n        condition = eca;\n      } else if (eca.group === 1) {\n        thenActions.push(eca);\n      } else if (eca.group === 2) {\n        elseActions.push(eca);\n      }\n    }\n\n    if (condition) {\n      ecas.push(`if ${convertFunctionCall(data, condition, callbacks)[0].parameters[0].value} then`);\n    }\n\n    for (const action of thenActions) {\n      const replacements = convertFunctionCall(data, action, callbacks);\n\n      for (const replacement of replacements) {\n        ecas.push(`${replacement.parameters[0].value}`);\n      }\n    }\n\n    if (elseActions.length) {\n      ecas.push('else');\n\n      for (const action of elseActions) {\n        const replacements = convertFunctionCall(data, action, callbacks);\n\n        for (const replacement of replacements) {\n          ecas.push(`${replacement.parameters[0].value}`);\n        }\n      }\n    }\n\n    ecas.push('endif');\n  } else if (isCode || isBoolexpr) {\n    const triggerName = data.getTriggerName();\n    const callbackName = `Trig_${ensureNameSafety(triggerName)}_Func${callbacks.length}`;\n    let call = `function ${callbackName}`;\n    let returnType = 'nothing';\n    let callOrReturn = 'call';\n    let lastParam = parameters.length - 1;\n    const isMultiple = object.name.endsWith('Multiple');\n\n    if (isBoolexpr) {\n      call = `Filter(${call})`;\n      returnType = 'boolean';\n      callOrReturn = 'return';\n    }\n\n    if (isMultiple) {\n      lastParam = parameters.length;\n    }\n\n    // The callback names are based on where they are in the callback array.\n    // This breaks when one of the convert functions below need to create more callbacks before actually adding this one to the callbacks array.\n    // To solve this, add a placeholder and save the index, and then use the index after converting everything.\n    const callbackIndex = callbacks.length;\n    callbacks[callbackIndex] = 'NOTHING';\n\n    const callParams = [...parameters.slice(0, lastParam).map((value, index) => convertParameter(data, value, args[index], callbacks)), call];\n\n    if (object instanceof ECA) {\n      ecas.push(`call ${scriptName}(${callParams.join(', ')})`);\n    } else {\n      ecas.push(`${scriptName}(${callParams.join(', ')})`);\n    }\n\n    let body;\n\n    if (isMultiple) {\n      body = ecaObject.ecas.map((eca) => convertFunctionCall(data, eca, callbacks).map((customScript) => customScript.parameters[0].value).join('\\r\\n')).join('\\r\\n');\n    } else {\n      body = `${callOrReturn} ${convertParameter(data, parameters[lastParam], args[lastParam], callbacks)}`;\n    }\n\n    // Now use the callback index and replace the placeholder.\n    callbacks[callbackIndex] = `function ${callbackName} takes nothing returns ${returnType}\\r\\n${body}\\r\\nendfunction`;\n  } else if (isScriptCode) {\n    ecas.push(convertParameter(data, ecaObject.parameters[0], 'scriptcode', callbacks));\n  } else if (name === 'SetVariable') {\n    ecas.push(`set ${convertParameter(data, parameters[0], args[0], callbacks)} = ${convertParameter(data, parameters[1], args[1], callbacks)}`);\n  } else if (name === 'OperatorString') { // String concat\n    ecas.push(`${convertParameter(data, parameters[0], args[0], callbacks)} + ${convertParameter(data, parameters[1], args[1], callbacks)}`);\n  } else if (OPERATOR_NAMES.has(name)) { // All other operators\n    ecas.push(`${convertParameter(data, parameters[0], args[0], callbacks)} ${convertParameter(data, parameters[1], args[1], callbacks)} ${convertParameter(data, parameters[2], args[2], callbacks)}`);\n  } else if (name === 'CommentString') { // Comment\n    ecas.push(`// ${parameters[0].value}`);\n  } else if (name === 'GetBooleanAnd') {\n    ecas.push(`(${convertParameter(data, parameters[0], args[0], callbacks)} and ${convertParameter(data, parameters[1], args[1], callbacks)})`);\n  } else if (name === 'GetBooleanOr') {\n    ecas.push(`(${convertParameter(data, parameters[0], args[0], callbacks)} or ${convertParameter(data, parameters[1], args[1], callbacks)})`);\n  } else if (object instanceof ECA) {\n    // If this is a trigger event, there is the implicit trigger parameter at the beginning.\n    if (object.type === 0) {\n      args = ['trigger', ...args];\n    }\n\n    ecas.push(`call ${scriptName}(${parameters.map((value, index) => convertParameter(data, value, args[index], callbacks)).join(', ')})`);\n  } else if (object instanceof SubParameters) {\n    ecas.push(`${scriptName}(${parameters.map((value, index) => convertParameter(data, value, args[index], callbacks)).join(', ')})`);\n  }\n\n  return ecas.map((eca) => createCustomScriptECA(eca));\n}\n\n/**\n * Converts a parameter to custom script.\n * Callbacks that are generated due to the conversion are added to the input callbacks array.\n */\nexport function convertParameter(data: WeuData, parameter: Parameter, dataType: string, callbacks: string[]): string {\n  const { type, value } = parameter;\n\n  if (type === 0) {\n    const preset = data.triggerData.getPreset(value);\n\n    if (preset === undefined) {\n      throw new Error(`Failed to find a preset: \"${value}\"`);\n    }\n\n    return preset;\n  } else if (type === 1) {\n    if (value.startsWith('gg_')) {\n      // Used to track global generated variables and their status.\n      data.updateGUIReference(value, false);\n\n      return value;\n    } else {\n      let global = `udg_${value}`;\n\n      if (parameter.isArray && parameter.arrayIndex) {\n        global += `[${convertParameter(data, parameter.arrayIndex, 'integer', callbacks)}]`;\n      }\n\n      return global;\n    }\n  } else if (parameter.type === 2) {\n    return convertFunctionCall(data, <SubParameters>parameter.subParameters, callbacks)[0].parameters[0].value;\n  } else if (parameter.type === 3) {\n    const baseType = data.triggerData.getBaseType(dataType);\n\n    // \"value\"\n    // scriptcode needs to be converted as-is, and doesn't need quotes.\n    if (baseType === 'string' && dataType !== 'scriptcode') {\n      // Inline string table entries.\n      if (value.startsWith('TRIGSTR') && data.stringTable) {\n        const string = data.stringTable.getString(value);\n\n        if (string !== undefined) {\n          return `\"${string.replace(/\\r\\n/g, '\\\\r\\n')}\"`;\n        } else {\n          data.change('missingstring', 'Entry not found in the string table', value);\n        }\n      }\n\n      return `\"${value.replace(/\\\\/g, '\\\\\\\\')}\"`;\n    }\n\n    // 'value'\n    if (baseType === 'integer' && isNaN(parseInt(value))) {\n      return `'${value}'`;\n    }\n\n    // value\n    return value;\n  } else {\n    return '';\n  }\n}\n\n/**\n * Convert a parameter to a custom script string, discarding any generated callbacks.\n */\nexport function convertParameterInline(data: WeuData, parameter: Parameter, dataType: string): string {\n  return convertParameter(data, parameter, dataType, []);\n}\n","import { vec3, quat } from 'gl-matrix';\n\n// Backwards compat with existing clients.\nexport function setupCamera(scene, options = {}) {\n  return new SimpleOrbitCamera(scene, options);\n}\n\nconst vecHeap = vec3.create();\nconst vecHeap2 = vec3.create();\nconst quatHeap = quat.create();\nconst twistHeap = new Float32Array(1);\n\n// Get the vector length between two touches.\nfunction getTouchesLength(touch1, touch2) {\n  let dx = touch2.clientX - touch1.clientX;\n  let dy = touch2.clientY - touch1.clientY;\n\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\n// Touch modes.\nconst TOUCH_MODE_INVALID = -1;\nconst TOUCH_MODE_ROTATE = 0;\nconst TOUCH_MODE_ZOOM = 1;\n\n// An orbit camera setup example.\n// Left mouse button controls the orbit itself.\n// The right mouse button allows to move the camera and the point it's looking at on the XY plane.\n// Scrolling zooms in and out.\nexport class SimpleOrbitCamera {\n  constructor(scene, options = {}) {\n    this.scene = scene;\n    this.canvas = scene.viewer.canvas;\n    this.camera = scene.camera;\n    // Movement per pixel of movement.\n    this.moveSpeed = options.moveSpeed || 2;\n    // Rotation in radians per pixel of movement.\n    this.rotationSpeed = options.rotationSpeed || (Math.PI / 180);\n    // Zoom factor per scroll.\n    this.zoomFactor = options.zoomFactor || 0.1;\n    this.horizontalAngle = options.horizontalAngle || Math.PI / 2;\n    this.verticalAngle = options.verticalAngle || Math.PI / 4;\n    this.distance = options.distance || 500;\n    this.position = options.position || vec3.create();\n    // What the camera is looking at.\n    this.target = options.target || vec3.create();\n    // The twist angle of the camera, which affects the \"up\" direction.\n    // For example, a twist of 180 degrees, i.e. PI, will flip everything upside down.\n    this.twist = options.twist || 0;\n    // Mouse.\n    this.mouse = { buttons: [false, false, false], x: 0, y: 0, x2: 0, y2: 0 };\n    // Touches.\n    this.touchMode = TOUCH_MODE_INVALID;\n    this.touches = [];\n    this.instance = null;\n    this.onManualChange = options.onManualChange || null;\n    this.fov = options.fov || Math.PI / 4;\n    this.nearClipPlane = options.nearClipPlane || 1;\n    this.farClipPlane = options.farClipPlane || 200000;\n\n    this.update();\n\n    window.addEventListener('resize', (e) => this.onResize());\n    setTimeout(() => this.onResize(), 0);\n\n    // Disable the context menu when right-clicking.\n    this.canvas.addEventListener('contextmenu', (e) => e.preventDefault());\n\n    this.canvas.addEventListener('selectstart', (e) => e.preventDefault());\n\n    // Track mouse clicks.\n    this.canvas.addEventListener('mousedown', (e) => {\n      e.preventDefault();\n\n      this.mouse.buttons[e.button] = true;\n    });\n\n    // And mouse unclicks.\n    // On the whole document rather than the canvas to stop annoying behavior when moving the mouse out of the canvas.\n    document.addEventListener('mouseup', (e) => {\n      e.preventDefault();\n\n      this.mouse.buttons[e.button] = false;\n    });\n\n    // Handle rotating and moving the camera when the mouse moves.\n    window.addEventListener('mousemove', (e) => {\n      this.mouse.x2 = this.mouse.x;\n      this.mouse.y2 = this.mouse.y;\n      this.mouse.x = e.clientX;\n      this.mouse.y = e.clientY;\n\n      let dx = this.mouse.x - this.mouse.x2;\n      let dy = this.mouse.y - this.mouse.y2;\n\n      if (this.mouse.buttons[0]) {\n        this.rotate(dx, dy);\n      }\n\n      if (this.mouse.buttons[2]) {\n        this.move(-dx, dy);\n      }\n    });\n\n    // Handle zooming when the mouse scrolls.\n    this.canvas.addEventListener('wheel', (e) => {\n      e.preventDefault();\n\n      let deltaY = e.deltaY;\n\n      if (e.deltaMode === 1) {\n        deltaY = deltaY / 3 * 100;\n      }\n\n      this.zoom(deltaY / 100);\n    });\n\n    // Listen to touches.\n    // Supports 1 or 2 touch points.\n    this.canvas.addEventListener('touchstart', (e) => {\n      e.preventDefault();\n\n      let targetTouches = e.targetTouches;\n\n      if (targetTouches.length === 1) {\n        this.touchMode = TOUCH_MODE_ROTATE;\n      } else if (targetTouches.length == 2) {\n        this.touchMode = TOUCH_MODE_ZOOM;\n      } else {\n        this.touchMode = TOUCH_MODE_INVALID;\n      }\n\n      this.touches.length = 0;\n      this.touches.push(...targetTouches);\n    });\n\n    this.canvas.addEventListener('touchend', (e) => {\n      e.preventDefault();\n\n      this.touchMode = TOUCH_MODE_INVALID;\n    });\n\n    this.canvas.addEventListener('touchcancel', (e) => {\n      e.preventDefault();\n\n      this.touchMode = TOUCH_MODE_INVALID;\n    });\n\n    // Rotate or zoom based on the touch mode.\n    this.canvas.addEventListener('touchmove', (e) => {\n      e.preventDefault();\n\n      let targetTouches = e.targetTouches;\n\n      if (this.touchMode === TOUCH_MODE_ROTATE) {\n        let oldTouch = this.touches[0];\n        let newTouch = targetTouches[0];\n        let dx = newTouch.clientX - oldTouch.clientX;\n        let dy = newTouch.clientY - oldTouch.clientY;\n\n        this.rotate(dx, dy);\n      } else if (this.touchMode === TOUCH_MODE_ZOOM) {\n        let len1 = getTouchesLength(this.touches[0], this.touches[1]);\n        let len2 = getTouchesLength(targetTouches[0], targetTouches[1]);\n\n        this.zoom((len1 - len2) / 50);\n      }\n\n      this.touches.length = 0;\n      this.touches.push(...targetTouches);\n    });\n  }\n\n  update() {\n    if (this.instance) {\n      let instance = this.instance;\n      let mdxCamera = instance.model.cameras[0];\n\n      mdxCamera.getTranslation(vecHeap, instance.sequence, instance.frame, instance.counter);\n      vec3.add(vecHeap, vecHeap, mdxCamera.position);\n\n      mdxCamera.getTargetTranslation(vecHeap2, instance.sequence, instance.frame, instance.counter);\n      vec3.add(vecHeap2, vecHeap2, mdxCamera.targetPosition);\n\n      mdxCamera.getRotation(twistHeap, instance.sequence, instance.frame, instance.counter);\n      this.twist = twistHeap[0];\n\n      // Change to world space in case the instance was moved in any way.\n      // I am not sure how well this will handle scales, twists, and other things.\n      vec3.transformMat4(vecHeap, vecHeap, instance.worldMatrix);\n      vec3.transformMat4(vecHeap2, vecHeap2, instance.worldMatrix);\n\n      this.moveToAndFace(vecHeap, vecHeap2);\n    } else {\n      this.updateInternalCamera();\n    }\n  }\n\n  // Move the camera and the target on the XY plane.\n  move(x, y) {\n    let dirX = this.camera.directionX;\n    let dirY = this.camera.directionY;\n    let w = this.canvas.width;\n    let h = this.canvas.height;\n    let aspect = w / h;\n\n    let sw = (x / w) * this.distance * aspect;\n    let sh = (y / h) * this.distance;\n\n    vec3.add(this.target, this.target, vec3.scale(vecHeap, vec3.normalize(vecHeap, vec3.set(vecHeap, dirX[0], dirX[1], 0)), sw));\n    vec3.add(this.target, this.target, vec3.scale(vecHeap, vec3.normalize(vecHeap, vec3.set(vecHeap, dirY[0], dirY[1], 0)), sh));\n\n    this.manualChange();\n  }\n\n  // Rotate the camera around the target.\n  rotate(x, y) {\n    this.horizontalAngle -= x * this.rotationSpeed;\n    this.verticalAngle -= y * this.rotationSpeed;\n\n    this.manualChange();\n  }\n\n  // Zoom the camera by changing the distance from the target.\n  zoom(factor) {\n    this.distance = Math.max(1, this.distance * (1 + factor * this.zoomFactor));\n\n    this.manualChange();\n  }\n\n  manualChange() {\n    this.updateInternalCamera();\n\n    if (this.instance) {\n      this.instance = null;\n\n      if (this.onManualChange) {\n        this.onManualChange();\n      }\n    }\n  }\n\n  // Resize the canvas automatically and update the camera.\n  onResize() {\n    let width = Math.max(this.canvas.clientWidth, 1);\n    let height = Math.max(this.canvas.clientHeight, 1);\n\n    this.canvas.width = width;\n    this.canvas.height = height;\n\n    this.scene.viewport[2] = width;\n    this.scene.viewport[3] = height;\n\n    this.camera.perspective(this.fov, width / height, this.nearClipPlane, this.farClipPlane);\n  }\n\n  moveToAndFace(position, target) {\n    vec3.sub(vecHeap, position, target);\n\n    let r = vec3.length(vecHeap);\n    let theta = Math.atan2(vecHeap[1], vecHeap[0]);\n    let phi = Math.acos(vecHeap[2] / r);\n\n    vec3.copy(this.target, target);\n\n    this.verticalAngle = phi;\n    this.horizontalAngle = theta + Math.PI / 2;\n    this.distance = r;\n\n    this.updateInternalCamera();\n  }\n\n  updateInternalCamera() {\n    // Limit the vertical angle so it doesn't flip.\n    // Since the camera uses a quaternion, flips don't matter to it, but this feels better.\n    this.verticalAngle = Math.min(Math.max(0.01, this.verticalAngle), Math.PI - 0.01);\n\n    quat.identity(quatHeap);\n    quat.rotateZ(quatHeap, quatHeap, this.horizontalAngle);\n    quat.rotateX(quatHeap, quatHeap, this.verticalAngle);\n\n    vec3.set(this.position, 0, 0, 1);\n    vec3.transformQuat(this.position, this.position, quatHeap);\n    vec3.scale(this.position, this.position, this.distance);\n    vec3.add(this.position, this.position, this.target);\n\n    let twist = this.twist - Math.PI / 2;\n    vec3.set(vecHeap, 0, -Math.cos(twist), -Math.sin(twist));\n\n    this.camera.moveToAndFace(this.position, this.target, vecHeap);\n  }\n\n  applyInstanceCamera(instance) {\n    this.instance = instance;\n    this.fov = instance.model.cameras[0].fieldOfView;\n\n    this.onResize();\n\n    this.update();\n  }\n}\n","import * as ModelViewer from '../../src/';\nimport { setupCamera } from '../shared/camera';\n\nfunction initModelViewer(canvas2,path='clients/example/resources') {\n  const handlers = ModelViewer.viewer.handlers;\n\n  let canvas\n  if (!canvas2) {\n    canvas = document.getElementById('canvas');\n    canvas.width = 800;\n    canvas.height = 600;\n  } else {\n    canvas = canvas2;\n  }\n\n  // Create the viewer!\n  let viewer = new ModelViewer.viewer.ModelViewer(canvas);\n  viewer.enableAudio()\n  // Create a new scene. Each scene has its own camera, and a list of things to render.\n  let scene = viewer.addScene();\n  // Check camera.js!\n  setupCamera(scene);\n\n  // Events.\n  // viewer.on('loadstart', (e) => console.log(e));\n  // viewer.on('load', (e) => console.log('load', e));\n  // viewer.on('loadend', (e) => console.log('loadend', e));\n  // viewer.on('error', (e) => console.log('error', e));\n  viewer.on('error', (e) => {});\n\n  // Add the MDX handler.\n  // Note that this also loads all of the team colors/glows.\n  // You can optionally supply a path solver (look below) to point the viewer to the right location of the textures.\n  // Additionally, a boolean can be given that selects between RoC/TFT and Reforged team colors.\n  // For example:\n  //   viewer.addHandler(handlers.mdx, pathSolver); // Roc/TFT = 14 teams.\n  //   viewer.addHandler(handlers.mdx, pathSolver, true); // Reforged = 28 teams.\n  // In the case of this example, team colors aren't used, so it's fine for their loads to simply fail.\n  viewer.addHandler(handlers.mdx, pathSolver, true);\n  // Add the BLP handler.\n  viewer.addHandler(handlers.blp);\n  viewer.addHandler(handlers.dds);\n  viewer.addHandler(handlers.tga);\n\n  (function step() {\n    requestAnimationFrame(step);\n\n    viewer.updateAndRender();\n  })();\n  // A path solver is used for every load call.\n  // Given a possibly relative source, it should return the actual source to load from.\n  // This can be in the form of an URL string, or direct sources from memory (e.g. a previously loaded ArrayBuffer).\n  async function pathSolver(src) {\n    src = src.toLowerCase();\n    let local = `${window.location.origin}/${path}/${src}`;\n    let hive = `https://www.hiveworkshop.com/casc-contents?path=${src}`;\n    let promise1 = fetch(local).then((res) => {\n      if (res.ok) {\n        return local;\n      } else {\n        return Promise.reject(new Error('Not found'));\n      }\n    }).catch((err) => {\n      return Promise.reject(err)\n    });\n    let promise2 = fetch(hive).then((res) => {\n      if (res.ok) {\n        return hive;\n      } else {\n        return Promise.reject(new Error('Not found'));\n      }\n    }).catch((err) => {\n      return Promise.reject(err)\n    });\n    let res = await Promise.any([promise1, promise2])\n    return res;\n  }\n\n  function clearModel() {\n    scene.clear();\n  }\n\n  function enableAudio() {\n\n    scene.enableAudio()\n    scene.clear();\n    loadModel(names)\n  }\n  let names\n  function loadModel(name) {\n    names = name\n    // Load our MDX model!\n    let modelPromise = viewer.load(name, pathSolver);\n    modelPromise.then((model) => {\n      // The promise can return undefined if something went wrong!\n      if (model) {\n        // Create an instance of this model.\n        let instance = model.addInstance();\n        console.log(\"model\", model, instance)\n        let  sequences = [1,0,2]\n        if(name === \"e03r.mdx\"){\n          sequences = [14,15,13]\n        }\n        // Set the instance's scene.\n        // Equivalent to scene.addInstance(instance)\n        instance.setScene(scene);\n\n        // Want to run the second animation.\n        // 0 is the first animation, and -1 is no animation.\n        instance.setSequence(sequences[0]);\n\n        // Tell the instance to loop animations forever.\n        // This overrides the setting in the model itself.\n        instance.setSequenceLoopMode(2);\n        instance.move([0, 0, 0]);\n\n        // Let's create another instance and do other stuff with it.\n        let instance2 = model.addInstance();\n        instance2.setScene(scene);\n        instance2.setSequence(sequences[1]);\n        instance2.setSequenceLoopMode(2);\n        instance2.move([100, 100, 0]);\n        instance2.uniformScale(0.5);\n        console.log(\"instance2\", instance2)\n\n        // And a third one.\n        let instance3 = model.addInstance();\n        instance3.setScene(scene);\n        instance3.setSequence(sequences[2]);\n        instance3.setSequenceLoopMode(2);\n        instance3.move([-100, -100, 0]);\n      }\n    });\n  }\n  window.clearModel = clearModel;\n  window.loadModel = loadModel;\n  window.enableAudio = enableAudio;\n}\nwindow.initModelViewer = initModelViewer;"],"names":["ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","this","module","exports","once","emitter","name","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","flags","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","get","set","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","luastring_from","luastring_indexOf","luastring_of","Uint8Array","from","a","r","s","v","indexOf","array_indexOf","of","is_luastring","unicode_error_message","uri_allowed","split","reduce","c","charCodeAt","to_luastring_cache","to_luastring","str","cache","cached","outU8Array","outIdx","u","luastring_eq","b","to_jsstring","to","replacement_char","Math","min","u0","fromCharCode","u1","u2","s1","s2","u3","to_uristring","toString","from_userstring","LUA_SIGNATURE","LUA_VERSION","LUA_RELEASE","LUA_COPYRIGHT","LUA_VERSION_MAJOR","LUA_VERSION_MINOR","LUA_VERSION_NUM","LUA_VERSION_RELEASE","LUA_AUTHORS","constant_types","LUA_TNONE","LUA_TNIL","LUA_TBOOLEAN","LUA_TLIGHTUSERDATA","LUA_TNUMBER","LUA_TSTRING","LUA_TTABLE","LUA_TFUNCTION","LUA_TUSERDATA","LUA_TTHREAD","LUA_NUMTAGS","LUA_TSHRSTR","LUA_TLNGSTR","LUA_TNUMFLT","LUA_TNUMINT","LUA_TLCL","LUA_TLCF","LUA_TCCL","LUAI_MAXSTACK","LUA_REGISTRYINDEX","LUA_HOOKCALL","LUA_HOOKCOUNT","LUA_HOOKLINE","LUA_HOOKRET","LUA_HOOKTAILCALL","LUA_MASKCALL","LUA_MASKCOUNT","LUA_MASKLINE","LUA_MASKRET","LUA_MINSTACK","LUA_MULTRET","LUA_OPADD","LUA_OPBAND","LUA_OPBNOT","LUA_OPBOR","LUA_OPBXOR","LUA_OPDIV","LUA_OPEQ","LUA_OPIDIV","LUA_OPLE","LUA_OPLT","LUA_OPMOD","LUA_OPMUL","LUA_OPPOW","LUA_OPSHL","LUA_OPSHR","LUA_OPSUB","LUA_OPUNM","LUA_RIDX_GLOBALS","LUA_RIDX_LAST","LUA_RIDX_MAINTHREAD","lua_Debug","constructor","event","NaN","namewhat","what","source","currentline","linedefined","lastlinedefined","nups","nparams","isvararg","istailcall","short_src","i_ci","lua_upvalueindex","thread_status","LUA_OK","LUA_YIELD","LUA_ERRRUN","LUA_ERRSYNTAX","LUA_ERRMEM","LUA_ERRGCMM","LUA_ERRERR","defs","FENGARI_VERSION","FENGARI_RELEASE","FENGARI_AUTHORS","FENGARI_COPYRIGHT","FENGARI_VERSION_MAJOR","FENGARI_VERSION_MINOR","FENGARI_VERSION_NUM","FENGARI_VERSION_RELEASE","api_check","ldebug","ldo","luaU_dump","lfunc","lobject","lstate","luaS_bless","luaS_new","luaS_newliteral","ltm","lvm","ltable","ZIO","TValue","CClosure","api_incr_top","L","top","ci","api_checknelems","funcOff","fengari_argcheck","fengari_argcheckinteger","isvalid","o","luaO_nilobject","index2addr","idx","stack","l_G","l_registry","MAXUPVAL","func","ttislcf","nupvalues","upvalue","index2addr_","lua_settop","newtop","stack_last","adjust_top","lua_pop","reverse","fromtv","temp","setobjs2s","setobj2s","lua_rotate","t","pIdx","p","lua_copy","fromidx","toidx","setfrom","lua_pushcclosure","fn","cl","setclCvalue","lua_pushjsclosure","lua_pushcfunction","lua_pushjsfunction","auxsetstr","k","pushsvalue2s","settable","lua_setglobal","luaH_getint","auxgetstr","luaV_gettable","ttnov","lua_rawgeti","ttistable","pushobj2s","lua_createtable","narray","nrec","luaH_new","aux_upvalue","fi","ttype","f","val","upvalues","getstr","upvals","lua_tolstring","ttisstring","cvt2str","luaO_tostring","svalue","lua_tostring","lua_tointegerx","tointeger","lua_tonumberx","tonumber","seen","WeakMap","f_call","ud","luaD_callnoyield","nresults","lua_type","default_chunkname","checkresults","na","nr","lua_callk","nargs","ctx","callstatus","CIST_LUA","status","nny","c_k","c_ctx","luaD_call","lua_pcallk","errfunc","luaD_pcall","extra","c_old_errfunc","CIST_OAH","allowhook","CIST_YPCALL","getupvalref","fidx","ttisLclosure","lua_absindex","lua_arith","op","luaO_arith","lua_atpanic","panicf","old","panic","lua_atnativeerror","errorf","atnativeerror","lua_call","lua_checkstack","res","EXTRA_STACK","luaD_growstack","lua_compare","index1","index2","o1","o2","luaV_equalobj","luaV_lessthan","luaV_lessequal","lua_concat","luaV_concat","lua_dump","writer","data","strip","lua_error","luaG_errormsg","lua_gc","lua_getallocf","lua_getextraspace","lua_getfield","lua_getglobal","lua_geti","lua_getmetatable","objindex","mt","obj","metatable","lua_gettable","lua_gettop","lua_getupvalue","funcindex","up","lua_getuservalue","ttisfulluserdata","uv","uservalue","lua_insert","lua_isboolean","lua_iscfunction","ttisCclosure","lua_isfunction","lua_isinteger","ttisinteger","lua_islightuserdata","lua_isnil","lua_isnone","lua_isnoneornil","lua_isnumber","lua_isproxy","G","lua_isstring","lua_istable","lua_isthread","lua_isuserdata","ttislightuserdata","lua_len","tv","luaV_objlen","lua_load","reader","chunkname","mode","z","luaD_protectedparser","gt","lua_newtable","lua_newuserdata","size","Udata","luaS_newudata","lua_next","luaH_next","lua_pcall","lua_pushboolean","lua_pushfstring","fmt","argp","luaO_pushvfstring","lua_pushglobaltable","lua_pushinteger","lua_pushlightuserdata","lua_pushliteral","ts","lua_pushlstring","subarray","lua_pushnil","lua_pushnumber","lua_pushstring","lua_pushthread","mainthread","lua_pushvalue","lua_pushvfstring","lua_rawequal","lua_rawget","luaH_get","lua_rawgetp","lua_rawlen","vslen","luaH_getn","lua_rawset","luaH_setfrom","invalidateTMcache","lua_rawseti","luaH_setint","lua_rawsetp","lua_register","lua_remove","lua_replace","lua_setallocf","lua_setfield","lua_seti","lua_setmetatable","ttisnil","lua_settable","lua_setupvalue","aux","lua_setuservalue","lua_status","lua_stringtonumber","sz","luaO_str2num","lua_toboolean","l_isfalse","lua_tocfunction","lua_todataview","u8","DataView","buffer","byteOffset","byteLength","lua_tointeger","lua_tojsstring","jsstring","lua_tonumber","lua_topointer","lua_toproxy","proxy","lua_State","create_proxy","lua_tothread","ttisthread","lua_touserdata","lua_typename","ttypename","lua_upvalueid","ref","lua_upvaluejoin","fidx1","n1","fidx2","n2","ref1","ref2","up2","lua_version","version","lua_xmove","LUAL_BUFFERSIZE","lua_getinfo","lua_getstack","lua_newstate","LUA_ERRFILE","LUA_LOADED_TABLE","LUA_PRELOAD_TABLE","LUA_FILEHANDLE","__name","__tostring","empty","luaL_Buffer","findfield","objidx","level","pushglobalfuncname","ar","pushfuncname","msg","luaL_argerror","extramsg","luaL_error","typeerror","tname","typearg","luaL_getmetafield","luaL_typename","luaL_where","luaL_fileresult","stat","fname","e","errno","luaL_getmetatable","luaL_testudata","tag_error","tag","luaL_checklstring","luaL_checkstring","luaL_optlstring","def","luaL_optstring","luaL_checknumber","d","luaL_checkinteger","interror","luaL_prepbuffsize","B","newend","newsize","max","newbuff","luaL_buffinit","luaL_addlstring","l","luaL_addsize","luaL_addstring","luaL_pushresult","luaL_opt","getS","string","luaL_loadbufferx","buff","luaL_loadbuffer","luaL_loadstring","tt","luaL_callmeta","p_I","p_f","find_subarray","subarr","from_index","sl","loop","j","luaL_getsubtable","luaL_setfuncs","nup","luaL_checkstack","lib","space","errfile","fnameindex","serr","filename","getc","utf8_bom","skipcomment","lf","skipBOM","skipped","luaL_loadfilex","LoadF","pos","getF","bytes","path","xhr","XMLHttpRequest","open","window","responseType","send","statusText","response","com","readstatus","luaL_loadfile","luaL_checkversion_","ver","kind","lua_assert","llex","lopcodes","lparser","OpCodesI","NO_JUMP","BinOpr","OPR_ADD","OPR_SUB","OPR_MUL","OPR_MOD","OPR_POW","OPR_DIV","OPR_IDIV","OPR_BAND","OPR_BOR","OPR_BXOR","OPR_SHL","OPR_SHR","OPR_CONCAT","OPR_EQ","OPR_LT","OPR_LE","OPR_NE","OPR_GT","OPR_GE","OPR_AND","OPR_OR","OPR_NOBINOPR","UnOpr","OPR_MINUS","OPR_BNOT","OPR_NOT","OPR_LEN","OPR_NOUNOPR","hasjumps","tonumeral","make_tvalue","ek","expkind","VKINT","ival","VKFLT","nval","luaK_nil","fs","previous","pc","lasttarget","code","opcode","OP_LOADNIL","pfrom","A","pl","SETARG_A","SETARG_B","luaK_codeABC","getinstruction","info","getjump","offset","sBx","fixjump","dest","jmp","abs","MAXARG_sBx","luaX_syntaxerror","ls","SETARG_sBx","luaK_concat","l1","l2","next","luaK_jump","jpc","luaK_codeAsBx","OP_JMP","condjump","C","luaK_getlabel","getjumpcontroloffset","testTMode","getjumpcontrol","patchtestreg","node","reg","OP_TESTSET","NO_REG","CREATE_ABC","OP_TEST","removevalues","patchlistaux","vtarget","dtarget","luaK_patchtohere","luaK_patchlist","luaK_code","dischargejpc","lineinfo","lastline","getOpMode","iABC","getBMode","OpArgN","getCMode","MAXARG_A","MAXARG_B","MAXARG_C","luaK_codeABx","bc","iABx","iAsBx","MAXARG_Bx","CREATE_ABx","codeextraarg","MAXARG_Ax","CREATE_Ax","OP_EXTRAARG","luaK_codek","OP_LOADK","OP_LOADKX","luaK_checkstack","newstack","freereg","maxstacksize","luaK_reserveregs","ISK","nactvar","freeexp","VNONRELOC","freeexps","e1","e2","r1","r2","addk","h","nk","luaK_intK","luaK_numberK","boolK","luaK_setreturns","VCALL","SETARG_C","VVARARG","luaK_setoneret","VRELOCABLE","luaK_dischargevars","VLOCAL","VUPVAL","OP_GETUPVAL","VINDEXED","ind","vt","OP_GETTABLE","OP_GETTABUP","code_loadbool","jump","OP_LOADBOOL","discharge2reg","VNIL","VFALSE","VTRUE","VK","OP_MOVE","VJMP","discharge2anyreg","need_value","exp2reg","final","p_t","fj","luaK_exp2nextreg","luaK_exp2anyreg","luaK_exp2val","luaK_exp2RK","vk","nilK","MAXINDEXRK","RKASK","negatecondition","jumponcond","cond","ie","OP_NOT","luaK_goiftrue","luaK_goiffalse","constfolding","v1","v2","validop","codebinexpval","line","rk2","rk1","luaK_fixline","luaK_exp2anyregup","luaK_indexed","vkisinreg","luaK_infix","luaK_jumpto","luaK_patchclose","ins","luaK_posfix","OP_CONCAT","OP_ADD","opr","OP_EQ","codecomp","luaK_prefix","ef","expdesc","codeunexpval","OP_UNM","codenot","luaK_ret","first","nret","OP_RETURN","luaK_self","ereg","OP_SELF","luaK_setlist","base","nelems","tostore","LFIELDS_PER_FLUSH","OP_SETLIST","luaK_setmultret","luaK_storevar","vr","ex","OP_SETUPVAL","OP_SETTABLE","OP_SETTABUP","luaK_stringK","LUA_IDSIZE","lapi","currentpc","l_savedpc","swapextra","upvalname","findlocal","numparams","l_base","findvararg","luaF_getlocalname","funcinfo","luaO_chunkid","getfuncname","funcname","CIST_FIN","CIST_TAIL","funcnamefromcode","kname","kvalue","INDEXK","getobjname","filterpc","jmptarget","lastpc","setreg","OCi","OP_TFORCALL","OP_CALL","OP_TAILCALL","testAMode","findsetreg","vn","LUA_ENV","Bx","Ax","tm","CIST_HOOKED","TMS","TM_INDEX","TM_NEWINDEX","TM_ADD","OP_SUB","TM_SUB","OP_MUL","TM_MUL","OP_MOD","TM_MOD","OP_POW","TM_POW","OP_DIV","TM_DIV","OP_IDIV","TM_IDIV","OP_BAND","TM_BAND","OP_BOR","TM_BOR","OP_BXOR","TM_BXOR","OP_SHL","TM_SHL","OP_SHR","TM_SHR","TM_UNM","OP_BNOT","TM_BNOT","OP_LEN","TM_LEN","TM_CONCAT","TM_EQ","OP_LT","TM_LT","OP_LE","TM_LE","tmname","varinfo","getupvalname","stkid","isinstack","luaO_pushfstring","luaG_typeerror","luaT_objtypename","luaG_runerror","luaG_addinfo","src","luaD_throw","luaG_concaterror","p1","p2","luaG_opinterror","luaG_ordererror","t1","t2","luaG_tointerror","luaG_traceexec","mask","hookmask","counthook","hookcount","basehookcount","CIST_HOOKYIELD","luaD_hook","npc","newline","oldpc","lua_gethook","hook","lua_gethookcount","lua_gethookmask","ttisfunction","ttisclosure","is_vararg","auxgetinfo","collectvalidlines","lua_getlocal","local","base_ci","lua_sethook","lua_setlocal","LUAI_MAXCCALLS","lundump","MBuffer","seterrorobj","errcode","oldtop","current_top","setsvalue2s","ERRORSTACKSIZE","luaD_reallocstack","needed","luaD_checkstack","luaD_shrinkstack","inuse","lim","stackinuse","goodsize","floor","luaE_freeCI","luaD_precall","luaE_extendCI","luaD_poscall","fsize","adjust_varargs","l_code","callhook","tryfuncTM","firstResult","nres","wanted","moveresults","setnilvalue","ci_top","actual","nfixargs","fixed","luaT_gettmbyobj","TM_CALL","nResults","nCcalls","stackerror","luaV_execute","errorJmp","g","luaD_rawrunprotected","oldnCcalls","lj","finishCcall","unroll","luaV_finishOp","recover","findpcall","luaF_close","resume_error","narg","resume","firstArg","lua_yieldk","old_top","old_ci","old_allowhooks","old_nny","old_errfunc","SParser","dyd","Dyndata","checkmode","x","f_parser","zgetc","luaU_undump","luaY_parser","luaF_initupvals","luaD_inctop","lua_isyieldable","lua_resume","oldnny","lua_yield","LUAC_DATA","LUAC_VERSION","DumpState","write","DumpBlock","D","DumpByte","y","DumpInt","ab","ArrayBuffer","setInt32","DumpInteger","DumpNumber","setFloat64","DumpString","tsslen","DumpFunction","psource","map","DumpCode","tsvalue","DumpConstants","instack","DumpUpvalues","DumpProtos","locvars","varname","startpc","endpc","DumpDebug","DumpHeader","Proto","id","id_counter","luaF_findupval","local_number","luaF_newLclosure","LClosure","luai_ctype_","lisdigit","lislalnum","lislalpha","lisprint","lisspace","lisxdigit","LUA_MINBUFFER","MAX_INT","luaS_hash","luaS_hashlongstr","EOZ","luaZ_buffer","luaZ_buffremove","luaZ_resetbuffer","luaZ_resizebuffer","FIRST_RESERVED","TK_EOS","TK_FLT","TK_STRING","RESERVED","luaX_tokens","SemInfo","Token","token","seminfo","save","lexerror","luaX_token2str","currIsNewline","current","save_and_next","TVtrue","luaX_newstring","tpair","strong","inclinenumber","linenumber","check_next1","check_next2","read_numeral","expo","ttisfloat","txtToken","skip_sep","read_long_string","sep","skip","esccheck","gethexa","luaO_hexavalue","readhexaesc","utf8esc","UTF8BUFFSZ","luaO_utf8esc","readutf8desc","readdecesc","read_string","del","will","token_to_index","forEach","kidx","LexState","lookahead","envn","isreserved","luaX_lookahead","luaX_next","luaX_setinput","firstchar","luai_apicheck","luai_nummod","MIN_INT","LUA_COMPAT_FLOATSTRING","ldexp","lua_integer2str","lua_number2str","LUA_TPROTO","LUA_TDEADKEY","checktag","checktype","ttisnumber","ttisboolean","ttisshrstring","ttislngstring","ttisdeadkey","setfltvalue","chgfltvalue","setivalue","chgivalue","setfvalue","setpvalue","setbvalue","setsvalue","setuvalue","setthvalue","setclLvalue","sethvalue","setdeadvalue","newidx","freeze","RETS","PRE","POS","mfb","l_str2dloc","result","neg","sigdig","nosigdig","hasdot","neg1","exp1","lua_strx2number","exec","flt","parseFloat","lua_str2number","SIGILS","modes","MAXBY10","MAXLASTD","test","pushstr","Table","JSON","stringify","ids","intarith","luaV_imul","luaV_mod","luaV_div","luaV_shiftl","numarith","pow","LocVar","p3","i1","i2","luaT_trybinTM","bufflen","out","nli","out_i","luaO_int2fb","s2i","l_str2int","pmode","l_str2d","oldidx","oldtv","luaP_opmodes","OpArgU","SIZE_Bx","POS_C","POS_Bx","BITRK","MASK1","MASK0","setarg","fullins","SETARG_Bx","GET_OPCODE","GETARG_A","GETARG_B","GETARG_C","GETARG_Bx","GETARG_Ax","GETARG_sBx","OpArgK","OpArgR","OpCodes","OP_NEWTABLE","OP_FORLOOP","OP_FORPREP","OP_TFORLOOP","OP_CLOSURE","OP_VARARG","POS_A","POS_Ax","POS_B","POS_OP","SETARG_Ax","SET_OPCODE","SIZE_A","SIZE_Ax","SIZE_B","SIZE_C","SIZE_OP","iAx","luaS_eqlngstr","hasmultret","eqstr","BlockCnt","firstlabel","firstgoto","upval","isloop","VVOID","FuncState","prev","bl","np","firstlocal","nlocvars","Vardesc","Labeldesc","Labellist","semerror","error_expected","checklimit","limit","where","errorlimit","testnext","check","checknext","check_condition","check_match","who","str_checkname","TK_NAME","init_exp","codestring","checkname","new_localvar","registerlocalvar","actvar","new_localvarliteral","getlocvar","adjustlocalvars","nvars","newupvalue","singlevaraux","searchvar","markupval","searchupvalue","singlevar","adjust_assign","nexps","enterlevel","leavelevel","closegoto","label","gl","vname","findlabel","lb","newlabelentry","findgotos","enterblock","open_func","leaveblock","breaklabel","tolevel","removevars","movegotosout","undefgoto","close_func","block_follow","withuntil","TK_ELSE","TK_ELSEIF","TK_END","TK_UNTIL","statlist","TK_RETURN","statement","fieldsel","yindex","expr","ConsControl","nh","recfield","cc","rkkey","closelistfield","listfield","field","lastlistfield","body","ismethod","new_fs","clp","addprototype","TK_DOTS","parlist","TK_FUNCTION","codeclosure","explist","funcargs","suffixedexp","primaryexp","priority","left","right","subexpr","uop","TK_NOT","getunopr","TK_INT","TK_NIL","TK_TRUE","TK_FALSE","simpleexp","TK_IDIV","TK_SHL","TK_SHR","TK_CONCAT","TK_NE","TK_EQ","TK_LE","TK_GE","TK_AND","TK_OR","getbinopr","nextop","block","LHS_assign","assignment","lh","nv","conflict","check_conflict","gotostat","TK_GOTO","labelstat","ll","checkrepeated","TK_DBCOLON","skipnoopstat","forbody","isnum","endfor","TK_DO","prep","forstat","fornum","TK_IN","indexname","forlist","TK_FOR","test_then_block","escapelist","jf","TK_THEN","TK_BREAK","funcstat","TK_IF","ifstat","TK_WHILE","whileinit","condexit","whilestat","TK_REPEAT","repeat_init","bl1","bl2","repeatstat","TK_LOCAL","localfunc","localstat","retstat","exprstat","lexstate","funcstate","mainfunc","BASIC_STACK_SIZE","CallInfo","global_State","TM_N","stack_init","L1","freestack","f_luaopen","registry","init_registry","luaT_init","CIST_FRESH","CIST_LEQ","lua_close","close_state","lua_newthread","luaE_freethread","TString","hash","realstring","lightuserdata_hashes","get_lightuserdata_hash","table_hash","Map","dead_strong","dead_weak","add","clear","entry","mark_dead","delete","getgeneric","luaH_getstr","kv","table","keyI","keyO","luaT_typenames_","TM_GC","TM_MODE","luaT_callTM","hasres","luaT_callbinTM","luaT_gettm","ename","fasttm","et","luaT_callorderTM","lua_setallof","conf","LUA_PATH_SEP","LUA_PATH_MARK","LUA_EXEC_DIR","LUA_VDIR","LUA_DIRSEP","LUA_LDIR","LUA_JSDIR","LUA_PATH_DEFAULT","LUA_JSPATH_DEFAULT","LUA_MININTEGER","mantissa","exponent","steps","ceil","LUA_INTEGER_FMT","LUA_INTEGER_FRMLEN","LUA_MAXINTEGER","LUA_NUMBER_FMT","LUA_NUMBER_FRMLEN","frexp","bits","getUint32","lua_getlocaledecpoint","toPrecision","lua_numbertointeger","luaZ_read","BytecodeParser","Z","intSize","size_tSize","instructionSize","integerSize","numberSize","arraybuffer","dv","read","LoadByte","LoadInt","getInt32","LoadNumber","getFloat64","LoadInteger","LoadSize_t","LoadString","LoadCode","LoadConstants","LoadProtos","LoadFunction","LoadUpvalues","LoadDebug","checkliteral","checkHeader","checksize","why","byte","S","RA","RB","RKB","RKC","dojump","donextjump","LTnum","l_strcmp","LEnum","forlimit","step","stopnow","ilimit","luaV_tointeger","cvt2num","rs","ra","rb","imul","aLo","bLo","getcached","encup","pushclosure","ncl","tostring","isemptystr","copy2buff","tl","total","slot","newframe","konst","rc","numberop1","numberop2","op1","op2","numberop","rbIdx","nci","oci","nfunc","nfuncOff","ofuncOff","forlim","plimit","pstep","initv","nlimit","nstep","ninit","cb","last","inst","luaV_rawequalobj","luaZ_fill","b_offset","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","prop","hasOwnProperty","Symbol","toStringTag","EPSILON","ARRAY_TYPE","Float32Array","RANDOM","random","setMatrixArrayType","degree","PI","toRadian","equals","clone","identity","fromValues","m00","m01","m10","m11","transpose","a1","invert","a0","a2","a3","det","adjoint","determinant","multiply","b0","b1","b2","b3","rotate","rad","sin","cos","scale","v0","fromRotation","fromScaling","frob","hypot","LDU","U","subtract","exactEquals","multiplyScalar","multiplyScalarAndAdd","sqrt","mul","sub","tx","ty","aa","ac","ad","atx","aty","a4","a5","b4","b5","translate","fromTranslation","fromMat4","m02","m12","m20","m21","m22","a01","a02","a12","a00","a10","a11","a20","a21","a22","b01","b11","b21","b00","b02","b10","b12","b20","b22","fromMat2d","fromQuat","q","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","projection","width","height","a6","a7","a8","b6","b7","b8","m03","m13","m23","m30","m31","m32","m33","axis","rotateX","rotateY","rotateZ","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","fromRotationTranslationScale","sx","sy","fromRotationTranslationScaleOrigin","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","frustum","bottom","near","far","rl","tb","nf","perspective","fovy","aspect","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","a9","a14","a15","b9","b13","b14","b15","divide","round","scaleAndAdd","distance","squaredDistance","squaredLength","negate","inverse","normalize","cross","lerp","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformMat4","transformMat3","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","angle","mag","cosine","acos","zero","vec","div","dist","sqrDist","sqrLen","stride","dot","E","F","H","I","J","v3","v4","ix","iy","iz","iw","setAxisAngle","getAxisAngle","out_axis","getAngle","dotproduct","calculateW","exp","ln","atan2","log","slerp","omega","cosom","sinom","scale0","scale1","sqrt1MinusU1","sqrtU1","invDot","conjugate","fromMat3","fRoot","fTrace","fromEuler","halfToRad","cx","cy","cz","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","rotationTo","sqlerp","setAxes","view","dq","w1","fromRotationTranslationValues","outer","getReal","getDual","setReal","setDual","ax1","ay1","az1","aw1","bx1","by1","bz1","ax2","ay2","az2","aw2","rotateByQuatAppend","rotateByQuatPrepend","rotateAroundAxis","axisLength","ax0","ay0","az0","aw0","bw1","bx0","by0","bz0","bw0","sqlen","a_dot_b","transformMat2","transformMat2d","p0","sinC","cosC","VEC3_UNIT_X","VEC3_UNIT_Y","VEC3_UNIT_Z","VEC3_ZERO","VEC3_ONE","QUAT_ZERO","QUAT_DEFAULT","vec4Heap","unproject","inverseMatrix","viewport","distanceToPlane","plane","point","distanceToPlane2","distanceToPlane3","testSphere","planes","testCell","planeLength","normalizePlane","unpackPlanes","quatLookAt","worldUp","degToRad","degrees","radToDeg","radians","randomInRange","clamp","minVal","maxVal","invt","copysign","signy","sign","powerOfTwo","isPowerOfTwo","canvas","canvas2","ctx2","blobToImage","blob","url","URL","createObjectURL","image","Image","onload","onerror","blobToImageData","revokeObjectURL","drawImage","getImageData","imageDataToBlob","imageData","putImageData","toBlob","imageDataToDataUrl","toDataURL","imageDataToImage","imageToImageData","resizeImageData","ImageData","document","createElement","getContext","decoder","TextDecoder","encoder","TextEncoder","decodeUtf8","decode","encodeUtf8","utf8","encode","byteLengthUtf8","bytesOf","isStringInBytes","start","end","whichByte","targetByte","int8","Int8Array","int16","Int16Array","int32","Int32Array","uint8","uint16","Uint16Array","uint32","Uint32Array","float32","float64","Float64Array","uint8ToInt8","uint8ToInt16","uint8ToInt32","uint8ToUint16","uint8ToUint32","uint8ToFloat32","uint8ToFloat64","int8ToUint8","int16ToUint8","int32ToUint8","uint16ToUint8","uint32ToUint8","float32ToUint8","float64ToUint8","numberToUint32","number","base256ToString","array","join","BinaryStream","uint8array","remaining","substream","seek","boundIndexOf","readNull","readBinary","readInt8","readInt16","readInt32","readUint8","readUint16","readUint32","readFloat32","readFloat64","readInt8Array","isView","readInt16Array","readInt32Array","readUint8Array","readUint16Array","readUint32Array","readFloat32Array","readFloat64Array","writeUint8Array","writeNull","writeBinary","writeInt8","writeInt16","writeInt32","writeUint8","writeUint16","writeUint32","writeFloat32","writeFloat64","writeInt8Array","writeInt16Array","writeInt32Array","writeUint16Array","writeUint32Array","writeFloat32Array","writeFloat64Array","BitStream","bitBuffer","peekBits","loadBits","readBits","skipBits","basename","lastIndexOf","extname","toLowerCase","isPng","isJpeg","isGif","isWebP","IniFile","properties","sections","load","section","startsWith","match","trim","lines","getSection","SlkFile","rows","valueString","substring","parseInt","rowCount","biggestColumn","row","columnCount","firstOfRow","encoded","Reference","entries","stream","Md34","model","BoundingSphere","radius","BoundingShape","shape","bone","unknown0","matrix","unknown1","unknown2","unknown3","unknown4","unknown5","unknown6","AnimationReference","interpolationType","animFlags","animId","initValue","nullValue","readInitNullValues","PixelAnimationReference","Uint16AnimationReference","Uint32AnimationReference","Float32AnimationReference","Vector2AnimationReference","Vector3AnimationReference","Vector4AnimationReference","Sd","biggestKey","values","UnsupportedEntry","tagMapping","MD34","MODL","modelName","sequences","stc","stg","sts","bones","numberOfBonesToCheckForSkin","vertexFlags","vertices","divisions","boneLookup","boundings","unknown4To20","attachmentPoints","attachmentPointAddons","ligts","shbxData","cameras","unknown21","materialReferences","materials","particleEmitters","particleEmitterCopies","ribbonEmitters","projections","forces","warps","unknown22","rigidBodies","unknown23","physicsJoints","clothBehavior","unknown24","ikjtData","unknown25","unknown26","partsOfTurrentBehaviors","turrentBehaviors","absoluteInverseBoneRestPositions","tightHitTest","fuzzyHitTestObjects","attachmentVolumes","attachmentVolumesAddon0","attachmentVolumesAddon1","billboardBehaviors","tmdData","unknown27","unknown28","SEQS","interval","movementSpeed","frequency","boundingSphere","STC_","runsConcurrent","stsIndex","stsIndexCopy","animIds","animRefs","sd","STG_","stcIndices","STS_","BONE","parent","location","rotation","visibility","DIV_","triangles","regions","batches","MSEC","REGN","firstVertexIndex","verticesCount","firstTriangleIndex","triangleIndicesCount","bonesCount","firstBoneLookupIndex","boneLookupIndicesCount","boneWeightPairsCount","rootBoneIndex","_index","BAT_","regionIndex","materialReferenceIndex","MATM","materialType","materialIndex","MAT_","additionalFlags","blendMode","usedRTTChannels","specularity","depthBlendFalloff","cutoutThreshold","specMult","emisMult","diffuseLayer","decalLayer","specularLayer","glossLayer","emissiveLayer","emissive2Layer","evioLayer","evioMaskLayer","alphaMaskLayer","alphaMask2Layer","normalLayer","heightLayer","lightMapLayer","ambientOcclusionLayer","unknown7","unknown8","layerBlendType","emisBlendType","emisMode","specType","unknown9","unknown10","unknown11","LAYR","imagePath","color","uvSource","colorChannelSetting","brightMult","midtoneOffset","noiseAmp","noiseFreq","rttChannel","videoFrameRate","videoStartFrame","videoEndFrame","videoMode","videoSyncTiming","videoPlay","videoRestart","flipBookRows","flipBookColumns","flipBookFrame","uvOffset","uvAngle","uvTiling","brightness","triPlanarOffset","triPlanarScale","fresnelType","fresnelExponent","fresnelMin","fresnelMaxOffset","fresnelInvertedMaskX","fresnelInvertedMaskY","fresnelInvertedMaskZ","fresnelRotationYaw","fresnelRotationPitch","EVNT","BNDS","ATT_","unknown","CAM_","fieldOfView","farClip","nearClip","clip2","focalDepth","falloffStart","falloffEnd","depthOfField","SDEV","SDU6","SDFG","SDS6","SDR3","SD2V","SD3V","SD4Q","SDCC","SDMB","FLAG","LITE","ATVL","PATU","TRGD","DIS_","CMS_","CMP_","TER_","VOL_","VON_","CREP","STBM","LFSB","LFLR","PAR_","PARC","PROJ","PHYJ","PHCC","PHAC","PHCL","FOR_","DMSE","PHSH","PHRB","SSGS","BBSC","SRIB","RIB_","IKJT","SHBX","WRP_","IndexEntry","entriesCount","mapping","readerOffset","entrySize","Model","header","modelEntries","isM3","TokenStream","ident","indentSpaces","precision","readToken","inComment","inString","peek","readInt","readFloat","readVector","readVectorsBlock","readColor","readBlock","writeLine","repeat","writeFlag","flag","writeFlagAttrib","writeNumberAttrib","floatDecimals","writeStringAttrib","writeVectorAttrib","floatArrayDecimals","writeColor","writeVector","writeVectorArrayBlock","startBlock","endBlock","headers","startObjectBlock","replace","endBlockComma","indent","unindent","trunc","Extent","boundsRadius","readMdx","writeMdx","writeMdl","moveSpeed","nonLooping","rarity","syncPoint","extent","readMdl","Animation","globalSequenceId","frames","inTans","outTans","tracksCount","readMdxValue","writeMdxValue","readMdlValue","writeMdlValue","getByteLength","bytesPerValue","valuesPerTrack","UintAnimation","FloatAnimation","Vector3Animation","Vector4Animation","KMTF","KMTA","KMTE","KFC3","KFCA","KFTC","KTAT","KTAR","KTAS","KGAO","KGAC","KGTR","KGRT","KGSC","KLAS","KLAE","KLAC","KLAI","KLBI","KLBC","KLAV","KATV","KPEE","KPEG","KPLN","KPLT","KPEL","KPES","KPEV","KP2S","KP2R","KP2L","KP2G","KP2E","KP2N","KP2W","KP2V","KPPA","KPPC","KPPE","KPPL","KPPS","KPPV","KRHA","KRHB","KRAL","KRCO","KRTX","KRVS","KCTR","KTTR","KCRL","AnimatedObject","animations","readAnimations","animation","writeAnimations","readAnimatedBlock","readAnimation","writeAnimation","_version","stringToMode","filterMode","textureId","textureAnimationId","coordId","alpha","emissiveGain","fresnelColor","fresnelOpacity","fresnelTeamColor","super","Material","priorityPlane","shader","layers","layer","Texture","replaceableId","wrapMode","TextureAnimation","Geoset","normals","faceTypeGroups","faceGroups","faces","vertexGroups","matrixGroups","matrixIndices","materialId","selectionGroup","selectionFlags","lod","lodName","sequenceExtents","tangents","skin","uvSets","sequenceExtent","uvSet","vertexGroup","vectors","indices","groups","_","groupSize","GeosetAnimation","geosetId","GenericObject","objectId","parentId","getGenericByteLength","eachAnimation","writeNonGenericAnimationChunks","readGenericBlock","writeGenericHeader","writeGenericAnimations","wantGeneric","isGeneric","geosetAnimationId","Light","attenuation","intensity","ambientColor","ambientIntensity","Helper","Attachment","attachmentId","ParticleEmitter","emissionRate","gravity","longitude","latitude","lifeSpan","speed","ParticleEmitter2","variation","columns","headOrTail","tailLength","timeMiddle","segmentColors","segmentAlphas","segmentScaling","headIntervals","tailIntervals","squirt","ParticleEmitterPopcorn","animationVisiblityGuide","RibbonEmitter","heightAbove","heightBelow","textureSlot","farClippingPlane","nearClippingPlane","targetPosition","EventObject","tracks","track","CollisionShape","FaceEffect","UnknownChunk","chunk","isMdx","isMdl","isStringInString","animationFile","blendTime","globalSequences","textures","textureAnimations","geosets","geosetAnimations","lights","helpers","attachments","pivotPoints","particleEmitters2","particleEmittersPopcorn","eventObjects","collisionShapes","faceEffects","bindPose","unknownChunks","loadMdx","loadMdl","loadVersionChunk","loadModelChunk","loadStaticObjects","loadGlobalSequenceChunk","loadDynamicObjects","loadPivotPointChunk","loadBindPoseChunk","object","_size","saveMdx","saveVersionChunk","saveModelChunk","saveStaticObjectChunk","saveGlobalSequenceChunk","saveDynamicObjectChunk","savePivotPointChunk","saveBindPoseChunk","objects","globalSequence","getObjectsByteLength","pivotPoint","loadVersionBlock","loadModelBlock","loadNumberedObjectBlock","loadGlobalSequenceBlock","loadObject","loadPivotPointBlock","loadBindPoseBlock","matrices","saveMdl","saveVersionBlock","saveModelBlock","saveStaticObjectsBlock","saveGlobalSequenceBlock","saveObjects","savePivotPointBlock","saveBindPoseBlock","getStaticObjectsChunkByteLength","getDynamicObjectsChunkByteLength","getBindPoseChunkByteLength","Block","compressedSize","normalSize","HASH_TABLE_KEY","HASH_ENTRY_DELETED","HASH_ENTRY_EMPTY","BLOCK_TABLE_KEY","FILE_ENCRYPTED","FILE_OFFSET_ADJUSTED_KEY","FILE_SINGLE_UNIT","FILE_EXISTS","BlockTable","addEmpties","howMany","uint32array","decryptBlock","encryptBlock","bytesHeap","longHeap","MpqCrypto","cryptTable","seed","seed1","seed2","toUpperCase","ch","decrypted","computeFileKey","sepIndex","pathlessName","encryptionKey","zero$1","buf","LITERALS$1","L_CODES$1","D_CODES$1","MAX_BITS$1","extra_lbits","extra_dbits","extra_blbits","bl_order","static_ltree","static_dtree","_dist_code","_length_code","MAX_MATCH$1","base_length","base_dist","StaticTreeDesc","static_tree","extra_bits","extra_base","elems","max_length","has_stree","static_l_desc","static_d_desc","static_bl_desc","TreeDesc","dyn_tree","stat_desc","max_code","d_code","put_short","pending_buf","pending","send_bits","bi_valid","bi_buf","send_code","tree","bi_reverse","gen_codes","bl_count","next_code","init_block","dyn_ltree","dyn_dtree","bl_tree","END_BLOCK","opt_len","static_len","sym_next","matches","bi_windup","smaller","depth","_n2","_m2","pqdownheap","heap","heap_len","compress_block","ltree","dtree","lc","sym_buf","build_tree","desc","stree","heap_max","xbits","overflow","gen_bitlen","scan_tree","curlen","prevlen","nextlen","max_count","min_count","REP_3_6","REPZ_3_10","REPZ_11_138","send_tree","static_init_done","_tr_stored_block$1","stored_len","_tr_init_1","LENGTH_CODES$1","tr_static_init","l_desc","d_desc","bl_desc","_tr_flush_block_1","opt_lenb","static_lenb","max_blindex","strm","data_type","block_mask","detect_data_type","BL_CODES$1","build_bl_tree","strategy","lcodes","dcodes","blcodes","rank","send_all_trees","_tr_tally_1","sym_end","_tr_align_1","STATIC_TREES","bi_flush","trees","_tr_init","_tr_stored_block","_tr_flush_block","_tr_tally","_tr_align","adler32_1","adler","crcTable","makeTable","crc32_1","crc","messages","constants$2","Z_NO_FLUSH","Z_PARTIAL_FLUSH","Z_SYNC_FLUSH","Z_FULL_FLUSH","Z_FINISH","Z_BLOCK","Z_TREES","Z_OK","Z_STREAM_END","Z_NEED_DICT","Z_ERRNO","Z_STREAM_ERROR","Z_DATA_ERROR","Z_MEM_ERROR","Z_BUF_ERROR","Z_NO_COMPRESSION","Z_BEST_SPEED","Z_BEST_COMPRESSION","Z_DEFAULT_COMPRESSION","Z_FILTERED","Z_HUFFMAN_ONLY","Z_RLE","Z_FIXED","Z_DEFAULT_STRATEGY","Z_BINARY","Z_TEXT","Z_UNKNOWN","Z_DEFLATED","Z_NO_FLUSH$2","Z_FULL_FLUSH$1","Z_FINISH$3","Z_BLOCK$1","Z_OK$3","Z_STREAM_END$3","Z_STREAM_ERROR$2","Z_DATA_ERROR$2","Z_BUF_ERROR$1","Z_DEFAULT_COMPRESSION$1","Z_DEFAULT_STRATEGY$1","Z_DEFLATED$2","MAX_MATCH","MIN_LOOKAHEAD","INIT_STATE","BUSY_STATE","FINISH_STATE","errorCode","slide_hash","wsize","w_size","hash_size","head","HASH","hash_shift","hash_mask","flush_pending","avail_out","output","pending_out","next_out","total_out","flush_block_only","block_start","strstart","put_byte","putShortMSB","read_buf","avail_in","input","next_in","wrap","total_in","longest_match","cur_match","chain_length","max_chain_length","scan","best_len","prev_length","nice_match","_win","wmask","w_mask","strend","scan_end1","scan_end","good_match","match_start","fill_window","_w_size","more","window_size","insert","ins_h","deflate_stored","flush","have","min_block","pending_buf_size","used","high_water","deflate_fast","hash_head","bflush","match_length","max_lazy_match","MIN_MATCH","deflate_slow","max_insert","prev_match","match_available","Config","good_length","max_lazy","nice_length","max_chain","configuration_table","DeflateState","gzhead","gzindex","method","last_flush","w_bits","hash_bits","HEAP_SIZE","MAX_BITS","lit_bufsize","deflateStateCheck","deflateResetKeep","deflateReset","lm_init","deflateInit2","windowBits","memLevel","deflate_2$1","old_flush","level_flags","text","hcrc","comment","time","os","beg","gzhead_extra","bstate","deflate_huff","deflate_rle","deflateSetDictionary_1","dictionary","dictLength","tmpDict","avail","deflate_1$2","deflateInit","deflateSetHeader","deflate","deflateEnd","deflateSetDictionary","deflateInfo","_has","sources","chunks","STR_APPLY_UIA_OK","__","_utf8len","strings","c2","m_pos","str_len","buf_len","utf16buf","c_len","buf2binstring","zstream","toString$1","Z_NO_FLUSH$1","Z_FINISH$2","Z_OK$2","Z_STREAM_END$2","Z_DEFLATED$1","Deflate$1","options","chunkSize","opt","raw","gzip","ended","dict","_dict_set","deflate$1","deflator","flush_mode","_flush_mode","onData","onEnd","deflate_1$1","Deflate","deflateRaw","constants","BAD$1","inffast","_in","_out","dmax","whave","wnext","s_window","hold","lcode","dcode","lmask","dmask","here","from_source","lencode","distcode","lenbits","distbits","dolen","sane","MAXBITS","lbase","lext","dbase","dext","inftrees","lens","lens_index","codes","table_index","work","opts","incr","fill","low","sym","root","curr","drop","huff","offs","here_bits","here_op","here_val","Z_FINISH$1","Z_OK$1","Z_STREAM_END$1","Z_NEED_DICT$1","Z_STREAM_ERROR$1","Z_DATA_ERROR$1","Z_MEM_ERROR$1","HEAD","DICT","TYPE","TYPEDO","COPY_","LEN_","LEN","CHECK","BAD","zswap32","InflateState","havedict","wbits","ncode","nlen","ndist","lendyn","distdyn","back","was","inflateStateCheck","inflateResetKeep","inflateReset","inflateReset2","inflateInit2","lenfix","distfix","virgin","fixedtables","updatewindow","inflate_2$1","put","last_bits","last_op","last_val","hbuf","order","inf_leave","done","xflags","extra_len","inflate_1$2","inflateInit","inflate","inflateEnd","inflateGetHeader","inflateSetDictionary","dictid","inflateInfo","gzheader","Inflate$1","inflate$1","inflator","last_avail_out","next_out_utf8","tail","utf8str","inflate_1$1","Inflate","inflateRaw","ungzip","deflate_1","inflate_1","TDcmpStruct","in_buff","ctype","outputPos","dsize_bits","dsize_mask","bit_buff","in_pos","out_buff","DistBits","DistCode","ExLenBits","LenBase","LenBits","LenCode","ChBitsAsc","ChCodeAsc","generatedDecodeTabs","DistPosCodes","LengthCodes","generatedAscTabs","offs2C34","offs2D34","offs2E34","offs2EB4","GenDecodeTabs","positions","start_indexes","length_bits","elements","WasteBits","pWork","nBits","DecodeLit","extra_length_bits","length_code","extra_length","uncompressed_byte","DecodeDist","rep_length","dist_pos_code","explode","acc","pChCodeAsc","pChBitsAsc","bits_asc","GenAscTabs","next_literal","minus_dist","Expand","searchHeader","isArchive","MpqFile","archive","rawBuffer","headerOffset","blockIndex","padStart","nameResolved","arrayBuffer","readonly","locale","platform","hashTable","blockTable","splice","files","rename","newName","newHash","sector","decompressSector","sectorCount","sectorSize","sectorOffsets","uncompressedSize","decompressedSize","compressionMask","offsets","sectors","compression","sectorOffset","compressed","isCompressed","reEncrypt","newEncryptionKey","offsetChanged","MpqHash","nameA","nameB","localePlatform","MpqHashTable","getInsertionIndex","insertionIndex","MpqArchive","formatVersionSectorSize","hashPos","blockPos","hashSize","blockSize","listfile","headerSize","saveMemory","getFileNames","file","hashes","blocks","filesSize","archiveSize","log2","saved","removeBlock","names","countUnresolved","unresolved","applyListfile","has","resizeHashtable","oldEntries","Import","isCustom","War3MapImp","newPath","Modification","variableType","levelOrVariation","dataPointer","useOptionalInts","ModifiedObject","oldId","newId","modifications","modification","ModificationTable","War3MapW3d","originalTable","customTable","bufferOrStream","War3MapW3u","CustomTextTrigger","textLength","War3MapWct","trigger","triggers","TriggerCategory","isComment","Variable","isArray","arraySize","isInitialized","initialValue","SubParameters","beginParameters","parameters","triggerData","signature","getFunction","parameter","Parameter","subParameters","arrayIndex","ECA","group","isEnabled","ecas","isChildECA","eca","Trigger","description","isInitiallyOff","runOnInitialization","category","War3MapWtg","categories","variables","variable","War3MapWts","stringMap","getString","setString","Force","playerMasks","Player","race","isFixedStartPosition","startLocation","allyLowPriorities","allyHighPriorities","RandomItem","chance","RandomItemSet","items","item","RandomItemTable","sets","RandomUnit","RandomUnitTable","columnTypes","units","unit","TechAvailabilityChange","playerFlags","UpgradeAvailabilityChange","levelAffected","availability","War3MapW3i","saves","editorVersion","buildVersion","author","recommendedPlayers","cameraBounds","cameraBoundsComplements","playableSize","tileset","campaignBackground","loadingScreenModel","loadingScreenText","loadingScreenTitle","loadingScreenSubtitle","loadingScreen","prologueScreenModel","prologueScreenText","prologueScreenTitle","prologueScreenSubtitle","useTerrainFog","fogHeight","fogDensity","fogColor","globalWeather","soundEnvironment","lightEnvironmentTileset","waterVertexColor","scriptMode","graphicsMode","players","upgradeAvailabilityChanges","techAvailabilityChanges","randomUnitTables","randomItemTables","player","force","upgradeAvailabilityChange","techAvailabilityChange","randomUnitTable","randomItemTable","change","getBuildVersion","War3Map","maxPlayers","imports","readImports","setImportsFile","archiveBuffer","information","getMapInformation","getImportNames","import","getScriptFile","parser","readTriggers","readCustomTextTriggers","readStringTable","readModifications","fileNames","Doodad","life","itemTable","itemSets","editorId","itemSet","TerrainDoodad","War3MapDoo","doodads","terrainDoodads","doodad","terrainDoodad","Corner","groundHeight","waterHeight","mapEdge","ramp","blight","water","boundary","groundTexture","cliffVariation","groundVariation","cliffTexture","layerHeight","waterAndEdge","textureAndFlags","cliffTextureAndLayer","War3MapW3e","haveCustomTileset","groundTilesets","cliffTilesets","mapSize","centerOffset","corners","column","corner","groundTileset","cliffTileset","DroppedItem","DroppedItemSet","InventoryItem","ModifiedAbility","activeForAutocast","heroLevel","Unit","hitpoints","mana","droppedItemTable","droppedItemSets","goldAmount","targetAcquisition","heroStrength","heroAgility","heroIntelligence","itemsInInventory","modifiedAbilities","randomFlag","itemClass","unitGroup","positionInGroup","customTeamColor","waygate","creationNumber","subversion","modifiedAbility","randomUnit","droppedItemSet","itemInInventory","War3MapUnitsDoo","convertBitRange","fromBits","toBits","_typeof","iterator","JpegError","dctZigZag","dctCos1","dctSin1","dctCos3","dctSin3","dctCos6","dctSin6","dctSqrt2","dctSqrt1d2","buildHuffmanTable","codeLengths","children","getBlockBufferOffset","component","col","blocksPerLine","decodeScan","frame","components","resetInterval","spectralStart","spectralEnd","successivePrev","successive","mcusPerLine","progressive","startOffset","bitsData","bitsCount","readBit","nextByte","decodeHuffman","receive","receiveAndExtend","eobrun","successiveACNextValue","successiveACState","decodeMcu","mcu","mcuCol","decodeBlock","componentsLength","decodeFn","huffmanTableDC","diff","blockData","pred","huffmanTableAC","fileMarker","mcuExpected","blocksPerColumn","mcusPerColumn","mcuToRead","findNextFileMarker","invalid","marker","quantizeAndInverse","blockBufferOffset","qt","quantizationTable","v5","v6","v7","p4","p5","p6","p7","buildComponentData","computationBuffer","blockRow","blockCol","currentPos","startPos","peekUint16","maxPos","newPos","currentMarker","newMarker","JpegImage","decodeTransform","colorTransform","parse","readDataBlock","endOffset","prepareComponents","samplesPerLine","maxH","scanLines","maxV","blocksPerLineForMcu","blocksBufferSize","jfif","adobe","quantizationTables","huffmanTablesAC","huffmanTablesDC","appData","major","minor","densityUnits","xDensity","yDensity","thumbWidth","thumbHeight","thumbData","flags0","flags1","transformCode","quantizationTablesEnd","quantizationTableSpec","tableData","extended","componentIds","componentId","componentsCount","qId","quantizationId","huffmanLength","huffmanTableSpec","codeLengthSum","huffmanValues","selectorsCount","componentIndex","tableSpec","successiveApproximation","processed","scaleX","scaleY","numComponents","getData","lineData","lineOffset","scanLine","bufferOffset","offset2","sample","BlpImage","content","alphaBits","hasMipmaps","mipmapOffsets","mipmapSizes","jpgHeader","pallete","getMipmap","jpegImage","bitStream","bitsToByte","dataIndex","paletteIndex","mipmaps","fakeMipmaps","dxt4to8","dxt5to8","dxt6to8","dx1colors","dx3colors","dx5alphas","red","green","dx1Colors","color0","color1","r0","g0","g1","dx3Colors","rgColors","FOURCC_DXT1","FOURCC_DXT3","FOURCC_DXT5","FOURCC_ATI2","DdsImage","format","mipmapWidths","mipmapHeights","mipmapDatas","fourCC","extendedHeader","dxgiFormat","mipmap","dst","blockY","blockHeight","blockX","blockWidth","dstI","rowOffset","dstOffset","dstIndex","colorOffset","decodeDxt1","rowBytes","colorBits","colorIndex","decodeDxt3","alpha0","alpha1","alphaOffset","alphaIndex","decodeDxt5","blockOffset","redbits","greenbits","shifts","decodeRgtc","isDds","_checkHeader","imageType","hasColorMap","colorMapLength","colorMapDepth","colorMapType","pixelDepth","_decodeRLE","_getImageData8bits","_getImageData16bits","_getImageData24bits","_getImageData32bits","_getImageDataGrey8bits","_getImageDataGrey16bits","idLength","colorMapIndex","offsetX","offsetY","hasEncoding","isGreyColor","palette","createImageData","Uint8ClampedArray","getCanvas","getDataURL","TgaImage","tga","isTga","async","fetchDataType","dataType","ok","fetch","ClientBuffer","byteView","floatView","createBuffer","reserve","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","bindAndUpdate","bufferSubData","ClientDataTexture","texture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","texImage2D","RGBA","FLOAT","texSubImage2D","DataTexture","channels","RGB","activeTexture","TEXTURE0","Shader","webgl","program","uniforms","attribs","attribsCount","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","substr","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","use","useShader","WebGL","currentShader","extensions","twoByTwo","emptyTexture","UNSIGNED_BYTE","ensureExtension","ext","getExtension","createShader","vertexSource","fragmentSource","vertex","VERTEX_SHADER","shaderSource","compileShader","fragment","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","LINK_STATUS","vertexLog","getShaderInfoLog","fragmentLog","enableVertexAttribs","enableVertexAttribArray","disableVertexAttribs","disableVertexAttribArray","oldAttribs","newAttribs","useProgram","webglResource","bindTextureAndWrap","wrapS","wrapT","setTextureMode","magFilter","minFilter","createClientBuffer","createDataTexture","createClientDataTexture","vectorHeap","vectorHeap2","vectorHeap3","quatHeap","facingCorrection","isPerspective","isOrtho","leftClipPlane","rightClipPlane","bottomClipPlane","topClipPlane","nearClipPlane","farClipPlane","inverseRotation","viewMatrix","projectionMatrix","viewProjectionMatrix","inverseViewMatrix","inverseViewProjectionMatrix","directionX","directionY","directionZ","billboardedVectors","update","setLocation","move","setRotation","face","moveToAndFace","reset","cameraToWorld","worldToCamera","worldToScreen","screenToWorldRay","Cell","instances","visible","instance","remove","isVisible","camera","Grid","cellWidth","cellDepth","cells","moved","bounds","worldLocation","worldScale","cell","EmittedObjectUpdater","alive","dt","timeScale","health","kill","Scene","viewer","grid","visibleCells","visibleInstances","updatedParticles","audioEnabled","audioContext","emittedObjectUpdater","lightPosition","enableAudio","AudioContext","disableAudio","suspend","addInstance","scene","removeInstance","detach","removeScene","forward","positionX","positionY","positionZ","forwardX","forwardY","forwardZ","upX","upY","upZ","rendered","updateFrame","sort","renderInstance","startFrame","scissor","depthMask","clearColor","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","renderOpaque","renderTranslucent","render","clearEmittedObjects","Resource","resourceData","blockers","fetchUrl","unload","GenericResource","HandlerResource","pathSolver","ImageTexture","LINEAR","LINEAR_MIPMAP_LINEAR","generateMipmap","DebugRenderMode","ModelViewer","resources","resourceMap","promiseMap","handlers","Set","scenes","sharedCache","debugRenderMode","None","directLoadId","depthFunc","LEQUAL","enable","DEPTH_TEST","SCISSOR_TEST","addHandler","isValidSource","reason","addScene","solverParams","finalSrc","promise","detectFormat","resource","then","actualSrc","HTMLImageElement","HTMLCanvasElement","HTMLVideoElement","isImageSource","detectMime","Blob","all","checkLoadingStatus","loadGeneric","callback","fetchPromise","performance","now","setTimeout","whenAllLoaded","updateAndRender","locationHeap","rotationHeap","scalingHeap","Node","pivot","localLocation","localRotation","localScale","worldRotation","inverseWorldLocation","inverseWorldRotation","inverseWorldScale","localMatrix","worldMatrix","dontInheritTranslation","dontInheritRotation","dontInheritScaling","setPivot","recalculateTransformation","setScale","varying","setUniformScale","uniform","setTransformation","resetTransformation","movePivot","rotateLocal","uniformScale","setParent","computedLocation","parentPivot","computedRotation","computedScaling","parentInverseScale","parentScale","child","Bounds","fromExtents","ModelInstance","textureOverrides","show","hide","shown","hidden","overrideTexture","getBounds","setScene","updateAnimations","_dt","biggest","bufferOrImage","isPOT","compressedTextures","internalFormat","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","pixelStorei","UNPACK_ALIGNMENT","compressedTexImage2D","LUMINANCE_ALPHA","M3Texture","repeatS","repeatT","layerTypeToTextureUnit","diffuse","decal","specular","gloss","emissive","emissive2","evio","evioMask","alphaMask","alphaMask2","normal","heightMap","lightMap","ao","M3Layer","material","layerReference","active","colorChannels","uvCoordinate","textureUnit","clampResult","teamColorMode","settings","uniformMap","enabled","m3Texture","uniform1f","STANDARD_MATERIAL_OFFSET","uniform1i","unbind","M3StandardMaterial","doubleSided","bindCommon","BLEND","blendFunc","ONE","disable","CULL_FACE","uniform4f","M3Bone","inhertTranslation","inheritScale","inheritRotation","billboard1","billboard2","twoDProjection","animated","inverseKinematics","skinned","real","M3Sequence","sequence","M3Sts","hasData","animRef","M3Sd","M3SdContainer","addSds","sds","getValueUnsafe","animationReference","va","vb","fakeVa","M3Stc","uints","container","M3Stg","stcs","stss","M3Attachment","attachment","M3Camera","M3Region","region","elementArray","drawElements","TRIANGLES","UNSIGNED_SHORT","cameraRayHeap","rotationHeap2","SkeletalNode","billboarded","billboardedX","billboardedY","billboardedZ","dirty","wasDirty","convertBasis","_rotation","createSkeletalNodes","nodes","count3","count4","count16","pivots","localLocations","localRotations","localScales","worldLocations","worldRotations","worldScales","inverseWorldLocations","invereseWorldRotations","inverseWorldScales","localMatrices","worldMatrices","i3","i33","i4","i44","i16","i1616","M3Node","halfPI","M3Skeleton","sharedNodeData","modelNodes","initialReference","modelNode","getValue4","getValue3","getValue","getValue2","unsafeHeap","boneHeap","M3ModelInstance","skeleton","teamColor","vertexColor","sequenceLoopMode","sequenceEnded","forced","boneTexture","setSequence","setTexture","updateSkeletonAndBoneTexture","isAnimated","finalMatrix","m3Cache","vertexSize","uvSetCount","standardShaders","uniform4fv","uniformMatrix4fv","uniform3fv","vertexAttribPointer","SHORT","ELEMENT_ARRAY_BUFFER","elementBuffer","batch","sequenceId","setTeamColor","setVertexColor","setSequenceLoopMode","getAttachment","M3Batch","teamColors","uniform3f","handlerData","bufferOrParser","materialMaps","setupGeometry","standardMaterials","regionId","materialMap","stgs","addGlobalAnims","totalElements","STATIC_DRAW","mapMaterial","OfflineAudioContext","MappedDataRow","MappedData","mapped","property","getRow","getProperty","setRow","findRow","expectedValue","SdSequence","isGlobal","constant","defval","firstValue","every","element","startFrameIndex","endFrameIndex","lengthLessOne","endFrame","timeBetweenFrames","interpolate","forcedInterpMap","floatDefval","uintDefval","visibilityDefval","translationDefval","rotationDefval","scaleDefval","colorDefval","defVals","forcedInterp","counter","isVariant","ScalarSd","startValue","VectorSd","QuatSd","createTypedSd","variants","getScalarValue","defaultValue","getVectorValue","getQuatValue","addVariants","variantName","addVariantIntersection","textureAnimation","getScale","emitterFilterMode","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ZERO","SRC_COLOR","DST_COLOR","layerId","blendSrc","blendDst","blended","unshaded","sphereEnvironmentMap","twoSided","unfogged","noDepthTest","noDepthSet","depthMaskValue","layerFilterMode","getAlpha","getTextureId","geosetAnimation","getColor","cameraAnchored","anyBillboarding","getVisibility","_sequence","_frame","_counter","light","getAttenuationStart","getAttenuationEnd","getIntensity","getAmbientIntensity","getAmbientColor","internalModel","ParticleEmitterObject","getSpeed","getLatitude","getLongitude","getLifeSpan","getGravity","getEmissionRate","startHeap","endHeap","BYTES_PER_OBJECT","EMITTER_EVENT_TEXTURE_OFFSET","bindEventObjectEmitterBuffer","floatOffset","p0Offset","BYTE_OFFSET_P0","BYTE_OFFSET_HEALTH","renderEmitter","emitterType","emitterObject","geometryEmitterType","instancedArrays","modelSpace","facing","velocity","bindParticleEmitter2Buffer","mdxCache","colors","intervals","replaceable","mdxTexture","internalTexture","teamGlows","xYQuad","teamColored","bindParticleEmitter2Shader","chainLengthFactor","leftRightTopOffset","bindRibbonEmitterBuffer","actualTexture","bindRibbonEmitterShader","intervalTimes","bindEventObjectSplEmitterShader","bindEventObjectUbrEmitterShader","drawArraysInstancedANGLE","MdxTexture","ParticleEmitter2Object","lineEmitter","texturesExt","reforged","cellHeight","blendModes","getWidth","getLength","getVariation","RibbonEmitterObject","getHeightBelow","getHeightAbove","getTextureSlot","keyframe","getTargetTranslation","EventObjectEmitterObject","eventObject","distanceCutoff","maxDistance","minDistance","pitch","pitchVariance","volume","decodedBuffers","getEventObjectData","hd","getValueAtTime","collisionShape","SkinningType","geoset","layerOrMaterial","skinningType","isHd","positionOffset","normalOffset","tangentOffset","skinOffset","faceOffset","faceType","bindShared","bindVertexGroups","skinDataType","bytesPerSkinElement","bindVertexGroupsExtended","bindSkin","bindExtended","bindHd","Skin","ExtendedVertexGroups","BatchGroup","layerAlphas","getBatchShader","normalsLayer","ormLayer","teamColorLayer","environmentMapLayer","layerAlpha","diffuseId","normalsId","ormId","emissiveId","teamColorId","environmentMapId","diffuseTexture","normalsTexture","ormTexture","emissiveTexture","teamColorTexture","environmentMapTexture","actualDiffuseTexture","actualNormalsTexture","actualOrmTexture","actualEmissiveTexture","actualTeamColorTexture","actualEnvironmentMapTexture","geosetColors","layerTextures","uvAnims","geosetIndex","layerIndex","geosetColor","textureIndex","layerTexture","uvAnim","uniform2f","EmitterGroup","particlesShader","rectBuffer","vertexAttribDivisorANGLE","getPrio","matchingGroup","createMatchingGroup","MdxNode","visibilityHeap","AttachmentInstance","internalInstance","Emitter","currentEmission","updateEmission","emitObject","emitData","createObject","otherObject","MdxEmitter","EmittedObject","velocityHeap","latitudeHeap","lifeSpanHeap","gravityHeap","speedHeap","Particle","emissionRateHeap","allowParticleSpawn","widthHeap","lengthHeap","variationHeap","Particle2","lastEmissionKey","belowHeap","aboveHeap","colorHeap","alphaHeap","slotHeap","Ribbon","ribbon","valueHeap","EventObjectEmitter","lastValue","EventObjectSpn","EventObjectSpnEmitter","vertexHeap","EventObjectSplUbr","EventObjectSplEmitter","EventObjectUbrEmitter","EventObjectSnd","panner","createPanner","createBufferSource","refDistance","connect","destination","EventObjectSndEmitter","translationHeap","scaleHeap","textureIdHeap","MdxModelInstance","eventObjectEmitters","sortedNodes","genericObjects","nodeIndex","initNode","helper","attachmentInstance","hierarchy","setParticle2Texture","setEventTexture","genericObject","resetAttachments","updateNodes","sortedGenericObjects","updateBatches","updateBoneTexture","opaqueGroups","translucentGroups","frameTime","resetEventEmitters","mappedDataCallback","decodedDataCallback","decodeAudioData","sdExtendedVert","sdDiffuse","sdTexcoords","sdNormals","hdExtendedVert","hdSkinVert","hdDiffuse","hdNormalMap","hdOcclusion","hdRoughness","hdMetallic","hdTCFactor","hdEmissive","hdTexCoords","hdNormals","hdTangents","sdShader","sdExtendedShader","hdShader","hdExtendedShader","hdSkinShader","sdDebugShaders","hdDebugShaders","shaders","Diffuse","TexCoords","Normals","VertexGroups","NormalMap","Occlusion","Roughness","Metallic","TCFactor","Emissive","Tangents","eventObjectTables","hasLayerAnims","hasGeosetAnims","hasTeamColors","vLayer","particleEmitter","particleEmitter2","ribbonEmitter","positionBytes","normalBytes","uvBytes","tangentBytes","skinBytes","faceBytes","skinTypes","biggestGroup","SkinTypedArray","skinGlType","BYTES_PER_ELEMENT","skinType","maxBones","matrixGroup","vGeoset","setupGeosets","opaqueBatches","translucentBatches","currentGroup","setupGroups","setupHierarchy","loadTeamTextures","teams","params","teamGlow","getEventObjectSoundFile","tables","raceRow","filePath","safePathSolver","paths","promises","mappedData","lookupRow","fileName","filtered","filter","unique","cliffVariations","AAAB","AAAC","AABA","AABB","AABC","AACA","AACB","AACC","ABAA","ABAB","ABAC","ABBA","ABBB","ABBC","ABCA","ABCB","ABCC","ACAA","ACAB","ACAC","ACBA","ACBB","ACBC","ACCA","ACCB","ACCC","BAAA","BAAB","BAAC","BABA","BABB","BABC","BACA","BACB","BACC","BBAA","BBAB","BBAC","BBBA","BBCA","BCAA","BCAB","BCAC","BCBA","BCCA","CAAA","CAAB","CAAC","CABA","CABB","CABC","CACA","CACB","CACC","CBAA","CBAB","CBAC","CBBA","CBCA","CCAA","CCAB","CCAC","CCBA","CCCA","cityCliffVariations","getCliffVariation","dir","TerrainModel","locations","vertexArrayObject","uvs","normalsOffset","uvsOffset","vao","createVertexArrayOES","bindVertexArrayOES","vertexBuffer","texturesOffset","locationAndTextureBuffer","faceBuffer","drawElementsInstancedANGLE","sequenceSorter","randomStandSequence","filterSequences","sequencesLeft","selectSequence","WidgetState","Widget","IDLE","worldScene","heapZ","centeroffset","normalHeap1","normalHeap2","War3MapViewerMap","waterIndex","waterIncreasePerFrame","waterHeightOffset","waterTextures","maxDeepColor","minDeepColor","maxShallowColor","minShallowColor","anyReady","terrainReady","cliffsReady","doodadsReady","unitsReady","tilesetTextures","cliffTextures","cliffModels","tilesets","blightTextureIndex","instanceBuffer","textureBuffer","variationBuffer","waterBuffer","waterHeightMap","cliffHeightMap","loadMapInformation","wc3PathSolver","loadTerrainCliffsAndWater","applyModificationFile","doodadsData","doodadMetaData","w3d","destructableMetaData","w3b","unitsData","unitMetaData","w3u","w3t","loadDoodadsAndDestructibles","loadUnitsAndItems","die","mpqFile","terrainData","K","N","O","Q","V","W","X","Y","cliffTypesData","waterRow","waterData","instanceCount","cliffHeights","cornerHeights","waterHeights","cornerTextures","cornerVariations","waterFlags","cliffs","bottomLeft","isWater","isCliff","bottomLeftLayer","bottomRightLayer","topLeftLayer","topRightLayer","cliffFileName","bottomLeftTexture","cornerTexture","bottomRightTexture","topLeftTexture","topRightTexture","bitset","ALPHA","currentValue","cliffShader","cliffPromisesForReal","cliff","loadBaseFile","numVar","endsWith","fileVar","renderGround","renderCliffs","renderWater","groundShader","instanceAttrib","positionAttrib","texturesAttrib","variationsAttrib","tilesetCount","uniform2fv","TEXTURE15","isExtended","waterShader","isWaterAttrib","TEXTURE1","TEXTURE2","bottomRight","topLeft","topRight","cliffGroundIndex","whichCliff","whichTileset","dataMap","metadataMap","modificationFile","applyModificationTable","modificationTable","modificationObject","assign","metadata","groundNormal","cellX","cellY","blp","dds","m3","mdx","War3MapViewer","isReforged","loadedBaseFiles","loadBaseFiles","reforgedPromises","terrain","cliffTypes","destructableData","unitData","unitUi","itemData","doodadSkins","destructableSkin","unitSkin","itemSkin","loadMap","Camera","JassHandle","handleId","JassAgent","JassPlayer","team","forcedStartLocation","racePreference","raceSelectable","controller","alliances","passive","helpRequest","helpResponse","sharedXp","sharedSpells","sharedVision","sharedControl","sharedAdvancedControl","rescuable","sharedVisionForced","JassWidget","maxHealth","JassUnit","unitId","acquireRange","JassForce","JassGroup","JassTrigger","conditions","actions","JassTimer","elapsed","timeout","periodic","handlerFunc","JassLocation","JassRegion","rects","JassRect","minx","miny","maxx","maxy","JassEnum","JassRace","JassAllianceType","JassRacePreference","JassGameState","JassIGameState","JassFGameState","JassPlayerState","JassPlayerScore","JassPlayerGameResult","JassUnitState","JassAiDifficulty","JassEventId","JassGameEvent","JassPlayerEvent","JassPlayerUnitEvent","JassUnitEvent","JassLimitOp","JassWidgetEvent","JassDialogEvent","JassUnitType","JassGameSpeed","JassGameDifficulty","JassGameType","JassMapFlag","JassMapVisibility","JassMapDensity","JassMapControl","JassPlayerSlotState","JassVolumeGroup","JassCameraField","JassCameraSetup","targetDistance","farZ","angleOfAttack","roll","zOffset","destPosition","JassPlayerColor","JassPlacement","JassStartLocPrio","JassRarityControl","JassBlendMode","JassTexMapFlags","JassEffectType","JassWeatherEffect","whichRect","effectId","JassFogState","JassVersion","JassItemType","JassAttackType","JassDamageType","JassWeaponType","JassSoundType","JassPathingType","JassHashTable","parentKey","childKey","childTable","flushChild","createRectangle","edges","boundingRadius","createUnitRectangle","createCube","createUnitCube","createSphere","stacks","slices","points","vOffset","uOffset","theta","sinTheta","cosTheta","phi","sinPhi","cosPhi","fOffset","second","createUnitSphere","createCylinder","eOffset","createUnitCylinder","createFrustum","aspectRatio","tanFov","nearHeight","nearWidth","farHeight","farWidth","vecHeap","vecHeap2","twistHeap","getTouchesLength","touch1","touch2","dx","clientX","dy","clientY","SimpleOrbitCamera","rotationSpeed","zoomFactor","horizontalAngle","verticalAngle","twist","mouse","buttons","touchMode","touches","onManualChange","onResize","preventDefault","button","deltaY","deltaMode","zoom","targetTouches","oldTouch","newTouch","len1","len2","mdxCamera","updateInternalCamera","dirX","dirY","sw","sh","manualChange","factor","clientWidth","clientHeight","applyInstanceCamera","initModelViewer","getElementById","origin","hive","promise1","catch","promise2","any","loadModel","instance2","instance3","setupCamera","requestAnimationFrame","clearModel"],"sourceRoot":""}