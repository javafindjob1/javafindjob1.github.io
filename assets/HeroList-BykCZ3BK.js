import{d as G,r as E,e as ce,w as $e,b as he,T as Ce,a as i,n as b,f as S,o as H,_ as j,g as U,i as be,c as $,h as ue,u as J,t as k,F as q,j as Y,k as X,l as ee}from"./index-ByX_AsRM.js";var Ee=1e-6,O=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Oe(){var e=new O(9);return O!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function R(){var e=new O(3);return O!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function de(e){var t=e[0],n=e[1],s=e[2];return Math.hypot(t,n,s)}function se(e,t,n){var s=new O(3);return s[0]=e,s[1]=t,s[2]=n,s}function Se(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function F(e,t,n,s){return e[0]=t,e[1]=n,e[2]=s,e}function V(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Pe(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function W(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function te(e,t){var n=t[0],s=t[1],a=t[2],o=n*n+s*s+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function ze(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Z(e,t,n){var s=t[0],a=t[1],o=t[2],r=n[0],l=n[1],c=n[2];return e[0]=a*c-o*l,e[1]=o*r-s*c,e[2]=s*l-a*r,e}function oe(e,t,n){var s=t[0],a=t[1],o=t[2],r=n[3]*s+n[7]*a+n[11]*o+n[15];return r=r||1,e[0]=(n[0]*s+n[4]*a+n[8]*o+n[12])/r,e[1]=(n[1]*s+n[5]*a+n[9]*o+n[13])/r,e[2]=(n[2]*s+n[6]*a+n[10]*o+n[14])/r,e}function Re(e,t,n){var s=n[0],a=n[1],o=n[2],r=n[3],l=t[0],c=t[1],M=t[2],u=a*M-o*c,v=o*l-s*M,f=s*c-a*l,m=a*f-o*v,y=o*u-s*f,T=s*v-a*u,I=r*2;return u*=I,v*=I,f*=I,m*=2,y*=2,T*=2,e[0]=l+u+m,e[1]=c+v+y,e[2]=M+f+T,e}var Ne=Pe,De=de;(function(){var e=R();return function(t,n,s,a,o,r){var l,c;for(n||(n=3),s||(s=0),a?c=Math.min(a*n+s,t.length):c=t.length,l=s;l<c;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],o(e,e,r),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();function Ue(){var e=new O(4);return O!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Ve(e,t){var n=t[0],s=t[1],a=t[2],o=t[3],r=n*n+s*s+a*a+o*o;return r>0&&(r=1/Math.sqrt(r)),e[0]=n*r,e[1]=s*r,e[2]=a*r,e[3]=o*r,e}(function(){var e=Ue();return function(t,n,s,a,o,r){var l,c;for(n||(n=4),s||(s=0),a?c=Math.min(a*n+s,t.length):c=t.length,l=s;l<c;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],o(e,e,r),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();function ne(){var e=new O(4);return O!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function qe(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Ye(e,t,n){n=n*.5;var s=Math.sin(n);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(n),e}function Fe(e,t,n){n*=.5;var s=t[0],a=t[1],o=t[2],r=t[3],l=Math.sin(n),c=Math.cos(n);return e[0]=s*c+r*l,e[1]=a*c+o*l,e[2]=o*c-a*l,e[3]=r*c-s*l,e}function Be(e,t,n){n*=.5;var s=t[0],a=t[1],o=t[2],r=t[3],l=Math.sin(n),c=Math.cos(n);return e[0]=s*c+a*l,e[1]=a*c-s*l,e[2]=o*c+r*l,e[3]=r*c-o*l,e}function Q(e,t,n,s){var a=t[0],o=t[1],r=t[2],l=t[3],c=n[0],M=n[1],u=n[2],v=n[3],f,m,y,T,I;return m=a*c+o*M+r*u+l*v,m<0&&(m=-m,c=-c,M=-M,u=-u,v=-v),1-m>Ee?(f=Math.acos(m),y=Math.sin(f),T=Math.sin((1-s)*f)/y,I=Math.sin(s*f)/y):(T=1-s,I=s),e[0]=T*a+I*c,e[1]=T*o+I*M,e[2]=T*r+I*u,e[3]=T*l+I*v,e}function Xe(e,t){var n=t[0]+t[4]+t[8],s;if(n>0)s=Math.sqrt(n+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[a*3+a]&&(a=2);var o=(a+1)%3,r=(a+2)%3;s=Math.sqrt(t[a*3+a]-t[o*3+o]-t[r*3+r]+1),e[a]=.5*s,s=.5/s,e[3]=(t[o*3+r]-t[r*3+o])*s,e[o]=(t[o*3+a]+t[a*3+o])*s,e[r]=(t[r*3+a]+t[a*3+r])*s}return e}var ve=Ve;(function(){var e=R(),t=se(1,0,0),n=se(0,1,0);return function(s,a,o){var r=ze(a,o);return r<-.999999?(Z(e,t,a),De(e)<1e-6&&Z(e,n,a),te(e,e),Ye(s,e,Math.PI),s):r>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(Z(e,a,o),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+r,ve(s,s))}})();(function(){var e=ne(),t=ne();return function(n,s,a,o,r,l){return Q(e,s,r,l),Q(t,a,o,l),Q(n,e,t,2*l*(1-l)),n}})();(function(){var e=Oe();return function(t,n,s,a){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],ve(t,Xe(t,e))}})();function Ge(e,t={}){return new je(e,t)}const L=R(),P=R(),z=ne(),ae=new Float32Array(1);function ie(e,t){let n=t.clientX-e.clientX,s=t.clientY-e.clientY;return Math.sqrt(n*n+s*s)}const B=-1,re=0,le=1;class je{constructor(t,n={}){this.scene=t,this.canvas=t.viewer.canvas,this.camera=t.camera,this.moveSpeed=n.moveSpeed||2,this.rotationSpeed=n.rotationSpeed||Math.PI/180,this.zoomFactor=n.zoomFactor||.1,this.horizontalAngle=n.horizontalAngle||Math.PI/2,this.verticalAngle=n.verticalAngle||Math.PI/4,this.distance=n.distance||500,this.position=n.position||R(),this.target=n.target||R(),this.twist=n.twist||0,this.mouse={buttons:[!1,!1,!1],x:0,y:0,x2:0,y2:0},this.touchMode=B,this.touches=[],this.instance=null,this.onManualChange=n.onManualChange||null,this.fov=n.fov||Math.PI/4,this.nearClipPlane=n.nearClipPlane||1,this.farClipPlane=n.farClipPlane||2e5,this.update(),window.addEventListener("resize",s=>this.onResize()),setTimeout(()=>this.onResize(),0),this.canvas.addEventListener("contextmenu",s=>s.preventDefault()),this.canvas.addEventListener("selectstart",s=>s.preventDefault()),this.canvas.addEventListener("mousedown",s=>{s.preventDefault(),this.mouse.buttons[s.button]=!0}),document.addEventListener("mouseup",s=>{s.preventDefault(),this.mouse.buttons[s.button]=!1}),window.addEventListener("mousemove",s=>{this.mouse.x2=this.mouse.x,this.mouse.y2=this.mouse.y,this.mouse.x=s.clientX,this.mouse.y=s.clientY;let a=this.mouse.x-this.mouse.x2,o=this.mouse.y-this.mouse.y2;this.mouse.buttons[0]&&this.rotate(a,o),this.mouse.buttons[2]&&this.move(-a,o)}),this.canvas.addEventListener("wheel",s=>{s.preventDefault();let a=s.deltaY;s.deltaMode===1&&(a=a/3*100),this.zoom(a/100)}),this.canvas.addEventListener("touchstart",s=>{s.preventDefault();let a=s.targetTouches;a.length===1?this.touchMode=re:a.length==2?this.touchMode=le:this.touchMode=B,this.touches.length=0,this.touches.push(...a)}),this.canvas.addEventListener("touchend",s=>{s.preventDefault(),this.touchMode=B}),this.canvas.addEventListener("touchcancel",s=>{s.preventDefault(),this.touchMode=B}),this.canvas.addEventListener("touchmove",s=>{s.preventDefault();let a=s.targetTouches;if(this.touchMode===re){let o=this.touches[0],r=a[0],l=r.clientX-o.clientX,c=r.clientY-o.clientY;this.rotate(l,c)}else if(this.touchMode===le){let o=ie(this.touches[0],this.touches[1]),r=ie(a[0],a[1]);this.zoom((o-r)/50)}this.touches.length=0,this.touches.push(...a)})}update(){if(this.instance){let t=this.instance,n=t.model.cameras[0];n.getTranslation(L,t.sequence,t.frame,t.counter),V(L,L,n.position),n.getTargetTranslation(P,t.sequence,t.frame,t.counter),V(P,P,n.targetPosition),n.getRotation(ae,t.sequence,t.frame,t.counter),this.twist=ae[0],oe(L,L,t.worldMatrix),oe(P,P,t.worldMatrix),this.moveToAndFace(L,P)}else this.updateInternalCamera()}move(t,n){let s=this.camera.directionX,a=this.camera.directionY,o=this.canvas.width,r=this.canvas.height,l=o/r,c=t/o*this.distance*l,M=n/r*this.distance;V(this.target,this.target,W(L,te(L,F(L,s[0],s[1],0)),c)),V(this.target,this.target,W(L,te(L,F(L,a[0],a[1],0)),M)),this.manualChange()}rotate(t,n){this.horizontalAngle-=t*this.rotationSpeed,this.verticalAngle-=n*this.rotationSpeed,this.manualChange()}zoom(t){this.distance=Math.max(1,this.distance*(1+t*this.zoomFactor)),this.manualChange()}manualChange(){this.updateInternalCamera(),this.instance&&(this.instance=null,this.onManualChange&&this.onManualChange())}onResize(){let t=Math.max(this.canvas.clientWidth,1),n=Math.max(this.canvas.clientHeight,1);this.canvas.width=t,this.canvas.height=n,this.scene.viewport[2]=t,this.scene.viewport[3]=n,this.camera.perspective(this.fov,t/n,this.nearClipPlane,this.farClipPlane)}moveToAndFace(t,n){Ne(L,t,n);let s=de(L),a=Math.atan2(L[1],L[0]),o=Math.acos(L[2]/s);Se(this.target,n),this.verticalAngle=o,this.horizontalAngle=a+Math.PI/2,this.distance=s,this.updateInternalCamera()}updateInternalCamera(){this.verticalAngle=Math.min(Math.max(.01,this.verticalAngle),Math.PI-.01),qe(z),Be(z,z,this.horizontalAngle),Fe(z,z,this.verticalAngle),F(this.position,0,0,1),Re(this.position,this.position,z),W(this.position,this.position,this.distance),V(this.position,this.position,this.target);let t=this.twist-Math.PI/2;F(L,0,-Math.cos(t),-Math.sin(t)),this.camera.moveToAndFace(this.position,this.target,L)}applyInstanceCamera(t){this.instance=t,this.fov=t.model.cameras[0].fieldOfView,this.onResize(),this.update()}}const Ke=G({__name:"MdxModal",props:{mdx:{},skin:{},clickHero:{}},setup(e){window.hive=new Set;const t=E(),n=E();let s;ce(()=>{s=u(n.value,e.skin.mdx),s(e.clickHero.heroId+".mdx")}),$e(()=>e.clickHero.heroId,v=>{s(v+".mdx")});const a=E({left:"50%",top:"50%"});let o,r=0;function l(v){o=v.clientX-t.value.offsetLeft,r=v.clientY-t.value.offsetTop,document.addEventListener("mousemove",c),document.addEventListener("mouseup",M)}function c(v){a.value.left=v.clientX-o+"px",a.value.top=v.clientY-r+"px"}function M(){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",M)}function u(v,f="clients/example/resources"){const m=window.ModelViewer.viewer.handlers,y=new window.ModelViewer.viewer.ModelViewer(v);y.enableAudio(),y.on("error",I=>console.log("error",I)),y.addHandler(m.mdx,T,!0),y.addHandler(m.blp),y.addHandler(m.dds),y.addHandler(m.tga),y.addHandler(m.m3),(function I(){requestAnimationFrame(I),y.updateAndRender()})();function T(I){I=I.toLowerCase();const C=`${window.location.origin}/${f}/${I}`,d=`https://www.hiveworkshop.com/assets/wc3/war3.w3mod/${I}`,h=new AbortController,p=fetch(C).then(g=>g.ok?(console.log("local",g.bytes(),C),h.abort(),C):Promise.reject(new Error("Not found"))).catch(g=>Promise.reject(g)),_=fetch(d,{signal:h.signal}).then(g=>g.ok?(window.hive.add(d),d):Promise.reject(new Error("Not found"))).catch(g=>Promise.reject(g)),w=(async()=>await Promise.any([p,_]))();return console.log("res",w),w}return function(C){y.clear();const d=y.addScene();Ge(d),y.load(C,T).then(p=>{if(p){const _=p,w=_.addInstance();console.log("model",C,_,w);let g=[1,0,2];C.toLowerCase()==="e03r.mdx"&&(g=[14,15,13]),w.setScene(d),w.setSequence(g[0]),w.setSequenceLoopMode(2),w.move([0,0,0]);const A=_.addInstance();A.setScene(d),A.setSequence(g[1]),A.setSequenceLoopMode(2),A.move([100,100,0]),A.uniformScale(.5),console.log("instance2",A);const x=_.addInstance();x.setScene(d),x.setSequence(g[2]),x.setSequenceLoopMode(2),x.move([-100,-100,0])}})}}return(v,f)=>(H(),he(Ce,{to:"body"},[i("div",{class:S(["canvas-mdx",{hide:e.mdx.hide}]),ref_key:"canvasmdx",ref:t,style:b(a.value)},[i("div",{class:"drag-head",onMousedown:l},[...f[1]||(f[1]=[i("p",null,"模型展示",-1)])],32),i("canvas",{ref_key:"canvas",ref:n},null,512),i("div",{class:"close",onClick:f[0]||(f[0]=m=>e.mdx.hideModal(!0))},"×")],6)]))}}),We=j(Ke,[["__scopeId","data-v-a731245a"]]),Ze={class:"console"},Qe=["innerHTML"],Je={class:"console-head"},et={class:"head-text"},tt={class:"red"},nt={class:"left-text"},st={class:"right-text"},ot={class:"blue"},at={class:"left-text"},it={class:"right-text"},rt={class:"console-base"},lt=["innerHTML"],ct=["innerHTML"],ht={class:"hero-base clearfix"},ut={class:"hero-prop rightfix"},dt=["innerHTML"],vt={class:"hero-prop-text"},ft=["innerHTML"],pt={class:"white"},mt=["innerHTML"],_t={class:"white"},gt=["innerHTML"],Mt={class:"white"},yt={class:"hero-prop leftfix"},It=["innerHTML"],wt={class:"hero-prop-text"},At=["innerHTML"],Tt={class:"white"},xt={class:"hero-prop leftfix"},Lt=["innerHTML"],Ht={class:"hero-prop-text"},kt=["innerHTML"],$t={class:"white"},Ct=["innerHTML"],bt={class:"console-item"},Et=["innerHTML"],Ot=["data-hero-id"],St=["innerHTML"],Pt=G({__name:"HeroConsole",props:{skin:{},clickHero:{}},setup(e){const t=e,n=t.skin,s=t.clickHero,a=be("data"),o=U(()=>a?.[s.heroId]);function r(d){const h=d.target;h.dataset.heroId&&s.changeHero(h.dataset.heroId)}function l(){for(let d=0;d<n.heroArr.length;d++){const h=n.heroArr[d];for(let p=0;p<h.length;p++)if(h[p]===o.value.baseUnitId){console.log("定位头像位置：",{i:d,j:p}),n.i=d,n.j=p;return}}}const c=U(()=>(l(),o.value.intro!==null&&o.value.intro!==void 0?{html:m(o.value.intro),active:["active"]}:{html:"",active:[]})),M=U(()=>{const d=Array.from({length:18},(h,p)=>({index:p,html:"",style:""}));return f(d),d}),u=U(()=>I(o.value)),v=U(()=>T(o.value));function f(d){function h(_,w,g,A,x,N,D,K){w&&(d[_]={index:_,html:m(w.desc),style:n.calcAbility(g,A,x,N,D,K)})}function p(_,w,g,A,x,N,D){w&&(d[_]={index:_,heroId:w.unitId,html:m(w.desc),style:n.calcAbility(g,A,x,N,D)})}if(p(0,o.value.p1,o.value.unitId,o.value.p1,o.value.p2,0,0),p(1,o.value.p2,o.value.unitId,o.value.p1,o.value.p2,1,0),h(4,o.value.core,o.value.unitId,o.value.p1,o.value.p2,0,1),h(5,o.value.d2,o.value.unitId,o.value.p1,o.value.p2,1,1),h(7,o.value.t2,o.value.unitId,o.value.p1,o.value.p2,3,1),h(6,o.value.t,o.value.unitId,o.value.p1,o.value.p2,2,1),h(7,o.value.d,o.value.unitId,o.value.p1,o.value.p2,3,1),h(8,o.value.q,o.value.unitId,o.value.p1,o.value.p2,0,2),h(9,o.value.w,o.value.unitId,o.value.p1,o.value.p2,1,2),h(10,o.value.e,o.value.unitId,o.value.p1,o.value.p2,2,2),h(11,o.value.r,o.value.unitId,o.value.p1,o.value.p2,3,2),o.value.items!=null)for(let _=0;_<o.value.items.length;_++)h(12+_,o.value.items[_],o.value.unitId,o.value.p1,o.value.p2,_%2+4,Math.floor(_/2),.68)}function m(d){const h=d.split("|n");let p={str:"",buf:"",lastColor:"|cfffff"};for(const _ of h)p.str=_,p=y(p);return p.buf}function y({str:d,buf:h,lastColor:p}){d=d.replaceAll("/|r|cff/gi","|cff"),d=d.replaceAll("|r","|cfffff"),d=d.replaceAll("|R","|cfffff"),d.startsWith("|cff")||(d=p+d),h+="<p>";const _=/(\|cff(\w{3,6}))(.*?)(?=((\|cff)|$))/gi,w=d.matchAll(_);for(const g of w){p=g[1];const A=g[2],x=g[3];h+=`<span style="color:#${A}">${x}</span>`}return h+="</p>",{str:d,buf:h,lastColor:p}}function T({hp:d,baseUnitId:h,unitId:p,p1:_,p2:w}){if(d==null)throw"hp is null or undefined";return console.log("设置头像",{hp:d,baseUnitId:h,unitId:p,p1:_,p2:w}),{hpArr:d.split(","),headStyle:n.calcHead(p,_,w)}}function I({prop:d,attack:h,armor:p,name:_,propernames:w}){if(d==null)throw"prop is null or undefined";const g=d.split(","),A=h.split(","),x=p.split(",");console.log("1234",A);const N="InfoPanelIconHeroIcon"+g[0];n[N];const D="InfoPanelIconDamage"+A[0].substring(0,1).toUpperCase()+A[0].substring(1);n[D];const K="InfoPanelIconArmor"+x[0].substring(0,1).toUpperCase()+x[0].substring(1);n[K],w=m(w);const fe=m(n.INFOPANEL_LEVEL_CLASS.replace("%u","1").replace("%s",_)),pe=m(n.PRIMARY_ATTRIBUTE),me=m(n.COLON_DAMAGE),_e=m(n.COLON_ARMOR),ge=m(n.COLON_HERO_ATTRIBUTES),Me=m(n.COLON_STRENGTH),ye=m(n.COLON_AGILITY),Ie=m(n.COLON_INTELLECT),we=m(n.COLON_STATUS),Ae=`${n.COLON_HERO_ATTRIBUTES}|n${n.COLON_STRENGTH}|n${g[0]==="0"?n.PRIMARY_ATTRIBUTE:""}${n.str}|n${n.COLON_AGILITY}|n ${g[0]==="1"?n.PRIMARY_ATTRIBUTE:""}${n.agi}|n${n.COLON_INTELLECT}|n${g[0]==="2"?n.PRIMARY_ATTRIBUTE:""}${n.int}`,Te=m(Ae),xe=`${n.COLON_DAMAGE} ${A[1]}|n${n["DAMAGE_"+A[0].toUpperCase()]}|r|n范围： ${A[2]}|n速度： |cff00ff00${((100+Number(g[2])/5)/(100*Number(A[3]))).toFixed(3)}/sec|r|n攻击间隔： |cff00ff00${A[3]} |r|n|n${n["DAMAGETIP_"+A[0].toUpperCase()]}`,Le=m(xe),He=`${n.COLON_ARMOR} ${x[1]}|n${n["ARMOR_"+x[0].toUpperCase()]}|r|n伤害减少：${(Number(x[1])*n.DefenseArmor*100/(1+Number(x[1])*n.DefenseArmor)).toFixed(0)}%|r|n移动速度：${x[2]}|r|n视野：${n.view}|r|n|n${n["ARMORTIP_"+x[0].toUpperCase()]}`,ke=m(He);return{propernames:w,infopanel_level_class:fe,primary_attribute:pe,colon_damage:me,colon_armor:_e,colon_hero_attributes:ge,colon_strength:Me,colon_agility:ye,colon_intellect:Ie,colon_status:we,propStyle:n.calcProp(g[0]),propInfo:Te,attackPropStyle:n.calcAttack(A[0]),attackInfo:Le,defPropStyle:n.calcDef(x[0]),defInfo:ke,propArr:g,attackArr:A,armorArr:x}}const C=E({hide:!0,hideModal(d){this.hide=d}});return(d,h)=>(H(),$("div",Ze,[i("div",{class:S(["info",c.value.active]),innerHTML:c.value.html},null,10,Qe),i("div",Je,[ue(We,{mdx:C.value,skin:J(n),clickHero:J(s)},null,8,["mdx","skin","clickHero"]),i("div",{class:"head-img",style:b(v.value.headStyle),onClick:h[0]||(h[0]=p=>C.value.hide=!1)},null,4),i("div",et,[i("p",tt,[i("span",nt,k(v.value.hpArr[0]),1),h[1]||(h[1]=i("span",{class:"split-text"},"/",-1)),i("span",st,k(v.value.hpArr[0]),1)]),i("p",ot,[i("span",at,k(v.value.hpArr[1]),1),h[2]||(h[2]=i("span",{class:"split-text"},"/",-1)),i("span",it,k(v.value.hpArr[1]),1)])])]),i("div",rt,[i("div",{class:"hero-propsname",innerHTML:u.value.propernames},null,8,lt),i("div",{class:"hero-level-name",innerHTML:u.value.infopanel_level_class},null,8,ct),i("div",ht,[i("div",ut,[i("div",{class:"hero-prop-img",style:b(u.value.propStyle)},[i("div",{class:"console-info",innerHTML:u.value.propInfo},null,8,dt)],4),i("div",vt,[i("div",{innerHTML:u.value.colon_strength},null,8,ft),i("div",null,[i("span",pt,k(u.value.propArr[1]),1),h[3]||(h[3]=i("span",{class:"green"},null,-1))]),i("div",{innerHTML:u.value.colon_agility},null,8,mt),i("div",null,[i("span",_t,k(u.value.propArr[2]),1),h[4]||(h[4]=i("span",{class:"green"},null,-1))]),i("div",{innerHTML:u.value.colon_intellect},null,8,gt),i("div",null,[i("span",Mt,k(u.value.propArr[3]),1),h[5]||(h[5]=i("span",{class:"green"},null,-1))])])]),i("div",yt,[i("div",{class:"hero-prop-img",style:b(u.value.attackPropStyle)},[i("div",{class:"console-info",innerHTML:u.value.attackInfo},null,8,It)],4),i("div",wt,[i("div",{innerHTML:u.value.colon_damage},null,8,At),i("div",null,[i("span",Tt,k(u.value.attackArr[1]),1),h[6]||(h[6]=i("span",{class:"green"},null,-1))])])]),i("div",xt,[i("div",{class:"hero-prop-img",style:b(u.value.defPropStyle)},[i("div",{class:"console-info",innerHTML:u.value.defInfo},null,8,Lt)],4),i("div",Ht,[i("div",{innerHTML:u.value.colon_armor},null,8,kt),i("div",null,[i("span",$t,k(u.value.armorArr[1]),1),h[7]||(h[7]=i("span",{class:"green"},null,-1))])])])]),i("div",{class:"hero-status",innerHTML:u.value.colon_status},null,8,Ct)]),i("div",bt,[(H(),$(q,null,Y(6,p=>i("div",{class:S("console-item-"+p),style:b(M.value[p+11]?.style),key:p},[i("div",{class:"console-info",innerHTML:M.value[p+11]?.html},null,8,Et)],6)),64))]),i("div",{class:"console-ability",onClick:X(r,["prevent"])},[(H(),$(q,null,Y(12,p=>i("div",{class:S("console-ability-"+p),style:b(M.value[p-1]?.style),key:p},[M.value[p-1]?.heroId?(H(),$("a",{key:0,href:"#","data-hero-id":M.value[p-1]?.heroId},null,8,Ot)):ee("",!0),i("div",{class:"console-info",innerHTML:M.value[p-1]?.html},null,8,St)],6)),64))])]))}}),zt=j(Pt,[["__scopeId","data-v-4a2595d7"]]),Rt={class:"update"},Nt={class:"inner modal"},Dt=["data-tabno"],Ut={class:"update-item"},Vt=["data-tabno"],qt={class:"meta"},Yt={class:"update-version"},Ft={class:"updatetime"},Bt=["innerHTML"],Xt=G({__name:"MapUpdate",props:{skin:{}},setup(e){const t=e,n=t.skin.mapId,s=t.skin.currentVersion,a=E({show:!1});function o(u){const v=u.target;if(v.classList.contains("tabno")){const f=v.dataset.tabno;for(const m of c.value)m.active="",m.mapVersion===f&&(m.active="active")}}function r(u){M(),a.value.show=!!u}function l(u,v){fetch(u).then(f=>{if(!f.ok)throw new Error("Network response was not ok "+f.statusText);return f.json()}).then(f=>{console.log(f),v(f)}).catch(f=>{console.error("There was a problem with the fetch operation:",f)})}const c=E([]);function M(){c.value=[],l(`https://map-api.kkdzpt.com/api/v3/map/changelogs?mapId=${n}&start=0&limit=5`,u=>{console.log("开始处理更新数据",u.data.rows);for(const v of u.data.rows){const{mapVersion:f,createTime:m,content:y}=v;c.value.push({mapVersion:f,createTime:m,content:y,active:""})}c.value.length>0&&(c.value[0].active="active")})}return M(),(u,v)=>(H(),$("div",null,[i("div",Rt,[i("p",null,[i("span",null,"页面版本 "+k(J(s))+" 最新 "+k(c.value[0]?.mapVersion),1),i("a",{href:"#","data-turbo":"false",onClick:v[0]||(v[0]=X(f=>r(!0),["prevent"]))},"更新说明"),v[2]||(v[2]=i("i",{class:"iconfont icon-refresh-v2"},null,-1))])]),i("div",{ref:"updateModal",id:"updateModal",class:S(a.value)},[i("div",Nt,[v[3]||(v[3]=i("header",null,"更新说明",-1)),v[4]||(v[4]=i("div",{class:"_sticky_top",style:{position:"relative",top:"-1px",height:"1px"}},null,-1)),i("ul",{class:"tab",onClick:o},[(H(!0),$(q,null,Y(c.value,f=>(H(),$("li",{key:f.mapVersion},[i("span",{class:S(["tabno",{active:f.active}]),"data-tabno":f.mapVersion},k(f.mapVersion),11,Dt)]))),128))]),i("ul",Ut,[(H(!0),$(q,null,Y(c.value,f=>(H(),$("li",{key:f.mapVersion,class:S(["update-detail",{active:f.active}]),"data-tabno":f.mapVersion},[i("h3",qt,[i("span",Yt,k(f.mapVersion),1),i("span",Ft,k(f.createTime),1)]),i("p",{innerHTML:f.content},null,8,Bt)],10,Vt))),128))]),i("div",{class:"close",onClick:v[1]||(v[1]=X(f=>r(!1),["prevent"]))},"×")])],2)]))}}),Gt=j(Xt,[["__scopeId","data-v-25297769"]]),jt={class:"hero"},Kt={class:"container"},Wt=["hero"],Zt=["onClick","data-hero-id"],Qt=G({__name:"HeroList",props:{skin:{}},setup(e){const t=e.skin.locArr,n=e.skin.heroArr,s=e.skin.heightArr,a=e.skin.heroImg,o=E({heroId:"",changeHero(c){this.heroId=c}}),r=E("");ce(()=>{console.log("HeroList mounted"),r.value="background-color: #d2c075;"});const l=E([]);for(let c=0;c<n.length;c++){const M=s[c+1],u=s[c],v=(M-u)*.7,f=u*-.7,m=n[c],y=t[c];for(let T=0;T<m.length;T++){const I=m[T],C=y[T+1],d=y[T],h=(C-d)*.7,p=y[T]*-.7,_=`background: url('${a[0]}') no-repeat left top / 1332px 700px;width: ${h}px;height: ${v}px;background-position: ${p}px ${f}px;`;l.value.push({heroId:I,style:_,empty:I===""})}}return(c,M)=>(H(),$("div",jt,[i("div",Kt,[ue(Gt,{skin:e.skin},null,8,["skin"]),i("ul",{class:"hero-list",style:b(r.value)},[(H(!0),$(q,null,Y(l.value,(u,v)=>(H(),$("li",{hero:!u.empty,style:b(u.style),key:v},[u.empty===!1?(H(),$("a",{key:0,onClick:X(f=>o.value.heroId=u.heroId,["prevent"]),href:"/bilibili/hero/hero-console.html","data-hero-id":u.heroId,class:"no-drag",title:""},null,8,Zt)):ee("",!0)],12,Wt))),128))],4),o.value.heroId!==""?(H(),he(zt,{key:0,clickHero:o.value,skin:e.skin},null,8,["clickHero","skin"])):ee("",!0)])]))}}),en=j(Qt,[["__scopeId","data-v-8e4a3551"]]);export{en as H};
